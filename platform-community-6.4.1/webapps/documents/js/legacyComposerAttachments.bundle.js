define((()=>(()=>{var __webpack_modules__={669:(e,t,s)=>{e.exports=s(609)},448:(e,t,s)=>{"use strict";var r=s(867),i=s(26),o=s(372),n=s(327),a=s(97),l=s(109),c=s(985),d=s(61);e.exports=function(e){return new Promise((function(t,s){var h=e.data,u=e.headers,p=e.responseType;r.isFormData(h)&&delete u["Content-Type"];var m=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",v=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";u.Authorization="Basic "+btoa(f+":"+v)}var _=a(e.baseURL,e.url);function g(){if(m){var r="getAllResponseHeaders"in m?l(m.getAllResponseHeaders()):null,o={data:p&&"text"!==p&&"json"!==p?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m};i(t,s,o),m=null}}if(m.open(e.method.toUpperCase(),n(_,e.params,e.paramsSerializer),!0),m.timeout=e.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(s(d("Request aborted",e,"ECONNABORTED",m)),m=null)},m.onerror=function(){s(d("Network Error",e,null,m)),m=null},m.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),s(d(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",m)),m=null},r.isStandardBrowserEnv()){var F=(e.withCredentials||c(_))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;F&&(u[e.xsrfHeaderName]=F)}"setRequestHeader"in m&&r.forEach(u,(function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete u[t]:m.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(m.withCredentials=!!e.withCredentials),p&&"json"!==p&&(m.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&m.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&m.upload&&m.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){m&&(m.abort(),s(e),m=null)})),h||(h=null),m.send(h)}))}},609:(e,t,s)=>{"use strict";var r=s(867),i=s(849),o=s(321),n=s(185);function a(e){var t=new o(e),s=i(o.prototype.request,t);return r.extend(s,o.prototype,t),r.extend(s,t),s}var l=a(s(655));l.Axios=o,l.create=function(e){return a(n(l.defaults,e))},l.Cancel=s(263),l.CancelToken=s(972),l.isCancel=s(502),l.all=function(e){return Promise.all(e)},l.spread=s(713),l.isAxiosError=s(268),e.exports=l,e.exports.default=l},263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},972:(e,t,s)=>{"use strict";var r=s(263);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var s=this;e((function(e){s.reason||(s.reason=new r(e),t(s.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,s)=>{"use strict";var r=s(867),i=s(327),o=s(782),n=s(572),a=s(185),l=s(875),c=l.validators;function d(e){this.defaults=e,this.interceptors={request:new o,response:new o}}d.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&l.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean,"1.0.0"),forcedJSONParsing:c.transitional(c.boolean,"1.0.0"),clarifyTimeoutError:c.transitional(c.boolean,"1.0.0")},!1);var s=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,s.unshift(t.fulfilled,t.rejected))}));var i,o=[];if(this.interceptors.response.forEach((function(e){o.push(e.fulfilled,e.rejected)})),!r){var d=[n,void 0];for(Array.prototype.unshift.apply(d,s),d=d.concat(o),i=Promise.resolve(e);d.length;)i=i.then(d.shift(),d.shift());return i}for(var h=e;s.length;){var u=s.shift(),p=s.shift();try{h=u(h)}catch(e){p(e);break}}try{i=n(h)}catch(e){return Promise.reject(e)}for(;o.length;)i=i.then(o.shift(),o.shift());return i},d.prototype.getUri=function(e){return e=a(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){d.prototype[e]=function(t,s){return this.request(a(s||{},{method:e,url:t,data:(s||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){d.prototype[e]=function(t,s,r){return this.request(a(r||{},{method:e,url:t,data:s}))}})),e.exports=d},782:(e,t,s)=>{"use strict";var r=s(867);function i(){this.handlers=[]}i.prototype.use=function(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},97:(e,t,s)=>{"use strict";var r=s(793),i=s(303);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},61:(e,t,s)=>{"use strict";var r=s(481);e.exports=function(e,t,s,i,o){var n=new Error(e);return r(n,t,s,i,o)}},572:(e,t,s)=>{"use strict";var r=s(867),i=s(527),o=s(502),n=s(655);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||n.adapter)(e).then((function(t){return a(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(a(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,s,r,i){return e.config=t,s&&(e.code=s),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},185:(e,t,s)=>{"use strict";var r=s(867);e.exports=function(e,t){t=t||{};var s={},i=["url","method","data"],o=["headers","auth","proxy","params"],n=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function l(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function c(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(s[i]=l(void 0,e[i])):s[i]=l(e[i],t[i])}r.forEach(i,(function(e){r.isUndefined(t[e])||(s[e]=l(void 0,t[e]))})),r.forEach(o,c),r.forEach(n,(function(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(s[i]=l(void 0,e[i])):s[i]=l(void 0,t[i])})),r.forEach(a,(function(r){r in t?s[r]=l(e[r],t[r]):r in e&&(s[r]=l(void 0,e[r]))}));var d=i.concat(o).concat(n).concat(a),h=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return r.forEach(h,c),s}},26:(e,t,s)=>{"use strict";var r=s(61);e.exports=function(e,t,s){var i=s.config.validateStatus;s.status&&i&&!i(s.status)?t(r("Request failed with status code "+s.status,s.config,null,s.request,s)):e(s)}},527:(e,t,s)=>{"use strict";var r=s(867),i=s(655);e.exports=function(e,t,s){var o=this||i;return r.forEach(s,(function(s){e=s.call(o,e,t)})),e}},655:(e,t,s)=>{"use strict";var r=s(867),i=s(16),o=s(481),n={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l,c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(l=s(448)),l),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,s){if(r.isString(e))try{return(0,JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,s=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,n=!s&&"json"===this.responseType;if(n||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(n)})),e.exports=c},849:e=>{"use strict";e.exports=function(e,t){return function(){for(var s=new Array(arguments.length),r=0;r<s.length;r++)s[r]=arguments[r];return e.apply(t,s)}}},327:(e,t,s)=>{"use strict";var r=s(867);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,s){if(!t)return e;var o;if(s)o=s(t);else if(r.isURLSearchParams(t))o=t.toString();else{var n=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),n.push(i(t)+"="+i(e))})))})),o=n.join("&")}if(o){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},372:(e,t,s)=>{"use strict";var r=s(867);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,s,i,o,n){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(s)&&a.push("expires="+new Date(s).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(o)&&a.push("domain="+o),!0===n&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},268:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},985:(e,t,s)=>{"use strict";var r=s(867);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");function i(e){var r=e;return t&&(s.setAttribute("href",r),r=s.href),s.setAttribute("href",r),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:"/"===s.pathname.charAt(0)?s.pathname:"/"+s.pathname}}return e=i(window.location.href),function(t){var s=r.isString(t)?i(t):t;return s.protocol===e.protocol&&s.host===e.host}}():function(){return!0}},16:(e,t,s)=>{"use strict";var r=s(867);e.exports=function(e,t){r.forEach(e,(function(s,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=s,delete e[r])}))}},109:(e,t,s)=>{"use strict";var r=s(867),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,s,o,n={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),s=r.trim(e.substr(o+1)),t){if(n[t]&&i.indexOf(t)>=0)return;n[t]="set-cookie"===t?(n[t]?n[t]:[]).concat([s]):n[t]?n[t]+", "+s:s}})),n):n}},713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},875:(e,t,s)=>{"use strict";var r=s(593),i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}}));var o={},n=r.version.split(".");function a(e,t){for(var s=t?t.split("."):n,r=e.split("."),i=0;i<3;i++){if(s[i]>r[i])return!0;if(s[i]<r[i])return!1}return!1}i.transitional=function(e,t,s){var i=t&&a(t);function n(e,t){return"[Axios v"+r.version+"] Transitional option '"+e+"'"+t+(s?". "+s:"")}return function(s,r,a){if(!1===e)throw new Error(n(r," has been removed in "+t));return i&&!o[r]&&(o[r]=!0,console.warn(n(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(s,r,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,s){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var o=r[i],n=t[o];if(n){var a=e[o],l=void 0===a||n(a,o,e);if(!0!==l)throw new TypeError("option "+o+" must be "+l)}else if(!0!==s)throw Error("Unknown option "+o)}},validators:i}},867:(e,t,s)=>{"use strict";var r=s(849),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function n(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===i.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var s=0,r=e.length;s<r;s++)t.call(null,e[s],s,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!n(e)&&null!==e.constructor&&!n(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:l,isUndefined:n,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var t={};function s(s,r){l(t[r])&&l(s)?t[r]=e(t[r],s):l(s)?t[r]=e({},s):o(s)?t[r]=s.slice():t[r]=s}for(var r=0,i=arguments.length;r<i;r++)d(arguments[r],s);return t},extend:function(e,t,s){return d(t,(function(t,i){e[i]=s&&"function"==typeof t?r(t,s):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},851:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var axios__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(669),axios__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__),_attachmentsService_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(816),_extension__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(647);const __WEBPACK_DEFAULT_EXPORT__={directives:{DynamicEvents:{bind:function(e,t,s){const r=t.value;r&&r.forEach((e=>{s.componentInstance&&s.componentInstance.$on(e.event,(t=>{const r=t||e.listenerParam;s.context[e.listener](r)}))}))},unbind:function(e,t,s){s.componentInstance&&s.componentInstance.$off()}}},props:{value:{type:Array,default:()=>[]},spaceId:{type:String,default:""},maxFilesCount:{type:Number,required:!1,default:parseInt(`${eXo.env.portal.maxToUpload}`)},maxFileSize:{type:Number,required:!1,default:parseInt(`${eXo.env.portal.maxFileSize}`)},showAttachmentsBackdrop:{type:Boolean,default:!0}},data(){return{showDestinationFolder:!1,message:"",selectedFolder:"",uploadingFilesQueue:[],attachedFiles:[],uploadingCount:0,maxUploadInProgressCount:2,maxProgress:100,showDocumentSelector:!1,fileSizeLimitError:!1,fileSizeNullError:!1,filesCountLimitError:!1,sameFileError:!1,sameFileErrorMessage:`${this.$t("attachments.drawer.sameFile.error")}`,BYTES_IN_MB:1048576,MESSAGES_DISPLAY_TIME:5e3,drawerTitle:null,pathDestinationFolder:"",showDestinationPath:!1,schemaFolder:[],destinationFileName:"",showDestinationFolderForFile:!1,modeFolderSelectionForFile:!1,showAttachmentsDrawer:!1,displayMessageDestinationFolder:!0,cloudDriveConnecting:!1,connectedDrive:{},privateFilesAttached:!1,isActivityStream:!0,fromAnotherSpaces:"",spaceGroupId:"",spaceDisplayName:"",attachmentSeveralFiles:!1,drivesInProgress:{},attachmentInfo:!1,attachmentConfirmInfo:!1,isCloudDriveEnabled:!1,creationType:""}},computed:{attachmentsFileAvailableFor(){return this.attachmentSeveralFiles?this.$t("attachments.alert.sharing.filesAvailableFor"):this.$t("attachments.alert.sharing.fileAvailableFor")},attachmentsFileMembers(){return this.attachmentSeveralFiles?this.$t("attachments.alert.sharing.members"):this.$t("attachments.alert.sharing.fileMembers")}},watch:{fileSizeLimitError:function(){this.fileSizeLimitError&&setTimeout((()=>this.fileSizeLimitError=!1),this.MESSAGES_DISPLAY_TIME)},filesCountLimitError:function(){this.filesCountLimitError&&setTimeout((()=>this.filesCountLimitError=!1),this.MESSAGES_DISPLAY_TIME)},sameFileError:function(){this.sameFileError&&setTimeout((()=>this.sameFileError=!1),this.MESSAGES_DISPLAY_TIME)},attachmentInfo:function(){this.attachmentInfo&&setTimeout((()=>this.attachmentInfo=!1),this.MESSAGES_DISPLAY_TIME)},attachmentConfirmInfo:function(){this.attachmentConfirmInfo&&setTimeout((()=>this.attachmentConfirmInfo=!1),this.MESSAGES_DISPLAY_TIME)},value:{deep:!0,handler(){if(this.attachedFiles=this.value,this.$emit("attachmentsChanged",this.attachedFiles),this.displayMessageDestinationFolder=!this.attachedFiles.some((e=>null!=e.uploadId&&""!==e.uploadId)),0===this.attachedFiles.length&&(this.pathDestinationFolder="",this.showDestinationPath=!1,this.schemaFolder=[],this.displayMessageDestinationFolder=!0,this.addDefaultPath()),this.attachedFiles.length>0&&!this.pathDestinationFolder)for(let e=0;e<this.attachedFiles.length;e++)this.attachedFiles[e].pathDestinationFolder||(this.attachedFiles[e].pathDestinationFolder=this.pathDestinationFolder);this.privateFilesAttached=this.attachedFiles.some((e=>!1===e.isPublic)),this.fromAnotherSpaces=this.attachedFiles.filter((({space:e})=>e&&e.name!==this.groupId)).map((({space:e})=>e.title)).filter(((e,t,s)=>s.indexOf(e)===t)).join(",")}}},mounted(){["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(function(e){this.$refs.dropFileBox.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation()}.bind(this),!1)}.bind(this)),this.$refs.dropFileBox.addEventListener("drop",function(e){this.handleFileUpload(e.dataTransfer.files)}.bind(this)),window.require(["SHARED/jquery"],(function(e){e('#exoAttachmentsApp *[rel="tooltip"]').tooltip()}))},created(){this.addDefaultPath(),this.getCloudDriveStatus(),document.addEventListener("extension-AttachmentsComposer-attachments-composer-action-updated",(()=>this.attachmentsComposerActions=(0,_extension__WEBPACK_IMPORTED_MODULE_1__.h)())),this.attachmentsComposerActions=(0,_extension__WEBPACK_IMPORTED_MODULE_1__.h)()},methods:{toggleAttachmentsDrawer:function(){this.showAttachmentsDrawer=!this.showAttachmentsDrawer,this.showAttachmentsDrawer?(document.addEventListener("paste",this.onPaste,!1),$(".spaceButtomNavigation").addClass("hidden")):(document.removeEventListener("paste",this.onPaste,!1),$(".spaceButtomNavigation").removeClass("hidden")),this.$emit("HideAttachmentsDrawer",this.uploadingCount)},uploadFile:function(){this.$refs.uploadInput.click()},handleFileUpload:function(e){const t=Array.from(e);t.sort((function(e,t){return e.size-t.size}));const s=[];t.forEach((e=>{s.push({originalFileObject:e,name:e.name,size:e.size,mimetype:e.type,uploadId:this.getNewUploadId(),uploadProgress:0,destinationFolder:this.pathDestinationFolder,pathDestinationFolderForFile:"",isPublic:!0})})),s.forEach((e=>{this.queueUpload(e)})),this.$refs.uploadInput.value=""},getFormattedFileSize(e){return(e/this.BYTES_IN_MB).toFixed(2)},getNewUploadId:function(){return Math.floor(1e5*Math.random())},queueUpload:function(e){if(this.attachedFiles.length>=this.maxFilesCount)return void(this.filesCountLimitError=!0);const t=e.size/this.BYTES_IN_MB;if(!(t>this.maxFileSize))return 0===t?(this.fileSizeNullError=!0,void window.setTimeout((()=>this.fileSizeNullError=!1),2e3)):this.attachedFiles.some((t=>t.name===e.name))?(this.sameFileErrorMessage=this.sameFileErrorMessage.replace("{0}",e.name),void(this.sameFileError=!0)):(this.attachedFiles.push(e),void(this.uploadingCount<this.maxUploadInProgressCount?this.sendFileToServer(e):this.uploadingFilesQueue.push(e)));this.fileSizeLimitError=!0},processNextQueuedUpload:function(){this.uploadingFilesQueue.length>0&&this.sendFileToServer(this.uploadingFilesQueue.shift())},sendFileToServer:function(file){this.uploadingCount++,this.$emit("uploadingCountChanged",this.uploadingCount);const formData=new FormData;formData.append("file",file.originalFileObject);const uploadUrl=`${eXo.env.server.context}/upload?action=upload&uploadId=${file.uploadId}`;axios__WEBPACK_IMPORTED_MODULE_0___default().request({method:"POST",url:uploadUrl,credentials:"include",data:formData,onUploadProgress:e=>{file.uploadProgress=Math.round(e.loaded*this.maxProgress/e.total)}}).then((()=>{const progressUrl=`${eXo.env.server.context}/upload?action=progress&uploadId=${file.uploadId}`;fetch(progressUrl).then((e=>e.text())).then((responseText=>{let responseObject;try{eval(`responseObject = ${responseText}`)}catch(e){return}responseObject.upload[file.uploadId]&&responseObject.upload[file.uploadId].percent&&responseObject.upload[file.uploadId].percent===this.maxProgress.toString()?file.uploadProgress=this.maxProgress:this.removeAttachedFile(file.uploadId)})),this.uploadingCount--,this.$emit("uploadingCountChanged",this.uploadingCount),this.processNextQueuedUpload(),this.creationType=this.$t("attachments.uploaded.from.device"),this.sendDocumentAnalytics(file)}))},removeAttachedFile:function(e){e.id?this.attachedFiles=this.attachedFiles.filter((t=>t.id!==e.id)):(this.attachedFiles=this.attachedFiles.filter((t=>t.uploadId!==e.uploadId)),e.uploadProgress!==this.maxProgress&&(this.uploadingCount--,this.$emit("uploadingCountChanged",this.uploadingCount),this.processNextQueuedUpload())),this.$emit("input",this.attachedFiles)},addDestinationFolder(e,t){this.pathDestinationFolder=e,this.showDestinationPath=""!==e;for(let e=0;e<this.attachedFiles.length;e++)this.attachedFiles[e].destinationFolder||(this.attachedFiles[e].destinationFolder=this.pathDestinationFolder);this.schemaFolder=[];const s=t.split("/");for(let e=0;e<s.length;e++)this.schemaFolder[e]=s[e];this.showDocumentSelector=!this.showDocumentSelector,this.drawerTitle=this.showDocumentSelector?this.$t("attachments.drawer.existingUploads"):this.$t("attachments.drawer.header"),this.showDocumentSelector||(this.showDestinationFolder=!1)},addDestinationFolderForFile(e,t,s){for(let r=0;r<this.attachedFiles.length;r++)this.attachedFiles[r].name===this.destinationFileName&&(this.attachedFiles[r].pathDestinationFolderForFile=t,this.attachedFiles[r].destinationFolder=e,this.attachedFiles[r].isPublic=s);this.pathDestinationFolder="",this.showDocumentSelector=!this.showDocumentSelector,this.drawerTitle=this.showDocumentSelector?this.$t("attachments.drawer.existingUploads"):this.$t("attachments.drawer.header"),this.showDocumentSelector||(this.showDestinationFolderForFile=!1),this.modeFolderSelectionForFile=!1,this.attachmentConfirmInfo=!0,this.selectedFolder=t},toggleServerFileSelector(e){e&&(this.attachedFiles=e,this.attachmentInfo=!0,this.$emit("input",this.attachedFiles),this.$emit("attachmentsChanged",this.attachedFiles),e.length>1&&(this.attachmentSeveralFiles=!0),this.creationType=this.$t("attachments.uploaded.from.cloud"),e.forEach((e=>{this.sendDocumentAnalytics(e)}))),this.showDocumentSelector=!this.showDocumentSelector,this.drawerTitle=this.showDocumentSelector?this.$t("attachments.drawer.existingUploads"):this.$t("attachments.drawer.header"),this.showDocumentSelector||(this.showDestinationFolder=!1,this.showDestinationFolderForFile=!1)},toggleSelectDestinationFolder(){this.showDestinationFolder=!0,this.showDocumentSelector=!this.showDocumentSelector,this.drawerTitle=this.showDocumentSelector?this.$t("attachments.drawer.destination.folder"):this.$t("attachments.drawer.header")},openSelectDestinationFolderForFile(e){this.modeFolderSelectionForFile=!0,this.destinationFileName=e.name,this.showDestinationFolderForFile=!0,this.showDocumentSelector=!this.showDocumentSelector,this.drawerTitle=this.showDocumentSelector?this.$t("attachments.drawer.destination.folder"):this.$t("attachments.drawer.header")},addDefaultPath(){eXo.env.portal.spaceId?_attachmentsService_js__WEBPACK_IMPORTED_MODULE_2__.NL(eXo.env.portal.spaceId).then((e=>{this.schemaFolder.push(e.displayName),this.schemaFolder.push("Activity Stream Documents"),this.showDestinationPath=!0,this.isActivityStream=!1,this.spaceGroupId=e.groupId,this.spaceDisplayName=e.displayName})):(this.schemaFolder.push(eXo.env.portal.userName),this.schemaFolder.push("Public"),this.schemaFolder.push("Activity Stream Documents"),this.showDestinationPath=!0,this.isActivityStream=!0)},deleteDestinationFolderForFile(e){for(let t=0;t<this.attachedFiles.length;t++)if(this.attachedFiles[t].name===e){this.attachedFiles[t].showDestinationFolderForFile="",this.attachedFiles[t].pathDestinationFolderForFile="",this.attachedFiles[t].isPublic=!0;break}},setCloudDriveProgress({progress:e}){this.cloudDriveConnecting=!!e},onPaste(e){if(e.clipboardData&&e.clipboardData.items){const t=Array.from(e.clipboardData.items),s=t.filter((e=>~e.type.indexOf("text")))[0]||null,r=s?s.type:"",i=t.filter((e=>~e.type.indexOf("image")))[0]||null;if(i){const e=i.getAsFile();this.getFilename(s,r,(t=>{const s=new File([e],t,{type:e.type});this.handleFileUpload([s])}))}}},getFilename(e,t,s){let r;const i=this;e?e.getAsString((e=>{if("text/plain"===t)r=decodeURI(e).split("/").pop();else if("text/html"===t){const t=i.parseHTML(e).querySelectorAll("img")[0];r=t.src.split("/").pop()}s(r)})):(r=`image-${Date.now()}.png`,s(r))},parseHTML(e){const t=document.createElement("template");return t.innerHTML=e,t.content.cloneNode(!0)},addCloudDrive(e){this.connectedDrive=e},changeCloudDriveProgress(e){this.drivesInProgress=e},getCloudDriveStatus(){_attachmentsService_js__WEBPACK_IMPORTED_MODULE_2__.Jb().then((e=>{this.isCloudDriveEnabled="true"===e.result}))},sendDocumentAnalytics(e){if(e&&e.uploadId||e.UUID||e.id){const t=eXo.env.portal.selectedNodeUri,s=e.uploadId||e.UUID||e.id,r=e.name.split(".").pop()||e.title.split(".").pop(),i={module:"Drive",subModule:"attachment-drawer",parameters:{documentId:s,origin:t.toLowerCase(),documentSize:e.size,documentName:e.name||e.title,documentExtension:r,creationType:this.creationType},userId:eXo.env.portal.userIdentityId,spaceId:eXo.env.portal.spaceId,userName:eXo.env.portal.userName,operation:"fileCreated",timestamp:Date.now()};document.dispatchEvent(new CustomEvent("exo-statistic-message",{detail:i}))}}}}},816:(e,t,s)=>{"use strict";function r(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/spaces/${e}`,{credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.json()})).catch((e=>{throw c(`Error getting space: ${e.errorMessage?e.errorMessage:e.errorCode}`),new Error(`Error getting space with id ${e}`)}))}function i(e,t,s){return fetch(`/portal/rest/managedocument/getFoldersAndFiles/?driveName=${e}&workspaceName=${t}&currentFolder=${s}`,{}).then((e=>e.ok?e.text():e.text().then((e=>{throw c(`Error get data: ${e}`),new Error(e)})))).then((e=>(new window.DOMParser).parseFromString(e,"text/xml"))).then((e=>{if(e)return e})).catch((e=>{throw c(`Error get data: ${e.errorMessage?e.errorMessage:e}`),new Error(`Error getting folders and files of the current path ${e}`)}))}function o(){return fetch("/portal/rest/wcmDriver/getDrivers",{}).then((e=>e.ok?e.text():e.text().then((e=>{throw c(`Error get data: ${e}`),new Error(e)})))).then((e=>(new window.DOMParser).parseFromString(e,"text/xml"))).then((e=>{if(e)return e})).catch((e=>{throw c(`Error get drives data: ${e.errorMessage?e.errorMessage:e}`),new Error(`Error getting drivers ${e}`)}))}function n(e,t,s,r){return fetch(`/portal/rest/managedocument/createFolder?driveName=${e}&workspaceName=${t}&currentFolder=${s}&folderName=${r}`,{}).then((e=>e.ok?e.text():e.text().then((e=>{throw c(`Error post data: ${e}`),new Error(e)})))).then((e=>(new window.DOMParser).parseFromString(e,"text/xml"))).then((e=>{if(e)return e})).catch((e=>{throw c(`Error creating folder: ${e.errorMessage?e.errorMessage:e}`),new Error(`Error creating a new folder ${e}`)}))}function a(e,t,s){return fetch(`/portal/rest/managedocument/deleteFolderOrFile/?driveName=${e}&workspaceName=${t}&itemPath=${s}`,{}).then((e=>e.ok?e.text():e.text().then((e=>{throw c(`Error delete data: ${e}`),new Error(e)})))).then((e=>(new window.DOMParser).parseFromString(e,"text/xml"))).then((e=>{if(e)return e})).catch((e=>{throw c(`Error deleting the folder: ${e.errorMessage?e.errorMessage:e}`),new Error(`Error deleting the folder or the file ${e}`)}))}function l(e,t){return fetch(`/portal/rest/contents/rename/rename?oldPath=${e}&newTitle=${t}`,{credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.ok})).catch((e=>{throw c(`Error rename folder: ${e.errorMessage?e.errorMessage:e.errorCode}`),new Error(`Error rename this folder ${e}`)}))}function c(e,t){const s="[attachmentsSelector] ";if("undefined"!=typeof console&&void 0!==console.log){const r=`--${(new Date).toISOString()}`;let i=e;t?(i+=". Error: ",t.name||t.message?(t.name&&(i+=`[${t.name}]`),t.message&&(i+=t.message)):i+="string"==typeof t?t:JSON.stringify(t)+(t.toString&&"function"==typeof t.toString?`; ${t.toString()}`:""),console.log(s+i+r),void 0!==t.stack&&console.log(t.stack)):(null!=t&&(i+=`. Error: ${t}`),console.log(s+i+r))}}function d(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/clouddrive/features/status/enabled`,{credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.json()}))}s.d(t,{Jb:()=>d,L6:()=>n,NL:()=>r,QD:()=>i,iN:()=>a,jT:()=>o,p0:()=>l})},647:(e,t,s)=>{"use strict";s.d(t,{E:()=>o,h:()=>i});let r=null;function i(){if(null==r||!r.length){const e=("attachments-composer-action",extensionRegistry.loadExtensions("AttachmentsComposer","attachments-composer-action"));r=e.filter((e=>function(e){if(Object.prototype.hasOwnProperty.call(e,"enabled")){if("boolean"==typeof e.enabled)return e.enabled;if(n(e.enabled))return e.enabled.call()}return!0}(e)))}return r}function o(e,t){Object.prototype.hasOwnProperty.call(e,"onExecute")&&n(e.onExecute)&&e.onExecute.apply(t,[t])}function n(e){return e&&"[object Function]"==={}.toString.call(e)}},593:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__webpack_require__),s.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{destroy:()=>v,init:()=>f});var e=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"exoAttachmentsApp"}},[t("div",{staticClass:"attachments drawer ignore-vuetify-classes",class:{open:e.showAttachmentsDrawer},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])||t.target!==t.currentTarget?null:e.toggleAttachmentsDrawer()}}},[t("div",{staticClass:"attachmentsHeader header",class:e.showDocumentSelector?"documentSelector":""},[e.showDocumentSelector?t("a",{staticClass:"backButton",on:{click:function(t){return e.toggleServerFileSelector()}}},[t("i",{staticClass:"uiIconBack"})]):e._e(),e._v(" "),e.showDocumentSelector?e._e():t("a",{staticClass:"backButton",on:{click:function(t){return e.toggleAttachmentsDrawer()}}},[t("i",{staticClass:"uiIconBack"})]),e._v(" "),t("span",{staticClass:"attachmentsTitle"},[e._v(e._s(e.drawerTitle||e.$t("attachments.drawer.header")))]),e._v(" "),t("a",{staticClass:"attachmentsCloseIcon",on:{click:function(t){return e.toggleAttachmentsDrawer()}}},[e._v("×")]),e._v(" "),t("v-progress-linear",{attrs:{active:e.cloudDriveConnecting,absolute:"",bottom:"",indeterminate:""}})],1),e._v(" "),t("div",{staticClass:"content",class:e.showDocumentSelector?"serverFiles":"attachments"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showDocumentSelector,expression:"!showDocumentSelector"}]},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.attachmentInfo&&e.isActivityStream&&(e.privateFilesAttached||e.fromAnotherSpaces.length>0),expression:"attachmentInfo && isActivityStream && (privateFilesAttached || fromAnotherSpaces.length > 0)"}],staticClass:"alert alert-info attachmentsAlert"},[e._v("\n          "+e._s(e.$t("attachments.alert.sharing.attachedFrom"))+"\n          "+e._s(e.$t("attachments.alert.sharing."+(e.privateFilesAttached&&!e.fromAnotherSpaces.length?"personal":"space")))+"\n          "),t("b",{directives:[{name:"show",rawName:"v-show",value:e.fromAnotherSpaces.length>0,expression:"fromAnotherSpaces.length > 0"}]},[e._v("\n            "+e._s(e.fromAnotherSpaces)+"\n          ")]),e._v("\n          "+e._s(e.$t("attachments.alert.sharing.availableFor"))+" "+e._s(e.$t("attachments.alert.sharing.connections"))+"\n        ")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.attachmentInfo&&!e.isActivityStream&&(e.privateFilesAttached||e.fromAnotherSpaces.length>0),expression:"attachmentInfo && !isActivityStream && (privateFilesAttached || fromAnotherSpaces.length > 0)"}],staticClass:"alert alert-info attachmentsAlert"},[e._v("\n          "+e._s(e.$t("attachments.alert.sharing.attachedFrom"))+"\n          "+e._s(e.$t("attachments.alert.sharing."+(e.privateFilesAttached&&!e.fromAnotherSpaces.length?"personal":"space")))+"\n          "),t("b",{directives:[{name:"show",rawName:"v-show",value:e.fromAnotherSpaces.length>0,expression:"fromAnotherSpaces.length > 0"}]},[e._v("\n            "+e._s(e.fromAnotherSpaces)+"\n          ")]),e._v("\n          "+e._s(e.attachmentsFileAvailableFor)+" "),t("b",[e._v(e._s(e.spaceDisplayName))]),e._v(" "+e._s(e.attachmentsFileMembers)+"\n        ")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.attachmentConfirmInfo,expression:"attachmentConfirmInfo"}],staticClass:"alert alert-info attachmentsAlert"},[t("span",[e._v(e._s(e.$t("attachments.alert.sharing.attachedFrom"))+" "),t("b",[e._v(e._s(e.selectedFolder))]),e._v(" "+e._s(e.$t("attachment.alert.drive.confirm")))])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showDocumentSelector,expression:"!showDocumentSelector"}],staticClass:"attachmentsContent"},[t("div",{staticClass:"multiploadFilesSelector"},[t("div",{ref:"dropFileBox",staticClass:"dropFileBox",attrs:{id:"DropFileBox"}},[t("div",{staticClass:"contentAttachments"},[t("div",{staticClass:"contentDragAndDrop"},[t("div",{staticClass:"contentDrop"},[e._m(0),e._v(" "),t("div",[t("span",{staticClass:"dropMsg colorText"},[e._v(e._s(e.$t("attachments.drawer.dropOrPaste")))])])]),e._v(" "),t("div",{staticClass:"contentUpload"},[t("a",{staticClass:"uploadButton",attrs:{title:e.$t("attachments.drawer.upload"),href:"#",rel:"tooltip","data-placement":"bottom"},on:{click:e.uploadFile}},[t("i",{staticClass:"fas fa-download uiIcon32x32LightGray colorIcon"}),e._v(" "),t("span",{staticClass:"text colorText"},[e._v(e._s(e.$t("attachments.drawer.upload")))]),e._v(" "),t("span",{staticClass:"mobileText"},[e._v(e._s(e.$t("attachments.drawer.upload")))])])])]),e._v(" "),t("div",{staticClass:"contentOR"},[e._m(1),e._v(" "),t("div",{staticClass:"itemOR"},[t("span",{staticClass:"or colorText"},[e._v(" "+e._s(e.$t("attachments.drawer.or"))+"  ")])]),e._v(" "),e._m(2)]),e._v(" "),t("div",{staticClass:"lastContent"},[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:r}){return[t("a",e._g(e._b({staticClass:"uploadButton",attrs:{href:"#",rel:"tooltip","data-placement":"bottom"},on:{click:function(t){return e.toggleServerFileSelector()}}},"a",r,!1),s),[t("i",{staticClass:"uiIcon32x32FolderDefault uiIcon32x32LightGray"}),e._v(" "),t("v-icon",{staticClass:"iconCloud",attrs:{color:"#fff","x-small":""}},[e._v("cloud")]),e._v(" "),t("span",{staticClass:"text colorText"},[e._v(e._s(e.$t("attachments.drawer.existingUploads")))])],1)]}}])},[e._v(" "),t("span",[e._v(e._s(e.$t("attachments.drawer.existingUploads")))])])],1)])]),e._v(" "),t("div",{staticClass:"fileHidden",staticStyle:{display:"none"}},[t("input",{ref:"uploadInput",staticClass:"file",staticStyle:{display:"none"},attrs:{name:"file",type:"file",multiple:"multiple"},on:{change:function(t){return e.handleFileUpload(e.$refs.uploadInput.files)}}})]),e._v(" "),t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.fileSizeLimitError,expression:"fileSizeLimitError"}],staticClass:"sizeExceeded alert alert-error"},[t("i",{staticClass:"uiIconError"}),e._v("\n              "+e._s(e.$t("attachments.drawer.maxFileSize.error").replace("{0}",e.maxFileSize))+"\n            ")])]),e._v(" "),t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.fileSizeNullError,expression:"fileSizeNullError"}],staticClass:"sizeExceeded alert alert-error"},[t("i",{staticClass:"uiIconError"}),e._v("\n              "+e._s(e.$t("attachments.drawer.nullFileSize.error"))+"\n            ")])]),e._v(" "),t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.filesCountLimitError,expression:"filesCountLimitError"}],staticClass:"countExceeded alert alert-error"},[t("i",{staticClass:"uiIconError"}),e._v("\n              "+e._s(e.$t("attachments.drawer.maxFileCount.error").replace("{0}",e.maxFilesCount))+"\n            ")])]),e._v(" "),t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.sameFileError,expression:"sameFileError"}],staticClass:"sameFile alert alert-error"},[t("i",{staticClass:"uiIconError"}),e._v("\n              "+e._s(e.sameFileErrorMessage)+"\n            ")])])],1),e._v(" "),t("div",{staticClass:"limitMessage"},[t("div",{staticClass:"sizeLimit"},[e._v(e._s(e.$t("attachments.drawer.maxFileSize").replace("{0}",e.maxFileSize)))]),e._v(" "),t("div",{staticClass:"countLimit"},[e._v(e._s(e.$t("attachments.drawer.maxFileCount").replace("{0}",e.maxFilesCount)))])]),e._v(" "),t("div",{staticClass:"uploadedFiles"},[t("div",{staticClass:"uploadedFilesTitle"},[e._v(e._s(e.$t("attachments.drawer.title"))+" ("+e._s(e.attachedFiles.length)+")")]),e._v(" "),e.attachedFiles.length>0?t("div",{staticClass:"destinationFolder"},[e.showDestinationPath&&!e.displayMessageDestinationFolder?t("div",{staticClass:"folderLocation"},[t("div",{staticClass:"drive",attrs:{title:e.schemaFolder[0],rel:"tooltip","data-placement":"top"}},[e._v("\n                "+e._s(e.schemaFolder[0])+"\n              ")]),e._v(" "),e.schemaFolder.length>1?t("div",{staticClass:"folder"},[e._m(3),e._v(" "),t("div",{staticClass:"folderName",class:2===e.schemaFolder.length?"active":"",attrs:{title:e.schemaFolder[1],rel:"tooltip","data-placement":"top"}},[e._v("\n                  "+e._s(e.schemaFolder[1])+"\n                ")])]):e._e(),e._v(" "),3===e.schemaFolder.length?t("div",{staticClass:"folder"},[e._m(4),e._v(" "),t("div",{staticClass:"folderName",class:"Activity Stream Documents"!==e.schemaFolder[2]?"path":"active",attrs:{title:e.schemaFolder[2],rel:"tooltip","data-placement":"top"}},[e._v("\n                  "+e._s(e.schemaFolder[2])+"\n                ")])]):e._e(),e._v(" "),e.schemaFolder.length>3?t("div",{staticClass:"folder"},[e._m(5),e._v(" "),t("div",{staticClass:"folderName",attrs:{title:e.schemaFolder[2],rel:"tooltip","data-placement":"top"}},[e._v("\n                  ...\n                ")])]):e._e(),e._v(" "),e._l(e.schemaFolder.slice(e.schemaFolder.length-1,e.schemaFolder.length),(function(s){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.schemaFolder.length>3,expression:"schemaFolder.length > 3"}],key:s,staticClass:"folder"},[e._m(6,!0),e._v(" "),t("div",{staticClass:"folderName",class:e.schemaFolder[e.schemaFolder.length-1]===s&&e.schemaFolder[e.schemaFolder.length-1].length<11?"active":"path",attrs:{title:s,rel:"tooltip","data-placement":"top"}},[e._v("\n                  "+e._s(s)+"\n                ")])])}))],2):e._e(),e._v(" "),e.displayMessageDestinationFolder?t("div",{staticClass:"messageDestination"},[t("p",{attrs:{title:e.$t("attachments.drawer.destination.attachment.message"),rel:"tooltip","data-placement":"top"}},[e._v("\n                "+e._s(e.$t("attachments.drawer.destination.attachment.message"))+"\n              ")])]):e._e(),e._v(" "),t("button",{staticClass:"buttonSelect",attrs:{disabled:e.displayMessageDestinationFolder},on:{click:function(t){return e.toggleSelectDestinationFolder()}}},[t("i",{staticClass:"uiIconFolder",class:e.displayMessageDestinationFolder?"disabled":"",attrs:{title:e.displayMessageDestinationFolder?e.$t("attachments.drawer.destination.attachment.access"):e.$t("attachments.drawer.destination.attachment"),rel:"tooltip","data-placement":"top"}})])]):e._e(),e._v(" "),t("div",{staticClass:"uploadedFilesItems"},e._l(e.attachedFiles,(function(s){return t("div",{key:s.name,staticClass:"uploadedFilesItem"},[t("div",{staticClass:"showDestination"},[t("div",{staticClass:"showFile"},[t("exo-attachment-item",{attrs:{file:s}})],1)]),e._v(" "),t("div",{staticClass:"destinationFolder"},[t("div",{staticClass:"folderLocation"},[t("div",{staticClass:"emptyMessage"}),e._v(" "),s.pathDestinationFolderForFile&&s.uploadId?t("div",{staticClass:"box"},[t("div",[t("p",{staticClass:"folder",attrs:{title:s.pathDestinationFolderForFile,rel:"tooltip","data-placement":"top"}},[e._v("\n                        "+e._s(s.pathDestinationFolderForFile)+"\n                      ")])]),e._v(" "),t("div",{staticClass:"folderName"},[t("a",{staticClass:"colorIcon",on:{click:function(t){return e.deleteDestinationFolderForFile(s.name)}}},[e._v("x")])])]):e._e(),e._v(" "),t("div",[!s.pathDestinationFolderForFile&&s.uploadId?t("i",{staticClass:"fas fa-folder fa-sm colorIcon",attrs:{title:e.$t("attachments.drawer.destination.folder"),rel:"tooltip","data-placement":"top"},on:{click:function(t){return e.openSelectDestinationFolderForFile(s)}}}):e._e()]),e._v(" "),t("div",[s.uploadId?e._e():t("i",{staticClass:"fas fa-ban fa-xs colorIconStop",attrs:{title:e.$t("attachments.drawer.destination.attachment.access"),rel:"tooltip","data-placement":"top"}})]),e._v(" "),t("div",{staticClass:"btnTrash"},[t("i",{staticClass:"fas fa-trash fa-xs colorIcon",attrs:{title:e.$t("attachments.drawer.delete"),rel:"tooltip","data-placement":"top"},on:{click:function(t){return e.removeAttachedFile(s)}}})])])])])})),0)])]),e._v(" "),!e.showDocumentSelector||e.showDestinationFolder||e.showDestinationFolderForFile?e._e():t("exo-folders-files-selector",{attrs:{"attached-files":e.attachedFiles,"space-id":e.spaceId,"is-cloud-enabled":e.isCloudDriveEnabled,"extension-refs":e.$refs,"connected-drive":e.connectedDrive,"cloud-drives-in-progress":e.drivesInProgress},on:{itemsSelected:e.toggleServerFileSelector,cancel:function(t){return e.toggleServerFileSelector()}}}),e._v(" "),e.showDocumentSelector&&e.showDestinationFolder&&!e.showDestinationFolderForFile?t("exo-folders-files-selector",{attrs:{"is-cloud-enabled":e.isCloudDriveEnabled,"mode-folder-selection":e.showDestinationFolder},on:{itemsSelected:e.addDestinationFolder,cancel:function(t){return e.toggleServerFileSelector()}}}):e._e(),e._v(" "),e.showDocumentSelector&&e.showDestinationFolderForFile?t("exo-folders-files-selector",{attrs:{"is-cloud-enabled":e.isCloudDriveEnabled,"mode-folder-selection":e.showDestinationFolderForFile,"mode-folder-selection-for-file":e.modeFolderSelectionForFile},on:{itemsSelected:e.addDestinationFolderForFile,cancel:function(t){return e.toggleServerFileSelector()}}}):e._e(),e._v(" "),e._l(e.attachmentsComposerActions,(function(s){return t("div",{key:s.key,class:`${s.appClass}Action`},[s.component?t(s.component.name,e._b({directives:[{name:"dynamic-events",rawName:"v-dynamic-events",value:s.component.events,expression:"action.component.events"}],ref:s.key,refInFor:!0,tag:"component"},"component",s.component.props?s.component.props:{},!1)):e._e()],1)}))],2),e._v(" "),e.showDocumentSelector?e._e():t("div",{staticClass:"attachmentsFooter footer ignore-vuetify-classes"},[t("a",{staticClass:"btn btn-primary ignore-vuetify-classes",on:{click:function(t){return e.toggleAttachmentsDrawer()}}},[e._v(e._s(e.$t("attachments.drawer.apply")))])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showAttachmentsDrawer&&e.showAttachmentsBackdrop,expression:"showAttachmentsDrawer && showAttachmentsBackdrop"}],staticClass:"drawer-backdrop",on:{click:function(t){return e.toggleAttachmentsDrawer()}}})])};function t(e,t,s,r,i,o,n,a){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=s,c._compiled=!0),r&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),n?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=l):i&&(l=a?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,l):[l]}return{exports:e,options:c}}e._withStripped=!0;const s=t(__webpack_require__(851).Z,e,[function(){var e=this._self._c;return e("div",{staticClass:"icon"},[e("i",{staticClass:"uiIconTemplate uiIcon32x32LightGray colorText"})])},function(){var e=this._self._c;return e("div",{staticClass:"item"},[e("span",{staticClass:"colorText"},[e("hr",{staticClass:"leftLine"})])])},function(){var e=this._self._c;return e("div",{staticClass:"item"},[e("span",{staticClass:"colorText"},[e("hr",{staticClass:"rightLine"})])])},function(){var e=this._self._c;return e("div",[e("span",{staticClass:"uiIconArrowRight colorIcon"})])},function(){var e=this._self._c;return e("div",[e("span",{staticClass:"uiIconArrowRight colorIcon"})])},function(){var e=this._self._c;return e("div",[e("span",{staticClass:"uiIconArrowRight colorIcon"})])},function(){var e=this._self._c;return e("div",[e("span",{staticClass:"uiIconArrowRight colorIcon"})])}],!1,null,null,null).exports;var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"serverFiles"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.connectedMessage,expression:"connectedMessage"}],staticClass:"alert alert-info attachmentsAlert"},[t("b",[e._v(e._s(e.$t("attachments.alert.connected"))+" "+e._s(e.connectedMessage)+"!")]),e._v(e._s(e.$t("attachments.alert.pleaseNote"))+"\n  ")]),e._v(" "),t("div",{staticClass:"contentHeader"},[e.showSearchInput?e._e():t("div",{staticClass:"currentDirectory"},[t("div",{staticClass:"documents",on:{click:function(t){return e.fetchUserDrives()}}},[t("i",{staticClass:"uiIconFolder"}),e._v(" "),t("p",{staticClass:"documents",attrs:{"data-toggle":"tooltip",rel:"tooltip","data-placement":"bottom","data-original-title":"Documents"}},[e._v("\n          "+e._s(e.$t("attachments.drawer.drives"))+"\n        ")])]),e._v(" "),e.currentDrive?t("div",{staticClass:"currentDrive",on:{click:function(t){return e.openDrive(e.currentDrive)}}},[t("span",{staticClass:"uiIconArrowRight"}),e._v(" "),t("a",{staticClass:"currentDriveTitle",class:e.currentDrive.isSelected?"active":"",attrs:{title:e.getI18nTitle(e.currentDrive.title,"Drives"),"data-toggle":"tooltip",rel:"tooltip","data-placement":"bottom"}},[e._v("\n          "+e._s(e.getI18nTitle(e.currentDrive.title,"Drives"))+"\n        ")])]):e._e(),e._v(" "),t("div",{staticClass:"foldersHistory"},[e.foldersHistory.length>2?t("div",{staticClass:"longFolderHistory"},[t("span",{staticClass:"uiIconArrowRight"}),e._v(" "),t("div",{staticClass:"btn-group"},[t("button",{staticClass:"btn dropdown-toggle",attrs:{"data-toggle":"dropdown"}},[e._v("...")]),e._v(" "),t("ul",{staticClass:"dropdown-menu"},e._l(e.foldersHistory.slice(0,e.foldersHistory.length-2),(function(s){return t("li",{key:s},[t("a",{on:{click:function(t){return e.openFolder(s)}}},[e._v(e._s(s.title))])])})),0)])]):e._e(),e._v(" "),e._l(e.foldersHistory.slice(e.foldersHistory.length-2,e.foldersHistory.length),(function(s){return t("div",{key:s,staticClass:"folderHistory"},[t("span",{staticClass:"uiIconArrowRight"}),e._v(" "),t("a",{staticClass:"currentSpaceDirectory",class:s.isSelected?"active":"",attrs:{title:s.title,"data-toggle":"tooltip",rel:"tooltip","data-placement":"bottom"},on:{click:function(t){return e.openFolder(s)}}},[e._v("\n            "+e._s(s.title)+"\n          ")])])}))],2)]),e._v(" "),t("div",{staticClass:"selectorActions",class:e.showSearchInput?"visible":""},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchFilesFolders,expression:"searchFilesFolders"}],ref:"searchServerAttachments",staticClass:"searchInput",attrs:{id:"searchServerAttachments",type:"text"},domProps:{value:e.searchFilesFolders},on:{input:function(t){t.target.composing||(e.searchFilesFolders=t.target.value)}}}),e._v(" "),t("a",{staticClass:"uiIconLightGray",class:e.showSearchInput?"uiIconCloseServerAttachments":"uiIconFilter",on:{click:function(t){return e.showSearchDocumentInput()}}}),e._v(" "),(e.modeFolderSelectionForFile||e.modeFolderSelection)&&e.currentDrive?t("a",{staticClass:"uiIconLightGray uiIconAddFolder",attrs:{title:e.$t("attachments.filesFoldersSelector.button.addNewFOlder.tooltip"),rel:"tooltip","data-placement":"bottom"},on:{click:function(t){return e.addNewFolder()}}}):e._e()]),e._v(" "),e._l(e.attachmentsComposerActions,(function(s){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showDriveAction,expression:"showDriveAction"}],key:s.key,staticClass:"actionBox",class:`${s.appClass}Action`},[e.modeFolderSelection?e._e():t("div",{staticClass:"actionBoxLogo",on:{click:function(t){return e.executeAction(s)}}},[s.iconName?t("v-icon",{staticClass:"uiActionIcon"},[e._v(e._s(s.iconName))]):t("i",{staticClass:"uiActionIcon",class:s.iconClass})],1)])}))],2),e._v(" "),t("transition",{attrs:{name:"fade",mode:"in-out"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showErrorMessage,expression:"showErrorMessage"}],staticClass:"alert foldersFilesSelectorAlert alert-error"},[t("i",{staticClass:"uiIconError"}),e._v(e._s(e.errorMessage)+"\n    ")])]),e._v(" "),t("div",{staticClass:"contentBody"},[e.currentDrive?t("div",{staticClass:"selectionBox"},[e.loadingFolders?t("div",{staticClass:"VuetifyApp loader"},[t("v-app",{staticClass:"VuetifyApp"},[t("v-progress-circular",{staticClass:"loadingRing",attrs:{size:30,width:3,indeterminate:"",color:"#476A9C"}})],1)],1):e._e(),e._v(" "),e.emptyFolder?t("div",{staticClass:"emptyFolder"},[t("i",{staticClass:"uiIconEmptyFolder"}),e._v(" "),t("p",[e._v(e._s(e.$t("attachments.drawer.destination.subfolder.empty")))])]):e._e(),e._v(" "),e._l(e.filteredFolders,(function(s){return t("div",{key:s.id,staticClass:"folderSelection",class:"new_folder"===s.type?"boxOfFolder":"",attrs:{id:s.id,title:s.name},on:{click:function(t){return e.openFolder(s)},contextmenu:function(t){return e.openFolderActionsMenu(s,t)}}},["new_folder"===s.type?t("a",{staticClass:"closeIcon",attrs:{href:"javascript:void(0);"},on:{mousedown:function(t){return e.cancelCreatingNewFolder(t)}}},[t("p",[e._v("\n            x\n          ")])]):e._e(),e._v(" "),t("div",{class:"new_folder"===s.type?"boxOfTitle":""},[t("a",{attrs:{title:e.getI18nTitle(s.title,"Folder"),href:"javascript:void(0);",rel:"tooltip","data-placement":"bottom"}},[t("i",{staticClass:"uiIcon24x24FolderDefault uiIconEcmsLightGray selectionIcon center",class:s.folderTypeCSSClass}),e._v(" "),t("i",{directives:[{name:"show",rawName:"v-show",value:s.isCloudDrive,expression:"folder.isCloudDrive"}],staticClass:"uiIcon-clouddrive",class:e.getFolderIcon(s)}),e._v(" "),"new_folder"===s.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.newFolderName,expression:"newFolderName"}],ref:s.ref,refInFor:!0,staticClass:"newFolderInput ignore-vuetify-classes",attrs:{type:"text"},domProps:{value:e.newFolderName},on:{blur:function(t){return e.createNewFolder(t)},keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.target.blur()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.cancelCreatingNewFolder(t)}],input:function(t){t.target.composing||(e.newFolderName=t.target.value)}}}):e.renameFolderAction&&s.id===e.selectedFolder.id?t("input",{directives:[{name:"model",rawName:"v-model",value:e.newName,expression:"newName"}],ref:"rename",refInFor:!0,staticClass:"newFolderInput ignore-vuetify-classes",attrs:{id:s.id,type:"text"},domProps:{value:e.newName},on:{blur:function(t){return e.saveNewNameFolder()},keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.target.blur()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.cancelRenameNewFolder(t)}],input:function(t){t.target.composing||(e.newName=t.target.value)}}}):t("div",{staticClass:"selectionLabel center"},[e._v(e._s(e.getI18nTitle(s.title,"Folder")))])])])])})),e._v(" "),t("exo-dropdown-menu",{ref:"folderActionsMenu",attrs:{"folder-actions-menu-left":e.folderActionsMenuLeft,"folder-actions-menu-top":e.folderActionsMenuTop,"show-dropdown-menu":e.showFolderActionsMenu,"selected-folder":e.selectedFolder},on:{renameFolder:function(t){return e.renameFolder()},deleteFolder:e.deleteFolder,closeMenu:e.closeFolderActionsMenu}}),e._v(" "),e.emptyFolderForSelectDestination&&e.modeFolderSelection&&!e.emptyFolder?t("div",{staticClass:"emptyFolder"},[t("i",{staticClass:"uiIconEmptyFolder"}),e._v(" "),t("p",[e._v(e._s(e.$t("attachments.drawer.destination.subfolder.empty")))])]):e._e(),e._v(" "),e._l(e.filteredFiles,(function(s){return t("div",{directives:[{name:"show",rawName:"v-show",value:!e.modeFolderSelection,expression:"!modeFolderSelection"}],key:s.id,staticClass:"fileSelection",class:s.selected?"selected":"",attrs:{id:s.idAttribute,title:s.idAttribute},on:{click:function(t){return e.selectFile(s)}}},[t("exo-attachment-item",{attrs:{file:s}})],1)}))],2):t("div",{staticClass:"categorizedDrives"},[t("v-list",{staticClass:"drivesList",attrs:{dense:"",flat:""}},[t("v-list-group",{staticClass:"categories",attrs:{value:"true",eager:""}},e._l(e.filteredDrivers,(function(s,r){return t("v-list-group",{key:r,staticClass:"category",attrs:{ripple:!1,"sub-group":"","no-action":"",value:"true","active-class":"categoryActive"},scopedSlots:e._u([{key:"activator",fn:function(){return[t("v-list-item-content",{staticClass:"categoryContent"},[e._v(e._s(e.getI18nTitle(r,"Category")))])]},proxy:!0}],null,!0)},[e._v(" "),t("div",{staticClass:"selectionBox"},e._l(s.drives,(function(s){return t("div",{key:s.name,staticClass:"folderSelection",attrs:{title:e.getI18nTitle(s.title,"Drives")},on:{click:function(t){return e.openDrive(s,r)}}},[t("a",{attrs:{"data-original-title":s.title,rel:"tooltip","data-placement":"bottom"}},[t("i",{directives:[{name:"show",rawName:"v-show",value:!e.drivesInProgress[s.title],expression:"!drivesInProgress[driver.title]"}],staticClass:"uiIconEcmsLightGray selectionIcon center",class:s.isCloudDrive?s.driveTypeCSSClass:`uiIconEcms24x24DriveGroup ${s.driveTypeCSSClass}`}),e._v(" "),t("div",{staticClass:"text-center connectingDrive"},[t("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.drivesInProgress[s.title]>=0||e.drivesInProgress[s.title]<=100,expression:"drivesInProgress[driver.title] >= 0 || drivesInProgress[driver.title] <= 100"}],staticClass:"connectingDriveProgress",attrs:{indeterminate:!1,rotate:0,size:40,value:e.drivesInProgress[s.title],width:4,color:"var(--allPagesPrimaryColor, #476A9C)"}},[e._v(e._s(e.drivesInProgress[s.title])),t("span",{staticClass:"connectingDriveProgressPercent"},[e._v("%")])])],1),e._v(" "),t("div",{staticClass:"selectionLabel center",class:{connectingDriveTitle:e.drivesInProgress[s.title]>=0||e.drivesInProgress[s.title]<=100}},[e._v(e._s(e.getI18nTitle(s.title,"Drives")))])])])})),0)])})),1)],1)],1)]),e._v(" "),t("div",{staticClass:"attachActions"},[!e.modeFolderSelection&&e.currentDrive?t("div",{staticClass:"limitMessage"},[t("span",{staticClass:"countLimit",class:e.filesCountClass},[e._v("\n        "+e._s(e.$t("attachments.drawer.maxFileCountLeft").replace("{0}",e.filesCountLeft))+"\n      ")])]):e._e(),e._v(" "),e.modeFolderSelection?t("div",{staticClass:"buttonActions btnActions"},[t("button",{staticClass:"btn btn-primary attach ignore-vuetify-classes btnSelect",attrs:{type:"button"},on:{click:function(t){return e.selectDestination()}}},[e._v("\n        "+e._s(e.$t("attachments.drawer.select"))+"\n      ")]),e._v(" "),t("button",{staticClass:"btn btnCancel",attrs:{type:"button"},on:{click:function(t){return e.$emit("cancel")}}},[e._v("\n        "+e._s(e.$t("attachments.drawer.cancel"))+"\n      ")])]):e._e(),e._v(" "),!e.modeFolderSelection&&e.currentDrive?t("div",{staticClass:"buttonActions"},[t("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(t){return e.$emit("cancel")}}},[e._v("\n        "+e._s(e.$t("attachments.drawer.cancel"))+"\n      ")]),e._v(" "),t("button",{staticClass:"btn btn-primary attach ignore-vuetify-classes",attrs:{disabled:0===e.selectedFiles.length,type:"button"},on:{click:function(t){return e.addSelectedFiles()}}},[e._v("\n        "+e._s(e.$t("attachments.drawer.select"))+"\n      ")])]):e._e()]),e._v(" "),t("exo-confirm-dialog",{ref:"confirmDialog",attrs:{title:e.titleLabel,message:e.popupBodyMessage,"ok-label":e.okLabel,"cancel-label":e.cancelLabel},on:{ok:e.okConfirmDialog}})],1)};r._withStripped=!0;var i=__webpack_require__(816),o=__webpack_require__(647);const n=t({props:{modeFolderSelectionForFile:{type:Boolean,default:!1},modeFolderSelection:{type:Boolean,default:!1},isCloudEnabled:{type:Boolean,default:!1},spaceId:{type:String,default:""},attachedFiles:{type:Array,default:()=>[]},extensionRefs:{type:Array,default:()=>[]},connectedDrive:{type:Object,default:()=>({})},cloudDrivesInProgress:{type:Object,default:()=>({})}},data:()=>({workspace:"collaboration",currentDrive:null,driveRootPath:"",drivers:[],folders:[],files:[],space:{},selectedFiles:[],maxFilesCount:20,foldersHistory:[],showSearchInput:!1,searchFilesFolders:"",loadingFolders:!0,filesCountClass:"",selectedFolderPath:"",schemaFolder:"",folderDestinationForFile:"",attachmentsComposerActions:[],creatingNewFolder:!1,newFolderName:"",currentAbsolutePath:"",popupBodyMessage:"",showFolderActionsMenu:!1,folderActionsMenuTop:"0px",folderActionsMenuLeft:"0px",selectedFolder:{},windowPositionLimit:25,MESSAGE_TIMEOUT:5e3,showErrorMessage:!1,errorMessage:"",renameFolderAction:!1,newName:"",MESSAGES_DISPLAY_TIME:5e3,privateDestinationForFile:!1,fromSpace:{},okLabel:"",cancelLabel:"",titleLabel:"",okAction:!1}),computed:{showDriveAction(){return this.isCloudEnabled&&(!this.currentDrive||"Personal Documents"===this.currentDrive.name)},filteredFolders(){let e=this.folders.slice();if(this.searchFilesFolders&&this.searchFilesFolders.trim().length){const t=this.searchFilesFolders.trim().toLowerCase();e=this.folders.filter((e=>e.name.toLowerCase().indexOf(t)>=0))}const t=document.createElement("textarea");return e.forEach((e=>{t.innerHTML=e.title,e.title=t.value})),e},filteredFiles(){let e=this.files.slice();if(this.searchFilesFolders&&this.searchFilesFolders.trim().length){const t=this.searchFilesFolders.trim().toLowerCase();e=this.files.filter((e=>e.name.toLowerCase().indexOf(t)>=0))}return e},filteredDrivers(){let e=this.drivers.slice();if(this.searchFilesFolders&&this.searchFilesFolders.trim().length){const t=this.searchFilesFolders.trim().toLowerCase();e=this.drivers.filter((e=>e.title.toLowerCase().indexOf(t)>=0))}const t={"My Drives":{drives:[]},"My Spaces":{drives:[]},Others:{drives:[]}};return e.map((e=>("Personal Drives"===e.driverType?t["My Drives"].drives.push(e):e.path.includes("spaces")?t["My Spaces"].drives.push(e):e.path.includes("Trash")||t.Others.drives.push(e),e))),t},filesCountLeft(){return this.maxFilesCount-this.selectedFiles.length},emptyFolder(){return 0===this.files.length&&0===this.folders.length&&0===this.drivers.length&&!this.loadingFolders},emptyFolderForSelectDestination(){return 0===this.folders.length&&0===this.drivers.length&&!this.loadingFolders},connectedMessage(){let e;for(const t in this.drivesInProgress){const s=100;e=this.drivesInProgress[t]>=s?t:""}return e},drivesInProgress(){return{...this.cloudDrivesInProgress.drives}}},watch:{filesCountLeft(){this.filesCountClass=0===this.filesCountLeft?"noFilesLeft":""},showErrorMessage:function(e){e&&setTimeout((()=>this.showErrorMessage=!1),this.MESSAGE_TIMEOUT)},connectedDrive:function(e){this.drivers.some((({title:t})=>t===e.title))||this.drivers.push(e)}},created(){this.selectedFiles=this.attachedFiles.slice();const e=this,t=this.getURLQueryParam("spaceId")?this.getURLQueryParam("spaceId"):`${eXo.env.portal.spaceId}`?`${eXo.env.portal.spaceId}`:this.spaceId;i.NL(t).then((t=>{if(t.id){e.space=t;const s=t.groupId.split("/spaces/")[1];e.currentDrive={name:`.spaces.${s}`,title:s,isSelected:!0},e.fetchChildrenContents("")}else e.currentDrive=null,this.fetchUserDrives()})).catch((()=>{this.errorMessage=`${this.$t("attachments.fetchFoldersAndFiles.error")}`,this.showErrorMessage=!0})),document.addEventListener("extension-AttachmentsComposer-attachments-composer-action-updated",(()=>this.attachmentsComposerActions=(0,o.h)())),this.attachmentsComposerActions=(0,o.h)()},methods:{getI18nTitle(e,t){const s=`${t}.label.${e.replace(/\s+|_/g,"")}`,r=this.$t(s);return r===s&&e||r},openFolder:function(e){this.selectedFolder.id&&this.selectedFolder.canRemove?this.$refs.rename[0].focus():e.type&&"new_folder"===e.type?this.$refs.newFolder[0].focus():(this.currentAbsolutePath=e.path,this.generateHistoryTree(e),this.resetExplorer(),e.isSelected=!0,this.fetchChildrenContents(e.path),this.getFolderPath(e),this.schemaFolder=this.currentDrive.title.concat("/",e.path),this.folderDestinationForFile=e.name),this.schemaFolder=this.currentDrive.title.concat("/",e.path),this.folderDestinationForFile=e.title,this.privateDestinationForFile=e.isPublic},openDrive(e,t){this.currentAbsolutePath="",this.foldersHistory=[],this.resetExplorer(),this.fromSpace="My Spaces"===t?{title:e.title,name:e.name}:{},this.currentDrive={name:e.name,title:e.title,isSelected:!0},this.fetchChildrenContents("")},fetchChildrenContents:function(e){this.loadingFolders=!0;const t=this;i.QD(this.currentDrive.name,this.workspace,e).then((s=>{const r=s.childNodes[0];"/"===r.getAttribute("path")?t.driveRootPath=`${r.getAttribute("path")}`:""===e&&(t.driveRootPath=`${r.getAttribute("path")}/`),t.setFoldersAndFiles(r),t.loadingFolders=!1})).catch((e=>{this.loadingFolders=!1,this.errorMessage=`${this.$t("attachments.fetchFoldersAndFiles.error")}. ${e.message?e.message:""}`,this.showErrorMessage=!0}))},fetchUserDrives(){this.resetExplorer(),this.loadingFolders=!0,this.currentDrive=null,this.foldersHistory=[];const e=this;i.jT().then((t=>{const s=t.childNodes[0].childNodes;e.setDrivers(s),this.loadingFolders=!1})).catch((()=>{this.loadingFolders=!1,this.errorMessage=`${this.$t("attachments.getDrivers.error")}`,this.showErrorMessage=!0}))},resetExplorer(){this.drivers=[],this.folders=[],this.files=[]},getRelativePath:function(e){if(e&&e.startsWith(this.driveRootPath))return e.substr(this.driveRootPath.length)},getURLQueryParam(e){const t=new URLSearchParams(window.location.search);if(t.has(e))return t.get(e)},selectFile(e){if("fileSelection"===document.getElementById(e.idAttribute).className&&this.filesCountLeft>0)document.getElementById(e.idAttribute).className="fileSelection selected",this.selectedFiles.find((t=>t.id===e.id))||this.selectedFiles.push({...e,space:this.fromSpace});else{document.getElementById(e.idAttribute).className="fileSelection";const t=this.selectedFiles.findIndex((t=>t.id===e.id));-1!==t&&this.selectedFiles.splice(t,1)}},generateHistoryTree(e){!this.foldersHistory.find((t=>t.name===e.name))&&e&&this.foldersHistory.push({name:e.name,title:e.title,path:e.driverType?"":e.path,driverType:e.driverType?e.driverType:""}),!e.driverType&&e.path&&(this.foldersHistory=this.foldersHistory.filter((t=>e.path.split("/").find((e=>e===t.name))))),this.currentDrive.isSelected=!1,this.foldersHistory.forEach((e=>e.isSelected=!1)),this.foldersHistory.find((t=>t.name===e.name)).isSelected=!0},addSelectedFiles(){this.$emit("itemsSelected",this.selectedFiles)},showSearchDocumentInput(){this.showSearchInput=!this.showSearchInput,document.getElementById("searchServerAttachments").style.display=this.showSearchInput?"block":"none",this.$refs.searchServerAttachments.focus(),this.searchFilesFolders=""},setFoldersAndFiles(e){const t=e.childNodes;for(let e=0;e<t.length;e++)if("Folders"===t[e].tagName){const s=t[e].childNodes;for(let e=0;e<s.length;e++){const t=`uiIcon24x24${s[e].getAttribute("nodeType").replace(":","_")}`,r=s[e].getAttribute("path").split("/").pop();this.folders.push({id:r,name:s[e].getAttribute("name"),title:s[e].getAttribute("title"),path:s[e].getAttribute("currentFolder"),folderTypeCSSClass:t,isSelected:!1,canRemove:"true"===s[e].getAttribute("canRemove"),isCloudDrive:"true"===s[e].getAttribute("isCloudDrive"),isPublic:"true"===s[e].getAttribute("isPublic"),cloudProvider:s[e].getAttribute("cloudProvider")})}}else if("Files"===t[e].tagName){const s=t[e].childNodes;for(let e=0;e<s.length;e++){const t=s[e].getAttribute("path").split("/").pop(),r=s[e].getAttribute("id"),i=this.attachedFiles.some((e=>e.id===r));this.files.push({id:r,name:s[e].getAttribute("name"),title:s[e].getAttribute("title"),path:this.getRelativePath(s[e].getAttribute("path")),size:s[e].getAttribute("size"),idAttribute:t,selected:i,mimetype:s[e].getAttribute("nodeType"),isCloudFile:"true"===s[e].getAttribute("isCloudFile"),isPublic:"true"===s[e].getAttribute("isPublic")})}}},setDrivers(e){for(let t=0;t<e.length;t++)if("Folders"===e[t].tagName){const s=e[t].childNodes;let r;const i=e[t].getAttribute("name");r="Personal Drives"===i?"uiIconEcms24x24DrivePrivate":`uiIconEcms24x24Drive${i.split(" ")[0]}`;for(let e=0;e<s.length;e++){const t=s[e].getAttribute("name"),o="true"===s[e].getAttribute("isCloudDrive"),n=o?`uiIconEcmsDrive-${s[e].getAttribute("cloudProvider")}`:`${t.replace(/\s/g,"")} ${r}`;this.drivers.push({name:t,title:s[e].getAttribute("label"),path:s[e].getAttribute("path"),css:s[e].getAttribute("nodeTypeCssClass"),type:"drive",driveTypeCSSClass:n,driverType:i,isCloudDrive:o})}}},selectDestination(){this.selectedFolderPath||(this.selectedFolderPath=this.driveRootPath,this.schemaFolder=this.currentDrive.title,this.folderDestinationForFile=this.currentDrive.title),this.modeFolderSelectionForFile?this.$emit("itemsSelected",this.selectedFolderPath,this.folderDestinationForFile,this.privateDestinationForFile):this.$emit("itemsSelected",this.selectedFolderPath,this.schemaFolder)},executeAction(e){(0,o.E)(e,this.extensionRefs[e.key][0])},addNewFolder(){this.creatingNewFolder||(this.creatingNewFolder=!0,this.newFolderName=this.$t("Folder.label.newfolder"),this.folders.unshift({id:"new_folder",type:"new_folder",ref:"newFolder",folderTypeCSSClass:"uiIcon24x24nt_folder",isSelected:!1})),this.$nextTick((()=>this.$refs.newFolder[0].focus()))},createNewFolder(){if(this.creatingNewFolder)if(this.newFolderName)if(this.folders.some((e=>e.title===this.newFolderName)))this.$refs.confirmDialog.open(),this.titleLabel=this.$t("attachments.filesFoldersSelector.popup.title"),this.okLabel=this.$t("attachments.filesFoldersSelector.popup.button.ok"),this.popupBodyMessage=`${this.$t("attachments.filesFoldersSelector.popup.folderNameExists")}`;else{const e=this;i.L6(this.currentDrive.name,this.workspace,this.currentAbsolutePath,this.newFolderName).then((t=>{const s=t.childNodes[0];if(s){const t=`uiIcon24x24${s.getAttribute("nodeType").replace(":","_")}`,r={id:s.getAttribute("path").split("/").pop(),name:s.getAttribute("name"),title:s.getAttribute("title"),path:s.getAttribute("currentFolder"),folderTypeCSSClass:t,isSelected:!1,canRemove:!0};e.folders.shift(),e.folders.unshift(r),e.creatingNewFolder=!1,e.newFolderName=""}else e.creatingNewFolder=!1,e.newFolderName=""})).catch((()=>{this.errorMessage=`${this.$t("attachments.createFolder.error")}`,this.showErrorMessage=!0}))}else this.$refs.confirmDialog.open(),this.titleLabel=this.$t("attachments.filesFoldersSelector.popup.title"),this.okLabel=this.$t("attachments.filesFoldersSelector.popup.button.ok"),this.popupBodyMessage=`${this.$t("attachments.filesFoldersSelector.popup.emptyFolderName")}`},cancelCreatingNewFolder(){this.folders.shift(),this.creatingNewFolder=!1,this.newFolderName=""},cancelRenameNewFolder(){this.renameFolderAction=!1,this.newName=this.selectedFolder.title},openFolderActionsMenu(e,t){this.selectedFolder=e,this.showFolderActionsMenu=!0,Vue.nextTick(function(){this.$refs.folderActionsMenu.$el.focus(),this.setFolderActionsMenu(t.y,t.x)}.bind(this)),t.preventDefault()},setFolderActionsMenu:function(e,t){const s=window.innerHeight-this.$refs.folderActionsMenu.$el.offsetHeight-this.windowPositionLimit,r=window.innerWidth-this.$refs.folderActionsMenu.$el.offsetWidth-this.windowPositionLimit;e>s&&(e=s),t>r&&(t=r),this.folderActionsMenuTop=`${e}px`,this.folderActionsMenuLeft=`${t}px`},closeFolderActionsMenu:function(){this.showFolderActionsMenu=!1},deleteFolder(){this.selectedFolder.canRemove&&(this.$refs.confirmDialog.open(),this.titleLabel=this.$t("attachments.filesFoldersSelector.action.delete.popup.title"),this.okLabel=this.$t("attachments.filesFoldersSelector.action.delete.popup.button.ok"),this.cancelLabel=this.$t("attachments.cancel"),this.okAction=!0,this.popupBodyMessage=`${this.$t("attachments.filesFoldersSelector.action.delete.popup.bodyMessage")}`)},okConfirmDialog(){this.okAction&&i.iN(this.currentDrive.name,this.workspace,this.selectedFolder.path).then((()=>{this.reloadCurrentPath()})).catch((()=>{this.errorMessage=`${this.$t("attachments.deleteFolderOrFile.error")}`,this.showErrorMessage=!0}))},reloadCurrentPath(){this.resetExplorer(),this.currentAbsolutePath?this.fetchChildrenContents(this.currentAbsolutePath):this.fetchChildrenContents("")},renameFolder(){this.selectedFolder.canRemove&&this.selectedFolder.title&&(this.newName=this.selectedFolder.title,this.renameFolderAction=!0,this.showFolderActionsMenu=!1,this.$nextTick((()=>{this.$refs.rename[0].focus()})))},saveNewNameFolder(){if(this.newName!==this.selectedFolder.title&&""!==this.newName)if(this.folders.some((e=>e.title===this.newName)))this.$refs.confirmDialog.open(),this.titleLabel=this.$t("attachments.filesFoldersSelector.popup.title"),this.okLabel=this.$t("attachments.filesFoldersSelector.popup.button.ok"),this.popupBodyMessage=`${this.$t("attachments.renameFolder.error")}`,this.cancelRenameNewFolder();else{this.getFolderPath(this.selectedFolder);const e=encodeURIComponent(this.workspace.concat(":",this.selectedFolderPath));i.p0(e,this.newName).then((e=>{e&&(this.renameFolderAction=!1,this.folders.find((e=>{if(e.id===this.selectedFolder.id){e.title=this.newName,e.name=this.newName,e.id=this.newName;const t=e.path.split("/");let s=t[0];for(let e=0;e<t.length-1;e++)s.concat("/",s[e]);1===t.length?s=this.newName:s.concat("/",this.newName),e.path=s}})),this.selectedFolder={})}))}else this.selectedFolder={};this.selectedFolderPath=""},getFolderPath(e){if("Public"===e.path){const t=this.driveRootPath.split("/");let s=t[0];const r=2;for(let e=1;e<t.length-r;e++)s=s.concat("/",t[e]);this.selectedFolderPath=s.concat("/",e.path)}else this.selectedFolderPath=this.driveRootPath.concat(e.path)},getFolderIcon:e=>`uiIcon-${e.cloudProvider}`}},r,[],!1,null,null,null).exports;var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"attachment"},[t("div",{staticClass:"fileType"},[t("i",{class:e.getIconClassFromFileMimeType(e.file.mimetype)})]),e._v(" "),t("div",{staticClass:"fileDetails"},[t("div",{staticClass:"fileDetails1"},[t("div",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.fileTitle,expression:"fileTitle"}],staticClass:"fileNameLabel text-truncate",attrs:{"data-toggle":"tooltip",rel:"tooltip","data-placement":"top"}}),e._v(" "),t("div",{staticClass:"fileSize"},[e._v(e._s(e.getFormattedFileSize(e.file.size))+" "+e._s(e.$t(`attachments.composer.file.size.${e.measure}`)))])]),e._v(" "),e.file.uploadProgress?t("div",{staticClass:"fileDetails2"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.file.id,expression:"!file.id"}],staticClass:"progress",class:[100===e.file.uploadProgress?"upload-completed":""]},[t("div",{staticClass:"bar",style:"width:"+e.file.uploadProgress+"%"})])]):e._e()])])};a._withStripped=!0;const l=t({props:{file:{type:Object,required:!1,default:function(){return new Object}}},data:()=>({BYTES_IN_KB:1024,BYTES_IN_MB:1048576,BYTES_IN_GB:1073741824,MB_IN_GB:10,measure:"bytes"}),computed:{fileTitle(){return this.file.title||this.file.name}},methods:{getIconClassFromFileMimeType:function(e){if(e){const t=e.replace(/\./g,"").replace("/","").replace("\\","");return this.file.isCloudFile?`uiIcon32x32${e.replace(/[/.]/g,"")}`:`uiIconFileType${t} uiIconFileTypeDefault`}return""},getFormattedFileSize:function(e){const t=this.MB_IN_GB*this.BYTES_IN_MB;let s=e;return e<10?this.measure="bytes":e<1e4?(s=e/this.BYTES_IN_KB,this.measure="kilo"):e<t?(s=e/this.BYTES_IN_MB,this.measure="mega"):(s=e/this.BYTES_IN_GB,this.measure="giga"),(+s).toFixed(2)}}},a,[],!1,null,null,null).exports;var c=function(){var e=this,t=e._self._c;return t("ul",{directives:[{name:"show",rawName:"v-show",value:e.showDropdownMenu,expression:"showDropdownMenu"}],staticClass:"dropdown-menu",style:{top:e.folderActionsMenuTop,left:e.folderActionsMenuLeft},attrs:{id:"folderActionsMenu",tabindex:"-1"},on:{blur:e.closeMenu}},[t("li",{staticClass:"folderActionsMenuItem delete",class:e.selectedFolder.canRemove?"":"disabled",on:{click:function(t){return e.deleteFolder()}}},[t("i",{staticClass:"uiIconTrash"}),e._v(" "),t("span",[e._v(e._s(e.$t("attachments.filesFoldersSelector.action.delete")))])]),e._v(" "),t("li",{staticClass:"folderActionsMenuItem rename",class:e.selectedFolder.canRemove?"":"disabled",on:{click:function(t){return e.renameFolder()}}},[t("i",{staticClass:"uiIconEdit"}),e._v(" "),t("span",[e._v(e._s(e.$t("attachments.filesFoldersSelector.action.rename")))])])])};c._withStripped=!0;const d=t({props:{showDropdownMenu:{type:Boolean,default:!1},folderActionsMenuTop:{type:Number,default:0},folderActionsMenuLeft:{type:Number,default:0},selectedFolder:{type:Object,required:!1,default:function(){return new Object}}},methods:{deleteFolder(){this.$emit("deleteFolder")},closeMenu(){this.$emit("closeMenu")},renameFolder(){this.$emit("renameFolder")}}},c,[],!1,null,null,null).exports;Vue.component("ExoAttachments",s),Vue.component("ExoFoldersFilesSelector",n),Vue.component("ExoAttachmentItem",l),Vue.component("ExoDropdownMenu",d),Vue.use(Vuetify);const h=new Vuetify(eXo.env.portal.vuetifyPreset),u="undefined"!=typeof eXo?eXo.env.portal.language:"en",p=`/portal/rest/i18n/bundle/locale.portlet.attachments-${u}.json`;if(extensionRegistry){const e=extensionRegistry.loadComponents("attachmentsSelector");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}let m;function f(){exoi18n.loadLanguageAsync(u,p).then((e=>{m=Vue.createApp({template:"<exo-attachments></exo-attachments>",i18n:e,vuetify:h},"#exoAttachmentsApp","Legacy Attachments Drawer")}))}function v(){m&&m.$destroy()}})(),__webpack_exports__})()));