define((()=>(()=>{"use strict";var e={d:(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{formatSearchResult:()=>a});var r=function(){var e=this,t=e._self._c;return t("v-card",{staticClass:"searchFileCard d-flex flex-column border-radius box-shadow",attrs:{flat:"","min-height":"227"}},[t("exo-docs-favorite-action",{attrs:{document:e.result,absolute:"",top:"0",right:"0"},on:{removed:function(t){return e.$emit("refresh-favorite")}}}),e._v(" "),t("div",{staticClass:"mx-auto flex-grow-1 px-3 pt-3"},[t("div",{ref:"excerptNode",staticClass:"text-wrap text-break caption",attrs:{title:e.excerptText}})]),e._v(" "),t("div",[t("exo-document",{ref:"documentDetail",staticClass:"light-grey-background flex-grow-0 border-top-color py-0 px-1",attrs:{document:e.result,"hide-time":""}})],1)],1)};function i(e,t,r,i,o,s,n,a){var l,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=r,d._compiled=!0),i&&(d.functional=!0),s&&(d._scopeId="data-v-"+s),n?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},d._ssrRegister=l):o&&(l=a?function(){o.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(d.functional){d._injectStyles=l;var c=d.render;d.render=function(e,t){return l.call(t),c(e,t)}}else{var p=d.beforeCreate;d.beforeCreate=p?[].concat(p,l):[l]}return{exports:e,options:d}}r._withStripped=!0;const o=i({props:{term:{type:String,default:null},result:{type:Object,default:null}},data:()=>({lineHeight:22,maxEllipsisHeight:154}),computed:{excerpts(){return[this.result&&this.result.excerpt]||0},excerptTitle(){return this.excerpts&&this.excerpts.title&&window.decodeURIComponent(this.excerpts.title[0])},excerptName(){return this.excerpts&&this.excerpts.name&&window.decodeURIComponent(this.excerpts.name[0])},excerptHtml(){return this.excerpts&&this.excerpts.join("<br />...")},excerptText(){return $("<div />").html(this.excerptHtml).text()}},mounted(){this.result&&this.excerptTitle&&this.$set(this.result,"excerptTitle",this.excerptTitle),this.computeEllipsis()},methods:{computeEllipsis(){if(!this.excerptHtml||0===this.excerptHtml.length)return;const e=this.$refs.excerptNode;if(!e)return;e.innerHTML=this.excerptHtml;let t=e.getBoundingClientRect().height||this.lineHeight;if(t>this.maxEllipsisHeight){for(;t>this.maxEllipsisHeight;){const r=this.deleteLastChars(e.innerHTML.replace(/&[a-z]*;/,""),10);if(r.length===e.innerHTML.length)break;e.innerHTML=r,t=e.getBoundingClientRect().height||this.lineHeight}e.innerHTML=this.deleteLastChars(e.innerHTML,4),e.innerHTML=`${e.innerHTML}...`}},deleteLastChars(e,t){">"===e.slice(-1)&&(e=e.replace(/<[a-zA-Z 0-9 "'=]*><\/[a-zA-Z 0-9]*>$/g,"")),t=t||1;let r="";return">"===(e=e.replace(/<br>(\.*)$/g,"")).slice(-1)?(r=(e=e.replace(/(<br>)*$/g,"")).replace(new RegExp(`([^>]{${t}})(</)([a-zA-Z 0-9]*)(>)$`),"$2$3"),r=$("<div />").html(r).html().replace(/&[a-z]*;/,""),r.length===e.length&&(r=e.replace(new RegExp("([^>]*)(</)([a-zA-Z 0-9]*)(>)$"),"$2$3"))):r=e.substring(0,e.trimRight().length-t),r}}},r,[],!1,null,null,null).exports;var s=function(){var e=this;return(0,e._self._c)("favorite-button",{attrs:{id:e.favoriteId,favorite:e.isFavorite,absolute:e.absolute,top:e.top,right:e.right,"space-id":e.spaceId,"template-params":e.templateParams,small:!1,type:"file","type-label":"Documents"},on:{removed:e.removed,"remove-error":e.removeError,added:e.added,"add-error":e.addError}})};s._withStripped=!0;const n=i({props:{document:{type:Object,default:null},absolute:{type:Boolean,default:!1},top:{type:Number,default:()=>0},right:{type:Number,default:()=>0}},data:()=>({spaceId:null,templateParams:{}}),computed:{isFavorite(){return this.document&&this.document.metadatas&&this.document.metadatas.favorites&&this.document.metadatas.favorites.length},favoriteId(){return this.document&&this.document.id}},watch:{document(){this.document&&(this.templateParams.page_id=this.document.id)}},methods:{removed(){this.displayAlert(this.$t("Favorite.tooltip.SuccessfullyDeletedFavorite")),this.$favoriteService.removeFavorite("file",this.favoriteId).then((()=>{this.isFavorite=!1,this.$emit("removed")})).catch((()=>this.$emit("remove-error")))},removeError(){this.displayAlert(this.$t("Favorite.tooltip.ErrorDeletingFavorite","document"),"error")},added(){this.displayAlert(this.$t("Favorite.tooltip.SuccessfullyAddedAsFavorite")),this.$favoriteService.addFavorite("file",this.favoriteId).then((()=>{this.isFavorite=!0,this.$emit("added")})).catch((()=>this.$emit("add-error")))},addError(){this.displayAlert(this.$t("Favorite.tooltip.ErrorAddingAsFavorite","file"),"error")},displayAlert(e,t){document.dispatchEvent(new CustomEvent("notification-alert",{detail:{message:e,type:t||"success"}}))}}},s,[],!1,null,null,null).exports;if(Vue.component("FileSearchCard",o),Vue.component("ExoDocsFavoriteAction",n),extensionRegistry){const e=extensionRegistry.loadComponents("FileSearch");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}function a(e){return e}return Vue.use(Vuetify),t})()));