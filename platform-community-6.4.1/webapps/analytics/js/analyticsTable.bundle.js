define((()=>(()=>{var e={879:()=>{extensionRegistry.registerExtension("AnalyticsTable","CellValue",{type:"user",options:{rank:40,vueComponent:Vue.options.components["analytics-table-cell-user-value"],match:(e,t)=>"userId"===e&&"TERMS"===t}}),extensionRegistry.registerExtension("AnalyticsTable","CellValue",{type:"space",options:{rank:50,vueComponent:Vue.options.components["analytics-table-cell-space-value"],match:(e,t)=>"spaceId"===e&&"TERMS"===t}})}},t={};function i(a){var l=t[a];if(void 0!==l)return l.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{"use strict";i.r(a),i.d(a,{init:()=>S});var e=function(){var e=this,t=e._self._c;return t("v-app",{staticClass:"analytics-application",attrs:{id:e.appId,flat:""}},[t("div",{staticClass:"d-flex px-3 pb-2 pt-1 white analytics-table-header",attrs:{flat:""}},[t("analytics-select-period",{attrs:{"hide-time":"",right:""},model:{value:e.selectedPeriod,callback:function(t){e.selectedPeriod=t},expression:"selectedPeriod"}}),e._v(" "),t("v-spacer"),e._v(" "),e.canUseSuggester?t("exo-identity-suggester",{staticClass:"analytics-table-suggester me-2",attrs:{"search-options":e.searchOptions,labels:e.suggesterLabels,"include-users":e.useUsersInSearch,"include-spaces":e.useSpacesInSearch,"filter-style":"",name:"selectedUser"},model:{value:e.selectedIdentity,callback:function(t){e.selectedIdentity=t},expression:"selectedIdentity"}}):e._e(),e._v(" "),e.canEdit?[t("v-btn",{staticClass:"d-none d-sm-inline text-header-title my-auto",attrs:{icon:"",title:e.$t("analytics.settings")},on:{click:function(t){return e.$refs.tableSettingDrawer.open()}}},[t("v-icon",[e._v("fa-cog")])],1),e._v(" "),t("analytics-table-setting",{ref:"tableSettingDrawer",staticClass:"mt-0",attrs:{"retrieve-mappings-url":e.retrieveMappingsUrl,settings:e.settings,"user-fields":e.userFields,"space-fields":e.spaceFields},on:{save:e.saveSettings}})]:e._e()],2),e._v(" "),t("analytics-table",{ref:"table",attrs:{"retrieve-table-data-url":e.retrieveTableDataUrl,settings:e.settings,period:e.selectedPeriod,"selected-identity":e.selectedIdentity,"user-fields":e.userFields,"space-fields":e.spaceFields,limit:e.settings&&e.settings.pageSize,"page-size":e.settings&&e.settings.pageSize}})],1)};function t(e,t,i,a,l,n,s,r){var o,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=i,u._compiled=!0),a&&(u.functional=!0),n&&(u._scopeId="data-v-"+n),s?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),l&&l.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=o):l&&(o=r?function(){l.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:l),o)if(u.functional){u._injectStyles=o;var g=u.render;u.render=function(e,t){return o.call(t),g(e,t)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,o):[o]}return{exports:e,options:u}}e._withStripped=!0;const l=t({props:{retrieveSettingsUrl:{type:String,default:function(){return null}},retrieveMappingsUrl:{type:String,default:function(){return null}},retrieveFiltersUrl:{type:String,default:function(){return null}},retrieveTableDataUrl:{type:String,default:function(){return null}},retrieveFieldValuesUrl:{type:String,default:function(){return null}},saveSettingsUrl:{type:String,default:function(){return null}}},data:()=>({settings:null,appId:`AnalyticsApplication${parseInt(1e4*Math.random()).toString().toString()}`,loading:!0,canEdit:!1,selectedIdentity:null,error:null,scope:null,initialized:!1,selectedPeriod:null,columnsData:{},searchOptions:{currentUser:"",filterType:"all"}}),computed:{suggesterLabels(){return{searchPlaceholder:this.$t("analytics.searchPlaceholder"),placeholder:this.$t("analytics.searchPlaceholder"),noDataLabel:this.$t("analytics.noDataLabel")}},mainColumnAggregation(){return this.settings&&this.settings.mainColumn&&this.settings.mainColumn.valueAggregation&&this.settings.mainColumn.valueAggregation.aggregation},mainColumnAggregationField(){return this.mainColumnAggregation&&this.mainColumnAggregation.field},useUsersInSearch(){return"userId"===this.mainColumnAggregationField},useSpacesInSearch(){return"spaceId"===this.mainColumnAggregationField},canUseSuggester(){return this.useUsersInSearch||this.useSpacesInSearch},scopeTooltip(){switch(this.scope){case"NONE":return this.$t("analytics.permissionDenied");case"GLOBAL":return this.$t("analytics.noDataRestriction");case"USER":return this.$t("analytics.dataRestrictedToCurrentUser");case"SPACE":return this.$t("analytics.dataRestrictedToCurrentSpace")}return this.error},userFields(){return[{name:"createdDate",label:this.$t("analytics.createdDate"),sortable:!0,type:"date"}]},spaceFields(){return[{name:"createdTime",label:this.$t("analytics.createdDate"),sortable:!0,type:"date"},{name:"managersCount",label:this.$t("analytics.managersCount"),sortable:!0,type:"long"},{name:"membersCount",label:this.$t("analytics.membersCount"),sortable:!0,type:"long"},{name:"redactorsCount",label:this.$t("analytics.redactorsCount"),sortable:!0,type:"long"},{name:"template",label:this.$t("analytics.template"),sortable:!0,type:"string"},{name:"subscription",label:this.$t("analytics.subscription"),sortable:!1,type:"string"},{name:"visibility",label:this.$t("analytics.visibility"),sortable:!1,type:"string"}]}},watch:{selectedPeriod(e,t){t||!e||this.initialized||(this.initialized=!0,this.init())}},created(){this.$root.retrieveSettingsUrl=this.retrieveSettingsUrl,this.$root.retrieveMappingsUrl=this.retrieveMappingsUrl,this.$root.retrieveFiltersUrl=this.retrieveFiltersUrl,this.$root.retrieveTableDataUrl=this.retrieveTableDataUrl,this.$root.retrieveFieldValuesUrl=this.retrieveFieldValuesUrl,this.$root.saveSettingsUrl=this.saveSettingsUrl},methods:{init(){return this.loading=!0,this.getSettings().then(this.$nextTick).then(this.getFilters).then(this.$nextTick).then(this.updateTable).finally((()=>{this.loading=!1}))},getSettings(){return fetch(this.retrieveSettingsUrl,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error(`Error getting analytics of table '${this.title}'`)})).then((e=>{this.scope=e&&e.scope,this.canEdit=e&&e.canEdit,this.title=e&&e.title||""})).catch((e=>{console.error("Error retrieving table settings",e),this.error="Error retrieving table settings"}))},getFilters(){return fetch(this.retrieveFiltersUrl,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error(`Error getting analytics of ${JSON.stringify(this.settings)}`)})).then((e=>{e||(e={}),e.mainColumn||(e.mainColumn={title:e.mainColumn.title||"",valueAggregation:{},thresholdAggregation:{},aggregation:{field:e.mainColumn.field||null,type:e.mainColumn.type||"TERMS"}}),e.columns||(e.columns=[]),this.settings=e})).catch((e=>{console.error("Error retrieving table filters",e),this.error="Error retrieving table filters"}))},saveSettings(e){this.loading=!0;const t=JSON.parse(JSON.stringify(e));return t.columns.forEach((e=>{e.valueAggregation&&e.valueAggregation.aggregation&&e.valueAggregation.aggregation.type||delete e.valueAggregation,e.thresholdAggregation&&e.thresholdAggregation.aggregation&&e.thresholdAggregation.aggregation.type||delete e.thresholdAggregation})),t.mainColumn.valueAggregation&&t.mainColumn.valueAggregation.aggregation&&t.mainColumn.valueAggregation.aggregation.type||delete t.mainColumn.valueAggregation,fetch(this.saveSettingsUrl,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:$.param({settings:JSON.stringify(t)})}).then((e=>{if(!e||!e.ok)throw new Error("Error saving table settings",t);return this.init()})).catch((e=>{console.error("Error saving table settings",e),this.error="Error saving table settings"})).finally((()=>{this.loading=!1}))},updateTable(){this.selectedPeriod&&this.$refs.table.refresh()}}},e,[],!1,null,null,null).exports;var n=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"tableSettingDrawer",staticClass:"analytics-table-settings",attrs:{"drawer-width":e.drawerWidth,"allow-expand":"",right:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("analytics.settings"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[e.tableSettings?t("v-card-text",[t("v-subheader",{staticClass:"px-0"},[t("h4",{staticClass:"mt-0"},[e._v(e._s(e.$t("analytics.limit")))])]),e._v(" "),t("v-text-field",{staticClass:"pt-2",attrs:{label:e.$t("analytics.limit"),placeholder:e.$t("analytics.limit"),type:"number",outlined:"",required:""},model:{value:e.tableSettings.pageSize,callback:function(t){e.$set(e.tableSettings,"pageSize",t)},expression:"tableSettings.pageSize"}}),e._v(" "),t("v-subheader",{staticClass:"px-0"},[t("h4",{staticClass:"mt-0"},[e._v(e._s(e.$t("analytics.mainColumn")))])]),e._v(" "),t("v-text-field",{staticClass:"pt-2",attrs:{label:e.$t("analytics.tableMainColumnTitle"),placeholder:e.$t("analytics.tableMainColumnTitlePlaceholder"),outlined:"",required:""},model:{value:e.tableSettings.mainColumn.title,callback:function(t){e.$set(e.tableSettings.mainColumn,"title",t)},expression:"tableSettings.mainColumn.title"}}),e._v(" "),t("analytics-field-selection",{attrs:{"fields-mappings":e.fieldsMappings,label:e.$t("analytics.fieldName"),attach:"",aggregation:""},on:{change:function(t){return e.updateMainColumnDataType()}},model:{value:e.tableSettings.mainColumn.valueAggregation.aggregation.field,callback:function(t){e.$set(e.tableSettings.mainColumn.valueAggregation.aggregation,"field",t)},expression:"tableSettings.mainColumn.valueAggregation.aggregation.field"}}),e._v(" "),t("v-list",{attrs:{nav:""}},[t("v-subheader",{staticClass:"px-0"},[t("h4",[e._v(e._s(e.$t("analytics.tableColumns")))]),e._v(" "),t("v-btn",{attrs:{color:"primary",icon:""},on:{click:e.addColumn}},[t("v-icon",[e._v("fa-plus-circle")])],1)],1),e._v(" "),t("v-list-item-group",{model:{value:e.selectedColumn,callback:function(t){e.selectedColumn=t},expression:"selectedColumn"}},e._l(e.columns,(function(i,a){return t("analytics-table-column-setting",{key:a,staticClass:"mb-0",attrs:{"fields-mappings":e.fieldsMappings,"main-column":e.mainColumn,column:i,"user-fields":e.userFields,"space-fields":e.spaceFields},on:{delete:function(t){return e.deleteColumn(a)}}})})),1)],1)],1):e._e()],1),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex"},[t("v-spacer"),e._v(" "),t("button",{staticClass:"btn ignore-vuetify-classes me-1",on:{click:function(t){return e.$refs.tableSettingDrawer.close()}}},[e._v("\n        "+e._s(e.$t("analytics.close"))+"\n      ")]),e._v(" "),t("button",{staticClass:"btn btn-primary ignore-vuetify-classes ml-1",on:{click:e.save}},[e._v("\n        "+e._s(e.$t("analytics.save"))+"\n      ")])],1)])],2)};n._withStripped=!0;const s=t({props:{retrieveMappingsUrl:{type:String,default:function(){return null}},settings:{type:Object,default:function(){return null}},userFields:{type:Array,default:function(){return null}},spaceFields:{type:Array,default:function(){return null}}},data:()=>({tableSettings:null,fieldsMappings:[],dialog:!1,selectedColumn:1,drawerWidth:"650px",tab:0}),computed:{columns(){return this.tableSettings&&this.tableSettings.columns||[]},mainColumn(){return this.tableSettings&&this.tableSettings.mainColumn}},mounted(){this.init()},methods:{init(){return this.loading=!0,fetch(this.retrieveMappingsUrl,{method:"GET",credentials:"include",headers:{Accept:"application/json"}}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting analytics fields mappings:")})).then((e=>(this.fieldsMappings=e,this.$nextTick()))).then((()=>{this.$refs&&Object.keys(this.$refs).forEach((e=>{const t=this.$refs[e];t&&t.init&&t.init()}))})).catch((e=>{console.error("fetch analytics - error",e),this.error="Error getting analytics"})).finally((()=>this.loading=!1))},addColumn(){this.columns.push({valueAggregation:{aggregation:{type:"COUNT"},filters:[]}})},deleteColumn(e){this.columns.splice(e,1),this.selectedColumn=0},open(){const e=this.settings||{},t={pageSize:e.pageSize||20,title:e.title||"",mainColumn:{title:"",valueAggregation:{aggregation:{},filters:[]}},columns:[]};e.mainColumn&&(e.mainColumn.title&&(t.mainColumn.title=e.mainColumn.title),e.mainColumn.valueAggregation&&e.mainColumn.valueAggregation.aggregation&&(t.mainColumn.valueAggregation.aggregation={field:e.mainColumn.valueAggregation.aggregation.field||null,type:e.mainColumn.type||"TERMS",dataType:e.mainColumn.dataType||"text"}),e.sortBy&&(t.sortBy=e.sortBy),e.sortDirection&&(t.sortDirection=e.sortDirection),e.mainColumn.valueAggregation&&e.mainColumn.valueAggregation.filters&&e.mainColumn.valueAggregation.filters.length&&(t.mainColumn.valueAggregation.filters=e.mainColumn.valueAggregation.filters)),e.columns&&e.columns.length&&e.columns.forEach((e=>{const i={title:e.title||"",previousPeriod:e.previousPeriod||!1,userField:e.userField||"",spaceField:e.spaceField||"",valueAggregation:{aggregation:e&&e.valueAggregation&&e.valueAggregation.aggregation||{},filters:e&&e.valueAggregation&&e.valueAggregation.filters||[],periodIndependent:e&&e.valueAggregation&&e.valueAggregation.periodIndependent||!1},sortable:e.sortable||!1,dataType:e.dataType||"text"};i.userField||i.spaceField||(e.valueAggregation&&(i.valueAggregation=e.valueAggregation),e.thresholdAggregation&&(i.thresholdAggregation=e.thresholdAggregation)),t.columns.push(i)})),this.tableSettings=t,this.selectedColumn=0,this.$refs.tableSettingDrawer.open()},updateMainColumnDataType(){const e=this.tableSettings.mainColumn,t=e&&e.valueAggregation,i=t&&t.aggregation;if(i){if(i.type="TERMS",e.dataType="text",i.field){const t=this.fieldsMappings.find((e=>e&&e.name===i.field));e.dataType=t&&t.type}e.sortable=!1,e.userField=null,e.spaceField=null,"long"!==e.dataType&&"userId"!==i.field&&"spaceId"!==i.field||(t.filters=[{field:i.field,type:"GREATER",valueString:"1"}])}},save(){this.$emit("save",this.tableSettings),this.$refs.tableSettingDrawer.close()}}},n,[],!1,null,null,null).exports;var r=function(){var e=this,t=e._self._c;return t("v-list-group",{attrs:{"active-class":"primary white--text border-radius border-color mb-0",dark:""},scopedSlots:e._u([{key:"activator",fn:function(){return[e.columnTitle?t("v-list-item-title",[e._v(e._s(e.$t(e.columnTitle)))]):t("v-list-item-title",{staticClass:"font-italic subtitle-1 text-sub-title"},[e._v(e._s(e.$t("analytics.columnTitlePlaceholder")))])]},proxy:!0}])},[e._v(" "),t("div",{staticClass:"border-radius border-color pa-2"},[e.canEnableIdentityFields?[t("v-switch",{staticClass:"my-auto text-no-wrap",attrs:{label:e.useIdentityFieldLabel},model:{value:e.useIdentityField,callback:function(t){e.useIdentityField=t},expression:"useIdentityField"}}),e._v(" "),e.useIdentityField?[e.useUserField?t("analytics-identity-field-selection",{attrs:{items:e.userFields,label:e.$t("analytics.userField")},model:{value:e.column.userField,callback:function(t){e.$set(e.column,"userField",t)},expression:"column.userField"}}):e.useSpaceField?t("analytics-identity-field-selection",{attrs:{items:e.spaceFields,label:e.$t("analytics.spaceField")},model:{value:e.column.spaceField,callback:function(t){e.$set(e.column,"spaceField",t)},expression:"column.spaceField"}}):e._e()]:e._e()]:e._e(),e._v(" "),e.canEnableIdentityFields&&e.useIdentityField?e._e():[t("v-text-field",{attrs:{label:e.$t("analytics.columnTitle"),outlined:"",required:""},model:{value:e.column.title,callback:function(t){e.$set(e.column,"title",t)},expression:"column.title"}}),e._v(" "),t("v-switch",{directives:[{name:"show",rawName:"v-show",value:!e.isTermsAggregation&&!e.isPeriodIndependent,expression:"!isTermsAggregation && !isPeriodIndependent"}],staticClass:"my-2 text-no-wrap",attrs:{label:e.$t("analytics.compareWithPreviousPeriod")},model:{value:e.column.previousPeriod,callback:function(t){e.$set(e.column,"previousPeriod",t)},expression:"column.previousPeriod"}}),e._v(" "),t("analytics-table-column-aggregation-setting",{attrs:{"column-aggregation":e.column.valueAggregation,"fields-mappings":e.fieldsMappings},on:{change:function(t){return e.updateColumnDataType("aggregation")}}}),e._v(" "),e.isTermsAggregation?e._e():[t("v-switch",{staticClass:"my-2 text-no-wrap",attrs:{label:e.$t("analytics.definePercentageThreshold")},model:{value:e.computeThreshold,callback:function(t){e.computeThreshold=t},expression:"computeThreshold"}}),e._v(" "),e.displayThresholdComuting?t("analytics-table-column-aggregation-setting",{staticClass:"ps-10 ml-2",attrs:{"column-aggregation":e.column.thresholdAggregation,"fields-mappings":e.fieldsMappings}}):e._e()]],e._v(" "),t("v-btn",{staticClass:"pa-0",attrs:{color:"error",outlined:""},on:{click:function(t){return e.$emit("delete")}}},[t("i",{staticClass:"uiIconTrash pb-1 pe-2"}),e._v("\n      "+e._s(e.$t("analytics.removeColumnSetting"))+"\n    ")])],2)])};r._withStripped=!0;const o=t({props:{mainColumn:{type:Object,default:function(){return null}},column:{type:Object,default:function(){return null}},userFields:{type:Array,default:function(){return null}},spaceFields:{type:Array,default:function(){return null}},fieldsMappings:{type:Array,default:function(){return null}}},data:()=>({useIdentityField:!1,computeThreshold:!1,aggregationType:"MAX",limitResults:!1}),computed:{columnTitle(){return this.column&&this.column.title},canEnableIdentityFields(){return this.useUserField||this.useSpaceField},mainColumnField(){return this.mainColumn&&this.mainColumn.valueAggregation&&this.mainColumn.valueAggregation.aggregation&&this.mainColumn.valueAggregation.aggregation.field},userField(){return this.column.userField},spaceField(){return this.column.spaceField},useUserField(){return"userId"===this.mainColumnField},useSpaceField(){return"spaceId"===this.mainColumnField},useIdentityFieldLabel(){return this.useUserField?this.$t("analytics.displayUserField"):this.useSpaceField?this.$t("analytics.displaySpaceField"):null},displayThresholdComuting(){return this.computeThreshold&&this.column.thresholdAggregation},aggregationTypes(){return[{text:this.$t("analytics.perCustomField"),value:"TERMS"},{text:this.$t("analytics.count"),value:"COUNT"},{text:this.$t("analytics.cardinality"),value:"CARDINALITY"},{text:this.$t("analytics.sum"),value:"SUM"},{text:this.$t("analytics.avg"),value:"AVG"},{text:this.$t("analytics.max"),value:"MAX"},{text:this.$t("analytics.min"),value:"MIN"}]},isTermsAggregation(){return"TERMS"===this.aggregationType},isPeriodIndependent(){return this.column&&this.column.valueAggregation&&this.column.valueAggregation.periodIndependent},numericAggregationField(){return"CARDINALITY"!==this.aggregationType&&"TERMS"!==this.aggregationType}},watch:{isPeriodIndependent(){this.isPeriodIndependent&&(this.column.previousPeriod=!1)},isTermsAggregation(){this.isTermsAggregation&&(this.computeThreshold=!1)},canEnableIdentityFields(){this.canEnableIdentityFields||this.useIdentityField||(this.column.userField=null,this.column.spaceField=null)},computeThreshold(){this.computeThreshold?this.column.thresholdAggregation||(this.column.thresholdAggregation={aggregation:{},filters:[]}):this.column.thresholdAggregation=null},spaceField(){this.spaceField?(this.column.valueAggregation=null,this.userField=null,this.computeThreshold=!1,this.updateColumnDataType("space")):this.column.valueAggregation||(this.column.valueAggregation={aggregation:{},filters:[]})},userField(){this.userField?(this.column.valueAggregation=null,this.spaceField=null,this.computeThreshold=!1,this.updateColumnDataType("user")):this.column.valueAggregation||(this.column.valueAggregation={aggregation:{},filters:[]})}},created(){this.useIdentityField=this.column.userField&&this.useUserField||this.column.spaceField&&this.useSpaceField,this.useIdentityField||(this.column.userField=null,this.column.spaceField=null),this.computeThreshold=!!(this.column.thresholdAggregation&&this.column.thresholdAggregation.aggregation&&this.column.thresholdAggregation.aggregation.type)},methods:{updateColumnDataType(e){if("user"===e&&this.column.userField){this.column.spaceField=null,this.column.valueAggregation&&this.column.valueAggregation.aggregation&&(this.column.valueAggregation.aggregation.field=null);const e=this.userFields.find((e=>e&&e.name===this.column.userField));this.column.dataType=e&&e.type,this.column.sortable=!1}if("space"===e&&this.column.spaceField){this.column.userField=null,this.column.valueAggregation&&this.column.valueAggregation.aggregation&&(this.column.valueAggregation.aggregation.field=null);const e=this.spaceFields.find((e=>e&&e.name===this.column.spaceField));this.column.dataType=e&&e.type,this.column.sortable=!1}else if(this.column.valueAggregation&&this.column.valueAggregation.aggregation&&this.column.valueAggregation.aggregation.type){if(this.column.sortable="TERMS"!==this.column.valueAggregation.aggregation.type,this.column.dataType=null,this.column.valueAggregation.aggregation.field){const e=this.fieldsMappings.find((e=>e&&e.name===this.column.valueAggregation.aggregation.field));this.column.dataType=e&&e.type}else"COUNT"===this.column.valueAggregation.aggregation.type&&(this.column.dataType="long");this.column.dataType&&(this.column.userField=null,this.column.spaceField=null)}}}},r,[],!1,null,null,null).exports;var u=function(){var e=this,t=e._self._c;return t("div",[t("h4",[e._v(e._s(e.$t("analytics.computingRule")))]),e._v(" "),t("v-layout",{attrs:{"no-wrap":""}},[t("v-flex",{staticClass:"my-auto px-2"},[t("v-radio-group",{model:{value:e.aggregationType,callback:function(t){e.aggregationType=t},expression:"aggregationType"}},e._l(e.aggregationTypes,(function(e){return t("v-radio",{key:e.value,attrs:{label:e.text,value:e.value}})})),1)],1),e._v(" "),t("v-flex",{directives:[{name:"show",rawName:"v-show",value:!e.isAggregationCount,expression:"!isAggregationCount"}],staticClass:"my-auto px-2"},[t("analytics-field-selection",{attrs:{"fields-mappings":e.fieldsMappings,placeholder:e.numericAggregationField?e.$t("analytics.numericAggregationField"):e.$t("analytics.distinctAggregationField"),numeric:e.numericAggregationField,attach:"",aggregation:""},on:{change:function(t){return e.$emit("change")}},model:{value:e.columnAggregation.aggregation.field,callback:function(t){e.$set(e.columnAggregation.aggregation,"field",t)},expression:"columnAggregation.aggregation.field"}}),e._v(" "),e.isTermsAggregation?t("v-flex",{staticClass:"px-2 mt-2 d-flex flex-row"},[t("v-switch",{staticClass:"my-auto text-no-wrap",attrs:{label:e.$t("analytics.limitResults")},model:{value:e.limitResults,callback:function(t){e.limitResults=t},expression:"limitResults"}}),e._v(" "),e.limitResults?t("input",{directives:[{name:"model",rawName:"v-model",value:e.columnAggregation.aggregation.limit,expression:"columnAggregation.aggregation.limit"}],staticClass:"ignore-vuetify-classes inputSmall mt-1 ml-3",attrs:{type:"number"},domProps:{value:e.columnAggregation.aggregation.limit},on:{input:function(t){t.target.composing||e.$set(e.columnAggregation.aggregation,"limit",t.target.value)}}}):e._e(),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.columnAggregation.aggregation.sortDirection,expression:"columnAggregation.aggregation.sortDirection"}],staticClass:"ignore-vuetify-classes ml-2 mt-1 width-auto",on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.columnAggregation.aggregation,"sortDirection",t.target.multiple?i:i[0])}}},[t("option",{attrs:{value:"desc"}},[e._v(e._s(e.$t("analytics.descending")))]),e._v(" "),t("option",{attrs:{value:"asc"}},[e._v(e._s(e.$t("analytics.ascending")))])])],1):e._e()],1)],1),e._v(" "),t("v-switch",{staticClass:"my-2 text-no-wrap",attrs:{label:e.$t("analytics.periodIndependent")},model:{value:e.columnAggregation.periodIndependent,callback:function(t){e.$set(e.columnAggregation,"periodIndependent",t)},expression:"columnAggregation.periodIndependent"}}),e._v(" "),t("analytics-search-filter-form",{attrs:{"fields-mappings":e.fieldsMappings,filters:e.columnAggregation.filters,attach:""}})],1)};u._withStripped=!0;const g=t({props:{columnAggregation:{type:Object,default:function(){return null}},fieldsMappings:{type:Array,default:function(){return null}}},data:()=>({aggregationType:"MAX",limitResults:!1,initialized:!1}),computed:{aggregationTypes(){return[{text:this.$t("analytics.perCustomField"),value:"TERMS"},{text:this.$t("analytics.count"),value:"COUNT"},{text:this.$t("analytics.cardinality"),value:"CARDINALITY"},{text:this.$t("analytics.sum"),value:"SUM"},{text:this.$t("analytics.avg"),value:"AVG"},{text:this.$t("analytics.max"),value:"MAX"},{text:this.$t("analytics.min"),value:"MIN"}]},isAggregationCount(){return"COUNT"===this.aggregationType},isTermsAggregation(){return"TERMS"===this.aggregationType},numericAggregationField(){return"CARDINALITY"!==this.aggregationType&&"TERMS"!==this.aggregationType}},watch:{limitResults(){this.initialized&&(this.limitResults?this.columnAggregation.aggregation.limit=1:this.columnAggregation.aggregation.limit=0)},isAggregationCount(){this.initialized&&this.columnAggregation.aggregation&&(this.columnAggregation.aggregation.field=null)},aggregationType(){this.initialized&&(this.columnAggregation.aggregation?this.columnAggregation.aggregation.type=this.aggregationType:this.columnAggregation.aggregation={type:this.aggregationType},this.$emit("change"))}},created(){this.columnAggregation&&this.columnAggregation.aggregation&&this.columnAggregation.aggregation.type?this.aggregationType=this.columnAggregation.aggregation.type:this.aggregationType="COUNT",this.limitResults=this.columnAggregation.aggregation&&this.columnAggregation.aggregation.limit||0,this.$nextTick().then((()=>this.initialized=!0))},methods:{selectedValueComparator:(e,t)=>(e&&e.field||e)===(t&&t.field||t)}},u,[],!1,null,null,null).exports;var c=function(){var e=this,t=e._self._c;return t("v-form",{ref:"form",staticClass:"generalSettingForm",on:{submit:function(e){e.preventDefault(),e.stopPropagation()}}},[t("v-flex",{attrs:{wrap:"",xs12:"","d-flex":"","flex-column":""}},[t("v-text-field",{attrs:{label:e.$t("analytics.tableTitle"),outlined:"",required:""},model:{value:e.settings.title,callback:function(t){e.$set(e.settings,"title",t)},expression:"settings.title"}}),e._v(" "),t("h3",[e._v(e._s(e.$t("analytics.mainColumn")))]),e._v(" "),t("v-text-field",{attrs:{label:e.$t("analytics.tableMainColumnTitle"),required:""},model:{value:e.settings.mainColumn.title,callback:function(t){e.$set(e.settings.mainColumn,"title",t)},expression:"settings.mainColumn.title"}}),e._v(" "),t("analytics-field-selection",{attrs:{"fields-mappings":e.fieldsMappings,label:e.$t("analytics.fieldName"),aggregation:""},model:{value:e.settings.mainColumn.valueAggregation.aggregation.field,callback:function(t){e.$set(e.settings.mainColumn.valueAggregation.aggregation,"field",t)},expression:"settings.mainColumn.valueAggregation.aggregation.field"}})],1)],1)};c._withStripped=!0;const d=t({props:{settings:{type:Object,default:function(){return null}},fieldsMappings:{type:Object,default:function(){return null}}},computed:{columns(){return this.settings&&this.settings.columns||[]}},methods:{selectedValueComparator:(e,t)=>(e&&e.value||e)===(t&&t.value||t)}},c,[],!1,null,null,null).exports;var m=function(){var e=this,t=e._self._c;return t("v-data-table",{ref:"dataTable",staticClass:"analytics-table border-box-sizing px-2",attrs:{headers:e.headers,items:e.items,"items-per-page":e.pageSize,loading:e.loading,options:e.options,locale:e.lang,"hide-default-footer":"","disable-pagination":"","disable-filtering":""},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([e._l(e.headers,(function(i){return{key:`item.${i.value}`,fn:function({item:a}){return[t("analytics-table-cell",{key:i.value,attrs:{header:i,labels:e.labels,"cell-value-extensions":e.cellValueExtensions,item:a}})]}}}))],null,!0)},[e._v(" "),e.hasMore?t("template",{slot:"footer"},[t("v-flex",{staticClass:"d-flex py-2 border-box-sizing"},[t("v-btn",{staticClass:"btn mx-auto",attrs:{loading:e.loading,disabled:e.loading},on:{click:function(t){e.limit+=e.pageSize}}},[e._v("\n        "+e._s(e.$t("analytics.loadMore"))+"\n      ")])],1)],1):e._e()],2)};m._withStripped=!0;const h=t({props:{settings:{type:Object,default:function(){return null}},period:{type:Object,default:function(){return null}},selectedIdentity:{type:Object,default:function(){return null}},limit:{type:Number,default:20},pageSize:{type:Number,default:20},userFields:{type:Array,default:function(){return null}},spaceFields:{type:Array,default:function(){return null}},retrieveTableDataUrl:{type:Array,default:function(){return null}}},data:()=>({lang:eXo.env.portal.language,options:{},items:[],loading:!1,sortBy:null,sortDirection:null,extensionApp:"AnalyticsTable",cellValueExtensionType:"CellValue",cellValueExtensions:{}}),computed:{hasMore(){return this.loading&&this.limit>this.pageSize||this.limit===this.items.length},mainFieldName(){return this.settings&&this.settings.mainColumn&&this.settings.mainColumn.valueAggregation&&this.settings.mainColumn.valueAggregation.aggregation&&this.settings.mainColumn.valueAggregation.aggregation.field},mainFieldValues(){return this.items.map((e=>e.column0&&e.column0.key))},headers(){if(!this.settings)return[];const e=[];return this.settings.mainColumn&&this.addHeader(e,this.settings.mainColumn,0),this.settings.columns&&this.settings.columns.forEach(((t,i)=>{this.addHeader(e,t,i+1)})),e},labels(){return{CancelRequest:this.$t("spacesList.label.profile.CancelRequest"),Confirm:this.$t("spacesList.label.profile.Confirm"),Connect:this.$t("spacesList.label.profile.Connect"),Ignore:this.$t("spacesList.label.profile.Ignore"),RemoveConnection:this.$t("spacesList.label.profile.RemoveConnection"),StatusTitle:this.$t("spacesList.label.profile.StatusTitle"),External:this.$t("UsersManagement.type.external"),Disabled:this.$t("UsersManagement.status.disabled"),join:this.$t("spacesList.button.join"),leave:this.$t("spacesList.button.leave"),members:this.$t("peopleList.label.filter.member")}}},watch:{selectedIdentity(){this.items=[],this.refresh()},period(){this.items=[],this.$nextTick().then((()=>this.refresh()))},limit(){this.refresh()},options:{handler(){this.items=[],this.refresh()},deep:!0},settings:{immediate:!0,handler(){this.settings&&!this.sortBy&&(this.options.sortBy=[`column${this.settings.sortBy}`],this.options.sortDesc=[this.settings&&this.settings.sortDirection||"desc"])}}},created(){document.addEventListener(`extension-${this.extensionApp}-${this.cellValueExtensionType}-updated`,this.refreshCellValueExtensions),this.refreshCellValueExtensions()},methods:{refreshCellValueExtensions(){const e=extensionRegistry.loadExtensions(this.extensionApp,this.cellValueExtensionType);let t=!1;e.forEach((e=>{!e.type||!e.options||this.cellValueExtensions[e.type]&&this.cellValueExtensions[e.type]===e.options||(this.cellValueExtensions[e.type]=e.options,t=!0)})),t&&(this.cellValueExtensions=Object.assign({},this.cellValueExtensions))},addHeader(e,t,i){e.push({text:t.title&&this.$t(t.title)||"",align:t.align||"center",sortable:t.sortable,value:`column${i}`,class:"text-no-wrap",width:t.width||"auto",dataType:t.dataType||"text",column:t})},refresh(){if(this.settings){if(this.selectedIdentity)this.sortBy=0;else{const{sortBy:e,sortDesc:t}=this.options;this.sortBy=e.length&&this.headers.findIndex((t=>t.value===e[0]))||0,this.sortBy<0&&(this.sortBy=0),this.sortDirection=t[0]?"desc":"asc"}this.settings.mainColumn&&(this.loading=!0,this.refreshColumn(this.sortBy,this.limit,this.sortDirection).then((()=>{if(this.settings.columns){const e=this.settings.columns.length+1;for(let t=1;t<e;t++)this.sortBy!==t&&this.refreshColumn(t)}})).finally((()=>this.loading=!1)))}},refreshColumn(e,t,i){const a=0===e&&this.settings.mainColumn||this.settings.columns[e-1];a.loading=!0;const l={};this.headers.forEach((e=>{l[e.value]={value:"loadingData"}}));const n=a.valueAggregation&&a.valueAggregation.aggregation&&a.valueAggregation.aggregation.field,s=a.valueAggregation&&a.valueAggregation.aggregation&&a.valueAggregation.aggregation.type;if(this.selectedIdentity&&0===e&&"userId"===n&&"TERMS"===s)return this.$identityService.getIdentityByProviderIdAndRemoteId(this.selectedIdentity.providerId,this.selectedIdentity.remoteId,"all").then((t=>{const i=t.profile;if(i){const t=Object.assign({},l);t[`column${e}`]={key:i&&i.id,value:i&&i.id,identity:i&&i.profile},this.items.push(t)}}));if(this.selectedIdentity&&0===e&&"spaceId"===n&&"TERMS"===s)return this.$identityService.getIdentityByProviderIdAndRemoteId(this.selectedIdentity.providerId,this.selectedIdentity.remoteId).then((t=>{const i=t&&t.space;if(i){const t=Object.assign({},l);t[`column${e}`]={key:i&&i.id,value:i&&i.id,identity:i},this.items.push(t)}}));if(!a.userField&&!a.spaceField&&a.valueAggregation&&a.valueAggregation.aggregation){const n={lang:eXo.env.portal.language&&eXo.env.portal.language.replace("_","-"),column:e,limit:String(t||0),periodType:this.period.period||"",min:this.period.min,max:this.period.max+6e4,timeZone:this.$analyticsUtils.USER_TIMEZONE_ID};return i?n.sort=i:this.mainFieldName&&(n.fieldFilter=this.mainFieldName,n.fieldValues=this.mainFieldValues.join(",")),n.timeZone=this.$analyticsUtils.USER_TIMEZONE_ID,fetch(this.retrieveTableDataUrl,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:$.param(n)}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting analytics with settings:",this.settings)})).then((i=>{t?i&&i.items&&i.items.length&&(this.sortBy&&(this.items=[]),i.items.forEach(((t,i)=>{const a=(this.items.length<=i||!this.items.length)&&Object.assign({},l)||this.items[i][`column${e}`];a[`column${e}`]=t,a.column0={key:t.key,value:t.key,identity:null},this.items.length<=i&&this.items.push(a)}))):this.items.forEach(((t,a)=>{const l=i&&i.items&&i.items.find((e=>e.key===this.mainFieldValues[a]));t[`column${e}`]=l}))})).catch((t=>{console.error("fetch analytics - error",t),this.error="Error getting analytics",this.items.forEach((t=>{t[`column${e}`]={value:"errorRetrievingData"}}))})).finally((()=>a.loading=!1))}this.items.forEach((t=>{t[`column${e}`]?"loadingData"===t[`column${e}`].value&&(t[`column${e}`].value=null):t[`column${e}`]={key:t.column0&&t.column0.key}}))}}},m,[],!1,null,null,null).exports;var p=function(){var e=this,t=e._self._c;return e.loadingValue?t("v-progress-circular",{attrs:{size:"24",color:"primary",indeterminate:""}}):e.errorLoadingValue?t("i",{staticClass:"uiIconColorError",attrs:{title:e.$t("analytics.errorRetrievingData")}}):t("div",[e.cellItems.length?e._l(e.cellItems,(function(i){return t("div",{key:i.id},[t("analytics-table-cell-value",{attrs:{value:i.value,item:e.cellItem,"original-value":e.$analyticsUtils.toFixed(e.cellItem.value),"cell-value-extension":e.cellValueExtension,threshold:e.$analyticsUtils.toFixed(e.cellItem.threshold),field:e.columnField,"data-type":e.columnDataType,"aggregation-type":e.columnAggregationType,percentage:e.percentage,labels:e.labels,column:e.column}})],1)})):t("span",[e._v("\n    -\n  ")]),e._v(" "),e.previousPeriod?[e.cellItemPreviousValues.length?t("span",{staticClass:"ml-2"},e._l(e.cellItemPreviousValues,(function(i){return t("analytics-table-cell-value",{key:i.value,attrs:{item:e.cellItem,value:i.percentage,"previous-value":e.percentage&&`${i.value}%`||i.value,"cell-value-extension":e.cellValueExtension,field:e.columnField,"aggregation-type":e.columnAggregationType,"data-type":e.columnDataType,percentage:e.isValueNumber,labels:e.labels,column:e.column,compare:""}})})),1):t("span",[e._v("\n      -\n    ")])]:e._e()],2)};p._withStripped=!0;const v=t({props:{header:{type:Object,default:function(){return null}},labels:{type:Object,default:function(){return null}},item:{type:Object,default:function(){return null}},cellValueExtensions:{type:Object,default:function(){return null}}},data:()=>({fullDateFormat:{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},cellItems:[]}),computed:{column(){return this.header.column},columnField(){return this.column&&this.column.valueAggregation&&this.column.valueAggregation.aggregation&&this.column.valueAggregation.aggregation.field},columnAggregationType(){return this.column&&this.column.valueAggregation&&this.column.valueAggregation.aggregation&&this.column.valueAggregation.aggregation.type},previousPeriod(){return this.column&&this.column.previousPeriod},percentage(){return this.column&&this.column.thresholdAggregation},columnDataType(){return this.header&&this.header.dataType},cellItem(){return this.item[this.header.value]},isValueNumber(){return"long"===this.columnDataType||"double"===this.columnDataType||"int"===this.columnDataType},mainColumnValue(){return this.item&&this.item.column0},mainColumnIdentity(){return this.mainColumnValue&&this.mainColumnValue.identity},cellItemValue(){return this.cellItem&&this.cellItem.value},loadingValue(){return"loadingData"===this.cellItemValue},errorLoadingValue(){return"errorRetrievingData"===this.cellItemValue},cellItemValues(){return this.column.userField?this.mainColumnIdentity&&[this.mainColumnIdentity[this.column.userField]]||[]:this.column.spaceField?this.mainColumnIdentity&&[this.mainColumnIdentity[this.column.spaceField]]||[]:"TERMS"!==this.columnAggregationType||"userId"!==this.columnField&&"spaceId"!==this.columnField?!this.cellItemValue||this.loadingValue||this.errorLoadingValue?[]:this.formatValues(this.cellItem.value,this.cellItem.threshold):this.cellItem&&(this.cellItem.identity&&[this.cellItem.identity]||this.cellItemValue&&this.formatValues(this.cellItemValue))||[]},cellValueExtension(){return this.cellValueExtensions&&Object.values(this.cellValueExtensions).sort(((e,t)=>(e.rank||0)-(t.rank||0))).find((e=>e.match&&e.match(this.columnField,this.columnAggregationType,this.columnDataType,this.cellItem)))||null},cellItemPreviousValues(){if(this.previousPeriod&&this.cellItem&&this.cellItem.key){const e=this.formatValues(this.cellItem.previousValue,this.cellItem.previousThreshold);return this.isValueNumber&&(e.length<1||!e[0]?this.cellItemValues.length&&this.cellItemValues[0]?e[0]={value:"0",percentage:100}:e.length&&e.splice(0,e.length):this.cellItemValues.length<1||!this.cellItemValues[0]?e[0]={value:e[0],percentage:this.percentage&&-e[0]||-100}:this.percentage?e[0]={value:e[0],percentage:this.cellItemValues[0]-e[0]}:e[0]={value:e[0],percentage:100*(this.cellItemValues[0]-e[0])/e[0]}),e}return[]}},watch:{cellItemValue(e,t){e!==t&&this.computeCellItemValues()}},mounted(){this.computeCellItemValues()},methods:{computeCellItemValues(){!this.cellItemValue||this.loadingValue||this.errorLoadingValue||(this.cellItems=this.cellItemValues&&this.cellItemValues.map((e=>({id:e&&(e.id||e.value)||e,value:e})))||[])},formatValues(e,t){if(this.percentage){const i=e&&Number(e)||0,a=this.cellItem.threshold&&Number(t)||0;return i?a?[this.$analyticsUtils.toFixed(100*i/a)]:[100]:[0]}return e&&"object"==typeof e&&e.length?e:e&&Number(e)?[this.$analyticsUtils.toFixed(e)]:[e]}}},p,[],!1,null,null,null).exports;var y=function(){var e=this,t=e._self._c;return e.value?e.cellValueExtension?t("extension-registry-component",{attrs:{component:e.extendedCellValueComponent,params:e.extendedCellValueComponentParams}}):"date"===e.dataType?t("date-format",{staticClass:"text-no-wrap",attrs:{value:e.dateValue,format:e.fullDateFormat}}):e.percentage?t("span",{staticClass:"text-no-wrap",class:e.signClass},[e.previousValue?t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:a}){return[t("span",e._g(e._b({},"span",a,!1),i),[e._v("\n        "+e._s(e.sign||"")+e._s(e.valueNumberAbs||"")+"%\n      ")])]}}],null,!1,1670083578)},[e._v(" "),t("span",[e._v(e._s(e.$t("analytics.previousPeriodValue",{0:e.previousValue})))])]):e.threshold?t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:a}){return[t("span",e._g(e._b({class:e.signClass},"span",a,!1),i),[e._v("\n        "+e._s(e.sign||"")+e._s(e.valueNumberAbs||"")+"%\n      ")])]}}])},[e._v(" "),t("span",[e._v(e._s(e.$t("analytics.percentOfValue",{0:e.originalValue,1:e.threshold})))])]):t("span",{class:e.signClass},[e._v(e._s(e.sign||"")+e._s(e.valueNumberAbs||"")+"%")])],1):"long"===e.dataType||"double"===e.dataType?t("span",{staticClass:"text-no-wrap"},[e._v("\n  "+e._s(e.valueNumber)+"\n")]):t("span",{staticClass:"text-no-wrap"},[e._v("\n  "+e._s(e.i18NValue)+"\n")]):t("span",{class:e.signClass},[e._v("\n  -\n")])};y._withStripped=!0;const f=t({props:{value:{type:Object,default:function(){return null}},previousValue:{type:Object,default:function(){return null}},originalValue:{type:Object,default:function(){return null}},threshold:{type:Object,default:function(){return null}},field:{type:Object,default:function(){return null}},aggregationType:{type:Object,default:function(){return null}},dataType:{type:Object,default:function(){return null}},percentage:{type:Boolean,default:!1},compare:{type:Boolean,default:!1},item:{type:Object,default:function(){return null}},column:{type:Object,default:()=>null},labels:{type:Object,default:function(){return null}},cellValueExtension:{type:Object,default:function(){return null}}},data:()=>({fullDateFormat:{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}}),computed:{i18NValue(){const e=`analytics.${this.value}`,t=this.$t(e);return t===e?this.value:t},dateValue(){return this.value&&!Number.isNaN(Number(this.value))?new Date(Number(this.value)):null},valueNumber(){const e=this.value&&Number(this.value)||0;return e&&this.$analyticsUtils.toFixed(e)||0},valueNumberAbs(){return Math.abs(this.valueNumber)},extendedCellValueComponent(){return this.cellValueExtension&&{componentName:"cell-value",componentOptions:{vueComponent:this.cellValueExtension.vueComponent}}||null},extendedCellValueComponentParams(){return this.cellValueExtension&&{column:this.column,item:this.item,value:this.value,labels:this.labels}||null},sign(){return this.compare?this.valueNumber>0?"+":"-":""},signClass(){return this.compare?this.valueNumber>=0?"success--text":"error--text":""}}},y,[],!1,null,null,null).exports;var b=function(){var e=this,t=e._self._c;return e.loading?t("v-progress-circular",{attrs:{size:"24",color:"primary",indeterminate:""}}):e.error?t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:a}){return[t("i",e._g(e._b({staticClass:"uiIconColorError"},"i",a,!1),i))]}}])},[e._v(" "),t("span",[e._v(e._s(e.$t("analytics.errorRetrievingDataForValue",{0:e.value})))])]):e.user?t("exo-user-avatar",{attrs:{identity:e.user,size:32,"extra-class":"analytics-table-user my-1","avatar-class":"border-color",popover:""}},["true"===e.user.deleted?t("template",{slot:"subTitle"},[t("v-chip",{attrs:{"x-small":"",disabled:""}},[e._v("\n      "+e._s(e.$t("analytics.deletedUser"))+"\n    ")])],1):e._e()],2):t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:i,attrs:a}){return[t("i",e._g(e._b({staticClass:"uiIconColorInfo"},"i",a,!1),i))]}}])},[e._v(" "),t("span",[e._v(e._s(e.$t("analytics.errorRetrievingIdentityWithId",{0:e.value})))])])};b._withStripped=!0;const C=t({props:{value:{type:Object,default:function(){return null}},item:{type:Object,default:function(){return null}},labels:{type:Object,default:function(){return null}}},data:()=>({loading:!0,error:!1,user:null}),created(){this.value&&this.value.username?(this.user=this.value,this.loading=!1):this.value&&Number(this.value)?(this.loading=!0,this.error=!1,this.$identityService.getIdentityById(this.value).then((e=>{this.item.identity=this.user=e&&e.profile,this.$forceUpdate()})).catch((()=>this.error=!0)).finally((()=>this.loading=!1))):this.loading=!1}},b,[],!1,null,null,null).exports;var A=function(){var e=this,t=e._self._c;return e.loading?t("v-progress-circular",{attrs:{size:"24",color:"primary",indeterminate:""}}):e.error?t("div",{staticClass:"d-flex"},[t("i",{staticClass:"uiIconColorError my-auto",attrs:{title:e.$t("analytics.errorRetrievingDataForValue",{0:e.value})}}),e._v(" "),t("span",{staticClass:"text-no-wrap text-sub-title my-auto ml-1"},[e._v("\n    "+e._s(e.$t("analytics.deletedSpace"))+"\n  ")])]):e.space?t("exo-space-avatar",{attrs:{space:e.space,size:32,"avatar-class":"border-color","extra-class":"analytics-table-space my-1",popover:""}}):e._e()};A._withStripped=!0;const _={"analytics-table-application":l,"analytics-table-column-aggregation-setting":g,"analytics-table-column-setting":o,"analytics-table-general-setting":d,"analytics-table-setting":s,"analytics-table":h,"analytics-table-cell":v,"analytics-table-cell-value":f,"analytics-table-cell-user-value":C,"analytics-table-cell-space-value":t({props:{value:{type:Object,default:function(){return null}},item:{type:Object,default:function(){return null}},labels:{type:Object,default:function(){return null}}},data:()=>({loading:!0,error:!1,space:null}),created(){this.value=JSON.parse(this.value),this.value&&this.value.prettyName?(this.space=this.value,this.loading=!1):this.value&&(this.loading=!0,this.error=!1,this.$spaceService.getSpaceById(this.value).then((e=>{this.item.identity=this.space=e,this.$forceUpdate()})).catch((()=>this.error=!0)).finally((()=>this.loading=!1)))}},A,[],!1,null,null,null).exports};for(const e in _)Vue.component(e,_[e]);i(879),Vue.use(Vuetify);const x=new Vuetify(eXo.env.portal.vuetifyPreset),T=eXo&&eXo.env&&eXo.env.portal&&eXo.env.portal.language||"en",I=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.Analytics-${T}.json`;function S(e){exoi18n.loadLanguageAsync(T,I).then((t=>{const i=$(`#${e}`),a=i.attr("data-settings-url"),l=i.attr("data-mappings-url"),n=i.attr("data-filters-url"),s=i.attr("data-table-data-url"),r=i.attr("data-field-values-url"),o=i.attr("data-save-settings-url");new Vue({data:()=>({retrieveSettingsURL:a,retrieveMappingsURL:l,retrieveFiltersURL:n,retrieveTableDataUrl:s,retrieveFieldValuesUrl:r,saveSettingsURL:o}),mounted(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:`\n        <analytics-table-application\n           id="${e}"\n           :retrieve-settings-url="retrieveSettingsURL"\n           :retrieve-mappings-url="retrieveMappingsURL"\n           :retrieve-filters-url="retrieveFiltersURL"\n           :retrieve-table-data-url="retrieveTableDataUrl"\n           :retrieve-field-values-url="retrieveFieldValuesUrl"\n           :save-settings-url="saveSettingsURL"\n           data-id="${e}"\n           data-settings-url="${a}"\n           data-mappings-url="${l}"\n           data-filters-url="${n}"\n           data-table-data-url="${s}"\n           data-field-values-url="${r}"\n           data-save-settings-url="${o}" />`,vuetify:x,i18n:t}).$mount(`#${e}`)}))}document.dispatchEvent(new CustomEvent("displayTopBarLoading"))})(),a})()));