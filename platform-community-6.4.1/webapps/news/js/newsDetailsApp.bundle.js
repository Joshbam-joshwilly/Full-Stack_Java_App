define((()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{destroy:()=>_,init:()=>A});var n={};e.r(n),e.d(n,{canPublishNews:()=>O,canScheduleNews:()=>D,canUserCreateNews:()=>x,clickOnEditButton:()=>y,deleteDraft:()=>N,deleteNews:()=>P,escapeHTML:()=>X,fetchFoldersAndFiles:()=>b,findUserSpaces:()=>g,getDrivers:()=>j,getNews:()=>w,getNewsByActivityId:()=>u,getNewsById:()=>l,getNewsSpaces:()=>h,getSpaceById:()=>E,getUserSpaces:()=>S,importFileFromUrl:()=>v,markNewsAsRead:()=>p,saveNews:()=>f,scheduleNews:()=>$,searchSpaces:()=>T,undoDeleteNews:()=>C,updateNews:()=>m});const o=eXo.env.portal.context||"",r=(eXo.env.portal.portalName,eXo.env.portal.containerName,eXo.env.portal.rest),s=`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news`,i=(eXo.env.portal.context,eXo.env.portal.rest,`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/spaces`),a=`${eXo.env.portal.context}/${eXo.env.portal.rest}${eXo.env.portal.context}/social/spaces/suggest.json`,c=`${eXo.env.portal.context}/${eXo.env.portal.rest}/space/user/searchSpace/`,d=(eXo.env.portal.spaceId,window.location.host,eXo.env.portal.context,eXo.env.portal.userName);function l(e,t){return fetch(`${s}/${e}?editMode=${t||""}`,{credentials:"include",method:"GET"}).then((e=>e&&e.ok?e.json():401===e.status?e.status:void 0)).then((e=>e)).catch((e=>e))}function u(e){return fetch(`${s}/byActivity/${e}`,{credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function h(e){return fetch(`${s}/${e}?fields=spaces`,{credentials:"include",method:"GET"}).then((e=>e.json())).then((e=>e))}function p(e){return fetch(`${s}/markAsRead/${e}`,{credentials:"include",method:"POST"}).then((e=>{if(e&&e.ok)return e.text();throw new Error("Error while marking news as read")}))}function w(e,t,n,o,r,i){let a=`${s}?author=${d}&publicationState=published&filter=${e}`;return n&&(a+=`&text=${n}`),t&&(a+=`&spaces=${t}`),isNaN(o)||(a+=`&offset=${o}`),isNaN(r)||(a+=`&limit=${r}`),i&&(a+=`&returnSize=${i}`),fetch(a,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting news list")}))}function f(e){return fetch(`${s}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"POST",body:JSON.stringify(e)}).then((e=>e.json()))}function $(e){return fetch(`${s}/schedule`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PATCH",body:JSON.stringify(e)}).then((e=>e.json()))}function v(e){return fetch(e,{headers:{"Content-Type":"blob"},credentials:"include",method:"GET"})}function m(e,t){return fetch(`${s}/${e.id}?post=${t}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PUT",body:JSON.stringify(e)}).then((e=>e.json()))}function y(e){return fetch(`${s}/${e}/click`,{credentials:"include",method:"POST",body:"edit"})}function g(e){return fetch(`${a}?conditionToSearch=${e}&currentUser=${d}&typeOfRelation=confirmed`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json())).then((e=>e.options))}function N(e){return fetch(`${s}/${e}`,{credentials:"include",method:"DELETE"})}function E(e){return fetch(`${i}/${e}`,{credentials:"include",method:"GET"}).then((t=>{if(t&&t.ok)return t.json();throw new Error(`Error getting space with id ${e}`)}))}function S(e,t,n){return fetch(`${i}?offset=${e}&limit=${t}&returnSize=true&filterType=${n}`,{credentials:"include",method:"GET"}).then((e=>e.json())).then((e=>e))}function T(e){return fetch(`${c}?fields=id,url,displayName,avatarUrl&keyword=${e}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json()))}function b(e,t,n){return fetch(`/portal/rest/managedocument/getFoldersAndFiles/?driveName=${e}&workspaceName=${t}&currentFolder=${n}`,{}).then((e=>e.text())).then((e=>(new window.DOMParser).parseFromString(e,"text/xml"))).then((e=>e))}function j(){return fetch("/portal/rest/wcmDriver/getDrivers",{}).then((e=>e.text())).then((e=>(new window.DOMParser).parseFromString(e,"text/xml"))).then((e=>e))}function X(e){const t=document.createElement("div");return t.innerText=e,t.innerHTML}function x(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news/canCreateNews/${eXo.env.portal.spaceId||e}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e&&e.ok&&e.json()))}function D(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news/canScheduleNews/${eXo.env.portal.spaceId||e}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e&&e.ok&&e.json()))}function P(e,t,n){return n>0&&localStorage.setItem("deletedNews",e),fetch(`${s}/${e}?isDraft=${t||""}&delay=${n||0}`,{credentials:"include",method:"DELETE"}).then((e=>{if(e&&!e.ok)throw new Error("Error when deleting news")}))}function C(e){return fetch(`${s}/${e}/undoDelete`,{method:"POST",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Error when undoing deleting news");localStorage.removeItem("deletedNews")}))}function O(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news/canPublishNews?spaceId=${eXo.env.portal.spaceId}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json())).then((e=>e))}var I=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"newsDetails"}},[e.notFound?t("div",{staticClass:"articleNotFound"},[t("i",{staticClass:"iconNotFound"}),e._v(" "),t("h3",[e._v(e._s(e.$t("news.details.restricted")))])]):t("exo-news-details",{attrs:{id:"newsFullDetails",news:e.news,"news-id":e.newsId,"show-edit-button":e.showEditButton,"show-publish-button":e.showPublishButton,"show-delete-button":e.showDeleteButton}})],1)};I._withStripped=!0;var k=function(e,t,n,o,r,s,i,a){var c,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=[],d._compiled=!0),c)if(d.functional){d._injectStyles=c;var l=d.render;d.render=function(e,t){return c.call(t),l(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:d}}({props:{newsId:{type:String,default:""}},data:()=>({news:null,notFound:!1,showEditButton:!1,showPublishButton:!1,showDeleteButton:!1}),created(){this.$newsServices.getNewsById(this.newsId,!1).then((e=>{null!==e&&401!==e?(this.news=e,this.showEditButton=this.news.canEdit,this.showPublishButton=this.news.canPublish,this.showDeleteButton=this.news.canDelete,this.news.spaceMember||this.$root.$emit("restricted-space",this.news.spaceDisplayName,this.news.hiddenSpace)):this.notFound=!0}))}},I);const F={"exo-news-details-app":k.exports};for(const e in F)Vue.component(e,F[e]);Vue.prototype.$newsServices||window.Object.defineProperty(Vue.prototype,"$newsServices",{value:n}),Vue.use(Vuetify);const B=new Vuetify(eXo.env.portal.vuetifyPreset);if(extensionRegistry){const e=extensionRegistry.loadComponents("NewsDetailApp");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}let G;function A(){const e="undefined"!=typeof eXo?eXo.env.portal.language:"en",t=[`${o}/${r}/i18n/bundle/locale.portlet.news.News-${e}.json`,`${o}/${r}/i18n/bundle/locale.attachmentsSelector.attachments-${e}.json`],n="newsDetailApp",s=document.createElement("div");s.id=n,exoi18n.loadLanguageAsync(e,t).then((e=>{G=new Vue({el:"#NewsDetailApp",data:function(){return{newsId:M("newsId")}},template:`<v-app id="${n}">\n                   <exo-news-details-app :news-id="newsId"></exo-news-details-app>\n                 </v-app>`,i18n:e,vuetify:B}).$mount(s)}))}function _(){G&&G.$destroy()}function M(e){const t=new URLSearchParams(window.location.search);if(t.has(e))return t.get(e)}return t})()));