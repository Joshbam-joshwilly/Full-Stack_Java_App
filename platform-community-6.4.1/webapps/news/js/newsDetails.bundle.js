define((()=>(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{destroy:()=>de,init:()=>le});var s={};e.r(s),e.d(s,{canPublishNews:()=>ne,canScheduleNews:()=>te,canUserCreateNews:()=>ee,clickOnEditButton:()=>V,deleteDraft:()=>G,deleteNews:()=>se,escapeHTML:()=>Q,fetchFoldersAndFiles:()=>Z,findUserSpaces:()=>H,getDrivers:()=>K,getNews:()=>O,getNewsByActivityId:()=>F,getNewsById:()=>X,getNewsSpaces:()=>M,getSpaceById:()=>J,getUserSpaces:()=>W,importFileFromUrl:()=>R,markNewsAsRead:()=>j,saveNews:()=>q,scheduleNews:()=>L,searchSpaces:()=>Y,undoDeleteNews:()=>ie,updateNews:()=>z});var i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"archiveNews"}},[e.showArchiveMessage?t("div",{staticClass:"confirmPublishMessage",attrs:{id:"messageArchive"}},[t("transition",{attrs:{name:"fade"}},[t("div",{staticClass:"alert text-center",class:[e.successArchive?"alert-success":"alert-error"]},[t("i",{class:[e.successArchive?"uiIconSuccess":"uiIconError"]}),e._v(" "),t("span",[e._v(e._s(e.messageArchive))])])])],1):e._e(),e._v(" "),t("a",{staticClass:"btn newsArchiveButton",attrs:{"data-original-title":e.archiveLabel,rel:"tooltip","data-placement":"bottom"},on:{click:e.confirmAction}},[t("i",{class:[e.newsArchived?"uiIconArchived":"uiIconUnarchived"]})])])};function n(e,t,s,i,n,a,r,o){var l,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=s,d._compiled=!0),i&&(d.functional=!0),a&&(d._scopeId="data-v-"+a),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},d._ssrRegister=l):n&&(l=o?function(){n.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(d.functional){d._injectStyles=l;var c=d.render;d.render=function(e,t){return l.call(t),c(e,t)}}else{var h=d.beforeCreate;d.beforeCreate=h?[].concat(h,l):[l]}return{exports:e,options:d}}i._withStripped=!0;const a=n({props:{newsId:{type:String,required:!1,default:null},newsTitle:{type:String,required:!0,default:null},newsArchived:{type:Boolean,required:!0,default:!1},published:{type:Boolean,required:!0,default:!1}},data:()=>({showArchiveMessage:!1,messageArchive:"",successArchive:!0,archiveLabel:""}),created(){this.newsArchived?this.archiveLabel=this.$t("news.unarchive.action"):this.archiveLabel=this.$t("news.archive.action")},methods:{confirmAction(){let e=this.$t("news.archive.confirm"),t=this.$t("news.archive.action");const s=this.$t("news.archive.btn.confirm"),i=this.$t("news.archive.btn.cancel");!0===this.newsArchived&&(e=this.$t("news.unarchive.confirm").replace("{0}",this.newsTitle),t=this.$t("news.unarchive.action")),eXo.social.PopupConfirmation.confirm("newsArchiveButton",[{action:this.updateArchivedField(),label:s}],t,e,i)},updateArchivedField(){const e=this;let t=null;t=!1===this.newsArchived?{archived:!0,published:this.published}:{archived:!1,published:this.published},fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news/${this.newsId}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PATCH",body:JSON.stringify(t)}).then((function(){e.$emit("refresh-news-list"),!0===e.newsArchived&&e.$emit("update-archived-field"),e.showArchiveMessage=!0,!1===e.newsArchived?(e.messageArchive=e.$t("news.archive.success"),e.archiveLabel=e.$t("news.unarchive.action"),e.newsArchived=!0):(e.messageArchive=e.$t("news.unarchive.success"),e.archiveLabel=e.$t("news.archive.action"),e.newsArchived=!1),setTimeout((function(){e.showArchiveMessage=!1}),5e3)})).catch((function(){e.showArchiveMessage=!0,e.successArchive=!1,!1===e.newsArchived?e.messageArchive=e.$t("news.archive.error"):e.messageArchive=e.$t("news.unarchive.error"),setTimeout((function(){e.successArchive=!0,e.showArchiveMessage=!1}),5e3)}))}}},i,[],!1,null,null,null).exports;var r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"newsDetails"}},[e.isMobile?e._e():t("exo-news-details-toolbar",{attrs:{news:e.news,"news-id":e.newsId,"activity-id":e.activityId,"show-edit-button":e.showEditButton,"show-delete-button":e.showDeleteButton,"show-publish-button":e.showPublishButton}}),e._v(" "),e.isMobile?t("exo-news-details-toolbar-mobile",{attrs:{news:e.news,"show-edit-button":e.showEditButton,"show-delete-button":e.showDeleteButton,"show-publish-button":e.showPublishButton}}):e._e(),e._v(" "),t("schedule-news-drawer",{attrs:{"news-id":e.newsId},on:{"post-article":e.postNews}}),e._v(" "),t("exo-confirm-dialog",{ref:"deleteConfirmDialog",attrs:{message:e.$t("news.message.confirmDeleteNews"),title:e.$t("news.title.confirmDeleteNews"),"ok-label":e.$t("news.button.ok"),"cancel-label":e.$t("news.button.cancel")},on:{ok:e.deleteNews}}),e._v(" "),e.isMobile?e._e():t("exo-news-details-body",{attrs:{news:e.news}}),e._v(" "),e.isMobile?t("exo-news-details-body-mobile",{attrs:{news:e.news,"news-id":e.newsId,space:e.currentSpace}}):e._e(),e._v(" "),e.news?t("exo-news-edit-publishing-drawer",{attrs:{news:e.news},on:{"refresh-news":function(t){return e.getNewsById(e.newsId)}}}):e._e(),e._v(" "),t("exo-news-notification-alerts")],1)};r._withStripped=!0;const o=(new window.Intl.DateTimeFormat).resolvedOptions().timeZone,l={props:{news:{type:Object,required:!1,default:function(){return new Object}},newsId:{type:String,required:!1,default:null},activityId:{type:String,required:!1,default:""},showEditButton:{type:Boolean,required:!1,default:!1},showPublishButton:{type:Boolean,required:!1,default:!1},showDeleteButton:{type:Boolean,required:!1,default:!1}},data:()=>({currentSpace:null,spaceId:null,BYTES_IN_MB:1048576,dateFormat:{year:"numeric",month:"long",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}},created(){this.$root.$on("delete-news",this.deleteConfirmDialog),this.$root.$on("edit-news",this.editLink),this.news&&this.news.spaceId?(this.spaceId=this.news.spaceId,this.getSpaceById(this.spaceId),this.news.newsId||(this.news.newsId=this.newsId),this.$root.$emit("application-loaded")):this.getNewsById(this.newsId)},mounted(){this.markNewsAsRead(this.newsId)},methods:{markNewsAsRead(e){e&&this.$newsServices.markNewsAsRead(e)},getSpaceById(e){this.$spaceService.getSpaceById(e,"identity").then((e=>{e&&e.identity&&e.identity.id&&(this.currentSpace=e)})).catch((t=>{console.warn(`Could not get the space with id ${e} : ${t}`)}))},editLink(){const e=`${eXo.env.portal.context}/${eXo.env.portal.portalName}/news/editor?spaceId=${this.spaceId}&newsId=${this.newsId}&activityId=${this.activityId}`;window.open(e,"_target")},deleteConfirmDialog(){this.$refs.deleteConfirmDialog.open()},deleteNews(){this.$newsServices.deleteNews(this.newsId,!1,6).then((()=>{this.$root.$emit("confirm-news-deletion",this.news)})),setTimeout((()=>{null!=localStorage.getItem("deletedNews")&&(window.location.href=this.news.spaceUrl)}),6100)},postNews(e,t,s,i,n,a){this.news.timeZoneId=o,this.news.activityPosted=i,this.news.published=s,this.news.targets=n,null!==a&&(this.news.audience=a===this.$t("news.composer.stepper.audienceSection.allUsers")?"all":"space"),"later"===t?(this.news.schedulePostDate=e,this.$newsServices.scheduleNews(this.news).then((e=>{e&&(window.location.href=e.url)}))):"immediate"===t?(this.news.publicationState="published",this.$newsServices.saveNews(this.news).then((e=>{let t=null;if(e.activities){const s=e.activities.split(";")[0].split(":");s.length>1&&(t=s[1])}window.location.href=t?`${eXo.env.portal.context}/${eXo.env.portal.portalName}/activity?id=${t}`:`${eXo.env.portal.context}/${eXo.env.portal.portalName}`}))):(this.news.publicationState="draft",this.$newsServices.saveNews(this.news).then((e=>{this.news.id=e.id,this.$emit("draftCreated"),e&&(window.location.href=`${eXo.env.portal.context}/${eXo.env.portal.portalName}/news?filter=drafts`)})))},getNewsById(e){this.$newsServices.getNewsById(e).then((t=>(this.spaceId=t.spaceId,this.getSpaceById(this.spaceId),this.news||(this.news=t),this.news.newsId||(this.news.newsId=e),this.$nextTick()))).finally((()=>{document.title=this.$t("news.window.title",{0:this.news.title}),this.$root.$emit("application-loaded")}))}}},d=n(l,r,[],!1,null,null,null).exports;var c=function(){var e=this,t=e._self._c;return t("div",[t("v-menu",{staticClass:"px-0 text-right mx-2",attrs:{eager:"",bottom:"",left:"","offset-y":"","min-width":"108px"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:i}){return[t("v-btn",e._g(e._b({staticClass:"newsDetailsActionMenu pull-right",attrs:{icon:""}},"v-btn",i,!1),s),[t("v-icon",[e._v("mdi-dots-vertical")])],1)]}}]),model:{value:e.actionMenu,callback:function(t){e.actionMenu=t},expression:"actionMenu"}},[e._v(" "),t("v-list",[e.showEditButton?t("v-list-item",{on:{click:function(t){return e.$root.$emit("edit-news")}}},[t("v-list-item-title",[e._v("\n          "+e._s(e.$t("news.details.header.menu.edit"))+"\n        ")])],1):e._e(),e._v(" "),e.showShareButton&&e.news.activityId?t("v-list-item",{on:{click:function(t){return e.$root.$emit("activity-share-drawer-open",e.news.activityId,"newsDetails")}}},[t("v-list-item-title",[e._v("\n          "+e._s(e.$t("news.details.header.menu.share"))+"\n        ")])],1):e._e(),e._v(" "),e.showResumeButton?t("v-list-item",{on:{click:function(t){return e.$root.$emit("edit-news")}}},[t("v-list-item-title",[e._v("\n          "+e._s(e.$t("news.details.header.menu.resume"))+"\n        ")])],1):e._e(),e._v(" "),e.showDeleteButton?t("v-list-item",{on:{click:function(t){return e.$root.$emit("delete-news")}}},[t("v-list-item-title",[e._v("\n          "+e._s(e.$t("news.details.header.menu.delete"))+"\n        ")])],1):e._e(),e._v(" "),e.showPublishButton?t("v-list-item",{on:{click:function(t){return e.$root.$emit("open-edit-publishing-drawer")}}},[t("v-list-item-title",[e._v("\n          "+e._s(e.$t("news.details.header.menu.publish"))+"\n        ")])],1):e._e()],1)],1)],1)};c._withStripped=!0;const h=n({props:{news:{type:Object,required:!1,default:null},newsArchived:{type:Boolean,required:!0,default:!1},showShareButton:{type:Boolean,required:!1,default:!1},showEditButton:{type:Boolean,required:!1,default:!1},showResumeButton:{type:Boolean,required:!1,default:!1},showDeleteButton:{type:Boolean,required:!1,default:!1},showPublishButton:{type:Boolean,required:!1,default:!1},newsPublished:{type:Boolean,required:!1,default:!1}},data:()=>({actionMenu:null,showPublishMessage:!1,publishMessage:"",publishSuccess:!0}),computed:{isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}},mounted(){$("#UIPortalApplication").parent().click((()=>{this.actionMenu=!1}))}},c,[],!1,null,null,null).exports;var u=function(){var e=this,t=e._self._c;return e.news?t("exo-news-details",{attrs:{news:e.news,"news-id":e.newsId||e.sharedNewsId,"activity-id":e.activityId,"show-edit-button":e.showEditButton,"show-publish-button":e.showPublishButton,"show-delete-button":e.showDeleteButton}}):e._e()};u._withStripped=!0;const w=n({props:{activity:{type:Object,default:null}},data:()=>({news:null}),computed:{activityId(){return this.activity&&this.activity.id},sharedActivity(){return this.activity&&this.activity.originalActivity},sharedTemplateParams(){return this.sharedActivity&&this.sharedActivity.templateParams},templateParams(){return this.activity&&this.activity.templateParams},newsId(){return this.templateParams&&this.templateParams.newsId},sharedNewsId(){return this.sharedTemplateParams&&this.sharedTemplateParams.newsId},showDeleteButton(){return this.news&&this.news.canDelete},showEditButton(){return this.news&&this.news.canEdit},showPublishButton(){return this.news&&this.news.canPublish}},created(){(this.newsId||this.sharedNewsId)&&this.retrieveNews()},methods:{retrieveNews(){this.activity.news?this.news=this.activity.news:this.$newsServices.getNewsByActivityId(this.activityId).then((e=>{this.news=e,this.news||this.$root.$emit("activity-extension-abort",this.activityId),this.activity.news=e})).catch((()=>{this.$root.$emit("activity-extension-abort",this.activityId)}))}}},u,[],!1,null,null,null).exports;var p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"newsDetailsTopBar",class:!e.showEditButton&&"me-5"},[t("a",{staticClass:"backBtn",on:{click:e.goBack}},[t("i",{staticClass:"uiIconBack my-4"})]),e._v(" "),"staged"===e.publicationState?t("v-btn",{staticClass:"btn newsDetailsActionMenu mt-6 mr-2 pull-right",on:{click:function(t){return e.$root.$emit("open-schedule-drawer","editScheduledNews")}}},[e._v("\n    "+e._s(e.$t("news.composer.btn.scheduleArticle"))+"\n  ")]):e._e(),e._v(" "),"staged"!==e.publicationState&&(e.showEditButton||e.showDeleteButton||e.showPublishButton)?t("exo-news-details-action-menu",{staticClass:"pull-right",attrs:{news:e.news,"news-published":e.newsPublished,"show-edit-button":e.showEditButton,"show-delete-button":e.showDeleteButton,"show-publish-button":e.showPublishButton}}):e._e(),e._v(" "),e.displayFavoriteButton?t("exo-news-favorite-action",{staticClass:"mt-6 pull-right",attrs:{news:e.news,"activity-id":e.activityId}}):e._e()],1)};p._withStripped=!0;const m=n({props:{news:{type:Object,required:!1,default:function(){return new Object}},newsId:{type:String,required:!1,default:null},activityId:{type:String,required:!1,default:null},showEditButton:{type:Boolean,required:!1,default:!1},showPublishButton:{type:Boolean,required:!1,default:!1},showDeleteButton:{type:Boolean,required:!1,default:!1}},data:()=>({spaceId:null,updaterIdentity:null,BYTES_IN_MB:1048576,dateFormat:{year:"numeric",month:"long",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{historyClearedBackUrl(){return this.news&&this.news.spaceMember?this.news.spaceUrl:`${eXo.env.portal.context}/${eXo.env.portal.portalName}`},archivedNews(){return this.news&&this.news.archived},publicationState(){return this.news&&this.news.publicationState},newsTitle(){return this.news&&this.news.title},newsPublished(){return this.news&&this.news.published},lastVisitedPage:()=>history&&history.length&&history.length>2,displayFavoriteButton(){return"staged"!==this.publicationState}},methods:{goBack(){this.lastVisitedPage?history.back():window.open(this.historyClearedBackUrl,"_self")}}},p,[],!1,null,null,null).exports;var v=function(){var e=this,t=e._self._c;return t("v-app-bar",{staticClass:"news-details-toolbar",attrs:{absolute:"",flat:"",src:e.illustrationUrl,prominent:""}},[t("v-app-bar-nav-icon",[t("v-btn",{staticClass:"newsDetailsMenuBtn my-2",attrs:{fab:"",dark:"","x-small":"",href:e.backURL}},[t("v-btn",{attrs:{icon:""}},[t("v-icon",[e._v("mdi-arrow-left")])],1)],1)],1),e._v(" "),t("v-spacer"),e._v(" "),"staged"!==e.publicationState&&e.showEditButton?t("v-btn",{staticClass:"newsDetailsMenuBtn my-2",attrs:{fab:"",dark:"","x-small":""}},[e.showEditButton&&"staged"!==e.publicationState?t("exo-news-details-action-menu",{attrs:{news:e.news,"show-edit-button":e.showEditButton,"show-delete-button":e.showDeleteButton,"show-publish-button":e.showPublishButton,"news-published":e.newsPublished}}):e._e()],1):e._e(),e._v(" "),"staged"===e.publicationState?t("v-btn",{staticClass:"btn newsDetailsActionMenu my-2 pull-right",on:{click:function(t){return e.$root.$emit("open-schedule-drawer","editScheduledNews")}}},[e._v("\n    "+e._s(e.$t("news.composer.btn.scheduleArticle"))+"\n  ")]):e._e()],1)};v._withStripped=!0;const f=n({props:{news:{type:Object,required:!1,default:null},showEditButton:{type:Boolean,required:!1,default:!1},showPublishButton:{type:Boolean,required:!1,default:!1},showDeleteButton:{type:Boolean,required:!1,default:!1}},computed:{backURL(){return this.news&&this.news.spaceMember?this.news.spaceUrl:`${eXo.env.portal.context}/${eXo.env.portal.portalName}`},illustrationUrl(){return this.news&&this.news.illustrationURL?this.news.illustrationURL.concat("&size=315x128").toString():"/news/images/news.png"},publicationState(){return this.news&&this.news.publicationState},newsPublished(){return this.news&&this.news.published}}},v,[],!1,null,null,null).exports;var b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"newsContent"},[t("div",{staticClass:"newsDetailsTitle mt-2 pl-2 pr-2 ms-2 font-weight-bold subtitle-1",attrs:{title:e.newsTitle}},[e._v("\n    "+e._s(e.newsTitle)+"\n  ")]),e._v(" "),t("div",{staticClass:"d-flex flex-row pa-2 ms-2"},[e.news?t("div",{staticClass:"flex-column newsAuthor"},[t("exo-user-avatar",{staticClass:"align-center my-auto text-truncate flex-grow-0 flex",attrs:{"profile-id":e.newsAuthor,size:32,"bold-title":"","link-style":""}})],1):e._e(),e._v(" "),t("v-icon",[e._v("\n      mdi-chevron-right\n    ")]),e._v(" "),t("div",{staticClass:"flex-column"}),e._v(" "),e.space?t("v-list-item-title",{staticClass:"font-weight-bold body-2 mb-0"},[t("exo-space-avatar",{staticClass:"align-center my-auto text-truncate flex-grow-0 flex",attrs:{space:e.space,size:32,"bold-title":"","link-style":""}})],1):e._e()],1),e._v(" "),t("div",{staticClass:"d-flex flex-row caption text-light-color"},[t("exo-news-details-time",{attrs:{news:e.news}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-row caption font-italic grey--text text-darken-1 pa-4"},[t("span",{domProps:{innerHTML:e._s(e.newsSummary)}})]),e._v(" "),t("v-divider",{staticClass:"mx-4"}),e._v(" "),t("div",{staticClass:"d-flex flex-row pa-4 newsBody"},[t("span",{domProps:{innerHTML:e._s(e.newsBody)}})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.attachments&&e.attachments.length,expression:"attachments && attachments.length"}],staticClass:"d-flex flex-row pa-4 newsAttachmentsTitle subtitle-2"},[e._v("\n    "+e._s(e.$t("news.details.attachments.title"))+" ("+e._s(e.attachments?e.attachments.length:0)+")\n  ")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.attachments&&e.attachments.length,expression:"attachments && attachments.length"}],staticClass:"newsAttachments"},e._l(e.attachments,(function(s){return t("div",{key:s.id,staticClass:"newsAttachment text-truncate",on:{click:function(t){return e.openPreview(s)}}},[t("exo-attachment-item",{attrs:{file:s}})],1)})),0)],1)};b._withStripped=!0;const y=n({props:{news:{type:Object,required:!1,default:null},newsId:{type:String,required:!1,default:null},space:{type:Object,required:!1,default:null}},data:()=>({dateFormat:{year:"numeric",month:"long",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{newsTitle(){return this.news&&this.news.title},spaceUrl(){return this.news&&this.news.spaceAvatarUrl},publicationState(){return this.news&&this.news.publicationState},newsSummary(){return this.news&&this.targetBlank(this.news.summary)},newsBody(){return this.news&&this.targetBlank(this.news.body)},newsAuthor(){return this.news&&this.news.author},attachments(){return this.news&&this.news.attachments}},methods:{targetBlank:function(e){const t=location.host+eXo.env.portal.context,s=(new DOMParser).parseFromString(e,"text/html").documentElement,i=s.getElementsByTagName("a");for(const e of i){let s=e.href.replace(/(^\w+:|^)\/\//,"");s.endsWith("/")&&(s=s.slice(0,-1)),s===location.host||s.startsWith(t)||(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))}return s.innerHTML},openPreview(e){const t=this;window.require(["SHARED/documentPreview"],(function(s){s.init({doc:{id:e.id,repository:"repository",workspace:"collaboration",title:e.name,downloadUrl:`/portal/rest/v1/news/attachments/${e.id}/file`,openUrl:`/portal/rest/v1/news/attachments/${e.id}/open`},showComments:!1}),t.hideDocPreviewComments()}))}}},b,[],!1,null,null,null).exports;var g=function(){var e=this,t=e._self._c;return e.news?t("div",[e.archivedNews&&!e.news.canArchive?t("div",[t("div",{staticClass:"userNotAuthorized"},[e._m(0),e._v(" "),t("h3",[e._v(e._s(e.$t("news.archive.text")))])])]):e._e(),e._v(" "),t("div",{staticClass:"newsDetails-description"},[t("div",{staticClass:"newsDetails-header",class:[e.illustrationURL?"newsDetails-header":""]},[e.illustrationURL?t("div",{staticClass:"illustration"},[t("img",{staticClass:"newsDetailsImage illustrationPicture",attrs:{src:e.illustrationURL.concat("&size=0x400").toString(),alt:e.newsTitle,longdesc:"#newsSummary"}})]):e._e(),e._v(" "),t("div",{staticClass:"newsDetails"},[t("div",{staticClass:"news-top-information d-flex"},[t("div",{staticClass:"newsTitle newsTitleMobile",attrs:{id:"titleNews"}},[t("a",{staticClass:"activityLinkColor newsTitleLink"},[e._v(e._s(e.newsTitle))]),e._v(" "),e.archivedNews?t("div",{staticClass:"newsArchived"},[t("span",{staticClass:"newsArchiveLabel"},[e._v(" ( "+e._s(e.$t("news.archive.label"))+" ) ")])]):e._e()])]),e._v(" "),t("div",{staticClass:"newsInformationBackground"},[t("div",{staticClass:"news-header-content d-inline-flex align-center",class:[e.showUpdateInfo?"news-update-details-header":"news-details-header"]},[t("div",{class:[e.showUpdateInfo?"newsUpdateInfo":""]},[t("exo-user-avatar",{staticClass:"me-1",attrs:{"profile-id":e.authorProfile,size:50,popover:"",avatar:""}})],1),e._v(" "),t("div",{staticClass:"newsInformation pa-1",attrs:{id:"informationNews"}},[t("div",{staticClass:"newsPosted d-flex align-center"},[t("exo-user-avatar",{attrs:{"profile-id":e.authorProfile,"extra-class":"me-1",fullname:"","small-font-size":"","link-style":"",popover:""}}),e._v(" "),e.hiddenSpace?e._e():t("span",{staticClass:"text-light-color caption"},[e._v(" "+e._s(e.$t("news.activity.in"))+" ")]),e._v(" "),e.hiddenSpace?e._e():t("exo-space-avatar",{attrs:{"space-id":e.spaceId,fullname:"","extra-class":"mx-1","small-font-size":"","link-style":"",popover:""}}),e._v(" "),e.publicationDate?[e._v("\n                  -\n                  "),t("date-format",{staticClass:"newsInformationValue newsPostedDate news-details-information caption ms-1",attrs:{value:e.publicationDate,format:e.dateFormat}})]:e.postedDate?t("span",{staticClass:"newsInformationValue newsPostedDate news-details-information"},[e._v("- "+e._s(e.postedDate))]):e._e()],2),e._v(" "),t("div",{staticClass:"newsUpdater caption"},["staged"!==e.publicationState&&e.showUpdateInfo?t("div",[t("span",{staticClass:"text-light-color"},[e._v(e._s(e.$t("news.activity.lastUpdated"))+" ")])]):"staged"===e.publicationState?t("div",[t("span",{staticClass:"text-light-color"},[e._v(e._s(e.$t("news.details.scheduled"))+" ")])]):e._e(),e._v(" "),t("div",["staged"!==e.publicationState&&e.updatedDate&&e.showUpdateInfo?[t("date-format",{staticClass:"newsInformationValue newsUpdatedDate",attrs:{value:e.updatedDate,format:e.dateFormat}})]:"staged"===e.publicationState?[t("date-format",{staticClass:"newsInformationValue newsUpdatedDate",attrs:{value:e.scheduleDate,format:e.dateFormat}}),e._v(" "),t("span",{staticClass:"newsInformationValue"},[e._v("-")]),e._v(" "),t("date-format",{staticClass:"newsInformationValue newsUpdatedDate ml-1 me-1",attrs:{value:e.scheduleDate,format:e.dateTimeFormat}})]:e._e(),e._v(" "),e.notSameUpdater&&e.showUpdateInfo?t("div",[t("span",{staticClass:"text-light-color"},[e._v(" "+e._s(e.$t("news.activity.by"))+" ")]),e._v(" "),t("exo-user-avatar",{attrs:{"profile-id":e.newsUpdater,"extra-class":"ms-1",fullname:"","small-font-size":"","link-style":"",popover:""}})],1):e._e()],2)])])])]),e._v(" "),e.newsSummary?t("div",{staticClass:"summary",attrs:{id:"newsSummary"}},[t("span",{domProps:{innerHTML:e._s(e.newsSummary)}})]):e._e(),e._v(" "),t("div",{staticClass:"fullDetailsBody clearfix",class:[e.summary?"":"fullDetailsBodyNoSummary"],attrs:{id:"newsBody"}},[t("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.newsBody,expression:"newsBody"}]})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.attachments&&e.attachments.length,expression:"attachments && attachments.length"}],staticClass:"newsAttachmentsTitle"},[e._v("\n          "+e._s(e.$t("news.details.attachments.title"))+" ("+e._s(e.attachments?e.attachments.length:0)+")\n        ")]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.attachments&&e.attachments.length,expression:"attachments && attachments.length"}],staticClass:"newsAttachments"},e._l(e.attachments,(function(s){return t("div",{key:s.id,staticClass:"newsAttachment",on:{click:function(t){return e.openPreview(s)}}},[t("exo-attachment-item",{attrs:{file:s}})],1)})),0)])])])]):e._e()};g._withStripped=!0;const _=n({props:{news:{type:Object,required:!1,default:null}},data:()=>({dateFormat:{year:"numeric",month:"long",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{archivedNews(){return this.news&&this.news.archived},illustrationURL(){return this.news&&this.news.illustrationURL},newsTitle(){return this.news&&this.news.title},showUpdateInfo(){return this.news&&this.news.updateDate&&"__system"!==this.news.updater&&"null"!==this.news.updateDate&&this.news.publicationDate&&"null"!==this.news.publicationDate&&this.news.updateDate.time>this.news.publicationDate.time},authorProfile(){return this.news&&this.news.author},hiddenSpace(){return this.news&&this.news.hiddenSpace},newsBody(){return this.news&&this.targetBlank(this.news.body)},updaterFullName(){return this.news&&this.news.updaterFullName},updaterProfileURL(){return this.news&&`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.news.updater}`},newsUpdater(){return this.news&&this.news.updater},publicationDate(){return this.news&&this.news.publicationDate&&this.news.publicationDate.time&&new Date(this.news.publicationDate.time)},updatedDate(){return this.news&&this.news.updateDate&&this.news.updateDate.time&&new Date(this.news.updateDate.time)},newsSummary(){return this.news&&this.targetBlank(this.news.summary)},spaceId(){return this.news&&this.news.spaceId},postedDate(){return this.news&&this.news.postedDate},summary(){return this.news&&this.news.summary},attachments(){return this.news&&this.news.attachments},publicationState(){return this.news&&this.news.publicationState},notSameUpdater(){return this.news&&this.news.updater!==this.news.author},scheduleDate(){return this.news&&this.news.schedulePostDate}},methods:{openPreview(e){const t=this;window.require(["SHARED/documentPreview"],(function(s){s.init({doc:{id:e.id,repository:"repository",workspace:"collaboration",title:e.name,downloadUrl:`/portal/rest/v1/news/attachments/${e.id}/file`,openUrl:`/portal/rest/v1/news/attachments/${e.id}/open`},showComments:!1}),t.hideDocPreviewComments()}))},hideDocPreviewComments(){const e=document.querySelector(".uiDocumentPreview .commentArea"),t=document.querySelector(".uiDocumentPreview .resizeButton");null!=e&&null!=t?(e.style.display="none",t.style.display="none",document.querySelector(".uiDocumentPreview").classList+=" collapsed"):setTimeout(this.hideDocPreviewComments,100)},targetBlank:function(e){const t=location.host+eXo.env.portal.context,s=(new DOMParser).parseFromString(e,"text/html").documentElement,i=s.getElementsByTagName("a");for(const e of i){let s=e.href.replace(/(^\w+:|^)\/\//,"");s.endsWith("/")&&(s=s.slice(0,-1)),s===location.host||s.startsWith(t)||(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))}return s.innerHTML}}},g,[function(){var e=this._self._c;return e("div",{staticClass:"notAuthorizedIconDiv"},[e("img",{staticClass:"iconNotAuthorized",attrs:{src:"/news/images/notauthorized.png"}})])}],!1,null,null,null).exports;var x=function(){var e=this,t=e._self._c;return e.news?t("div",{staticClass:"d-flex flex-row"},[t("div",{staticClass:"flex-column my-auto"},[t("v-icon",{staticClass:"ms-4 me-1",attrs:{"x-small":""}},[e._v("far fa-clock")])],1),e._v(" "),t("div",{staticClass:"flex-column me-1 my-auto"},[t("span",[e._v(e._s(e.postModeLabel)+" ")])]),e._v(" "),e.publicationDate?t("date-format",{attrs:{value:e.publicationDate,format:e.dateFormat}}):e.postedDate?t("span",{staticClass:"flex-column my-auto"},[e._v("- "+e._s(e.postedDate))]):"staged"===e.publicationState?[t("date-format",{attrs:{value:e.scheduleDate,format:e.dateFormat}}),e._v(" "),t("span",[e._v("-")]),e._v(" "),t("date-format",{attrs:{value:e.scheduleDate,format:e.dateTimeFormat}})]:e.updatedDate?t("date-format",{attrs:{value:e.updatedDate,format:e.dateFormat}}):e._e(),e._v(" "),e.notSameUpdater?t("div",{staticClass:"ms-1 flex-column me-1 my-auto"},[e._v(" "+e._s(e.$t("news.activity.by")))]):e._e(),e._v(" "),e.notSameUpdater?t("div",{staticClass:"flex-column my-auto"},[t("a",{attrs:{href:e.updaterProfileURL}},[e._v(e._s(e.updaterFullName))])]):e._e()],2):e._e()};x._withStripped=!0;const S=n({props:{news:{type:Object,required:!1,default:null}},data:()=>({dateFormat:{year:"numeric",month:"long",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{publicationDate(){return this.news&&this.news.publicationDate&&this.news.publicationDate.time&&new Date(this.news.publicationDate.time)},updatedDate(){return this.news&&this.news.updateDate&&this.news.updateDate.time&&new Date(this.news.updateDate.time)},postedDate(){return this.news&&this.news.postedDate},publicationState(){return this.news&&this.news.publicationState},scheduleDate(){return this.news&&this.news.schedulePostDate},notSameUpdater(){return this.news&&"__system"!==this.news.updater&&this.news.updater!==this.news.author},updaterProfileURL(){return this.news&&`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.news.updater}`},postModeLabel(){return"staged"===this.publicationState&&this.updatedDate?this.$t("news.details.scheduled"):this.$t("news.activity.lastUpdated")},updaterFullName(){return this.news&&"__system"!==this.news.updater?this.news.updaterFullName:this.news.authorFullName}}},x,[],!1,null,null,null).exports;var T=function(){var e=this,t=e._self._c;return t("div",[t("v-overlay",{attrs:{"z-index":"1000",value:e.drawer},nativeOn:{click:function(t){e.drawer=!1}}}),e._v(" "),t("exo-drawer",{ref:"postNewsDrawer",attrs:{id:"postNewsDrawer","show-overlay":"","body-classes":"hide-scroll decrease-z-index-more",right:""},on:{closed:e.closeDrawer},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[t("template",{slot:"title"},[e._v("\n      "+e._s(e.$t("news.details.editPublishing.title"))+"\n    ")]),e._v(" "),t("template",{slot:"content"},[t("div",[t("div",{staticClass:"d-flex flex-column pa-2"},[t("div",{staticClass:"d-flex flex-row font-weight-bold body-2 pa-3"},[e._v("\n            "+e._s(e.$t("news.details.editPublishing"))+"\n          ")]),e._v(" "),t("div",{staticClass:"d-flex flex-row pa-4"},[t("v-switch",{staticClass:"my-auto",attrs:{inset:"",dense:""},model:{value:e.isActivityPosted,callback:function(t){e.isActivityPosted=t},expression:"isActivityPosted"}}),e._v(" "),t("label",{staticClass:"publishSectionOption my-auto"},[e._v("\n              "+e._s(e.$t("news.composer.stepper.postOnStream.option"))+"\n            ")])],1),e._v(" "),t("div",{staticClass:"d-flex flex-row font-weight-bold body-2 pa-3"},[e._v("\n            "+e._s(e.$t("news.details.editPublishing.description"))+"\n          ")]),e._v(" "),t("div",{staticClass:"d-flex flex-row pa-4"},[t("v-switch",{staticClass:"my-auto",attrs:{disabled:!e.allowedTargets.length,inset:"",dense:""},on:{change:e.removeTargets},model:{value:e.publish,callback:function(t){e.publish=t},expression:"publish"}}),e._v(" "),t("label",{staticClass:"publishSectionOption my-auto"},[e._v("\n              "+e._s(e.$t("news.details.editPublishing.option"))+"\n            ")])],1),e._v(" "),0===e.allowedTargets.length?t("div",{staticClass:"d-flex flex-row grey--text ms-2"},[t("i",{staticClass:"fas fa-exclamation-triangle mx-2 mt-3"}),e._v("\n            "+e._s(e.$t("news.composer.stepper.selectedTarget.noTargetAllowed"))+"\n          ")]):e._e(),e._v(" "),e.publish&&e.allowedTargets.length?t("exo-news-targets-selector",{ref:"chooseTargets",attrs:{id:"chooseTargets",news:e.news,publish:e.publish,targets:e.allowedTargets,audience:e.audience},on:{"selected-targets":e.getSelectedTargets,"selected-audience":e.getSelectedAudience}}):e._e()],1)])]),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex justify-end"},[t("v-btn",{staticClass:"btn btn-primary ms-2",attrs:{disabled:e.disabled,loading:e.editingNews},on:{click:e.updateNews}},[e._v("\n          "+e._s(e.$t("news.edit.update"))+"\n        ")])],1)])],2)],1)};T._withStripped=!0;const D=n({props:{news:{type:String,required:!1,default:null}},data:()=>({selectedTargets:[],selectedAudience:null,audience:null,drawer:!1,allowNotPost:!1,publish:!1,targets:[{id:0,name:"Latest news"},{id:1,name:"Snapshot Slider"},{id:2,name:"Homepage widget"}],isActivityPosted:!0,editingNews:!1,disabled:!1,allowedTargets:[]}),watch:{selected(){this.publish=this.selected},isActivityPosted(){this.isHiddenActivity===!this.isActivityPosted&&(this.publish===this.selected||this.publish&&this.selectedTargets&&0===this.selectedTargets.length)?this.disabled=!0:this.disabled=!1},publish(){this.publish===this.selected&&this.isHiddenActivity===!this.isActivityPosted||this.isHiddenActivity===!this.isActivityPosted&&(this.publish===this.selected||this.publish&&this.selectedTargets&&0===this.selectedTargets.length)?this.disabled=!0:this.disabled=!1},selectedTargets(e,t){this.publish&&0===e.length?this.disabled=!0:this.disabled=e===t}},computed:{selected(){return this.news&&this.news.published},isHiddenActivity(){return this.news&&this.news.activityPosted},disableTargetOption(){return this.selectedTargets&&0===this.selectedTargets.length},showTargetInformation(){return this.disableTargetOption&&this.publish},selectAllTargets(){return this.selectedTargets.length===this.targets.length},selectSomeTarget(){return this.selectedTargets.length>0&&!this.selectAllTargets},selectionIcon(){return this.selectAllTargets?"mdi-close-box":this.selectSomeTarget?"mdi-minus-box":"mdi-checkbox-blank-outline"},selectTargetLabel(){return this.selectAllTargets?this.$t("news.composer.stepper.chooseTarget.deselectAllTargets"):this.$t("news.composer.stepper.chooseTarget.selectAllTargets")}},created(){this.selectedAudience="all"===this.news.audience?this.$t("news.composer.stepper.audienceSection.allUsers"):this.$t("news.composer.stepper.audienceSection.onlySpaceMembers"),this.audience=this.news.audience,this.getAllowedTargets(),this.$root.$on("open-edit-publishing-drawer",(()=>{this.openDrawer()})),$(document).click((()=>{this.$refs.chooseTargets&&this.$refs.chooseTargets.isMenuActive&&this.$refs.chooseTargets.blur()}))},methods:{openDrawer(){this.news&&(this.publish=this.news.published,this.isActivityPosted=!this.news.activityPosted),this.$refs.postNewsDrawer&&(this.disabled=!0,this.$refs.postNewsDrawer.open())},getSelectedTargets(e){this.selectedTargets=e},getSelectedAudience(e){this.selectedAudience=e,this.disabled=!1},updateNews(){return this.editingNews=!0,this.news.published=this.publish,this.news.activityPosted=!this.isActivityPosted,this.selectedTargets.length>0&&(this.news.targets=this.selectedTargets),this.publish?this.news.audience=this.selectedAudience===this.$t("news.composer.stepper.audienceSection.allUsers")?"all":"space":this.news.audience=null,this.$newsServices.updateNews(this.news,!1).then((()=>{this.editingNews=!1;const e=this.$t("news.composer.alert.success.UpdateTargets");this.$root.$emit("news-notification-alert",{message:e,type:"success"}),this.$emit("refresh-news",this.news.newsId),window.setTimeout((()=>{this.drawer=!1}),400)})).catch((()=>{this.editingNews=!1;const e=this.$t("news.composer.alert.error.UpdateTargets");this.$root.$emit("news-notification-alert",{message:e,type:"error"})}))},removeTargets(){this.selectedTargets=[]},closeDrawer(){this.disabled=!1,this.$refs.postNewsDrawer.close()},getAllowedTargets(){this.$newsTargetingService.getAllowedTargets().then((e=>{this.allowedTargets=e.map((e=>({name:e.name,label:e.properties&&e.properties.label&&e.properties.label.length>35?e.properties.label.substring(0,35).concat("..."):e.properties.label,tooltipInfo:e.properties&&e.properties.label,description:e.properties&&e.properties.description})))}))}}},T,[],!1,null,null,null).exports;var C=function(){var e=this;return(0,e._self._c)("favorite-button",{attrs:{id:e.newsId,favorite:e.news&&e.news.favorite,absolute:e.absolute,top:e.top,right:e.right,"template-params":e.templateParams,"space-id":e.spaceId,type:"news","type-label":"News"},on:{removed:e.removed,"remove-error":e.removeError,added:e.added,"add-error":e.addError}})};C._withStripped=!0;const I=n({props:{news:{type:Object,default:null},activityId:{type:String,default:null},absolute:{type:Boolean,default:!1},top:{type:Number,default:()=>0},right:{type:Number,default:()=>0}},data:()=>({templateParams:{}}),computed:{newsId(){return this.news?.id},spaceId(){return this.news?.spaceId}},created(){this.templateParams.newsId=this.news&&this.news.id,this.templateParams.spaceId=this.news&&this.news.spaceId},methods:{removed(){this.displayAlert(this.$t("Favorite.tooltip.SuccessfullyDeletedFavorite",{0:this.$t("news.label")})),this.$emit("removed")},removeError(){this.displayAlert(this.$t("Favorite.tooltip.ErrorDeletingFavorite",{0:this.$t("news.label")}),"error")},added(){this.displayAlert(this.$t("Favorite.tooltip.SuccessfullyAddedAsFavorite",{0:this.$t("news.label")})),this.$emit("added")},addError(){this.displayAlert(this.$t("Favorite.tooltip.ErrorAddingAsFavorite",{0:this.$t("news.label")}),"error")},displayAlert(e,t){document.dispatchEvent(new CustomEvent("notification-alert",{detail:{message:e,type:t||"success"}}))}}},C,[],!1,null,null,null).exports,A=eXo.env.portal.context||"",B=(eXo.env.portal.portalName,eXo.env.portal.containerName,eXo.env.portal.rest),N=`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news`,P=(eXo.env.portal.context,eXo.env.portal.rest,`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/spaces`),k=`${eXo.env.portal.context}/${eXo.env.portal.rest}${eXo.env.portal.context}/social/spaces/suggest.json`,E=`${eXo.env.portal.context}/${eXo.env.portal.rest}/space/user/searchSpace/`,U=(eXo.env.portal.spaceId,window.location.host,eXo.env.portal.context,eXo.env.portal.userName);function X(e,t){return fetch(`${N}/${e}?editMode=${t||""}`,{credentials:"include",method:"GET"}).then((e=>e&&e.ok?e.json():401===e.status?e.status:void 0)).then((e=>e)).catch((e=>e))}function F(e){return fetch(`${N}/byActivity/${e}`,{credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function M(e){return fetch(`${N}/${e}?fields=spaces`,{credentials:"include",method:"GET"}).then((e=>e.json())).then((e=>e))}function j(e){return fetch(`${N}/markAsRead/${e}`,{credentials:"include",method:"POST"}).then((e=>{if(e&&e.ok)return e.text();throw new Error("Error while marking news as read")}))}function O(e,t,s,i,n,a){let r=`${N}?author=${U}&publicationState=published&filter=${e}`;return s&&(r+=`&text=${s}`),t&&(r+=`&spaces=${t}`),isNaN(i)||(r+=`&offset=${i}`),isNaN(n)||(r+=`&limit=${n}`),a&&(r+=`&returnSize=${a}`),fetch(r,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting news list")}))}function q(e){return fetch(`${N}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"POST",body:JSON.stringify(e)}).then((e=>e.json()))}function L(e){return fetch(`${N}/schedule`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PATCH",body:JSON.stringify(e)}).then((e=>e.json()))}function R(e){return fetch(e,{headers:{"Content-Type":"blob"},credentials:"include",method:"GET"})}function z(e,t){return fetch(`${N}/${e.id}?post=${t}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PUT",body:JSON.stringify(e)}).then((e=>e.json()))}function V(e){return fetch(`${N}/${e}/click`,{credentials:"include",method:"POST",body:"edit"})}function H(e){return fetch(`${k}?conditionToSearch=${e}&currentUser=${U}&typeOfRelation=confirmed`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json())).then((e=>e.options))}function G(e){return fetch(`${N}/${e}`,{credentials:"include",method:"DELETE"})}function J(e){return fetch(`${P}/${e}`,{credentials:"include",method:"GET"}).then((t=>{if(t&&t.ok)return t.json();throw new Error(`Error getting space with id ${e}`)}))}function W(e,t,s){return fetch(`${P}?offset=${e}&limit=${t}&returnSize=true&filterType=${s}`,{credentials:"include",method:"GET"}).then((e=>e.json())).then((e=>e))}function Y(e){return fetch(`${E}?fields=id,url,displayName,avatarUrl&keyword=${e}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json()))}function Z(e,t,s){return fetch(`/portal/rest/managedocument/getFoldersAndFiles/?driveName=${e}&workspaceName=${t}&currentFolder=${s}`,{}).then((e=>e.text())).then((e=>(new window.DOMParser).parseFromString(e,"text/xml"))).then((e=>e))}function K(){return fetch("/portal/rest/wcmDriver/getDrivers",{}).then((e=>e.text())).then((e=>(new window.DOMParser).parseFromString(e,"text/xml"))).then((e=>e))}function Q(e){const t=document.createElement("div");return t.innerText=e,t.innerHTML}function ee(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news/canCreateNews/${eXo.env.portal.spaceId||e}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e&&e.ok&&e.json()))}function te(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news/canScheduleNews/${eXo.env.portal.spaceId||e}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e&&e.ok&&e.json()))}function se(e,t,s){return s>0&&localStorage.setItem("deletedNews",e),fetch(`${N}/${e}?isDraft=${t||""}&delay=${s||0}`,{credentials:"include",method:"DELETE"}).then((e=>{if(e&&!e.ok)throw new Error("Error when deleting news")}))}function ie(e){return fetch(`${N}/${e}/undoDelete`,{method:"POST",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Error when undoing deleting news");localStorage.removeItem("deletedNews")}))}function ne(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/news/canPublishNews?spaceId=${eXo.env.portal.spaceId}`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json())).then((e=>e))}const ae={"exo-news-archive":a,"exo-news-details":d,"exo-news-details-activity":w,"exo-news-details-action-menu":h,"exo-news-details-toolbar":m,"exo-news-details-toolbar-mobile":f,"exo-news-details-body-mobile":y,"exo-news-details-body":_,"exo-news-details-time":S,"exo-news-edit-publishing-drawer":D,"exo-news-favorite-action":I};for(const e in ae)Vue.component(e,ae[e]);Vue.prototype.$newsServices||window.Object.defineProperty(Vue.prototype,"$newsServices",{value:s}),Vue.use(Vuetify);const re=new Vuetify(eXo.env.portal.vuetifyPreset);if(extensionRegistry){const e=extensionRegistry.loadComponents("NewsDetails");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}let oe;function le(e){const t="undefined"!=typeof eXo?eXo.env.portal.language:"en",s=[`${A}/${B}/i18n/bundle/locale.portlet.news.News-${t}.json`,`${A}/${B}/i18n/bundle/locale.attachmentsSelector.attachments-${t}.json`],i="newsDetailsApp",n=`${i}_${e.activityId}`,a=document.createElement("div");a.id=i,exoi18n.loadLanguageAsync(t,s).then((t=>{oe=new Vue({data:function(){return{news:e.news,newsId:e.news.newsId,activityId:e.activityId,showEditButton:e.news.canEdit,showPublishButton:e.news.canPublish,showDeleteButton:e.news.canDelete}},template:`<v-app id="${i}" v-cacheable="{cacheId: '${n}'}">\n                  <exo-news-details\n                    :news="news"\n                    :news-id="newsId"\n                    :activity-id="activityId"\n                    :show-edit-button="showEditButton"\n                    :show-publish-button="showPublishButton"\n                    :show-delete-button="showDeleteButton"/>\n                 </v-app>`,i18n:t,vuetify:re}).$mount(a)}))}function de(){oe&&oe.$destroy()}return t})()));