define((()=>(()=>{"use strict";var e={d:(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{formatSearchResult:()=>n});var r=function(){var e=this,t=e._self._c;return t("v-card",{staticClass:"d-flex flex-column border-radius box-shadow",attrs:{flat:"","min-height":"227"}},[t("div",{staticClass:"d-flex flex-grow-1 px-3 py-3"},[t("div",{ref:"excerptNode",staticClass:"text-wrap me-3 text-break caption search-card-text",attrs:{title:e.excerptText}}),e._v(" "),t("exo-news-favorite-action",{attrs:{news:e.result,"activity-id":e.result.activityId,absolute:"",top:"0",right:"0"},on:{removed:function(t){return e.$emit("refresh-favorite")}}})],1),e._v(" "),t("v-list",{staticClass:"flex-grow-0 no-border-radius pa-0"},[t("v-list-item",{staticClass:"px-3 pt-1 pb-2"},[t("div",{staticClass:"grey-color"},[t("div",[e._v("\n          "+e._s(e.$t("search.news.card.author"))+" :  "),t("a",{attrs:{href:e.posterProfile,target:"_blank"}},[e._v("\n            "+e._s(e.posterFullName)+"\n          ")])]),e._v(" "),t("div",[e._v(e._s(e.$t("search.news.card.published"))+" : "+e._s(e.formatDate(this.result.postedTime)))])])])],1),e._v(" "),t("v-list",{staticClass:"light-grey-background flex-grow-0 border-top-color no-border-radius pa-0"},[t("v-list-item",{staticClass:"px-0 pt-1 pb-2",attrs:{href:this.result.newsUrl}},[t("v-list-item-icon",{staticClass:"mx-0"},[t("span",{staticClass:"uiIconActivity uiIconNews tertiary--text ps-2 pe-2"})]),e._v(" "),t("v-list-item-content",[t("v-list-item-title",[e._v("\n          "+e._s(this.result.title)+"\n        ")]),e._v(" "),t("v-list-item-subtitle",[e._v("\n          "+e._s(this.result.spaceDisplayName)+"\n        ")])],1)],1)],1)],1)};r._withStripped=!0;var s=function(e,t,r,s,i,n,l,o){var a,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=[],c._compiled=!0),a)if(c.functional){c._injectStyles=a;var p=c.render;c.render=function(e,t){return a.call(t),p(e,t)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,a):[a]}return{exports:e,options:c}}({props:{term:{type:String,default:null},result:{type:Object,default:null}},data:()=>({maxEllipsisHeight:90,lineHeight:22,profileActionExtensions:[],fullDateFormat:{day:"numeric",month:"short",year:"numeric"}}),computed:{poster(){return this.result&&this.result.poster.profile},posterFullName(){return this.poster&&this.poster.fullname},posterProfile(){return this.poster&&`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.poster.username}`},excerpts(){return this.result&&this.result.excerpts},excerptHtml(){return this.excerpts&&this.excerpts.join("\r\n...")},excerptText(){return $("<div />").html(this.excerptHtml).text()}},created(){this.profileActionExtensions=extensionRegistry.loadExtensions("profile-extension","action")||[]},mounted(){this.computeEllipsis()},methods:{computeEllipsis(){if(!(this.excerptHtml&&0!==this.excerptHtml.length||this.result&&this.result.body&&0!==this.result.body.length))return;const e=this.$refs.excerptNode;if(!e)return;e.innerHTML=this.excerptHtml||this.result.body;let t=20,r=e.getBoundingClientRect().height||this.lineHeight;if(r>this.maxEllipsisHeight){for(;r>this.maxEllipsisHeight;){const s=this.deleteLastChars(e.innerHTML.replace(/&[a-z]*;/,""),t),i=e.innerHTML.length;e.innerHTML=s,e.innerHTML.length===i&&(t*=2),r=e.getBoundingClientRect().height||this.lineHeight}e.innerHTML=this.deleteLastChars(e.innerHTML,4),e.innerHTML=`${e.innerHTML}...`}},deleteLastChars(e,t){">"===e.slice(-1)&&(e=e.replace(/<[a-zA-Z 0-9 "'=]*><\/[a-zA-Z 0-9]*>$/g,"")),t=t||1;let r="";return">"===(e=e.replace(/<br>(\.*)$/g,"")).slice(-1)?(r=(e=e.replace(/(<br>)*$/g,"")).replace(new RegExp(`([^>]{${t}})(</)([a-zA-Z 0-9]*)(>)$`),"$2$3"),r=$("<div />").html(r).html().replace(/&[a-z]*;/,""),r.length===e.length&&(r=e.replace(new RegExp("([^>]*)(</)([a-zA-Z 0-9]*)(>)$"),"$2$3"))):r=e.substring(0,e.trimRight().length-t),r},formatDate(e){return this.$dateUtil.formatDateObjectToDisplay(new Date(e),this.fullDateFormat,eXo.env.portal.language)}}},r);const i={"news-search-card":s.exports};for(const e in i)Vue.component(e,i[e]);if(extensionRegistry){const e=extensionRegistry.loadComponents("newsSearchCard");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}function n(e){return e}return t})()));