define((()=>(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);var n={};t.r(n),t.d(n,{filterTasksList:()=>k,getLabelsByProjectId:()=>y,getLabelsByTaskId:()=>E,getMyTasksList:()=>g,getStatusesByProjectId:()=>b,getTaskById:()=>T,getTasksByProjectId:()=>_,updateCompleted:()=>D});var o={};t.r(o),t.d(o,{addLabel:()=>B,addTask:()=>S,addTaskComments:()=>z,addTaskSubComment:()=>F,addTaskToLabel:()=>M,cloneTask:()=>W,editLabel:()=>N,findUsersToMention:()=>J,getAllUsers:()=>X,getDefaultStatusByProjectId:()=>P,getMyAllLabels:()=>A,getProjectLabels:()=>I,getProjects:()=>R,getStatusesByProjectId:()=>V,getSuggestedUsers:()=>q,getTaskComments:()=>U,getTaskLabels:()=>L,getTaskLogs:()=>H,getUser:()=>Y,getUserInformations:()=>j,removeLabel:()=>G,removeTaskComment:()=>K,removeTaskFromLabel:()=>O,updateTask:()=>x,urlVerify:()=>Z});var s=function(){var t=this,e=t._self._c;return e("v-app",[e("exo-drawer",{ref:"taskCommentDrawer",staticClass:"taskCommentDrawer",attrs:{id:"taskCommentDrawer",right:""},on:{closed:t.closeDrawer}},[e("template",{slot:"title"},[e("v-flex",{staticClass:"mx-0 drawerHeader flex-grow-0 width-full"},[e("v-list-item",{staticClass:"pe-0"},[e("v-list-item-content",{staticClass:"drawerTitle d-flex text-header-title text-truncate"},[e("i",{staticClass:"uiIcon uiArrowBAckIcon",on:{click:t.closeDrawer}}),t._v(" "),e("span",{staticClass:"ps-2 mt-2"},[t._v(t._s(t.$t("label.comments")))])]),t._v(" "),e("v-list-item-action",{staticClass:"drawerIcons align-end d-flex flex-row"},[e("v-btn",{staticClass:"addCommentBtn float-right",attrs:{disabled:t.isEditorActive,icon:"",title:t.$t("comment.message.addYourComment")},on:{click:function(e){return t.openEditorToBottom(t.commentId)}}},[e("i",{staticClass:"uiIcon uiIconTaskAddComment"})])],1)],1)],1)],1),t._v(" "),e("template",{slot:"content"},[e("v-flex",{staticClass:"drawerContent flex-grow-1 overflow-auto border-box-sizing",attrs:{id:"commentDrawerContent"}},[this.comments&&this.comments.length?e("div",{staticClass:"TaskCommentContent"},t._l(t.comments,(function(n,o){return e("div",{key:o,staticClass:"pe-0 ps-0 TaskCommentItem"},[e("task-comments",{attrs:{task:t.task,comment:n,comments:t.comments,"last-comment":t.commentId,"show-new-comment-editor":t.showNewCommentEditor},on:{confirmDialogOpened:function(e){return t.$emit("confirmDialogOpened")},confirmDialogClosed:function(e){return t.$emit("confirmDialogClosed")}}})],1)})),0):e("div",[e("div",{staticClass:"editorContent commentEditorContainer newCommentEditor"},[e("task-comment-editor",{ref:"commentEditor",staticClass:"subComment subCommentEditor",attrs:{"max-length":t.MESSAGE_MAX_LENGTH,placeholder:t.$t("task.placeholder").replace("{0}",t.MESSAGE_MAX_LENGTH),task:t.task,"show-comment-editor":!0,id:"commentContent-editor"},on:{addNewComment:function(e){return t.addTaskComment(e)}}})],1)])])],1)],2)],1)};function r(t,e,n,o,s,r,i,a){var m,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),o&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),i?(m=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=m):s&&(m=a?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),m)if(c.functional){c._injectStyles=m;var l=c.render;c.render=function(t,e){return m.call(e),l(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,m):[m]}return{exports:t,options:c}}s._withStripped=!0;const i=r({props:{comment:{type:Object,default:()=>({})},comments:{type:Object,default:()=>({})},task:{type:Boolean,default:!1},showTaskCommentDrawer:{type:Boolean,default:!1}},data:()=>({commentId:"",showNewCommentEditor:!1,test:!1,MESSAGE_MAX_LENGTH:1250}),computed:{isEditorActive(){return!this.comments.length}},mounted(){this.$root.$on("displayTaskComment",((t,e)=>{this.openDrawer(),this.commentId=t,this.showNewCommentEditor=e,this.openEditorToBottom(t)})),this.$root.$on("hideTaskComment",(()=>{this.closeDrawer()}))},methods:{addTaskComment(){let t=this.$refs.commentEditor.getMessage();t=this.urlVerify(t),this.$taskDrawerApi.addTaskComments(this.task.id,t).then((t=>{this.comments.push(t)})).then((()=>{this.$root.$emit("update-task-comments",this.comments.length,this.task.id)}))},closeDrawer(){this.$refs.taskCommentDrawer.close(),document.dispatchEvent(new CustomEvent("Task-comments-drawer-closed"))},openDrawer(){this.$refs.taskCommentDrawer.open()},urlVerify(t){return this.$taskDrawerApi.urlVerify(t)},openEditorToBottom(){this.comments.length>0&&this.$root.$emit("showNewCommentEditor"),window.setTimeout((()=>{const t=document.querySelector("#taskCommentDrawer .drawerContent");t.scrollTo({top:t.scrollHeight,behavior:"smooth",block:"start"})}),200)}}},s,[],!1,null,null,null).exports;var a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"comment-"+t.comment.comment.id}},[e("task-comment-item",{attrs:{comment:t.comment,comments:t.comments,"can-delete":t.canDelete},on:{openConfirmDeleteDialog:function(e){return t.confirmCommentDelete(e)},openCommentEditor:function(e){return t.commentActions(e)}}}),t._v(" "),e("div",{staticClass:"editorContent commentEditorContainer",class:t.comment.comment.id===t.lastComment&&t.newCommentEditor&&"newCommentEditor"},[e("task-comment-editor",{ref:"commentEditor",staticClass:"subComment subCommentEditor",attrs:{"max-length":t.MESSAGE_MAX_LENGTH,placeholder:t.$t("task.placeholder").replace("{0}",t.MESSAGE_MAX_LENGTH),task:t.task,"show-comment-editor":t.comment.comment.id===t.lastComment,"last-comment":t.lastComment,id:"commentContent-"+t.comment.comment.id,"comment-id":t.comment.comment.id},on:{addNewComment:function(e){return t.addTaskComment(e)}}})],1),t._v(" "),e("exo-confirm-dialog",{ref:"CancelSavingCommentDialog",attrs:{message:t.$t("popup.msg.deleteComment"),title:t.$t("popup.confirmation"),"ok-label":t.$t("popup.delete"),"cancel-label":t.$t("popup.cancel"),persistent:""},on:{ok:function(e){return t.removeTaskComment()},"dialog-opened":function(e){return t.$emit("confirmDialogOpened")},"dialog-closed":function(e){return t.$emit("confirmDialogClosed")}}})],1)};a._withStripped=!0;const m=r({props:{comment:{type:Object,default:()=>({})},comments:{type:Object,default:()=>({})},task:{type:Object,default:()=>null},lastComment:{type:String,default:""},showNewCommentEditor:{type:Boolean,default:!1}},data:()=>({MESSAGE_MAX_LENGTH:1250,lang:eXo.env.portal.language,commentId:"",commentToDelete:"",dateTimeFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}}),mounted(){this.$root.$on("showNewCommentEditor",(()=>{this.lastComment=this.comments[this.comments.length-1].comment.id,this.showNewCommentEditor=!0,this.$root.$emit("newCommentEditor",this.lastComment)}))},computed:{newCommentEditor(){return this.showNewCommentEditor}},methods:{addTaskComment(t){let e=this.$refs.commentEditor.getMessage();e=this.urlVerify(e),this.newCommentEditor?this.$taskDrawerApi.addTaskComments(this.task.id,e).then((t=>{this.comments.push(t)})).then((()=>{this.$root.$emit("update-task-comments",this.comments.length,this.task.id)})):this.$taskDrawerApi.addTaskSubComment(this.task.id,t,e).then((t=>{this.comment.subComments=this.comment.subComments||[],this.comment.subComments.push(t)}))},removeTaskComment(){this.$taskDrawerApi.removeTaskComment(this.commentToDelete).then((()=>{this.comments.forEach(((t,e)=>{t===this.comment&&(this.comment.comment.id===this.commentToDelete?this.comments.splice(e,1):t.subComments.forEach(((t,e)=>{t.comment.id===this.commentToDelete&&this.comment.subComments.splice(e,1)})))}))})),this.$emit("confirmDialogClosed")},displayCommentDate(t){return t&&this.$dateUtil.formatDateObjectToDisplay(new Date(t),this.dateTimeFormat,this.lang)||""},urlVerify(t){return this.$taskDrawerApi.urlVerify(t)},confirmCommentDelete(t){this.commentToDelete=t,this.$refs.CancelSavingCommentDialog.open()},commentActions(t){this.showNewCommentEditor=!1,this.$nextTick().then((()=>this.$root.$emit("showEditor",t)))}}},a,[],!1,null,null,null).exports;var c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment d-flex align-start",class:t.editorReady?"activeEditor":"inactiveEditor"},[e("exo-user-avatar",{attrs:{"profile-id":t.currentUserName,size:30,url:null,"extra-class":"me-2",avatar:""}}),t._v(" "),e("div",{staticClass:"editorContainer"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputVal,expression:"inputVal"}],ref:`editor-${t.id}`,staticClass:"textarea",attrs:{id:t.id,placeholder:t.placeholder,cols:"30",rows:"10",autofocus:""},domProps:{value:t.inputVal},on:{input:function(e){e.target.composing||(t.inputVal=e.target.value)}}}),t._v(" "),e("div",{staticClass:"activityCharsCount",class:t.charsCount>t.maxLength?"tooManyChars":""},[t._v("\n      "+t._s(t.charsCount)+t._s(t.maxLength>-1?" / "+t.maxLength:"")+"\n      "),e("i",{staticClass:"uiIconMessageLength"})]),t._v(" "),e("v-btn",{staticClass:"btn btn-primary ignore-vuetify-classes btnStyle mt-1 mb-2 commentBtn",attrs:{disabled:t.postDisabled,depressed:"",small:"",type:"button"},on:{click:function(e){return t.addNewComment()}}},[t._v("\n      "+t._s(t.$t("comment.label.comment"))+"\n    ")])],1)],1)};c._withStripped=!0;const l=r({props:{value:{type:String,default:""},task:{type:Object,default:null},placeholder:{type:String,default:""},maxLength:{type:Number,default:-1},id:{type:String,default:""},editorReady:{type:Boolean,default:!1},showCommentEditor:{type:Boolean,default:!1},lastComment:{type:String,default:""},commentId:{type:String,default:""}},data(){return{inputVal:this.value,charsCount:0,disabledComment:"",MESSAGE_MAX_LENGTH:1250,currentUserName:eXo.env.portal.userName,currentCommentId:""}},computed:{postDisabled(){if(this.disabledComment)return!0;if(null!==this.inputVal&&""!==this.inputVal){let t=this.inputVal?this.inputVal.replace(/<[^>]*>/g,"").replace(/&nbsp;/g,"").trim():"";const e=document.createElement("div");return e.innerHTML=t,t=e.textContent||e.innerText||"",t.length>this.MESSAGE_MAX_LENGTH}return!0}},watch:{inputVal(t){this.$emit("input",t),this.disabledComment=""===t},editorReady(t){!0===t?this.initCKEditor():CKEDITOR.instances[this.id]&&CKEDITOR.instances[this.id].destroy(!0)}},created(){this.$root.$on("showEditor",(t=>{this.$nextTick().then((()=>{this.showEditor(t)}))}))},mounted(){this.showCommentEditor&&(this.editorReady=!0),this.$root.$on("newCommentEditor",(t=>{this.editorReady=!1,window.setTimeout((()=>{this.showCommentEditor=`commentContent-${t}`===this.id,this.showCommentEditor&&(this.editorReady=!0)}),100)}));const t=this;$("body").suggester("addProvider","task:people",(function(e,n){const o=this,s=t.task.status?t.task.status.project.id:null;t.$taskDrawerApi.findUsersToMention(s,e).then((t=>{const e=[];for(let n=0;n<t.length;n++){const o=t[n],s={uid:o.id.substr(1),name:o.name,avatar:o.avatar};e.push(s)}n.call(o,e)}))}))},methods:{initCKEditor(){let t="suggester,widget,embedsemantic";const e=$(window).width();e>$(window).height()&&e<768&&(t="selectImage"),CKEDITOR.basePath="/commons-extension/ckeditor/";const n=this;$(this.$refs[`editor-${this.id}`]).ckeditor({customConfig:"/commons-extension/ckeditorCustom/config.js",extraPlugins:t,removePlugins:"confirmBeforeReload,maximize,resize",autoGrow_onStartup:!0,on:{instanceReady:function(){n.setFocus()},change:function(t){const e=t.editor.getData();n.inputVal=e;let o=e?e.replace(/<[^>]*>/g,"").replace(/&nbsp;/g,"").trim():"";const s=document.createElement("div");s.innerHTML=o,o=s.textContent||s.innerText||"",n.charsCount=o.length},destroy:function(){n.inputVal="",n.charsCount=0,n.editorReady=!1,n.showCommentEditor=!1}},suggester:{renderMenuItem:'<li data-value="${uid}"><div class="avatarSmall" style="display: inline-block;"><img src="${avatar}"></div>${name} (${uid})</li>',renderItem:'<span class="exo-mention">${name}<a href="#" class="remove"><i class="uiIconClose uiIconLightGray"></i></a></span>',sourceProviders:["task:people"]}})},getMessage(){const t=CKEDITOR.instances[this.id].getData();return t?t.trim():""},setFocus(){CKEDITOR.instances[this.id].focus()},destroyEditor(){CKEDITOR.instances[this.id].destroy()},showEditor(t){this.currentCommentId=t,this.editorReady=`commentContent-${t}`===this.id},addNewComment(){this.$emit("addNewComment",this.commentId),this.destroyEditor()}}},c,[],!1,null,null,null).exports;var d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"commentItem",attrs:{id:`commentItem-${t.comment.comment.id}`}},[e("div",{staticClass:"commentWrapper",on:{mouseover:function(e){t.hover=!0},mouseleave:function(e){t.hover=!1}}},[e("div",{staticClass:"commentHeader d-flex"},[e("exo-user-avatar",{attrs:{"profile-id":t.comment.author.username,"extra-class":"position-relative overflow-hidden",size:30,"bold-title":"","link-style":"",popover:""}}),t._v(" "),e("div",{staticClass:"commentContent ps-3 d-flex align-center flex-grow-0 flex-shrink-0"},[e("span",{staticClass:"dateTime caption font-italic d-block",attrs:{title:t.displayCommentDate(t.comment.comment.createdTime.time)}},[t._v(t._s(t.relativeTime))])]),t._v(" "),e("div",{staticClass:"removeCommentBtn position-relative"},[e("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:t.showDeleteButtom,expression:"showDeleteButtom"}],staticClass:"deleteComment position-absolute white",attrs:{title:t.$t("label.remove"),size:32,icon:"",small:""},on:{click:function(e){return t.$emit("openConfirmDeleteDialog",t.comment.comment.id)}}},t.on),[e("i",{staticClass:"uiIconTrashMini uiIconLightGray"})])],1)],1),t._v(" "),e("div",{staticClass:"commentBody ms-10 mt-1"},[e("div",{staticClass:"taskContentComment",domProps:{innerHTML:t._s(t.comment.formattedComment)}}),t._v(" "),e("v-btn",{attrs:{id:"reply_btn",depressed:"",text:"",small:"",color:"primary"},on:{click:t.replyComment}},[t._v("\n        "+t._s(t.$t("comment.message.Reply"))+"\n      ")])],1)]),t._v(" "),t.comment&&t.comment.subComments?e("div",{staticClass:"py-0 TaskSubComments"},t._l(t.comment.subComments,(function(n,o){return e("div",{key:o,staticClass:"TaskSubCommentItem pe-0 pb-2"},[e("task-comment-item",{attrs:{comment:n,comments:t.comment.subComments,"avatar-size":30},on:{openCommentEditor:function(e){return t.$emit("openCommentEditor",t.comment.comment.id)},openConfirmDeleteDialog:function(e){return t.$emit("openConfirmDeleteDialog",n.comment.id,!0)}}})],1)})),0):t._e()])};d._withStripped=!0;const u=r({props:{comment:{type:Object,default:()=>({})},replyLastComment:{type:Boolean,default:!1},showOnly:{type:Boolean,default:!0},lastCommentId:{type:String,default:""},comments:{type:Object,default:()=>({})}},data:()=>({hover:!1,lang:eXo.env.portal.language,dateTimeFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}}),computed:{showDeleteButtom(){return this.hover&&!this.replyLastComment&&eXo.env.portal.userName===this.comment.author.username},relativeTime(){return this.getRelativeTime(this.comment.comment.createdTime.time)}},methods:{displayCommentDate(t){return t&&this.$dateUtil.formatDateObjectToDisplay(new Date(t),this.dateTimeFormat,this.lang)||""},getRelativeTime(t){const e=6e4,n=36e5,o=864e5,s=(new Date).getTime()-t;return s<e?this.$t("task.timeConvert.Less_Than_A_Minute"):s===e?this.$t("task.timeConvert.About_A_Minute"):s<n?this.$t("task.timeConvert.About_?_Minutes").replace("{0}",Math.round(s/e)):s===n?this.$t("task.timeConvert.About_An_Hour"):s<o?this.$t("task.timeConvert.About_?_Hours").replace("{0}",Math.round(s/n)):s===o?this.$t("task.timeConvert.About_A_Day"):s<1728e5?this.$t("task.timeConvert.About_?_Days").replace("{0}",Math.round(s/o)):this.displayCommentDate(this.comment.comment.createdTime.time)},replyComment(){this.replyLastComment?this.$root.$emit("displayTaskComment",this.lastCommentId):this.$emit("openCommentEditor",this.comment.comment.id)}}},d,[],!1,null,null,null).exports;var h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"commentItem",attrs:{id:t.id}},[e("div",{staticClass:"commentHeader d-flex"},[e("exo-user-avatar",{key:t.comment.comment.id,attrs:{"profile-id":t.comment.author.username,size:30,"extra-class":"position-relative overflow-hidden","bold-title":"","link-style":"",popover:""}}),t._v(" "),e("div",{staticClass:"commentContent ps-3 d-flex align-center flex-grow-0 flex-shrink-0"},[e("span",{staticClass:"dateTime caption font-italic d-block text-sub-title",attrs:{title:t.displayCommentDate(t.comment.comment.createdTime.time)}},[t._v(t._s(t.relativeTime))])])],1),t._v(" "),e("div",{staticClass:"commentBody ms-10 mt-1"},[e("div",{staticClass:"taskContentComment",domProps:{innerHTML:t._s(t.comment.formattedComment)}}),t._v(" "),e("v-btn",{attrs:{id:"reply_btn",depressed:"",text:"",small:"",color:"primary"},on:{click:t.openCommentDrawer}},[t._v("\n      "+t._s(t.$t("comment.message.Reply"))+"\n    ")])],1),t._v(" "),t.comment.subComments&&t.comment.subComments.length?e("div",{staticClass:"py-0 TaskSubComments"},t._l(t.comment.subComments,(function(n,o){return e("div",{key:o,staticClass:"TaskSubCommentItem pe-0 pb-2"},[e("task-comment-item",{attrs:{comment:n,comments:t.comment.subComments,"avatar-size":30,"reply-last-comment":!0,"last-comment-id":t.comment.comment.id}})],1)})),0):t._e()])};h._withStripped=!0;const p=r({props:{task:{type:Boolean,default:!1},comment:{type:Object,default:()=>({})}},data:()=>({lang:eXo.env.portal.language,dateTimeFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}}),computed:{relativeTime(){return this.getRelativeTime(this.comment.comment.createdTime.time)},id(){return`comment-${this.comment.comment.id}`}},methods:{getRelativeTime(t){const e=6e4,n=36e5,o=864e5,s=(new Date).getTime()-t;return s<e?this.$t("task.timeConvert.Less_Than_A_Minute"):s===e?this.$t("task.timeConvert.About_A_Minute"):s<n?this.$t("task.timeConvert.About_?_Minutes").replace("{0}",Math.round(s/e)):s===n?this.$t("task.timeConvert.About_An_Hour"):s<o?this.$t("task.timeConvert.About_?_Hours").replace("{0}",Math.round(s/n)):s===o?this.$t("task.timeConvert.About_A_Day"):s<1728e5?this.$t("task.timeConvert.About_?_Days").replace("{0}",Math.round(s/o)):this.displayCommentDate(this.comment.comment.createdTime.time)},displayCommentDate(t){return t&&this.$dateUtil.formatDateObjectToDisplay(new Date(t),this.dateTimeFormat,this.lang)||""},openCommentDrawer(){this.$root.$emit("displayTaskComment",this.comment.comment.id)}}},h,[],!1,null,null,null).exports;var f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"taskComments"},[t.comments&&t.comments.length?e("div",{staticClass:"taskCommentNumber d-flex pb-3"},[e("span",{staticClass:"ViewAllCommentLabel",on:{click:function(e){return t.$root.$emit("displayTaskComment")}}},[t._v(t._s(t.$t("comment.message.viewAllComment"))+" ("+t._s(t.comments.length)+")")]),t._v(" "),e("div",{staticClass:"addCommentBtn ps-3",attrs:{title:t.$t("comment.message.addYourComment")},on:{click:t.openCommentDrawer}},[e("i",{staticClass:"uiIcon uiIconTaskAddComment"})])]):e("div",{staticClass:"taskCommentEmpty align-center pt-6 pb-3"},[e("i",{staticClass:"uiIcon uiIconComment"}),t._v(" "),e("span",{staticClass:"noCommentLabel"},[t._v(t._s(t.$t("comment.message.noComment")))]),t._v(" "),e("span",{staticClass:"ViewAllCommentText",on:{click:function(e){return t.$root.$emit("displayTaskComment")}}},[t._v(t._s(t.$t("comment.message.addYourComment")))])]),t._v(" "),t.comments&&t.comments.length?e("div",{staticClass:"pe-0 ps-0 TaskCommentItem"},[e("task-last-comment",{attrs:{task:t.task,comment:t.comments[t.comments.length-1]}})],1):t._e()])};f._withStripped=!0;const C=r({props:{comments:{type:Array,default:()=>[]},task:{type:Object,default:null}},methods:{openCommentDrawer(){this.$root.$emit("displayTaskComment",this.comments[this.comments.length-1].comment.id,!0)}}},f,[],!1,null,null,null).exports,w=(eXo.env.portal,eXo.env.portal.context||""),v=(eXo.env.portal.portalName,eXo.env.portal.context,eXo.env.portal.rest);function g(t,e,n,o){return document.dispatchEvent(new CustomEvent("displayTopBarLoading")),fetch(`${w}/${v}/tasks?status=${t||""}&q=${e||""}&offset=${n||0}&limit=${o||0}&returnDetails=true`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Response code indicates a server error",t)})).finally((()=>document.dispatchEvent(new CustomEvent("hideTopBarLoading"))))}function k(t,e,n,o,s){return document.dispatchEvent(new CustomEvent("displayTopBarLoading")),fetch(`${w}/${v}/tasks/filter?projectId=${s||t.projectId||-2}&query=${t.query||""}&dueDate=${t.dueDate||""}&priority=${t.priority||""}&statusId=${t.statusId||""}&showCompletedTasks=${t.showCompletedTasks||""}&assignee=${t.assignee||""}&watcher=${t.watcher||""}&coworker=${t.coworker||""}&groupBy=${e||t.groupBy||""}&orderBy=${n||t.orderBy||""}&dueCategory=${t.dueCategory||""}&filterLabelIds=${o||t.filterLabelIds||""}&offset=${t.offset||0}&limit=${t.limit||0}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Response code indicates a server error",t)})).finally((()=>document.dispatchEvent(new CustomEvent("hideTopBarLoading"))))}function E(t){return fetch(`${w}/${v}/tasks/labels/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Response code indicates a server error",t)}))}function y(t){return fetch(`${w}/${v}/tasks/labels/project/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Response code indicates a server error",t)}))}function T(t){return fetch(`${w}/${v}/tasks/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Response code indicates a server error",t)}))}function b(t){return fetch(`${w}/${v}/projects/projects/statuses/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Response code indicates a server error",t)}))}function _(t){return fetch(`${w}/${v}/tasks/project/${t}?returnDetails=true`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Response code indicates a server error",t)}))}function D(t){return document.dispatchEvent(new CustomEvent("displayTopBarLoading")),fetch(`${w}/${v}/tasks/updateCompleted/${t.id}?&isCompleted=${t.isCompleted}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PUT",body:JSON.stringify(t)}).then((t=>t.json())).finally((()=>document.dispatchEvent(new CustomEvent("hideTopBarLoading"))))}function j(t){return fetch(`/portal/rest/v1/social/users/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting user informations")}))}function x(t,e){return t?(document.dispatchEvent(new CustomEvent("displayTopBarLoading")),fetch(`/portal/rest/tasks/${t}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((t=>t&&t.ok?t.json():t.text().then((t=>{throw new Error(t)})))).finally((()=>document.dispatchEvent(new CustomEvent("hideTopBarLoading"))))):Promise.resolve()}function S(t){return document.dispatchEvent(new CustomEvent("displayTopBarLoading")),fetch("/portal/rest/tasks",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",credentials:"include",body:JSON.stringify(t)}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when adding task")})).finally((()=>document.dispatchEvent(new CustomEvent("hideTopBarLoading"))))}function A(){return fetch("/portal/rest/tasks/labels",{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting my all labels")}))}function I(t){return fetch(`/portal/rest/tasks/labels/project/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting my all labels")}))}function L(t){return fetch(`/portal/rest/tasks/labels/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting task labels")}))}function M(t,e){return fetch(`/portal/rest/tasks/labels/${t}`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",credentials:"include",body:JSON.stringify(e)}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when adding task to label")}))}function O(t,e){return fetch(`/portal/rest/tasks/labels/${t}/${e}`,{credentials:"include",method:"DELETE"}).then((t=>{if(!t||!t.ok)throw new Error("Error when deleting task from label")}))}function B(t){return fetch("/portal/rest/tasks/labels",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",credentials:"include",body:JSON.stringify(t)}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when adding task to label")}))}function N(t){return fetch(`/portal/rest/tasks/labels/${t.id}`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",credentials:"include",body:JSON.stringify(t)}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when updateing label")}))}function G(t){return fetch(`/portal/rest/tasks/labels/${t}`,{credentials:"include",method:"DELETE"}).then((t=>{if(!t||!t.ok)throw new Error("Error when deleting label")}))}function R(){return fetch("/portal/rest/projects/projects",{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting projects")}))}function P(t){return fetch(`/portal/rest/projects/projects/status/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting default status")}))}function V(t){return fetch(`/portal/rest/projects/projects/statuses/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting project statuses")}))}function X(){return fetch("/portal/rest/v1/social/users",{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting users")}))}function H(t){return fetch(`/portal/rest/tasks/logs/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting task logs")}))}function U(t){return fetch(`/portal/rest/tasks/comments/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting task comments")}))}function z(t,e){return fetch(`/portal/rest/tasks/comments/${t}`,{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:e}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when adding task comment")}))}function F(t,e,n){return fetch(`/portal/rest/tasks/comments/${e}/${t}`,{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:n}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when adding task sub comment")}))}function K(t){return fetch(`/portal/rest/tasks/comments/${t}`,{method:"DELETE",credentials:"include"}).then((t=>{if(!t||!t.ok)throw new Error("Error when removing task comment")}))}function J(t,e){return fetch(t?`/portal/rest/projects/projectParticipants/${t}/${e}`:`/portal/rest/tasks/usersToMention/${e}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting users to mention")}))}function q(t,e){return fetch(`/portal/rest/tasks/users/${t}/${e}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting suggested users")}))}function Y(t){return fetch(`/portal/rest/v1/social/users/${t}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting user")}))}function Z(t){return t.replace(/((?:href|src)=")?((((https?|ftp|file):\/\/)|www\.)[-a-zA-Z0-9+&@#/%?=~_|!:,.;]*[-a-zA-Z0-9+&@#/%=~_|])/gi,(function(t,e){if(e)return t;let n=t;return 0===n.indexOf("www.")&&(n=`//${n}`),`<a href="${n}" target="_blank">${t}</a>`}))}function W(t){return fetch(`${w}/${v}/tasks/clone/${t}`,{credentials:"include",method:"POST"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when cloning task")}))}eXo.env.portal.containerName,eXo.env.portal.language;const Q={"task-comment-editor":l,"task-comments":m,"task-comments-drawer":i,"task-comment-item":u,"task-last-comment":p,"task-view-all-comments":C};for(const t in Q)Vue.component(t,Q[t]);if(Vue.prototype.$tasksService||window.Object.defineProperty(Vue.prototype,"$tasksService",{value:n}),Vue.prototype.$taskDrawerApi||window.Object.defineProperty(Vue.prototype,"$taskDrawerApi",{value:o}),extensionRegistry){const t=extensionRegistry.loadComponents("TaskCommentsDrawer");t&&t.length>0&&t.forEach((t=>{Vue.component(t.componentName,t.componentOptions)}))}return Vue.use(Vuetify),e})()));