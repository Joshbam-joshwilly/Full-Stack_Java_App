define((()=>(()=>{"use strict";var t={d:(e,r)=>{for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{USER_TIMEZONE_ID:()=>n,fetchSearchResult:()=>l,formatSearchResult:()=>a});var r=function(){var t=this,e=t._self._c;return e("v-card",{staticClass:"agendaSearchCard d-flex flex-column border-radius box-shadow",attrs:{flat:"","min-height":"227"}},[t.ownerProfile?e("v-card-text",{staticClass:"px-2 pt-2 pb-0"},[e("a",{staticClass:"flex-nowrap flex-shrink-0 d-flex spaceAvatar"},[e("v-avatar",{staticClass:"pull-left my-auto",attrs:{size:t.spaceAvatarSize,tile:""}},[e("v-img",{staticClass:"mx-auto",attrs:{src:t.eventOwnerAvatarUrl,height:t.spaceAvatarSize,width:t.spaceAvatarSize,"max-height":t.spaceAvatarSize,"max-width":t.spaceAvatarSize}})],1),t._v(" "),t.eventTitle?e("div",{staticClass:"d-flex flex-column text-truncate pull-left ms-2"},[t.eventTitle?e("a",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:t.eventTitle,expression:"eventTitle"}],staticClass:"pt-2 text-left text-truncate",attrs:{href:t.eventUrl,title:t.eventTitleText}}):t._e(),t._v(" "),t.eventOwnerDisplayName?e("a",{staticClass:"text-sub-title my-0",attrs:{href:t.calendarOwnerLink}},[t._t("subTitle",(function(){return[t._v("\n            "+t._s(t.eventOwnerDisplayName)+"\n          ")]}))],2):t._e()]):t._e()],1)]):t._e(),t._v(" "),e("div",{staticClass:"mx-auto d-flex flex-grow-1 px-3 py-0"},[e("div",{ref:"excerptNode",staticClass:"text-wrap text-break caption flex-grow-1",attrs:{title:t.excerptText}})]),t._v(" "),e("v-list",{staticClass:"light-grey-background flex-grow-0 border-top-color no-border-radius pa-0"},[t.isConfirmedEvent?e("v-list-item",{staticClass:"px-0 pt-1 pb-2",attrs:{"two-line":""}},[e("v-list-item-icon",{staticClass:"mx-0 my-auto"},[e("span",{staticClass:"uiIconPLFEventTask tertiary--text ps-1 pe-2 display-1"})]),t._v(" "),e("v-list-item-content",[e("v-list-item-title",[e("date-format",{staticClass:"me-1",attrs:{value:t.eventStartDate,format:t.fullDateFormat}}),t._v(" "),e("date-format",{staticClass:"me-1",attrs:{value:t.eventStartDate,format:t.dateTimeFormat}})],1)],1)],1):t.isTentativeEvent?e("v-list-item",{staticClass:"px-2 pt-1 pb-2",attrs:{"two-line":""}},[e("v-list-item-icon",{staticClass:"mx-0 my-auto"},[e("span",{staticClass:"uiIconStatistics uiIcon32x32 uiIconPLFFont tertiary--text ps-1 pe-2"})]),t._v(" "),e("v-list-item-content",{staticClass:"pb-0"},[e("v-list-item-title",[t._v("\n          "+t._s(t.voteLabel)+"\n        ")])],1)],1):t._e()],1)],1)};r._withStripped=!0;var i=function(t,e,r,i,s,n,a,l){var o,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=[],c._compiled=!0),o)if(c.functional){c._injectStyles=o;var h=c.render;c.render=function(t,e){return o.call(e),h(t,e)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,o):[o]}return{exports:t,options:c}}({props:{result:{type:Object,default:null}},data:()=>({lineHeight:22,spaceAvatarSize:37,maxEllipsisHeight:92,currentUserId:eXo.env.portal.userIdentityId,fullDateFormat:{year:"numeric",month:"long",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{labels(){return{CancelRequest:this.$t("profile.CancelRequest"),Confirm:this.$t("profile.Confirm"),Connect:this.$t("profile.Connect"),Ignore:this.$t("profile.Ignore"),RemoveConnection:this.$t("profile.RemoveConnection"),StatusTitle:this.$t("profile.StatusTitle"),join:this.$t("space.join"),leave:this.$t("space.leave"),members:this.$t("space.members")}},eventUrl(){return this.result&&this.result.id&&`${eXo.env.portal.context}/${eXo.env.portal.portalName}/agenda?eventId=${this.result.id}`},eventDescription(){return this.result&&this.result.description},excerpts(){return this.result&&this.result.excerpts},excerptHtml(){return this.excerpts&&this.excerpts.concat("\r\n...")},excerptText(){return this.excerpts.length?$("<div />").html(this.excerptHtml).text():this.eventDescription},eventStartDate(){return this.result&&this.result.start},eventTitle(){return this.result&&this.result.summary||""},eventTitleText(){return $("<div />").html(this.eventTitle).text()},owner(){return this.result&&this.result.calendar&&this.result.calendar.owner},ownerProfile(){return this.owner&&(this.owner.profile||this.owner.space)},calendarOwnerLink(){if(this.owner){if("organization"===this.owner.providerId)return`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.owner.remoteId}`;if("space"===this.owner.providerId)return`${eXo.env.portal.context}/g/:spaces:${this.owner.remoteId}/`}return""},eventOwnerDisplayName(){return this.ownerProfile&&this.ownerProfile.displayName},eventOwnerAvatarUrl(){return this.ownerProfile&&this.ownerProfile.avatarUrl},isConfirmedEvent(){return this.result&&("CONFIRMED"===this.result.status||!this.result.status)},isTentativeEvent(){return this.result&&"TENTATIVE"===this.result.status},currentAttendee(){return this.result.attendees.find((t=>t.identity.id===this.currentUserId))},hasVoted(){return this.currentAttendee&&"TENTATIVE"===this.currentAttendee.response},voteLabel(){return this.currentAttendee?this.hasVoted&&this.$t("agenda.datePollVoted")||this.$t("agenda.datePollVoteNeeded"):this.$t("agenda.datePoll")}},mounted(){this.computeEllipsis()},methods:{computeEllipsis(){if(!this.excerptHtml||0===this.excerptHtml.length)return;const t=this.$refs.excerptNode;if(t&&(t.innerHTML=this.excerpts.length?this.excerptHtml:this.eventDescription,t.innerHTML.length)){const e=50;let r=t.getBoundingClientRect().height||this.lineHeight,i=0;if(r>this.maxEllipsisHeight){let s=r,n=3;for(;r>this.maxEllipsisHeight&&(s>0||n);)t.innerHTML=this.deleteLastChars(t.innerHTML.replace(/&[a-z]*;/,""),e),i=r,r=t.getBoundingClientRect().height||this.lineHeight,s=i-r,0===s&&r>this.maxEllipsisHeight&&n--;t.innerHTML=this.deleteLastChars(t.innerHTML,4),t.innerHTML=`${t.innerHTML}...`}}},deleteLastChars(t,e){">"===t.slice(-1)&&(t=t.replace(/<[a-zA-Z 0-9 "'=]*><\/[a-zA-Z 0-9]*>$/g,"")),e=e||1;let r="";return">"===(t=t.replace(/<br>(\.*)$/g,"")).slice(-1)?(r=(t=t.replace(/(<br>)*$/g,"")).replace(new RegExp(`([^>]{${e}})(</)([a-zA-Z 0-9]*)(>)$`),"$2$3"),r=$("<div />").html(r).html().replace(/&[a-z]*;/,""),r.length===t.length&&(r=t.replace(new RegExp("([^>]*)(</)([a-zA-Z 0-9]*)(>)$"),"$2$3"))):r=t.substring(0,t.trimRight().length-e),r}}},r);const s={"agenda-search-card":i.exports};for(const t in s)Vue.component(t,s[t]);if(extensionRegistry){const t=extensionRegistry.loadComponents("agendaSearchCard");t&&t.length>0&&t.forEach((t=>{Vue.component(t.componentName,t.componentOptions)}))}const n=(new window.Intl.DateTimeFormat).resolvedOptions().timeZone;function a(t){return t||[]}function l(t,e){return t=`${t}&timeZoneId=${n}`,fetch(t,e)}return e})()));