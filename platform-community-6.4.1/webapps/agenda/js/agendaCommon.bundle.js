define((()=>(()=>{"use strict";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t);var n={};e.r(n),e.d(n,{MINIMUM_TIME_INTERVAL:()=>Qt,MINIMUM_TIME_INTERVAL_MS:()=>en,TIMEZONES:()=>Kt,USER_TIMEZONE_ID:()=>Zt,addOpacity:()=>Tn,areDatesOnSameDay:()=>Dn,areSameObjects:()=>En,convertDates:()=>vn,convertVuetifyRangeToPeriod:()=>rn,generateCalendarTitle:()=>un,getDayNameFromDate:()=>hn,getDayNameFromDayAbbreviation:()=>mn,getDayNumberFromDate:()=>gn,getDayOfYear:()=>Cn,getMonthFromDate:()=>fn,getMonthNameFromMonthNumber:()=>yn,getMonthNumberFromDate:()=>$n,getSameTime:()=>wn,getTimeZoneNameFromTimeZoneId:()=>sn,getTimeZones:()=>an,getUserTimezone:()=>nn,getWeekNumber:()=>on,getWeekSequenceFromDay:()=>bn,initEventForm:()=>tn,isShortEvent:()=>xn,pad:()=>_n,roundTime:()=>In,toDate:()=>dn,toDateTime:()=>An,toRFC3339:()=>cn,toVuetifyDate:()=>ln});var a={};e.r(a),e.d(a,{checkWebConferencingEnabled:()=>Sn,deleteEventWebConferencing:()=>On,getAllProviders:()=>kn,saveEventWebConferencing:()=>Pn});var i={};e.r(i),e.d(i,{countDatePolls:()=>na,countPendingEvents:()=>ia,createEvent:()=>jn,deleteEvent:()=>Jn,dismissEventDate:()=>Qn,getDatePolls:()=>ea,getDatePollsByDates:()=>ta,getEventById:()=>Mn,getEventExceptionalOccurrences:()=>Ln,getEventOccurrence:()=>Vn,getEvents:()=>Fn,getPendingEvents:()=>aa,getUserReminderSettings:()=>qn,saveEventReminders:()=>Gn,saveEventVotes:()=>Zn,saveUserReminderSettings:()=>Yn,selectEventDate:()=>Kn,sendEventResponse:()=>Xn,undoDeleteEvent:()=>Hn,updateEvent:()=>Bn,updateEventFields:()=>zn,voteEventDate:()=>Wn});var s={};e.r(s),e.d(s,{getCalendars:()=>oa,saveCalendar:()=>la});var r={};e.r(r),e.d(r,{getUserSettings:()=>fa,resetUserConnector:()=>ga,saveEnabledWebConferencingProvider:()=>ha,saveRemoteProviderApiKey:()=>va,saveRemoteProviderSecretKey:()=>ua,saveRemoteProviderStatus:()=>da,saveTimeZone:()=>pa,saveUserConnector:()=>ma,saveUserSettings:()=>ca});var o={};e.r(o),e.d(o,{computeVoters:()=>ya});var l={};e.r(l),e.d(l,{pushEventToConnector:()=>Ca,removeEventFromConnector:()=>$a});var c={};e.r(c),e.d(c,{initCometd:()=>Da});var d=function(){var e=this,t=e._self._c;return t("v-toolbar",{attrs:{color:"white",flat:"",dense:""}},[t("v-row",[t("v-col",{staticClass:"align-start my-auto",attrs:{cols:"2",sm:"4"}},[t("agenda-create-event-button",{staticClass:"agenda-toolbar-left me-2",attrs:{"current-space":e.currentSpace,"can-create-event":e.canCreateEvent}})],1),e._v(" "),t("v-col",{staticClass:"d-flex flex-row align-center justify-start flex-nowrap",attrs:{cols:"8",sm:"4",align:"center"}},[t("agenda-switch-view",{attrs:{"calendar-type":e.calendarType}})],1),e._v(" "),t("v-col",{staticClass:"d-flex flex-row justify-end my-auto flex-nowrap",attrs:{cols:"2",sm:"4"}},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.eventType,expression:"eventType"}],staticClass:"width-auto my-auto ms-4 subtitle-1 ignore-vuetify-classes d-none d-sm-inline",on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.eventType=t.target.multiple?n:n[0]},function(t){return e.$root.$emit("agenda-event-type-changed",e.eventType)}]}},[t("option",{attrs:{value:"myEvents"}},[e._v(e._s(e.$t("agenda.myEvent")))]),e._v(" "),t("option",{attrs:{value:"declinedEvent"}},[e._v(e._s(e.$t("agenda.declinedEvent")))]),e._v(" "),t("option",{attrs:{value:"allEvents"}},[e._v(e._s(e.$t("agenda.allEvent")))])]),e._v(" "),t("agenda-calendar-filter-button",{staticClass:"ms-2",attrs:{"current-space":e.currentSpace,"owner-ids":e.ownerIds}}),e._v(" "),t("v-btn",{staticClass:"d-none d-sm-inline text-header-title",attrs:{icon:"",title:e.$t("agenda.settings.drawer.title")},on:{click:function(t){return e.$root.$emit("user-settings-agenda-drawer-open")}}},[t("v-icon",[e._v("mdi-cog")])],1)],1)],1)],1)};function v(e,t,n,a,i,s,r,o){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),a&&(c.functional=!0),s&&(c._scopeId="data-v-"+s),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},c._ssrRegister=l):i&&(l=o?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var v=c.beforeCreate;c.beforeCreate=v?[].concat(v,l):[l]}return{exports:e,options:c}}d._withStripped=!0;const u=v({props:{calendarType:{type:String,default:null},eventType:{type:String,default:null},currentSpace:{type:Object,default:null},currentCalendar:{type:Object,default:()=>null},ownerIds:{type:Array,default:null}},computed:{canCreateEvent(){return!this.currentCalendar||!this.currentCalendar.acl||this.currentCalendar.acl.canCreate}}},d,[],!1,null,null,null).exports;var h=function(){var e=this,t=e._self._c;return t("v-flex",{staticClass:"d-flex flex-column agenda-body"},[t("agenda-toolbar",{attrs:{"period-title":e.periodTitle}}),e._v(" "),t("agenda-calendar",{staticClass:"flex-grow-1",attrs:{events:e.events,"current-calendar":e.currentCalendar,"calendar-type":e.calendarType,weekdays:e.weekdays,"working-time":e.workingTime}})],1)};h._withStripped=!0;const p=v({props:{periodTitle:{type:String,default:()=>null},currentCalendar:{type:Object,default:()=>null},calendarType:{type:String,default:null},weekdays:{type:Array,default:()=>null},workingTime:{type:Object,default:()=>null},events:{type:Array,default:()=>null}}},h,[],!1,null,null,null).exports;var m=function(){var e=this,t=e._self._c;return t("v-calendar",{ref:"calendar",attrs:{events:e.eventsToDisplay,"event-color":e.getEventColor,"event-text-color":e.getEventTextColor,"event-timed":e.isEventTimed,type:e.calendarType,weekdays:e.weekdays,"interval-style":e.agendaIntervalStyle,"interval-height":40,"event-overlap-threshold":30,locale:e.lang,"event-overlap-mode":"stack","event-name":"summary","event-start":"startDate","event-end":"endDate","event-ripple":"acl.canEdit",color:"primary","show-week":""},on:{"click:event":e.showEvent,"click:more":e.showDay,"click:date":e.showDay,"mousedown:event":e.eventMouseDown,"mousemove:event":e.eventMouseMove,"mouseup:event":e.eventMouseUp,"mousedown:time":e.calendarMouseDown,"mousemove:time":e.calendarMouseMove,"mouseup:time":e.calendarMouseUp,"mousedown:day":e.calendarMouseDown,"mousemove:day":e.calendarMouseMove,"mouseup:day":e.calendarMouseUp,"contextmenu:event":e.cancelEventModification,"contextmenu:time":e.cancelEventModification,"contextmenu:day":e.cancelEventModification,change:e.retrievePeriodEvents},scopedSlots:e._u([{key:"day-body",fn:function(n){return[t("div",{staticClass:"v-current-time",class:{today:n.present},style:e.currentTimeStyle})]}},{key:"event",fn:function({event:n,timed:a}){return[t("div",{class:e.getEventClass(n)},[t("strong",{staticClass:"text-truncate my-auto d-flex ms-2",attrs:{title:n.summary}},[t("div",{staticClass:"flex-grow-1 text-truncate"},[e._v("\n          "+e._s(n.summary)+"\n        ")]),e._v(" "),e.isEventTentative(n)?t("div",{staticClass:"flex-grow-0 me-1"},[t("i",{staticClass:"uiIcon attendee-response attendee-response-tentative"})]):e._e()]),e._v(" "),!n||n.allDay||e.isShortEvent(n)?e._e():t("div",{staticClass:"v-event-draggable px-2 d-flex flex-row"},[t("date-format",{staticClass:"v-event-draggable me-2",attrs:{value:n.startDate,format:e.timeFormat}}),e._v(" "),t("strong",{staticClass:"mx-2"},[e._v("-")]),e._v(" "),t("date-format",{staticClass:"v-event-draggable me-2",attrs:{value:n.endDate,format:e.timeFormat}})],1)]),e._v(" "),a&&e.canEdit(n)?t("div",{staticClass:"v-event-drag-bottom",on:{mousedown:function(t){return t.stopPropagation(),e.extendEventEndDate(n)}}}):e._e()]}}]),model:{value:e.selectedDate,callback:function(t){e.selectedDate=t},expression:"selectedDate"}})};m._withStripped=!0;const g=v({props:{events:{type:Array,default:null},currentCalendar:{type:Object,default:()=>null},calendarType:{type:String,default:null},weekdays:{type:Array,default:()=>null},workingTime:{type:Object,default:()=>null}},data:()=>({saving:!1,quickEvent:null,originalDragedEvent:null,nowDate:null,lang:eXo.env.portal.language,dragEvent:null,dragDelta:null,mouseDown:!1,mouseIsPressed:0,eventExtended:!1,eventDragged:!1,selectedDate:"",selectedEvent:{},selectedElement:null,selectedOpen:!1,timeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{eventsToDisplay(){const e=[];return this.events.forEach((t=>{if(t.endDate&&t.endDate.toString().indexOf("00:00:00")>=0){const n=JSON.parse(JSON.stringify(t));n.startDate=this.$agendaUtils.toDate(t.startDate),n.endDate=this.$agendaUtils.toDate(t.endDate),t.allDay&&n.endDate.setDate(n.endDate.getDate()+1),n.endDate=new Date(n.endDate.getTime()-6e4),e.push(n)}else e.push(t)})),e},nowTimeOptions(){return this.nowDate&&{hour:this.nowDate.getHours(),minute:this.nowDate.getMinutes()}},currentTimeTop(){return this.nowDate&&this.$refs&&this.$refs.calendar&&this.nowTimeOptions&&this.$refs.calendar.timeToY(this.nowTimeOptions)},currentTimeStyle(){return this.nowDate&&this.currentTimeTop&&`top: ${this.currentTimeTop}px;`},canCreateEvent(){return!this.currentCalendar||!this.currentCalendar.acl||this.currentCalendar.acl.canCreate}},watch:{mouseIsPressed(){!this.mouseIsPressed&&this.mouseDown&&(this.mouseDown=!1,this.cancelEventModification())},mouseDown(e,t){!e&&t&&window.setTimeout((()=>{this.saving||this.cancelEventModification()}),500)},calendarType(){this.scrollToTime()},workingTime(){this.scrollToTime()}},created(){document.body.onmousedown=()=>++this.mouseIsPressed,document.body.onmouseup=()=>--this.mouseIsPressed},mounted(){this.$root.$on("agenda-display-calendar-atDate",(e=>{this.selectedDate=e||""})),this.$root.$on("agenda-display-calendar-next",(()=>{this.$refs.calendar&&this.$refs.calendar.next()})),this.$root.$on("agenda-display-calendar-previous",(()=>{this.$refs.calendar&&this.$refs.calendar.prev()})),this.$root.$on("agenda-calendar-color-changed",((e,t)=>{this.events.forEach((n=>{n.calendar.id===e&&(n.calendar.color=t)})),this.$forceUpdate()})),this.$root.$on("agenda-event-saved",this.applyEventModification),this.$root.$on("agenda-event-save-error",(()=>{this.saving=!1,this.cancelEventModification()})),this.$root.$on("agenda-event-save-opened",(()=>this.saving=!0)),this.$root.$on("agenda-event-save-cancel",(()=>{this.saving=!1,this.cancelEventModification()})),this.$root.$on("agenda-event-quick-form-cancel",(()=>{this.saving=!1,this.cancelEventModification()})),document.body.onmouseleave=()=>{this.cancelEventModification()},this.nowDate=new Date,this.$nextTick().then((()=>this.scrollToTime())),window.setTimeout((()=>{document.querySelector(".v-calendar-daily__scroll-area")&&window.setInterval((()=>{this.nowDate=new Date}),6e4)}),2e3)},methods:{getEventClass(e){const t=this.isEventDeclined(e)?" text-decoration-line-through":"";return`${this.canEdit(e)?"editable-event":"readonly-event"}${t}`},canEdit:e=>e&&e.acl&&e.acl.canEdit,scrollToTime(){this.$nextTick().then((()=>{const e=document.querySelector(".v-calendar-daily__scroll-area");if(e){const t=this.currentTimeTop-e.offsetHeight/2;e.scrollTo(0,t)}}))},retrievePeriodEvents(e){e.end=JSON.parse(JSON.stringify(e.end)),e.end.hour=23,e.end.minute=59;const t=this.$agendaUtils.convertVuetifyRangeToPeriod(e);t.title=this.$refs.calendar.title,this.$root.$emit("agenda-change-period",t)},getEventTextColor(e){const t=e&&(e.color||e.calendar&&e.calendar.color)||"#2196F3";if(!e.acl||!e.acl.attendee)return t;const n=e.attendees&&e.attendees.find((e=>e.identity.id===eXo.env.portal.userIdentityId));return n&&"DECLINED"!==n.response&&"NEEDS_ACTION"!==n.response&&"TENTATIVE"!==n.response?"white":t},isEventDeclined(e){const t=e.attendees&&e.attendees.find((e=>e.identity.id===eXo.env.portal.userIdentityId));return t&&"DECLINED"===t.response},isEventTentative(e){const t=e.attendees&&e.attendees.find((e=>e.identity.id===eXo.env.portal.userIdentityId));return t&&"TENTATIVE"===t.response},getEventColor(e){if(!e.acl||!e.acl.attendee)return"white";const t=e.attendees&&e.attendees.find((e=>e.identity.id===eXo.env.portal.userIdentityId));if(!t||"DECLINED"===t.response||"NEEDS_ACTION"===t.response||"TENTATIVE"===t.response)return"white";const n=e&&(e.color||e.calendar&&e.calendar.color)||"#2196F3";return this.$agendaUtils.toDate(e.endDate).getTime()>Date.now()?n:this.$agendaUtils.addOpacity(n,40)},isEventTimed:e=>e&&!e.allDay,showEvent(e){if(this.eventDragged||this.eventExtended)return void this.cancelEventModification();this.cancelEventModification();const t=e&&e.event||e;return t.id||t.occurrence?(e.nativeEvent&&(e.nativeEvent.preventDefault(),e.nativeEvent.stopPropagation()),this.$root.$emit("agenda-event-details",t),!1):void 0},showDay(e){e.nativeEvent&&(e.nativeEvent.preventDefault(),e.nativeEvent.stopPropagation()),this.cancelEventModification(),this.$root.$emit("agenda-display-calendar-atDate",e.date),this.$root.$emit("agenda-change-period-type","day")},extendEventEndDate(e){const t=e&&e.event||e;t&&t.acl&&t.acl.canEdit&&(this.eventExtended=!0,this.dragEvent=t,this.dragEvent&&(this.originalDragedEvent=JSON.parse(JSON.stringify(this.dragEvent)),this.originalDragedEvent.startDate=this.$agendaUtils.toDate(this.dragEvent.startDate),this.originalDragedEvent.endDate=this.$agendaUtils.toDate(this.dragEvent.endDate)))},eventMouseDown(e){e&&e.nativeEvent&&(e.nativeEvent.preventDefault(),e.nativeEvent.stopPropagation()),this.mouseDown=!0,window.setTimeout((()=>{if(this.mouseDown){const t=e&&e.event||e;if(!t||!t.acl||!t.acl.canEdit)return;this.dragEvent=t,this.dragEvent&&(this.originalDragedEvent=JSON.parse(JSON.stringify(this.dragEvent)),this.originalDragedEvent.startDate=this.$agendaUtils.toDate(this.dragEvent.startDate),this.originalDragedEvent.endDate=this.$agendaUtils.toDate(this.dragEvent.endDate))}}),500)},eventMouseUp(e){this.mouseDown=!1,(this.eventDragged||this.eventExtended)&&(e&&e.nativeEvent&&(e.nativeEvent.preventDefault(),e.nativeEvent.stopPropagation()),this.saveDraggedEvent())},eventMouseMove(e){if(this.dragEvent)if(this.eventExtended)this.$agendaUtils.toDateTime(e,!1)>=this.$agendaUtils.toDate(this.dragEvent.startDate).getTime()?this.dragEvent.endDate=this.$agendaUtils.toDateTime(e,!0):this.dragEvent.endDate=this.dragEvent.startDate;else{const t=this.$agendaUtils.toDateTime(e,!1);if(!Number.isNaN(t)){this.eventDragged=!0;const e=this.$agendaUtils.toDate(this.dragEvent.startDate).getTime(),n=this.$agendaUtils.toDate(this.dragEvent.endDate).getTime()-e,a=t-this.dragDelta,i=this.$agendaUtils.roundTime(a),s=i+n;this.dragEvent.startDate=this.$agendaUtils.toDate(i),this.dragEvent.endDate=this.$agendaUtils.toDate(s)}}},calendarMouseDown(e){if(e&&!e.event&&this.canCreateEvent)if(this.dragEvent)this.dragDelta||(this.dragDelta=this.$agendaUtils.toDateTime(e)-this.$agendaUtils.toDate(this.dragEvent.startDate).getTime());else if(!this.eventDragged&&!this.eventExtended){this.cancelEventModification();const t=this.$agendaUtils.toDateTime(e,!0);this.quickEvent={summary:"",startDate:t,endDate:t+this.$agendaUtils.MINIMUM_TIME_INTERVAL_MS,allDay:!e.time,editing:!0,calendar:{owner:{}},attachments:[],attendees:[]}}},calendarMouseMove(e){if(this.dragEvent&&this.eventMouseMove(e),this.quickEvent&&this.quickEvent.editing){const t=this.$agendaUtils.toDateTime(e);this.$agendaUtils.toDate(this.quickEvent.startDate).getTime()>t?this.quickEvent.startDate=this.$agendaUtils.toDateTime(e,!1):this.quickEvent.endDate=this.$agendaUtils.toDateTime(e,!0),this.quickEvent.added||(this.quickEvent.added=!0,this.events.push(this.quickEvent))}},calendarMouseUp(){this.mouseDown=!1,this.quickEvent?(this.quickEvent.added||(this.quickEvent.added=!0,this.events.push(this.quickEvent)),delete this.quickEvent.editing,window.setTimeout((()=>{this.quickEvent&&(this.saving=!0,this.$root.$emit("agenda-event-quick-form",this.quickEvent))}),200)):(this.eventDragged||this.eventExtended)&&this.saveDraggedEvent()},saveDraggedEvent(){if(!this.saving){if(this.originalDragedEvent)if(this.dragEvent.allDay){if(this.$agendaUtils.areDatesOnSameDay(this.dragEvent.startDate,this.originalDragedEvent.startDate)&&this.$agendaUtils.areDatesOnSameDay(this.dragEvent.endDate,this.originalDragedEvent.endDate))return}else if(this.$agendaUtils.toRFC3339(this.dragEvent.startDate)===this.$agendaUtils.toRFC3339(this.originalDragedEvent.startDate)&&this.$agendaUtils.toRFC3339(this.dragEvent.endDate)===this.$agendaUtils.toRFC3339(this.originalDragedEvent.endDate))return;if(this.dragEvent)return this.saving=!0,(this.dragEvent.id?this.$eventService.getEventById(this.dragEvent.id,"all"):this.$eventService.getEventOccurrence(this.dragEvent.parent.id,this.dragEvent.occurrence.id,"all")).then((e=>{"month"===this.calendarType&&(this.dragEvent.startDate.setHours(this.originalDragedEvent.startDate.getHours(),this.originalDragedEvent.startDate.getMinutes(),this.originalDragedEvent.startDate.getSeconds()),this.dragEvent.endDate.setHours(this.originalDragedEvent.endDate.getHours(),this.originalDragedEvent.endDate.getMinutes(),this.originalDragedEvent.endDate.getSeconds())),e.start=this.$agendaUtils.toRFC3339(this.dragEvent.startDate),e.end=this.$agendaUtils.toRFC3339(this.dragEvent.endDate),e.timeZoneId=this.$agendaUtils.USER_TIMEZONE_ID,e.allDay=this.dragEvent.allDay;const t=e.allDay||"CUSTOM"===e.parent.recurrence.type;this.$root.$emit("agenda-event-save",e,t,!0)}));this.cancelEventModification()}},applyEventModification(){this.originalDragedEvent=null,this.saving=!1,this.cancelEventModification()},cancelEventModification(){if(!this.saving)if(this.quickEvent){const e=this.events.findIndex((e=>e===this.quickEvent));e>=0&&this.events.splice(e,1),this.quickEvent=null}else this.cancelEventDrag()},cancelEventDrag(){this.saving||(this.dragEvent&&this.originalDragedEvent&&!this.saving&&(this.dragEvent.startDate=this.$agendaUtils.toDate(this.originalDragedEvent.start),this.dragEvent.endDate=this.$agendaUtils.toDate(this.originalDragedEvent.end)),this.eventDragged=!1,this.eventExtended=!1,this.dragDelta=null,this.dragEvent=null,this.originalDragedEvent=null)},agendaIntervalStyle(e){if(!this.workingTime.showWorkingTime)return null;if(this.workingTime.workingTimeStart&&this.workingTime.workingTimeEnd){const t=0===e.weekday||6===e.weekday||e.time<this.workingTime.workingTimeStart||e.time>=this.workingTime.workingTimeEnd,n=0===e.minute,a=this.dark,i=a?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)";return{backgroundColor:t?a?"rgba(0,0,0,0.4)":"rgba(0,0,0,0.05)":null,borderTop:n?null:`1px dashed ${i}`}}},isShortEvent(e){return this.$agendaUtils.isShortEvent(e)}}},m,[],!1,null,null,null).exports;var f=function(){var e=this,t=e._self._c;return t("v-toolbar",{attrs:{flat:"",color:"white"}},[t("v-row",[t("v-col",{staticClass:"my-auto",attrs:{cols:"2"}},[t("v-btn",{staticClass:"btn me-4",attrs:{outlined:"",color:"grey darken-2"},on:{click:e.setToday}},[e._v("\n        "+e._s(e.$t("agenda.toDay"))+"\n      ")])],1),e._v(" "),t("v-col",{staticClass:"d-flex flex-row align-center justify-center flex-nowrap",attrs:{cols:"8",align:"center"}},[t("v-btn",{attrs:{icon:"",color:"grey darken-2"},on:{click:e.prevDate}},[t("i",{staticClass:"uiIconArrowLeft uiIconMedium darkGreyIcon"})]),e._v(" "),t("div",{staticClass:"period-title text-uppercase"},[e._v("\n        "+e._s(e.periodTitle)+"\n      ")]),e._v(" "),t("v-btn",{attrs:{icon:"",color:"grey darken-2"},on:{click:e.nextDate}},[t("i",{staticClass:"uiIconArrowRight uiIconMedium darkGreyIcon"})])],1),e._v(" "),t("v-col",{attrs:{cols:"2"}})],1)],1)};f._withStripped=!0;const y=v({props:{periodTitle:{type:String,default:null}},methods:{setToday(){this.$root.$emit("agenda-display-calendar-atDate")},nextDate(){this.$root.$emit("agenda-display-calendar-next")},prevDate(){this.$root.$emit("agenda-display-calendar-previous")}}},f,[],!1,null,null,null).exports;var C=function(){var e=this,t=e._self._c;return t("v-menu",{attrs:{"close-on-content-click":!1,activator:e.selectedElement,"offset-x":""},model:{value:e.selectedOpen,callback:function(t){e.selectedOpen=t},expression:"selectedOpen"}},[t("v-card",{attrs:{color:"grey lighten-4",flat:""}},[t("v-toolbar",{attrs:{color:e.selectedEvent.color,dark:""}},[t("v-btn",{attrs:{icon:""}},[t("v-icon",[e._v("mdi-pencil")])],1),e._v(" "),t("v-toolbar-title",[e._v(e._s(e.selectedEvent.name))]),e._v(" "),t("v-spacer"),e._v(" "),t("v-btn",{attrs:{icon:""}},[t("v-icon",[e._v("mdi-heart")])],1),e._v(" "),t("v-btn",{attrs:{icon:""}},[t("v-icon",[e._v("mdi-dots-vertical")])],1)],1),e._v(" "),t("v-card-text",[t("span",[e._v(e._s(e.selectedEvent.details))])]),e._v(" "),t("v-card-actions",[t("v-btn",{attrs:{text:"",color:"secondary"},on:{click:function(t){e.selectedOpen=!1}}},[e._v("\n        Cancel\n      ")])],1)],1)],1)};C._withStripped=!0;const _=v({data:()=>({selectedOpen:!1,selectedEvent:{},selectedElement:null})},C,[],!1,null,null,null).exports;var w=function(){var e=this;return(0,e._self._c)("v-autocomplete",{staticClass:"subtitle-1 pa-0 agenda-time-zone",attrs:{id:"AgendaTimeZone",items:e.timeZones,dense:"",filled:""},model:{value:e.event.timeZoneId,callback:function(t){e.$set(e.event,"timeZoneId",t)},expression:"event.timeZoneId"}})};w._withStripped=!0;const D=v({props:{event:{type:Object,default:()=>({})}},data:()=>({timeZones:[]}),created(){this.timeZones=this.$agendaUtils.getTimeZones()}},w,[],!1,null,null,null).exports,b=v({props:{settings:{type:Object,default:null},currentCalendar:{type:Object,default:()=>null},calendarType:{type:String,default:null},ownerIds:{type:Array,default:()=>null},events:{type:Array,default:null},period:{type:Object,default:()=>null},limit:{type:Number,default:()=>0}},created(){this.$agendaWebSocket.initCometd(this.settings.cometdContextName,this.settings.cometdToken,this.handleAgendaUpdates)},methods:{handleAgendaUpdates(e,t){if(!t)return;const n=t.calendarId,a=t.eventId;this.currentCalendar&&this.currentCalendar.id!==n||("exo.agenda.event.deleted"===e?this.deleteEvent(a):this.retrieveAndAddEvent(a))},deleteEvent(e){if(this.events&&this.events.length){let t=0;for(;t<this.events.length;){const n=this.events.findIndex((t=>t.id===e||t.parent&&t.parent.id===e));n>=0?this.events.splice(n,1):t++}}this.$root.$emit("agenda-refresh-pending")},retrieveAndAddEvent(e){this.$eventService.getEventById(e,"all").then((t=>{t&&(this.ownerIds&&this.ownerIds.length&&this.ownerIds.indexOf(t.calendar.owner.id)<0||("TENTATIVE"===t.status||"CANCELLED"===t.status?this.deleteEvent(e):t.recurrence&&!t.occurrence?this.$root.$emit("agenda-refresh"):this.updateEventsView(t)))}))},updateEventsView(e){const t=this.events.findIndex((t=>t.id===e.id||t.parent&&e.parent&&t.parent.id===e.parent.id&&t.occurrence.id===e.occurrence.id)),n=t>=0&&this.events[t],a=e.attendees.find((e=>e.identity.id===eXo.env.portal.userIdentityId));if("allEvents"!==this.calendarType&&(!a||"declinedEvent"===this.calendarType&&"DECLINED"!==a.response||"myEvents"===this.calendarType&&"DECLINED"===a.response))a&&"NEEDS_ACTION"===a.response&&this.$root.$emit("agenda-refresh-pending"),n&&this.events.splice(t,1);else if(n){const i=n.attendees&&n.attendees.find((e=>e.identity.id===eXo.env.portal.userIdentityId));(a&&"NEEDS_ACTION"===a.response||i&&("TENTATIVE"===n.status||"NEEDS_ACTION"===i.response))&&this.$root.$emit("agenda-refresh-pending"),this.events.splice(t,1,e)}else{if(a&&"NEEDS_ACTION"===a.response&&this.$root.$emit("agenda-refresh-pending"),this.limit&&this.events&&this.events.length>=this.limit)return;this.events.push(e)}}}},void 0,void 0,!1,null,null,null).exports;var E=function(){var e=this,t=e._self._c;return t("v-flex",{staticClass:"agenda-mobile-header d-flex flex-row pa-2 border-radius border-color"},[t("agenda-create-event-button",{staticClass:"my-auto agenda-toolbar-left",attrs:{"current-space":e.currentSpace,"can-create-event":e.canCreateEvent,"offset-y":18,"offset-x":12}}),e._v(" "),t("date-picker",{staticClass:"d-flex flex-grow-1 ma-auto agenda-header-date-picker",model:{value:e.periodStart,callback:function(t){e.periodStart=t},expression:"periodStart"}}),e._v(" "),t("agenda-calendar-filter-button",{attrs:{"current-space":e.currentSpace,"owner-ids":e.ownerIds}})],1)};E._withStripped=!0;const x=v({props:{currentSpace:{type:Object,default:null},currentCalendar:{type:Object,default:()=>null},ownerIds:{type:Array,default:null},period:{type:Object,default:null}},data:()=>({periodStart:null}),computed:{canCreateEvent(){return!this.currentCalendar||!this.currentCalendar.acl||this.currentCalendar.acl.canCreate}},watch:{periodStart(e,t){t&&e&&this.$agendaUtils.toRFC3339(t,!0)!==this.$agendaUtils.toRFC3339(e,!0)&&(this.period.start=this.periodStart,this.$root.$emit("agenda-refresh"))}},created(){this.periodStart=this.period&&this.period.start||new Date}},E,[],!1,null,null,null).exports;var T=function(){var e=this,t=e._self._c;return t("v-flex",{staticClass:"agenda-timeline"},[e.events&&e.events.length?e._l(e.eventsMonths,(function(n){return t("v-list",{key:n,staticClass:"agenda-timeline-month pa-0 ma-0",attrs:{"min-height":"auto","min-width":"100%",dense:""}},[t("v-list-item",{staticClass:"agenda-timeline-month-title",attrs:{dense:""}},[t("v-list-item-action",{staticClass:"event-timeline-day"}),e._v(" "),t("v-list-item-action-text",{staticClass:"subtitle-1 me-2 text-capitalize"},[t("date-format",{attrs:{value:n,format:e.monthFormat}})],1),e._v(" "),t("v-list-item-content",[t("v-divider")],1)],1),e._v(" "),e._l(e.eventsDaysByMonth[n],(function(a){return t("v-list-item",{key:a,attrs:{dense:""}},[t("v-list-item-action",{staticClass:"align-self-start center event-timeline-day text-uppercase",class:e.toDay===a&&"primary--text"},[t("date-format",{attrs:{value:a,format:e.dayFormat}})],1),e._v(" "),t("v-list-item-content",{staticClass:"pa-0"},[t("v-list",{staticClass:"pa-0"},e._l(e.eventsByDates[n][a],(function(n,a){return t("v-list-item",{key:a,staticClass:"event-timeline-detail d-flex flex-column white--text px-2 py-0 mb-2 border-radius",style:{background:n.color||n.calendar.color},attrs:{title:n.summary,dark:""},on:{click:function(t){return e.$root.$emit("agenda-event-details",n)}}},[t("v-list-item-content",{staticClass:"event-timeline-detail-content"},[t("strong",{staticClass:"text-truncate"},[e._v(e._s(n.summary))]),e._v(" "),n.allDay?t("div",[e._v("\n                  "+e._s(e.$t("agenda.allDay"))+"\n                ")]):t("div",{staticClass:"d-flex flex-row"},[n.startsOnBeginningOfDay?t("div",[e._v("\n                    "+e._s(e.$t("agenda.beginningOfTheDay"))+"\n                  ")]):t("date-format",{attrs:{value:n.startDate,format:e.timeFormat}}),e._v(" "),t("strong",{staticClass:"mx-2"},[e._v("-")]),e._v(" "),n.endsOnEndOfDay?t("div",[e._v("\n                    "+e._s(e.$t("agenda.endOfTheDay"))+"\n                  ")]):t("date-format",{attrs:{value:n.endDate,format:e.timeFormat}})],1)])],1)})),1)],1)],1)}))],2)})):e.loading?e._e():t("agenda-empty-timeline")],2)};T._withStripped=!0;const I=v({props:{events:{type:Object,default:null},periodStartDate:{type:Object,default:null},limit:{type:Number,default:0},loading:{type:Boolean,default:!1},agendaBaseLink:{type:String,default:null}},data:()=>({monthFormat:{month:"long",year:"numeric"},dayFormat:{day:"numeric",weekday:"short"},timeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{toDay(){const e=new Date;return String(new Date(e.getFullYear(),e.getMonth(),e.getDate()))},eventsMonths(){return Object.keys(this.eventsByDates).sort(((e,t)=>new Date(e).getTime()-new Date(t).getTime()))},eventsDaysByMonth(){if(!this.events||!this.events.length)return{};const e={};return Object.keys(this.eventsByDates).forEach((t=>{e[t]=Object.keys(this.eventsByDates[t]).sort(((e,t)=>new Date(e).getTime()-new Date(t).getTime()))})),e},eventsByDates(){if(!this.events||!this.events.length)return{};const e={};let t=0;return this.events.forEach((n=>{const a=JSON.parse(JSON.stringify(n));a.startDate=new Date(n.startDate),a.endDate=new Date(n.endDate);let i=new Date(this.periodStartDate);if(i=new Date(i.getFullYear(),i.getMonth(),i.getDate()),new Date(a.startDate).getTime()>new Date(i).getTime()&&(t=this.addEventByDateInMap(a,n.startDate,e,t)),!this.$agendaUtils.areDatesOnSameDay(n.startDate,n.endDate)){a.endsOnEndOfDay=!0;const s=new Date(n.startDate),r=new Date(n.endDate),o=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1),l=(new Date(r.getFullYear(),r.getMonth(),r.getDate()+1).getTime()-o.getTime())/864e5;if(l>1)for(let a=1;a<l;a++){const a=JSON.parse(JSON.stringify(n));a.startDate=new Date(o),a.endDate=new Date(o),a.allDay=!0,i.getTime()>a.startDate.getTime()||(t=this.addEventByDateInMap(a,a.startDate,e,t),o.setDate(o.getDate()+1))}const c=JSON.parse(JSON.stringify(n));c.startDate=new Date(n.startDate),c.endDate=new Date(n.endDate),c.startsOnBeginningOfDay=!0,t=this.addEventByDateInMap(c,n.endDate,e,t)}})),e}},created(){this.$root.$emit("agenda-event-limit-increment")},methods:{addEventByDateInMap(e,t,n,a){if(++a>this.limit)return--a;const i=new Date(t.getFullYear(),t.getMonth());n[i]||(n[i]={});const s=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n[i][s]?n[i][s].push(e):n[i][s]=[e],a}}},T,[],!1,null,null,null).exports;var A=function(){var e=this,t=e._self._c;return t("v-flex",{staticClass:"d-flex agenda-empty-timeline"},[t("div",{staticClass:"ma-auto py-5 d-flex flex-column align-center"},[t("i",{staticClass:"uiIconCalendarEmpty"}),e._v(" "),t("span",{staticClass:"title mt-5"},[e._v("\n      "+e._s(e.$t("agenda.noEvent"))+"\n    ")]),e._v(" "),t("span",{staticClass:"sub-title-1 text-sub-title"},[e._v("\n      "+e._s(e.$t("agenda.noEventYet"))+"\n    ")])])])};A._withStripped=!0;const S=v({},A,[],!1,null,null,null).exports;var k=function(){var e=this,t=e._self._c;return t("v-card",{staticClass:"d-flex flex-column",attrs:{flat:""}},[t("div",{staticClass:"d-flex flex-nowrap py-3"},[t("div",{staticClass:"title text-truncate flex-grow-1 px-0 pt-1 mx-2"},[e._v("\n      "+e._s(e.$t("agenda.scheduleEvent"))+"\n    ")]),e._v(" "),t("div",{staticClass:"flex-grow-0 flex-shrink-0 px-0 me-2"},[t("v-btn",{attrs:{color:"grey",icon:""},on:{click:function(t){return e.$emit("close")}}},[t("v-icon",[e._v("\n          mdi-close\n        ")])],1)],1)]),e._v(" "),t("v-divider"),e._v(" "),e.event?t("v-form",{ref:"agendaEventForm",staticClass:"flex event-form-mobile px-3 pb-2",attrs:{flat:""},on:{submit:e.saveEvent}},[t("div",{staticClass:"d-flex flex-column flex-grow-1"},[t("label",{staticClass:"font-weight-bold my-2"},[e._v("\n        "+e._s(e.$t("agenda.title"))+"\n      ")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.event.summary,expression:"event.summary"}],ref:"eventTitle",staticClass:"ignore-vuetify-classes",attrs:{id:"eventTitle",placeholder:e.$t("agenda.eventTitle"),type:"text",name:"title",required:"",autofocus:""},domProps:{value:e.event.summary},on:{change:e.resetCustomValidity,input:function(t){t.target.composing||e.$set(e.event,"summary",t.target.value)}}}),e._v(" "),t("label",{staticClass:"font-weight-bold my-2"},[e._v("\n        "+e._s(e.$t("agenda"))+"\n      ")]),e._v(" "),t("agenda-event-form-calendar-owner",{ref:"calendarOwner",attrs:{event:e.event,"current-space":e.currentSpace},on:{initialized:function(t){return e.$emit("initialized")}}}),e._v(" "),t("agenda-event-form-date-pickers",{attrs:{event:e.event}},[t("template",{slot:"startDateLabel"},[e.event.allDay?t("label",{staticClass:"font-weight-bold my-2"},[e._v(e._s(e.$t("agenda.startDate")))]):t("label",{staticClass:"font-weight-bold my-2"},[e._v(e._s(e.$t("agenda.startTime")))])]),e._v(" "),t("template",{slot:"endDateLabel"},[e.event.allDay?t("label",{staticClass:"font-weight-bold my-2"},[e._v(e._s(e.$t("agenda.endDate")))]):t("label",{staticClass:"font-weight-bold my-2"},[e._v(e._s(e.$t("agenda.endTime")))])])],2),e._v(" "),t("label",{staticClass:"font-weight-bold my-2"},[e._v("\n        "+e._s(e.$t("agenda.repitition"))+"\n      ")]),e._v(" "),t("agenda-event-form-recurrence",{attrs:{event:e.event}}),e._v(" "),e.event.recurrence?t("agenda-event-recurrence",{staticClass:"text-wrap mt-2",attrs:{event:e.event}}):e._e(),e._v(" "),t("label",{staticClass:"font-weight-bold my-2"},[e._v("\n        "+e._s(e.$t("agenda.location"))+"\n      ")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.event.location,expression:"event.location"}],ref:"eventLocation",staticClass:"ignore-vuetify-classes my-0 location-event-input",attrs:{id:"eventLocation",placeholder:e.$t("agenda.eventLocation"),type:"text",name:"locationEvent"},domProps:{value:e.event.location},on:{input:function(t){t.target.composing||e.$set(e.event,"location",t.target.value)}}}),e._v(" "),t("label",{staticClass:"font-weight-bold my-2"},[e._v("\n        "+e._s(e.$t("agenda.conference"))+"\n      ")]),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[e.isConferenceEnabled?t("agenda-event-form-conference",{staticClass:"me-3",attrs:{event:e.event,settings:e.settings,"current-space":e.currentSpace,"conference-provider":e.conferenceProvider}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.conferenceURL,expression:"conferenceURL"}],ref:"eventConference",staticClass:"ignore-vuetify-classes my-3 location-event-input",attrs:{id:"eventConference",placeholder:e.$t("agenda.webConferenceURL"),type:"text",name:"locationEvent"},domProps:{value:e.conferenceURL},on:{input:function(t){t.target.composing||(e.conferenceURL=t.target.value)}}})],1),e._v(" "),t("label",{staticClass:"font-weight-bold my-2"},[e._v("\n        "+e._s(e.$t("agenda.participants"))+"\n      ")]),e._v(" "),t("agenda-event-form-attendees",{attrs:{event:e.event},on:{initialized:function(t){return e.$emit("initialized")}}}),e._v(" "),t("div",{staticClass:"d-flex flex-row my-2 align-center"},[t("label",{staticClass:"font-weight-bold"},[e._v(e._s(e.$t("agenda.modifyEventPermission")))]),e._v(" "),t("v-switch",{staticClass:"pa-0 mt-0 ms-4",model:{value:e.event.allowAttendeeToUpdate,callback:function(t){e.$set(e.event,"allowAttendeeToUpdate",t)},expression:"event.allowAttendeeToUpdate"}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-row font-weight-regular"},[e._v("\n        "+e._s(e.$t("agenda.modifyEventPermissionDescription"))+"\n      ")])],1)]):e._e(),e._v(" "),t("v-divider"),e._v(" "),t("div",{staticClass:"d-flex ma-2"},[t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn ms-2 d-inline d-sm-none",on:{click:e.close}},[e._v("\n      "+e._s(e.$t("agenda.button.cancel"))+"\n    ")]),e._v(" "),t("v-btn",{staticClass:"btn btn-primary ms-2",attrs:{disabled:e.disableSaveButton},on:{click:e.saveEvent}},[e._v("\n      "+e._s(e.$t("agenda.button.save"))+"\n    ")])],1)],1)};k._withStripped=!0;const O=v({props:{event:{type:Object,default:()=>null},currentSpace:{type:Object,default:()=>null},conferenceProvider:{type:Object,default:()=>null}},data:()=>({saving:!1,eventDescriptionTextLength:1300}),computed:{isNew(){return!this.event||!this.event.id&&!this.event.parent},eventTitle(){return this.event&&this.event.summary},eventTitleValid(){return this.eventTitle&&this.eventTitle.length>=5&&this.eventTitle.length<1024},eventOwner(){return this.event&&this.event.calendar&&this.event.calendar.owner},eventOwnerValid(){return this.eventOwner&&(this.eventOwner.id||this.eventOwner.remoteId&&this.eventOwner.providerId)},eventDescription(){return this.event&&this.event.description||""},eventDescriptionValid(){return this.eventDescription.length<=1300},disableSaveButton(){return this.saving||!this.eventTitleValid||!this.eventOwnerValid||!this.eventDescriptionValid},isConferenceEnabled(){return this.conferenceProvider&&this.conferenceProvider.getType()}},created(){this.$root.$on("agenda-event-form",(()=>{this.reset()})),this.$root.$on("agenda-event-saved",(()=>this.close()))},mounted(){this.reset()},watch:{conferenceURL(e){this.event.conferences=e?[{url:e,type:"manual"}]:[]},eventOwner(e){e&&e.providerId&&!this.event.calendar.owner.id&&this.$identityService.getIdentityByProviderIdAndRemoteId(e.providerId,e.remoteId).then((e=>{this.event.calendar.owner.id=e.id}))}},methods:{close(){this.$emit("close"),window.setTimeout((()=>{this.stepper=1}),200)},reset(){this.resetCustomValidity(),window.setTimeout((()=>{this.$refs.eventTitle&&this.$refs.eventTitle.focus()}),500)},resetCustomValidity(){this.$refs.eventTitle&&this.$refs.eventTitle.setCustomValidity(""),this.$refs.calendarOwner&&this.$refs.calendarOwner.resetCustomValidity()},validateForm(){if(this.resetCustomValidity(),this.$refs.calendarOwner.validateForm(),this.event.summary?(this.event.summary.trim().length<5||this.event.summary.trim().length>1024)&&this.$refs.eventTitle.setCustomValidity(this.$t("agenda.message.missingLengthEventTitle")):this.$refs.eventTitle.setCustomValidity(this.$t("agenda.message.missingEventTitle")),this.$refs.agendaEventForm.validate()&&this.$refs.agendaEventForm.$el.reportValidity())return!0},saveEvent(){this.validateForm()&&(this.event.start=this.$agendaUtils.toRFC3339(this.event.startDate),this.event.end=this.$agendaUtils.toRFC3339(this.event.endDate),this.event.timeZoneId=this.$agendaUtils.USER_TIMEZONE_ID,this.$root.$emit("agenda-event-save",this.event))}}},k,[],!1,null,null,null).exports;var P=function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-no-wrap"},[e.displayButton?t("div",{staticClass:"d-inline-block",attrs:{title:e.addEventButtonTooltip}},[t("v-btn",{staticClass:"btn btn-primary",attrs:{disabled:!e.canCreateEvent},on:{click:e.openNewEventForm}},[t("v-icon",{attrs:{dark:""}},[e._v("\n        mdi-plus\n      ")]),e._v(" "),t("span",{staticClass:"ms-2 d-none d-lg-inline"},[e._v("\n        "+e._s(e.$t("agenda.button.addEvent"))+"\n      ")])],1)],1):e._e(),e._v(" "),t("agenda-pending-invitation-badge",{attrs:{"current-space":e.currentSpace,"offset-x":e.offsetX,"offset-y":e.offsetY}})],1)};P._withStripped=!0;const U=v({props:{currentSpace:{type:Object,default:null},canCreateEvent:{type:Boolean,default:!1},offsetX:{type:Number,default:()=>18},offsetY:{type:Number,default:()=>22}},data:()=>({initialized:!1}),computed:{isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},displayButton(){return(!this.isMobile||this.canCreateEvent)&&(this.initialized||!eXo.env.portal.spaceId)},addEventButtonTooltip(){return this.canCreateEvent?"":this.$t("agenda.onlySpaceRedactorCanCreateEvent")}},created(){this.$root.$on("agenda-application-loaded",(()=>this.initialized=!0))},methods:{openNewEventForm(){this.$root.$emit("agenda-event-form",{summary:"",allDay:!1,calendar:{owner:{}},reminders:[],attachments:[],attendees:[]})}}},P,[],!1,null,null,null).exports;var R=function(){var e=this,t=e._self._c;return e.currentSpace?e._e():t("v-btn",{staticClass:"primary--text",attrs:{title:e.$t("agenda.filterAgendaTooltip"),icon:""},on:{click:function(t){return e.$root.$emit("agenda-calendar-owners-drawer-open")}}},[e.ownerIds&&e.ownerIds.length?[t("i",{staticClass:"uiIcon uiIcon24x24 settingsIcon primary--text"}),e._v("\n    ("+e._s(e.ownerIds.length)+")\n  ")]:[t("i",{staticClass:"uiIcon uiIcon24x24 settingsIcon text-color"})]],2)};R._withStripped=!0;const N=v({props:{currentSpace:{type:Object,default:null},period:{type:Object,default:null},ownerIds:{type:Array,default:null}}},R,[],!1,null,null,null).exports;var F=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"calendarOwnersFilters",attrs:{right:""},on:{opened:function(t){e.drawer=!0},closed:function(t){e.drawer=!1}}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("agenda.filterAgendaTitle"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("agenda-filter-calendar-list",{ref:"filterCalendarList",staticClass:"calendar-owners-filters me-4",on:{"start-loading":function(t){return e.$refs.calendarOwnersFilters.startLoading()},"end-loading":function(t){return e.$refs.calendarOwnersFilters.endLoading()}},model:{value:e.selectedOwnerIds,callback:function(t){e.selectedOwnerIds=t},expression:"selectedOwnerIds"}})],1)],2)};F._withStripped=!0;const M=v({props:{ownerIds:{type:Array,default:()=>[]}},data:()=>({drawer:!1,selectedOwnerIds:[]}),computed:{calendarOwnersSuggesterLabels(){return{placeholder:this.$t("agenda.filterAgendaPlaceholder"),noDataLabel:this.$t("agenda.noDataLabel")}}},watch:{selectedOwnerIds(){this.applyFilters()}},created(){this.$root.$on("agenda-calendar-owners-drawer-open",this.open)},methods:{applyFilters(){this.$emit("changed",this.selectedOwnerIds)},close(){this.$refs.calendarOwnersFilters.close()},open(){this.$refs.calendarOwnersFilters.open(),this.$nextTick().then((()=>{this.$refs.filterCalendarList.reset()}))}}},F,[],!1,null,null,null).exports;var V=function(){var e=this,t=e._self._c;return t("v-list",[t("v-list-item",{staticClass:"agenda-calendar-settings px-0"},[t("v-list-item-action",{staticClass:"me-2 ms-4"},[t("v-checkbox",{staticClass:"agenda-calendar-settings-color ma-auto",attrs:{indeterminate:e.partiallySelected,color:"primary"},on:{click:e.changeAllSelection},model:{value:e.selectAll,callback:function(t){e.selectAll=t},expression:"selectAll"}})],1),e._v(" "),t("v-list-item-content",[t("agenda-filter-calendar-search",{ref:"queryInput",staticClass:"mb-0 mt-1",model:{value:e.query,callback:function(t){e.query=t},expression:"query"}})],1),e._v(" "),t("v-list-item-action",{staticClass:"ms-2"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectionType,expression:"selectionType"}],staticClass:"width-auto my-auto subtitle-1 ignore-vuetify-classes",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectionType=t.target.multiple?n:n[0]}}},[t("option",{attrs:{value:"all"}},[e._v(e._s(e.$t("agenda.all")))]),e._v(" "),t("option",{attrs:{value:"selected"}},[e._v(e._s(e.$t("agenda.selected")))]),e._v(" "),t("option",{attrs:{value:"nonSelected"}},[e._v(e._s(e.$t("agenda.nonSelected")))])])])],1),e._v(" "),e._l(e.filteredCalendars,(function(n){return t("agenda-filter-calendar-item",{key:n.owner.id,attrs:{calendar:n,"owner-ids":e.spaceIdentityIds,"selected-owner-ids":e.value},on:{changeSelection:e.changeSelection}})})),e._v(" "),e.hasMore?t("v-flex",{staticClass:"agendaLoadMoreParent d-flex my-4 border-box-sizing"},[t("v-btn",{staticClass:"btn mx-auto",attrs:{loading:e.loading,disabled:e.loading},on:{click:e.loadMore}},[e._v("\n      "+e._s(e.$t("agenda.button.loadMore"))+"\n    ")])],1):e._e()],2)};V._withStripped=!0;const L=v({props:{value:{type:Array,default:()=>[]}},data:()=>({spaces:[],calendars:[],selectionType:"all",selectAll:!0,loading:!1,query:null,limit:20,pageSize:20,totalSize:0}),computed:{filteredCalendars(){return"selected"===this.selectionType?this.selectedCalendars:"nonSelected"===this.selectionType?this.unselectedCalendars:this.calendars},partiallySelected(){return this.value&&this.value.length&&(this.hasMore||this.spaceIdentityIds.length!==this.value.length)},hasMore(){return this.limit<this.totalSize},spaceIdentityIds(){return this.spaces&&this.spaces.filter((e=>e.identity&&e.identity.id)).map((e=>Number(e.identity.id)))||[]},selectedCalendars(){return!1===this.value?[]:!this.selectAll&&this.value&&this.value.length?this.calendars&&this.calendars.filter((e=>this.value.indexOf(Number(e.owner.id))>=0))||[]:this.calendars},unselectedCalendars(){return this.calendars&&this.calendars.filter((e=>!this.selectedCalendars||!this.selectedCalendars.find((t=>t.owner.id===e.owner.id))))||[]}},watch:{limit(){this.retrieveCalendars()},query(){this.retrieveCalendars()},loading(){this.loading?this.$emit("start-loading"):this.$emit("end-loading")}},methods:{reset(){this.calendars&&this.calendars.length||this.retrieveCalendars(),this.selectAll=!this.value||!this.value.length,window.setTimeout((()=>this.$refs.queryInput.$el.querySelector("input").focus()),200)},loadMore(){this.hasMore&&(this.limit+=this.pageSize)},changeAllSelection(){this.selectAll?this.checkAll():this.uncheckAll()},changeSelection(e){this.value&&1===this.value.length&&!e.length?this.uncheckAll():this.query||e.length!==this.spaceIdentityIds.length?(this.value=e,this.selectAll=!1,this.$emit("input",this.value)):this.checkAll()},checkAll(){this.query?(this.value=this.spaceIdentityIds.slice(),this.selectAll=!1):(this.value=[],this.selectAll=!0),this.$emit("input",this.value)},uncheckAll(){this.value=!1,this.selectAll=!1,this.$emit("input",this.value)},retrieveCalendars(){this.loading=!0,this.$spaceService.getSpaces(this.query,0,this.limit,"member","identity").then((e=>(this.spaces=e.spaces,this.totalSize=e.size||this.totalSize,this.$nextTick()))).then((()=>{if(this.spaceIdentityIds&&this.spaceIdentityIds.length)return this.$calendarService.getCalendars(0,this.limit,!1,this.spaceIdentityIds)})).then((e=>{e&&e.calendars?this.calendars=e.calendars:this.calendars=[];const t=this.limit===this.pageSize||this.query;if(!1===this.value)this.uncheckAll();else if(this.value&&this.value.length&&t){if(this.selectedCalendars.length<this.value.length)return this.$calendarService.getCalendars(0,0,!1,this.value)}else this.value&&this.value.length||(this.selectedCalendars=this.calendars.slice())})).then((e=>{e&&e.calendars&&(this.query?this.selectedCalendars=e.calendars.filter((e=>e.owner&&e.owner.space&&e.owner.space.displayName.indexOf(this.query)>=0)):this.selectedCalendars=e.calendars)})).finally((()=>this.loading=!1))}}},V,[],!1,null,null,null).exports;var j=function(){var e=this,t=e._self._c;return t("v-list-item",{staticClass:"agenda-calendar-settings px-0"},[t("v-list-item-content",{staticClass:"flex-grow-1 pa-0",attrs:{title:e.calendarDisplayName}},[t("v-checkbox",{staticClass:"agenda-calendar-settings-color ms-4",attrs:{color:e.calendarColor,label:e.calendarDisplayName},on:{click:e.changeSelection},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}})],1),e._v(" "),e.isMobile?e._e():t("v-list-item-action",{staticClass:"calendarSettingActions",attrs:{id:e.calendarMenuId}},[e.canEditCalendar?t("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"content-class":e.calendarMenuId,bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:a}){return[t("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",a,!1),n),[t("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!1,3221905750),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),t("v-card",[t("v-color-picker",{staticClass:"ma-2",attrs:{"hide-inputs":"",flat:""},model:{value:e.selectedCalendarColor,callback:function(t){e.selectedCalendarColor=t},expression:"selectedCalendarColor"}}),e._v(" "),t("v-card-actions",[t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn ms-2",attrs:{disabled:e.saving},on:{click:e.closeMenu}},[e._v("\n            "+e._s(e.$t("agenda.button.cancel"))+"\n          ")]),e._v(" "),t("v-btn",{staticClass:"btn btn-primary ms-2",attrs:{loading:e.saving,disabled:e.saving},on:{click:e.applyColor}},[e._v("\n            "+e._s(e.$t("agenda.button.apply"))+"\n          ")])],1)],1)],1):e._e()],1)],1)};j._withStripped=!0;const B=v({props:{calendar:{type:Object,default:null},ownerIds:{type:Array,default:()=>[]},selectedOwnerIds:{type:Array,default:()=>[]}},data:()=>({selectedCalendarColor:null,saving:!1,menu:!1,checked:!1}),computed:{isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},selected(){return!1!==this.selectedOwnerIds&&(!this.selectedOwnerIds.length||this.selectedOwnerIds.find((e=>e===this.calendarOwnerId)))},calendarOwnerId(){return Number(this.calendar.owner.id)},calendarMenuId(){return`settingsMenu${this.calendarOwnerId}`},calendarColor(){return this.calendar.color},canEditCalendar(){return this.calendar&&this.calendar.acl&&this.calendar.acl.canEdit},calendarDisplayName(){const e=this.calendar.owner,t=e.space||e.profile;return t.displayName||t.fullname||t.fullName}},watch:{menu(){this.menu&&this.$root.$emit("agenda-filter-close-menu",this.calendarOwnerId)},selected(){this.checked=this.selected}},created(){this.selectedCalendarColor=this.calendar.color,this.$root.$on("agenda-filter-close-menu",(e=>{e!==this.calendarOwnerId&&(this.menu=!1)})),$(".calendarSettingActions button").on("click",(e=>{e.target&&!$(e.target).parents(`#${this.calendarMenuId}`).length&&(this.menu=!1)})),$(document).on("click",(e=>{e.target&&!$(e.target).parents(`.${this.calendarMenuId}`).length&&(this.menu=!1)}))},mounted(){this.checked=this.selected},methods:{changeSelection(){if(this.selectedOwnerIds)if(this.selected){this.selectedOwnerIds&&!this.selectedOwnerIds.length&&(this.selectedOwnerIds=this.ownerIds.slice());const e=this.selectedOwnerIds.findIndex((e=>e===this.calendarOwnerId));e>=0&&(this.selectedOwnerIds.splice(e,1),this.selectedOwnerIds.length||(this.selectedOwnerIds=!1))}else this.selectedOwnerIds.push(this.calendarOwnerId);else this.selected||(this.selectedOwnerIds=[this.calendarOwnerId]);this.$emit("changeSelection",this.selectedOwnerIds)},reset(){this.selectedCalendarColor=this.calendar.color},applyColor(){const e=JSON.parse(JSON.stringify(this.calendar));e.color=this.selectedCalendarColor,this.saving=!0,this.$calendarService.saveCalendar(e).then((()=>{this.calendar.color=this.selectedCalendarColor,this.$root.$emit("agenda-calendar-color-changed",this.calendar.id,this.calendarColor),this.closeMenu()})).finally((()=>this.saving=!1))},closeMenu(){this.menu=!1}}},j,[],!1,null,null,null).exports;var z=function(){var e=this,t=e._self._c;return t("v-scale-transition",[t("v-text-field",{staticClass:"agenda-calendar-filter-input pa-0 my-auto",attrs:{placeholder:e.$t("agenda.SearchCalendarPlaceholder"),"append-icon":e.appendIcon,"prepend-inner-icon":"fa-filter"},on:{"click:append":function(t){e.query=null}},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}})],1)};z._withStripped=!0;const X=v({props:{value:{type:Array,default:()=>[]}},data:()=>({startSearchAfterInMilliseconds:600,endTypingKeywordTimeout:50,startTypingKeywordTimeout:0,query:null,loading:!1}),computed:{appendIcon(){return this.query?"mdi-close primary--text":null}},watch:{query(){if(!this.query)return this.loading=!1,void this.$emit("input","");this.startTypingKeywordTimeout=Date.now(),this.loading||(this.loading=!0,this.waitForEndTyping())}},methods:{waitForEndTyping(){window.setTimeout((()=>{if(Date.now()-this.startTypingKeywordTimeout>this.startSearchAfterInMilliseconds)return this.loading=!1,void this.$emit("input",this.query);this.waitForEndTyping()}),this.endTypingKeywordTimeout)}}},z,[],!1,null,null,null).exports;var q=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"pendingInvitationDrawer",attrs:{right:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("agenda.pendingInvitations"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("v-list",e._l(e.pendingInvitations,(function(n){return t("agenda-pending-invitation-item",{key:n.id,staticClass:"mx-2 px-2 py-0 mb-2",attrs:{"invited-event":n,"min-height":"auto","min-width":"100%"},on:{close:e.close}})})),1)],1),e._v(" "),e.hasMore?t("template",{slot:"footer"},[t("div",{staticClass:"d-flex mx-4"},[t("v-btn",{staticClass:"btn mx-auto",attrs:{loading:!!e.loading,disabled:!!e.loading},on:{click:e.loadMore}},[e._v("\n        "+e._s(e.$t("agenda.button.loadMore"))+"\n      ")])],1)]):e._e()],2)};q._withStripped=!0;const Y=v({props:{currentSpace:{type:Object,default:()=>null}},data:()=>({pendingDatePolls:[],pendingDatePollsCount:0,pendingEvents:[],pendingEventCount:0,pageSize:10,limit:10,loading:0}),computed:{spaceIdentityId(){return this.currentSpace&&this.currentSpace.identity&&this.currentSpace.identity.id},pendingInvitations(){const e=[...this.pendingEvents,...this.pendingDatePolls];return e.sort(((e,t)=>{const n=e.updated||e.created;return(t.updated||t.created).localeCompare(n)})),e.slice(0,this.limit)},pendingInvitationsCount(){return this.pendingDatePollsCount+this.pendingEventCount},displayedPendingInvitationsCount(){return this.pendingInvitations.length},hasMore(){return this.pendingInvitationsCount>this.displayedPendingInvitationsCount}},watch:{loading(){this.loading?this.$refs.pendingInvitationDrawer.startLoading():this.$refs.pendingInvitationDrawer.endLoading()}},created(){this.$root.$on("agenda-pending-date-polls-drawer-open",this.open)},methods:{close(){this.$refs.pendingInvitationDrawer.close()},open(){this.retrievePendingInvitations(),this.$refs.pendingInvitationDrawer.open()},loadMore(){this.limit+=this.pageSize,this.retrievePendingInvitations()},retrievePendingInvitations(){this.retrievePendingEvents(),this.retrieveDatePolls()},retrieveDatePolls(){return this.loading++,this.$eventService.getDatePolls(this.spaceIdentityId,0,this.limit,"response").then((e=>{this.pendingDatePollsCount=e.size||0,this.pendingDatePolls=e&&e.events||[]})).catch((e=>{console.error("Error retrieving pending date polls",e)})).finally((()=>this.loading--))},retrievePendingEvents(){return this.loading++,this.$eventService.getPendingEvents(this.spaceIdentityId,0,this.limit).then((e=>{this.pendingEventCount=e.size||0,this.pendingEvents=e&&e.events||[]})).catch((e=>{console.error("Error retrieving pending date polls",e)})).finally((()=>this.loading--))}}},q,[],!1,null,null,null).exports;var G=function(){var e=this,t=e._self._c;return t("v-list-item",{staticClass:"pending-invitation-item border-radius",style:e.eventStyle,attrs:{dense:""},on:{click:e.openEventDetails}},[t("v-list-item-icon",{staticClass:"my-auto me-2"},[e.isCreator?t("v-icon",{style:e.textStyle},[e._v("\n      fa-crown\n    ")]):e._e()],1),e._v(" "),t("v-list-item-content",{staticClass:"pa-0"},[t("v-list-item-title",{staticClass:"white--text text-truncate subtitle-1",style:e.textStyle,attrs:{title:e.invitedEvent.summary}},[e._v("\n      "+e._s(e.invitedEvent.summary)+"\n    ")]),e._v(" "),t("v-list-item-subtitle",{staticClass:"text-truncate d-flex caption mt-1"},[e.isDatePoll?t("span",{style:e.textStyle},[e._v("\n        "+e._s(e.$t("agenda.ongoingDatePoll"))+" - "+e._s(e.displayVoteStatus)+"\n      ")]):[t("span",[e._v("\n          "+e._s(e.$t("agenda.pendingReply"))+"\n        ")]),e._v(" "),t("date-format",{staticClass:"ms-auto",attrs:{value:e.invitedEvent.start,format:e.dayFormat}})]],2)],1),e._v(" "),t("v-list-item-action",{staticClass:"my-1 py-0"},[e.isDatePoll?t("span",{class:e.voteIconStatus,attrs:{title:e.displayVoteStatus}}):e._e(),e._v(" "),t("i",{staticClass:"uiIcon32x32 uiIconPLFFont align-self-center d-flex mb-1 me-1",class:e.eventIcon,style:e.textStyle})])],1)};G._withStripped=!0;const J=v({props:{invitedEvent:{type:Object,default:()=>({})}},data:()=>({dialog:!1,currentUserId:eXo.env.portal.userIdentityId,dayFormat:{year:"numeric",month:"long",day:"numeric"}}),computed:{isCreator(){return this.invitedEvent&&this.invitedEvent.creator&&Number(this.invitedEvent.creator.id)===Number(this.currentUserId)},isDatePoll(){return this.invitedEvent&&"TENTATIVE"===this.invitedEvent.status},currentAttendee(){return this.invitedEvent.attendees&&this.invitedEvent.attendees.find((e=>e.identity.id===this.currentUserId))},hasVoted(){return this.currentAttendee&&"TENTATIVE"===this.currentAttendee.response},textClass(){return this.invitedEvent?"white-text":"primary--text"},voteIconStatus(){return this.currentAttendee&&this.currentAttendee.response&&`attendee-vote-${this.currentAttendee.response.toLowerCase()}`||"attendee-vote-needs_action"},displayVoteStatus(){return this.hasVoted?this.$t("agenda.datePollVoted"):this.$t("agenda.datePollVoteNeeded")},eventIcon(){return this.isDatePoll?"uiIconStatistics":"uiIconCalendarEmpty"},eventColor(){const e=this.invitedEvent&&(this.invitedEvent.color||this.invitedEvent.calendar&&this.invitedEvent.calendar.color)||"#2196F3";return this.invitedEvent&&this.$agendaUtils.toDate(this.invitedEvent.end).getTime()>Date.now()?e:this.$agendaUtils.addOpacity(e,40)},textStyle(){return this.isDatePoll?"color: #fff !important":`color: ${this.eventColor} !important`},eventStyle(){return this.isDatePoll?`background: ${this.eventColor};`:`border: 1px solid ${this.eventColor};`}},methods:{openEventDetails(){this.$root.$emit("agenda-event-details",this.invitedEvent),this.$emit("close")}}},G,[],!1,null,null,null).exports;var H=function(){var e=this,t=e._self._c;return t("v-btn",{staticClass:"text-header-title",attrs:{title:e.$t("agenda.pendingInvitations"),icon:""},on:{click:function(t){return e.openPendingInvitationsDrawer()}}},[t("v-badge",{staticClass:"pending-invitation-badge",attrs:{value:e.pendingInvitationsCount,content:e.pendingInvitationsCount,"offset-x":e.offsetX,"offset-y":e.offsetY,bordered:"",flat:"",overlap:"",top:"",right:"",color:"#F8B121"}},[t("v-icon",[e._v("fa-history")])],1)],1)};H._withStripped=!0;const W=v({props:{currentSpace:{type:Object,default:()=>null},offsetX:{type:Number,default:()=>18},offsetY:{type:Number,default:()=>22}},data:()=>({datePollsCount:0,pendingEventsCount:0,loading:0}),computed:{pendingInvitationsCount(){return this.datePollsCount+this.pendingEventsCount},spaceRetrieved(){return!eXo.env.portal.spaceId||this.currentSpace},spaceIdentityId(){return this.currentSpace&&this.currentSpace.identity&&this.currentSpace.identity.id}},watch:{currentSpace(){this.spaceRetrieved&&this.countPendingInvitations()}},created(){this.$root.$on("agenda-refresh",this.countPendingInvitations),this.$root.$on("agenda-refresh-pending",this.countPendingInvitations),this.$root.$on("agenda-event-response-sent",this.countPendingEvents),this.$root.$on("agenda-event-saved",this.countDatePolls),this.$root.$on("agenda-event-deleted",(()=>{window.setTimeout((()=>{this.countPendingInvitations()}),11e3)})),this.countPendingInvitations()},methods:{openPendingInvitationsDrawer(){this.$root.$emit("agenda-pending-date-polls-drawer-open")},countPendingInvitations(){this.countDatePolls(),this.countPendingEvents()},countDatePolls(){return this.loading++,this.$eventService.countDatePolls(this.spaceIdentityId).then((e=>this.datePollsCount=e)).finally((()=>this.loading--))},countPendingEvents(){return this.loading++,this.$eventService.countPendingEvents(this.spaceIdentityId).then((e=>this.pendingEventsCount=e)).finally((()=>this.loading--))}}},H,[],!1,null,null,null).exports;var Z=function(){var e=this;return(0,e._self._c)("agenda-recurrent-event-save-confirm-dialog",{ref:"recurrentEventConfirm",on:{"save-event":e.save,"dialog-opened":function(t){return e.$root.$emit("agenda-event-save-opened")},"dialog-closed":function(t){return e.$root.$emit("agenda-event-save-cancel")}}})};Z._withStripped=!0;const K=v({data:()=>({event:null,saving:!1}),created(){this.$root.$on("agenda-event-save",this.saveEvent)},methods:{saveEvent(e,t,n){e.occurrence&&!t?this.$refs.recurrentEventConfirm.open(e,n):this.save(e,n)},save(e,t){this.saving=!0,e.id&&t?this.$eventService.updateEventFields(e.id,{start:this.$agendaUtils.toRFC3339(e.start,!1,!0),end:this.$agendaUtils.toRFC3339(e.end,!1,!0),timeZoneId:this.$agendaUtils.USER_TIMEZONE_ID},!!e.recurrence,t).then((t=>this.saved(t||e))).catch((e=>this.$root.$emit("agenda-event-save-error",event,e))).finally((()=>{this.saving=!1})):(e.id?this.$eventService.updateEvent:this.$eventService.createEvent)(e).then((t=>this.saved(t||e))).catch((e=>this.$root.$emit("agenda-event-save-error",event,e))).finally((()=>{this.saving=!1}))},saved(e){this.$refs.recurrentEventConfirm.close(),this.$root.$emit("agenda-event-saved",e)}}},Z,[],!1,null,null,null).exports;var Q=function(){var e=this,t=e._self._c;return t("v-dialog",{ref:"eventDialog",attrs:{"retain-focus":!1,attach:e.parentDialogSelector,"content-class":"agendaEventDialog",persistent:"",fullscreen:"","hide-overlay":""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e.event&&e.dialog?[e.isForm?[e.isMobile?t("agenda-event-mobile-form",{ref:"eventForm",staticClass:"fill-height event-form",attrs:{event:e.event,"current-space":e.currentSpace,"conference-provider":e.conferenceProvider},on:{close:e.close,saved:e.saved,initialized:e.formInitialized}}):t("agenda-event-form",{ref:"eventForm",staticClass:"fill-height event-form",attrs:{settings:e.settings,event:e.event,"display-time-in-form":e.displayTimeInForm,weekdays:e.weekdays,"current-space":e.currentSpace,"working-time":e.workingTime,connectors:e.connectors,"conference-provider":e.conferenceProvider},on:{close:e.close,saved:e.saved,initialized:e.formInitialized}}),e._v(" "),t("exo-confirm-dialog",{ref:"closeConfirmDialog",attrs:{title:e.confirmCloseLabels.title,message:e.confirmCloseLabels.message,"ok-label":e.confirmCloseLabels.ok,"cancel-label":e.confirmCloseLabels.cancel,persistent:""},on:{ok:e.closeEffectively}})]:e.isTentativeEvent||e.isConfirmedEvent?t("agenda-event-details",{ref:"eventDetails",attrs:{settings:e.settings,"conference-provider":e.conferenceProvider,event:e.event,weekdays:e.weekdays,connectors:e.connectors},on:{"refresh-event":function(t){return e.openEventById(e.event.id)},close:e.close}},[t("template",{slot:"top-bar-message"},[t("v-alert",{staticClass:"mb-0",attrs:{type:e.messageType,dismissible:""},model:{value:e.hasMessage,callback:function(t){e.hasMessage=t},expression:"hasMessage"}},[e._v("\n          "+e._s(e.message)+"\n        ")])],1)],2):e._e()]:e._e()],2)};Q._withStripped=!0;const ee=v({props:{settings:{type:Object,default:()=>null},weekdays:{type:Array,default:()=>null},workingTime:{type:Object,default:()=>null},currentSpace:{type:Object,default:()=>null},currentCalendar:{type:Object,default:()=>null},connectors:{type:Array,default:()=>null},conferenceProvider:{type:Object,default:()=>null}},data:()=>({isNew:!1,dialog:!1,saving:!1,event:null,parentDialogSelector:null,loadingMessage:!1,hasMessage:null,message:null,messageType:null,originalEventString:null,isForm:!1,displayTimeInForm:!1}),computed:{isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},isModified(){return!this.saving&&this.isForm&&this.event&&this.originalEventString&&this.originalEventString!==JSON.stringify(this.event)},isConfirmedEvent(){return this.event&&"CONFIRMED"===this.event.status},isTentativeEvent(){return this.event&&"TENTATIVE"===this.event.status},confirmCloseLabels(){return{title:this.$t("agenda.title.confirmCloseEditingEvent"),message:this.$t("agenda.message.confirmCloseEditingEvent"),ok:this.$t("agenda.button.ok"),cancel:this.$t("agenda.button.cancel")}},connectedConnector(){return this.connectors&&this.connectors.find((e=>e.connected))}},watch:{dialog(){this.dialog?this.isMobile||$("body").addClass("hide-scroll"):(this.isMobile||setTimeout((()=>$("body").removeClass("hide-scroll")),200),this.event=null)}},created(){if(this.isMobile)this.parentDialogSelector="#vuetify-apps";else{const e="#left-topNavigation-container .VuetifyApp .v-application";if($(e).length)this.parentDialogSelector=e;else if($("#left-topNavigation-container").length){const t="rtl"===eXo.env.portal.orientation?"v-application--is-rtl":"v-application--is-ltr";$("#left-topNavigation-container").html(`\n              <div class="VuetifyApp">\n                <div data-app="true" class="v-application ${t} transparent theme--light">\n                </div>\n              </div>`),this.parentDialogSelector=e}}const e=document.location.search.substring(1);if(e){const t=JSON.parse(`{"${decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')}"}`),n=t.eventId&&Number(t.eventId)||0,a=t.parentId&&Number(t.parentId)||0,i=t.occurrenceId;n?this.openEventDetails(n):a&&i&&this.openEventDetails(a,i)}$(document).on("keydown",this.closeByEscape),this.$root.$on("agenda-event-form",((e,t)=>{if(this.isNew=e.id?!e.id:!e.parent||!e.parent.id,this.isNew){if(this.currentCalendar&&this.currentCalendar.acl&&!this.currentCalendar.acl.canCreate)return;this.isForm=!0,this.displayTimeInForm=!!t,this.openDialog(e),this.$nextTick().then((()=>this.$root.$emit("agenda-event-form-opened",e)))}else this.displayTimeInForm=!0,e.id?this.openEventForm(e.id):e.occurrence&&e.occurrence.id&&this.openEventForm(e.parent.id,e.occurrence.id)})),this.$root.$on("agenda-event-details",(e=>{e.id?this.openEventDetails(e.id):e.occurrence&&e.occurrence.id&&this.openEventDetails(e.parent.id,e.occurrence.id)})),this.$root.$on("agenda-event-deleted",(()=>this.close())),this.$root.$on("agenda-event-save",(()=>this.saving=!0)),this.$root.$on("agenda-event-saved",(()=>this.close())),this.$root.$on("agenda-event-response-sent",((e,t,n)=>{this.event&&(this.event.occurrence&&this.event.occurrence.id?this.$eventService.getEventOccurrence(this.event.parent.id,this.event.occurrence.id,"all,parentAll"):this.$eventService.getEventById(this.event.id,"all,parentAll")).then((e=>this.event=e)).finally((()=>{const a=e.recurrence?this.event.parent:this.event;this.$root.$emit("agenda-event-response-updated",a,t,n)}))})),this.$root.$on("agenda-event-reminders-saved",((e,t,n)=>{this.event.reminders=n,e.id&&!this.event.id&&this.$root.$emit("agenda-refresh")})),this.$root.$on("agenda-remote-event-pushed",(()=>{if(this.displayMessage("success",this.$t("agenda.eventPushedSuccess")),this.event){const e=this.event.id,t=this.event.parent&&this.event.parent.id||0,n=this.event.occurrence&&this.event.occurrence.id;e?this.openEventDetails(e):t&&n&&this.openEventDetails(t,n)}})),this.$root.$on("agenda-remote-event-push-error",((e,t)=>{console.error("Error pushing event",t),this.displayMessage("error",this.$t("agenda.errorPushingEvent"))}))},methods:{closeByEscape(e){"Escape"===e.key&&this.dialog&&this.close(e)},formInitialized(){this.originalEventString=JSON.stringify(this.event)},openEventForm(e,t){this.isForm=!0,this.openEventById(e,t)},openEventDetails(e,t){return this.isForm=!1,this.openEventById(e,t)},openEventById(e,t){return e?(t?this.$eventService.getEventOccurrence(e,t,"all,parentAll"):this.$eventService.getEventById(e,"all,parentAll",!0)).then((e=>{if(e&&("TENTATIVE"===e.status||"CONFIRMED"===e.status))return e.startDate=this.$agendaUtils.toDate(e.start),e.endDate=this.$agendaUtils.toDate(e.end),this.openDialog(e),this.isForm?this.$nextTick().then((()=>this.$root.$emit("agenda-event-form-opened",e))):this.$nextTick().then((()=>this.$root.$emit("agenda-event-details-opened",e))),e})):Promise.resolve(null)},openDialog(e){this.saving=!1,e||(e={}),e.calendar||(e.calendar={}),e.calendar.owner||(e.calendar.owner={}),e.reminders||(e.reminders=[]),e.attachments||(e.attachments=[]),e.attendees||(e.attendees=[]),this.event=e;let t=`${window.location.pathname}`;this.event.id?t=`${t}?eventId=${this.event.id}`:this.event.parent&&this.event.parent.id&&this.event.occurrence&&this.event.occurrence.id&&(t=`${t}?parentId=${this.event.parent.id}&occurrenceId=${this.event.occurrence.id}`),window.history.replaceState("",window.document.title,t),this.dialog=!0},close(e){this.isModified?this.$refs.closeConfirmDialog&&(e&&(e.preventDefault(),e.stopPropagation()),this.$refs.closeConfirmDialog.dialog?this.$nextTick(this.$refs.closeConfirmDialog.close):this.$nextTick(this.$refs.closeConfirmDialog.open)):(e&&(e.preventDefault(),e.stopPropagation()),this.closeEffectively())},closeEffectively(){$("#tiptip_holder").mouseleave(),this.dialog=!1,window.history.replaceState("",window.document.title,window.location.pathname)},displayMessage(e,t){this.messageType=e,this.message=t,this.hasMessage=!0,window.setTimeout((()=>this.hasMessage=!1),5e3)}}},Q,[],!1,null,null,null).exports;var te=function(){var e=this,t=e._self._c;return t("v-card",{staticClass:"d-flex flex-column",attrs:{flat:""}},[e.event?t("v-stepper",{staticClass:"d-flex flex-grow-1 flex-column",model:{value:e.stepper,callback:function(t){e.stepper=t},expression:"stepper"}},[t("v-stepper-header",{staticClass:"flex-grow-0 no-box-shadow border-bottom-color border-box-sizing"},[t("div",{staticClass:"d-flex flex-grow-1"},[t("v-stepper-step",{attrs:{complete:e.stepper>1,step:"1"}},[t("small",{staticClass:"primary--text title"},[e._v("\n            "+e._s(e.$t("agenda.stepEventDetails"))+"\n          ")])]),e._v(" "),t("v-divider",{staticClass:"eventFormStepperDivider"}),e._v(" "),t("v-stepper-step",{attrs:{step:"2"}},[t("small",{staticClass:"title",class:e.stepper>1?"primary--text":""},[e._v("\n            "+e._s(e.$t("agenda.stepEventChooseDate"))+"\n          ")])])],1),e._v(" "),t("v-btn",{staticClass:"my-auto me-2",attrs:{color:"grey",icon:"",dark:""},on:{click:e.close}},[t("v-icon",[e._v("\n          mdi-close\n        ")])],1)],1),e._v(" "),t("v-stepper-items",{staticClass:"flex-grow-1"},[t("v-stepper-content",{attrs:{step:"1"}},[t("agenda-event-form-basic-information",{ref:"eventBasicInformation",attrs:{event:e.event,"display-time-in-form":e.displayTimes,settings:e.settings,connectors:e.connectors,"conference-provider":e.conferenceProvider,"selected-calendar":e.selectedCalendar,"current-space":e.currentSpace},on:{"next-step":e.nextStep,initialized:function(t){return e.$emit("initialized")}}})],1),e._v(" "),t("v-stepper-content",{staticClass:"pb-0",attrs:{step:"2"}},[2===e.stepper?t("agenda-event-form-dates",{ref:"eventDates",attrs:{settings:e.settings,event:e.event,connectors:e.connectors,weekdays:e.weekdays,"working-time":e.workingTime},on:{"date-option-added":e.updateDateOptionsLength,"date-option-deleted":e.updateDateOptionsLength}}):e._e()],1)],1)],1):e._e(),e._v(" "),t("v-divider"),e._v(" "),t("div",{staticClass:"d-flex flex-grow-0 my-2"},[e.stepper>1?t("v-btn",{staticClass:"btn mx-2",on:{click:e.previousStep}},[t("v-icon",[e._v(e._s(e.$vuetify.rtl?"mdi-chevron-right":"mdi-chevron-left"))]),e._v(" "),t("span",{staticClass:"d-none d-md-inline"},[e._v("\n        "+e._s(e.$t("agenda.button.previous"))+"\n      ")])],1):e._e(),e._v(" "),t("div",{staticClass:"ms-auto me-10"},[e.displaySaveButton?t("v-btn",{staticClass:"btn btn-primary me-2",attrs:{disabled:e.disableSaveButton},on:{click:e.saveEvent}},[e._v("\n        "+e._s(e.saveButtonLabel)+"\n      ")]):e._e(),e._v(" "),e.stepper<2?t("v-btn",{class:e.nextStepClass,attrs:{disabled:e.disableNextStepButton},on:{click:e.nextStep}},[e._v("\n        "+e._s(e.stepButtonLabel)+"\n      ")]):e._e(),e._v(" "),t("v-btn",{staticClass:"btn ms-2",on:{click:e.close}},[e._v("\n        "+e._s(e.$t("agenda.button.cancel"))+"\n      ")])],1)],1),e._v(" "),t("agenda-notification-alerts",{attrs:{name:"event-form"}})],1)};te._withStripped=!0;const ne=v({props:{settings:{type:Object,default:()=>null},event:{type:Object,default:()=>({})},displayTimeInForm:{type:Boolean,default:!1},weekdays:{type:Array,default:()=>null},workingTime:{type:Object,default:()=>null},currentSpace:{type:Object,default:()=>null},connectors:{type:Array,default:()=>null},conferenceProvider:{type:Object,default:()=>null}},data:()=>({eventDateOptionsLength:0,selectedCalendar:null,stepper:0}),computed:{eventTitle(){return this.event&&this.event.summary},eventTitleValid(){return this.eventTitle&&this.eventTitle.length>=5&&this.eventTitle.length<1024},eventCalendar(){return this.event&&this.event.calendar},eventOwner(){return this.eventCalendar&&this.eventCalendar.owner},eventOwnerValid(){return this.eventOwner&&(this.eventOwner.id||this.eventOwner.remoteId&&this.eventOwner.providerId)},eventDescription(){return this.event&&this.event.description||""},eventDescriptionValid(){return this.eventDescription.length<=1300},eventDateOptions(){return this.event&&this.event.dateOptions||[]},displayTimes(){return this.displayTimeInForm&&1===this.eventDateOptionsLength},displaySaveButton(){return this.displayTimeInForm||this.stepper>1},disableSaveButton(){return!this.eventTitleValid||!this.eventOwnerValid||!this.eventDescriptionValid||0===this.eventDateOptionsLength},disableNextStepButton(){return!this.eventTitleValid||!this.eventOwnerValid||!this.eventDescriptionValid},nextStepClass(){return this.displayTimeInForm?"btn":"btn btn-primary"},stepButtonLabel(){return this.displayTimeInForm?this.$t("agenda.alternativeDates"):this.$t("agenda.button.continue")},saveButtonLabel(){return this.eventDateOptionsLength>1?this.$t("agenda.label.schedule"):this.event.id||this.event.parent?this.$t("agenda.label.save"):this.$t("agenda.label.create")}},watch:{event(){this.$agendaUtils.initEventForm(this.event)},eventDateOptionsLength(e,t){e!==t&&(1===e&&t>1?this.$root.$emit("agenda-notification-alert",{message:this.$t("agenda.datePollSwitchedToEvent"),type:"info"},"event-form"):1===t&&e>1&&this.$root.$emit("agenda-notification-alert",{message:this.$t("agenda.eventSwitchedToDatePoll"),type:"info"},"event-form"))},eventDateOptions(){this.eventDateOptionsLength=this.event.dateOptions.length},eventOwner(){!this.eventOwner||!this.eventOwner.remoteId||this.selectedCalendar&&this.selectedCalendar.owner&&this.selectedCalendar.owner.remoteId===this.eventOwner.remoteId?this.eventOwner&&this.eventOwner.remoteId||(this.selectedCalendar=null):this.$identityService.getIdentityByProviderIdAndRemoteId(this.eventOwner.providerId,this.eventOwner.remoteId).then((e=>{if(e)return this.$calendarService.getCalendars(0,1,!1,[Number(e.id)])})).then((e=>{this.selectedCalendar=e&&e.calendars.length&&e.calendars[0]||null}))},stepper(){this.$agendaUtils.initEventForm(this.event),this.eventDateOptionsLength=this.event.dateOptions.length,this.$nextTick((()=>{this.$refs.eventBasicInformation&&this.$refs.eventBasicInformation.reset()}))}},mounted(){this.reset()},methods:{close(){this.$emit("close")},updateDateOptionsLength(){this.eventDateOptionsLength=this.event.dateOptions.length},reset(){this.eventCalendar&&this.eventCalendar.acl?this.selectedCalendar=this.eventCalendar:this.selectedCalendar=null,this.$agendaUtils.initEventForm(this.event),this.eventDateOptionsLength=this.event.dateOptions.length,this.stepper=0,this.$nextTick().then((()=>this.stepper=1)),this.$forceUpdate()},previousStep(){this.stepper--,this.$forceUpdate()},saveEvent(){this.event.start=this.event.startDate&&this.$agendaUtils.toRFC3339(this.event.startDate)||this.$agendaUtils.toRFC3339(new Date),this.event.end=this.event.endDate&&this.$agendaUtils.toRFC3339(this.event.endDate)||this.$agendaUtils.toRFC3339(new Date),this.event.calendar.owner.id=this.selectedCalendar.owner.id,this.$root.$emit("agenda-event-save",this.event)},nextStep(){this.stepper>1?this.saveEvent():1===this.stepper?this.$refs.eventBasicInformation.validateForm()&&this.stepper++:this.stepper=1}}},te,[],!1,null,null,null).exports;var ae=function(){var e=this,t=e._self._c;return t("v-form",{ref:"agendaEventForm",staticClass:"flex",attrs:{flat:""},on:{submit:function(t){return e.$emit("next-step")}}},[t("div",{staticClass:"d-flex flex-column flex-md-row"},[t("label",{staticClass:"create-event-label float-left mt-5 me-6 text-subtitle-1 d-none d-md-inline"},[e._v("\n      "+e._s(e.$t("agenda.label.create"))+"\n    ")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.event.summary,expression:"event.summary"}],ref:"eventTitle",staticClass:"ignore-vuetify-classes my-3",attrs:{id:"eventTitle",placeholder:e.$t("agenda.eventTitle"),type:"text",name:"title",required:""},domProps:{value:e.event.summary},on:{change:e.resetCustomValidity,input:function(t){t.target.composing||e.$set(e.event,"summary",t.target.value)}}}),e._v(" "),t("label",{staticClass:"mt-5 ms-4 me-4 text-subtitle-1 font-weight-bold d-none d-md-inline"},[e._v("\n      "+e._s(e.$t("agenda.label.in"))+"\n    ")]),e._v(" "),t("agenda-event-form-calendar-owner",{ref:"calendarOwner",attrs:{event:e.event,"current-space":e.currentSpace},on:{initialized:function(t){return e.$emit("initialized")}}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-column flex-md-row mt-1 event-form-body"},[t("div",{staticClass:"d-flex flex-column flex-grow-1 event-form-body-left"},[e.displayTimeInForm&&e.eventDateOption?t("div",{staticClass:"d-flex flex-row"},[t("i",{staticClass:"uiIconClock darkGreyIcon uiIcon32x32 mt-4 me-11"}),e._v(" "),t("agenda-event-form-date-pickers",{staticClass:"event-form-datetimes my-4",attrs:{event:e.eventDateOption},on:{changed:e.updateEventDates,initialized:e.formInitialized}})],1):e._e(),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("i",{staticClass:"uiIconLocation darkGreyIcon uiIcon32x32 mt-4 me-11"}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.event.location,expression:"event.location"}],ref:"eventLocation",staticClass:"ignore-vuetify-classes my-3 location-event-input",attrs:{id:"eventLocation",placeholder:e.$t("agenda.eventLocation"),type:"text",name:"locationEvent"},domProps:{value:e.event.location},on:{input:function(t){t.target.composing||e.$set(e.event,"location",t.target.value)}}})]),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("i",{staticClass:"uiIconRecurrence darkGreyIcon uiIcon32x32 my-auto me-11"}),e._v(" "),t("div",{staticClass:"d-flex flex-column"},[t("agenda-event-form-recurrence",{staticClass:"my-auto",attrs:{event:e.event}}),e._v(" "),e.hasRecurrence?t("agenda-event-recurrence",{staticClass:"text-wrap ms-2",attrs:{event:e.event}}):e._e()],1)]),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("i",{staticClass:"uiIconVideo darkGreyIcon uiIcon32x32 uiIcon32x32 my-3 me-11"}),e._v(" "),t("div",{staticClass:"d-flex flex-column"},[t("agenda-event-form-conference",{staticClass:"my-auto",attrs:{event:e.event,settings:e.settings,"current-space":e.currentSpace,"conference-provider":e.conferenceProvider}})],1)]),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("v-flex",{staticClass:"flex-grow-0"},[t("i",{staticClass:"uiIconDescription darkGreyIcon uiIcon32x32 my-3 me-11"})]),e._v(" "),t("extended-textarea",{ref:"eventDescription",staticClass:"pt-2",attrs:{id:"eventDescription",placeholder:e.$t("agenda.descriptionPlaceholder"),"max-length":e.eventDescriptionTextLength},model:{value:e.event.description,callback:function(t){e.$set(e.event,"description",t)},expression:"event.description"}})],1)]),e._v(" "),t("div",{staticClass:"d-none d-md-flex flex-column mx-5 event-form-body-divider"},[t("v-divider",{attrs:{vertical:""}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-column flex-grow-1 event-form-body-right"},[t("div",{staticClass:"d-flex flex-row"},[t("v-flex",{staticClass:"flex-grow-0 me-2 mt-1"},[t("i",{staticClass:"uiIconGroup darkGreyIcon uiIcon32x32 my-3"})]),e._v(" "),t("agenda-event-form-attendees",{staticClass:"ms-4",attrs:{event:e.event},on:{initialized:function(t){return e.$emit("initialized")}}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("label",{staticClass:"switch-label-text mt-1 text-subtitle-1 font-weight-bold"},[e._v(e._s(e.$t("agenda.modifyEventPermission")))]),e._v(" "),t("v-switch",{ref:"allowAttendeeToUpdateRef",staticClass:"mt-0 ms-4",attrs:{disabled:!e.canInviteeEdit},model:{value:e.event.allowAttendeeToUpdate,callback:function(t){e.$set(e.event,"allowAttendeeToUpdate",t)},expression:"event.allowAttendeeToUpdate"}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-row font-weight-regular"},[e._v("\n        "+e._s(e.$t("agenda.modifyEventPermissionDescription"))+"\n      ")])])])])};ae._withStripped=!0;const ie=v({props:{event:{type:Object,default:()=>({})},displayTimeInForm:{type:Boolean,default:!1},currentSpace:{type:Object,default:()=>null},selectedCalendar:{type:Object,default:()=>null},settings:{type:Object,default:()=>null},conferenceProvider:{type:Object,default:()=>null}},data:()=>({eventDescriptionTextLength:1300,canInviteeEdit:!0,eventDateOption:null}),computed:{allowAttendeeToUpdate(){return this.event.allowAttendeeToUpdate},hasRecurrence(){return this.event.recurrence||this.event.parent&&this.event.parent.recurrence},eventDateOptions(){return this.event&&this.event.dateOptions||[]}},watch:{displayTimeInForm(){this.reset()},eventDateOptions(){this.reset()},allowAttendeeToUpdate(){this.allowAttendeeToUpdate&&(this.event.allowAttendeeToInvite=!0)},selectedCalendar(){this.canInviteeEdit=!this.selectedCalendar||!this.selectedCalendar.acl||this.selectedCalendar.acl.canInviteeEdit,!this.canInviteeEdit&&this.selectedCalendar&&(this.event.allowAttendeeToUpdate=!1,this.$forceUpdate())},canInviteeEdit(){!this.canInviteeEdit&&this.selectedCalendar&&(this.event.allowAttendeeToUpdate=!1,this.$forceUpdate())}},created(){this.$root.$once("agenda-event-form-opened",(()=>{this.$nextTick().then(this.resetCustomValidity)}))},mounted(){window.setTimeout((()=>{this.$refs.eventTitle&&this.$refs.eventTitle.focus()}),500)},methods:{reset(){this.eventDateOption=null,this.$nextTick().then((()=>{this.eventDateOption=1===this.event.dateOptions.length&&this.event.dateOptions[0]||this.event}))},resetCustomValidity(){this.$refs.eventTitle&&this.$refs.eventTitle.setCustomValidity(""),this.$refs.calendarOwner&&this.$refs.calendarOwner.resetCustomValidity()},updateEventDates(){this.event.startDate=new Date(this.eventDateOption.startDate),this.event.endDate=new Date(this.eventDateOption.endDate),this.event.start=this.$agendaUtils.toRFC3339(this.event.startDate),this.event.end=this.$agendaUtils.toRFC3339(this.event.endDate),this.event.dateOptions&&1===this.event.dateOptions.length&&(this.event.dateOptions[0].startDate=new Date(this.event.startDate),this.event.dateOptions[0].endDate=new Date(this.event.endDate),this.event.dateOptions[0].start=this.event.start,this.event.dateOptions[0].end=this.event.end)},validateForm(){if(this.resetCustomValidity(),this.$refs.calendarOwner.validateForm(),this.event.summary?(this.event.summary.length<5||this.event.summary.length>1024)&&this.$refs.eventTitle.setCustomValidity(this.$t("agenda.message.missingLengthEventTitle")):this.$refs.eventTitle.setCustomValidity(this.$t("agenda.message.missingEventTitle")),this.$refs.agendaEventForm.validate()&&this.$refs.agendaEventForm.$el.reportValidity())return!0}}},ae,[],!1,null,null,null).exports;var se=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"quickAddEventDrawer",staticClass:"quickAddEventDrawer",attrs:{"confirm-close-labels":e.confirmCloseLabels,"confirm-close":e.eventChanged,right:"","body-classes":"hide-scroll decrease-z-index-more"},on:{closed:e.cancelEventCreation}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("agenda.title.addEvent"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[e.event?t("v-form",{ref:"agendaEventForm",staticClass:"flex event-form quick-add",attrs:{flat:""},on:{submit:e.createEvent}},[t("div",{staticClass:"d-flex flex-column flex-grow-1"},[t("div",{staticClass:"d-flex flex-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.event.summary,expression:"event.summary"}],ref:"eventTitle",staticClass:"ignore-vuetify-classes my-3",attrs:{id:"eventTitle",placeholder:e.$t("agenda.eventTitle"),type:"text",name:"title",required:"",autofocus:""},domProps:{value:e.event.summary},on:{change:e.resetCustomValidity,input:function(t){t.target.composing||e.$set(e.event,"summary",t.target.value)}}})]),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("v-flex",{staticClass:"flex-grow-0"},[t("i",{staticClass:"uiIconPLFEventTask darkGreyIcon uiIcon32x32 mt-4 mx-3"})]),e._v(" "),t("agenda-event-form-calendar-owner",{ref:"calendarOwner",staticClass:"ms-1 pe-1",attrs:{event:e.event,"current-space":e.currentSpace},on:{initialized:e.formInitialized}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("v-flex",{staticClass:"flex-grow-0 pt-4 my-2 mx-3"},[t("i",{staticClass:"uiIconClock darkGreyIcon uiIcon32x32"})]),e._v(" "),t("agenda-event-form-date-pickers",{staticClass:"pt-3 my-4 me-3",attrs:{event:e.event},on:{changed:e.updateEventDates,initialized:e.formInitialized}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("i",{staticClass:"uiIconLocation darkGreyIcon uiIcon32x32 mt-4 mx-3"}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.event.location,expression:"event.location"}],ref:"eventLocation",staticClass:"ignore-vuetify-classes my-3 location-event-input",attrs:{id:"eventLocation",placeholder:e.$t("agenda.eventLocation"),type:"text",name:"locationEvent"},domProps:{value:e.event.location},on:{input:function(t){t.target.composing||e.$set(e.event,"location",t.target.value)}}})]),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("v-flex",{staticClass:"flex-grow-0 my-auto mx-3"},[t("i",{staticClass:"uiIconVideo darkGreyIcon uiIcon32x32"})]),e._v(" "),e.isConferenceEnabled?t("agenda-event-form-conference",{staticClass:"me-3",attrs:{event:e.event,settings:e.settings,"current-space":e.currentSpace,"conference-provider":e.conferenceProvider}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.conferenceURL,expression:"conferenceURL"}],ref:"eventConference",staticClass:"ignore-vuetify-classes my-3 location-event-input",attrs:{id:"eventConference",placeholder:e.$t("agenda.webConferenceURL"),type:"text",name:"locationEvent"},domProps:{value:e.conferenceURL},on:{input:function(t){t.target.composing||(e.conferenceURL=t.target.value)}}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("v-flex",{staticClass:"flex-grow-0"},[t("i",{staticClass:"uiIconGroup darkGreyIcon uiIcon32x32 mt-4 mx-3"})]),e._v(" "),t("agenda-event-form-attendees",{staticClass:"pe-1",attrs:{event:e.event},on:{initialized:e.formInitialized}})],1)])]):e._e()],1),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex"},[t("v-btn",{staticClass:"btn ms-2",on:{click:e.close}},[e._v("\n        "+e._s(e.$t("agenda.button.cancel"))+"\n      ")]),e._v(" "),t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn ms-2",on:{click:e.openCompleteEventForm}},[e._v("\n        "+e._s(e.$t("agenda.button.moreDetails"))+"\n      ")]),e._v(" "),t("v-btn",{staticClass:"btn btn-primary ms-2",attrs:{disabled:e.disableSaveButton},on:{click:e.createEvent}},[e._v("\n        "+e._s(e.$t("agenda.button.save"))+"\n      ")])],1)])],2)};se._withStripped=!0;const re=v({props:{currentSpace:{type:Object,default:()=>null},currentCalendar:{type:Object,default:()=>null},settings:{type:Object,default:()=>null},conferenceProvider:{type:Object,default:()=>null}},data:()=>({event:null,originalEventString:null,saving:!1,conferenceURL:null}),computed:{confirmCloseLabels(){return{title:this.$t("agenda.title.confirmCloseEditingEvent"),message:this.$t("agenda.message.confirmCloseEditingEvent"),ok:this.$t("agenda.button.ok"),cancel:this.$t("agenda.button.cancel")}},eventChanged(){return!this.saving&&this.event&&this.originalEventString&&this.originalEventString!==JSON.stringify(this.event)},eventTitle(){return this.event&&this.event.summary},eventTitleValid(){return this.eventTitle&&this.eventTitle.length>=5&&this.eventTitle.length<1024},eventOwner(){return this.event&&this.event.calendar&&this.event.calendar.owner},eventOwnerValid(){return this.eventOwner&&(this.eventOwner.id||this.eventOwner.remoteId&&this.eventOwner.providerId)},disableSaveButton(){return this.saving||!this.eventTitleValid||!this.eventOwnerValid},isConferenceEnabled(){return this.conferenceProvider&&this.conferenceProvider.getType()}},watch:{conferenceURL(e){this.event.conferences=e?[{url:e,type:"manual"}]:[]},eventOwner(e){e&&e.providerId&&this.$identityService.getIdentityByProviderIdAndRemoteId(e.providerId,e.remoteId).then((e=>{this.event.calendar.owner.id=e.id}))}},created(){this.$root.$on("agenda-event-quick-form",(e=>{this.event=null,this.$nextTick().then((()=>{this.event=e,this.event.timeZoneId||(this.event.timeZoneId=this.$agendaUtils.USER_TIMEZONE_ID),this.open(),this.$nextTick().then((()=>this.$root.$emit("agenda-event-form-opened",this.event)))}))}))},methods:{close(){this.conferenceURL=null,this.$refs.quickAddEventDrawer.close()},open(){this.currentCalendar&&this.currentCalendar.acl&&!this.currentCalendar.acl.canCreate||(this.resetCustomValidity(),this.$refs.quickAddEventDrawer.open(),window.setTimeout((()=>{this.$refs.eventTitle&&this.$refs.eventTitle.focus()}),500))},formInitialized(){this.originalEventString=JSON.stringify(this.event)},openCompleteEventForm(){this.event.start=this.$agendaUtils.toRFC3339(this.event.startDate),this.event.end=this.$agendaUtils.toRFC3339(this.event.endDate),this.$root.$emit("agenda-event-form",this.event,!0),this.cancelEventCreation(),this.$nextTick((()=>this.$refs.quickAddEventDrawer.close()))},resetCustomValidity(){this.$refs.eventTitle&&this.$refs.eventTitle.setCustomValidity(""),this.$refs.calendarOwner&&this.$refs.calendarOwner.resetCustomValidity()},updateEventDates(e){e.startDate=new Date(e.startDate),e.endDate=new Date(e.endDate)},validateForm(){if(this.resetCustomValidity(),this.$refs.calendarOwner.validateForm(),this.event.summary?(this.event.summary.trim().length<5||this.event.summary.trim().length>1024)&&this.$refs.eventTitle.setCustomValidity(this.$t("agenda.message.missingLengthEventTitle")):this.$refs.eventTitle.setCustomValidity(this.$t("agenda.message.missingEventTitle")),this.$refs.agendaEventForm.validate()&&this.$refs.agendaEventForm.$el.reportValidity())return!0},cancelEventCreation(){this.event=null,this.$root.$emit("agenda-event-quick-form-cancel")},createEvent(){this.validateForm()&&(this.saving=!0,this.event.start=this.$agendaUtils.toRFC3339(this.event.startDate),this.event.end=this.$agendaUtils.toRFC3339(this.event.endDate),delete this.event.startDate,delete this.event.endDate,this.$eventService.createEvent(this.event).then((e=>{this.$root.$emit("agenda-event-saved",e),this.close()})).finally((()=>this.saving=!1)))}}},se,[],!1,null,null,null).exports;var oe=function(){var e=this,t=e._self._c;return t("v-flex",{staticClass:"event-form-dates d-flex flex-column"},[t("v-toolbar",{staticClass:"border-color mb-4",attrs:{"max-height":"64",flat:""}},[t("div",{staticClass:"d-flex flex-row align-start col-sm-3 col-2"},[t("agenda-connector-status",{staticClass:"my-auto",attrs:{connectors:e.connectors}},[t("template",{slot:"connectButton"},[t("v-btn",{staticClass:"btn"},[t("i",{staticClass:"uiIconHyperlink me-2 darkGreyIcon"}),e._v("\n            "+e._s(e.$t("agenda.connectYourPersonalAgenda"))+"\n          ")])],1)],2),e._v(" "),e.loading?t("v-progress-circular",{staticClass:"ms-3 my-auto",attrs:{indeterminate:"",color:"primary",size:"20"}}):e._e()],1),e._v(" "),t("v-row",{staticClass:"row d-flex flex-row flex-nowrap col-sm-6 col-8",attrs:{align:"center",justify:"center"}},[t("v-btn",{attrs:{icon:""},on:{click:e.prevDate}},[t("i",{staticClass:"uiIconArrowLeft uiIconMedium darkGreyIcon"})]),e._v(" "),t("div",{staticClass:"period-title text-uppercase"},[e._v("\n        "+e._s(e.periodTitle)+"\n      ")]),e._v(" "),t("v-btn",{attrs:{icon:"",color:"grey darken-2"},on:{click:e.nextDate}},[t("i",{staticClass:"uiIconArrowRight uiIconMedium darkGreyIcon"})])],1),e._v(" "),t("agenda-time-zone-select-box",{staticClass:"align-end my-auto col-sm-3 col-2",attrs:{event:e.event}})],1),e._v(" "),t("v-calendar",{ref:"calendar",attrs:{events:e.eventsToDisplay,"event-color":e.getEventColor,"event-timed":e.isEventTimed,weekdays:e.weekdays,"interval-style":e.agendaIntervalStyle,"event-ripple":!1,locale:e.lang,"event-name":"summary","event-start":"startDate","event-end":"endDate",color:"primary",type:"week"},on:{"click:event":e.cancelClick,"mousedown:event":e.cancelClick,"mousedown:day":e.startTime,"mousemove:day":e.mouseMove,"mouseup:day":e.endDrag,"mousedown:time":e.startTime,"mousemove:time":e.mouseMove,"mouseup:time":e.endDrag,change:e.retrieveEvents},scopedSlots:e._u([{key:"event",fn:function(n){return[n.event&&"remoteEvent"===n.event.type?t("agenda-connector-remote-event-item",{attrs:{"remote-event":n.event,avatar:e.connectedConnectorAvatar}}):t("div",{staticClass:"readonly-event",class:n.event.dateOption?"editing-event":""},[t("p",{staticClass:"text-truncate my-auto ms-2 caption font-weight-bold d-flex",attrs:{title:n.event.summary}},[t("span",{staticClass:"text-truncate me-auto"},[e._v(e._s(n.event.summary))]),e._v(" "),n.event.dateOption?t("v-icon",{staticClass:"my-auto py-0 pe-0",attrs:{color:"white",size:"18"},on:{click:function(t){return e.deleteDateOption(n)}}},[e._v("\n            close\n          ")]):e._e()],1),e._v(" "),n.event.allDay||e.isShortEvent(n)?e._e():t("div",{staticClass:"d-flex"},[t("date-format",{staticClass:"ms-2",attrs:{value:n.event.startDate,format:e.timeFormat}}),e._v(" "),t("strong",{staticClass:"mx-1"},[e._v("-")]),e._v(" "),t("date-format",{staticClass:"me-2",attrs:{value:n.event.endDate,format:e.timeFormat}})],1)])]}},{key:"day-body",fn:function(n){return[t("div",{staticClass:"v-current-time",class:{today:n.present},style:e.currentTimeStyle})]}}]),model:{value:e.dayToDisplay,callback:function(t){e.dayToDisplay=t},expression:"dayToDisplay"}}),e._v(" "),t("agenda-connectors-drawer",{attrs:{connectors:e.connectors}})],1)};oe._withStripped=!0;const le=v({props:{settings:{type:Object,default:()=>null},connectors:{type:Array,default:()=>null},event:{type:Object,default:()=>null},weekdays:{type:Array,default:()=>null},workingTime:{type:Object,default:()=>null}},data:()=>({periodTitle:"",loading:!1,lang:eXo.env.portal.language,dragEvent:null,dragStart:null,createEvent:null,createStart:null,extendOriginal:null,dayToDisplay:Date.now(),dateTimeFormat:{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},timeFormat:{hour:"2-digit",minute:"2-digit"},currentTimeTop:null,scrollToTimeTop:null,newStartedEvent:null,period:{},remoteEvents:[],spaceEvents:[],displayedEvents:[]}),computed:{eventsToDisplay(){const e=[];return this.displayedEvents.forEach((t=>{if(t.endDate&&t.endDate.toString().indexOf("00:00:00")>=0){const n=JSON.parse(JSON.stringify(t));n.startDate=this.$agendaUtils.toDate(t.startDate),n.endDate=this.$agendaUtils.toDate(t.endDate),n.endDate=new Date(n.endDate.getTime()-6e4),e.push(n)}else e.push(t)})),e},nowTimeOptions(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes()}},currentTimeStyle(){return`top: ${this.currentTimeTop}px;`},connectedConnector(){return this.connectors.find((e=>e.connected))},connectedConnectorAvatar(){return this.connectedConnector&&this.connectedConnector.avatar||""},spaceEventsToDisplay(){return this.spaceEvents&&this.spaceEvents.filter((e=>!this.isSameEvent(e)))||[]},remoteEventsToDisplay(){const e=this.remoteEvents&&this.remoteEvents.slice()||[];return this.spaceEvents.length&&e.length&&this.spaceEvents.forEach((t=>{const n=e.findIndex((e=>e.id&&e.id===t.remoteId||e.recurringEventId&&e.recurringEventId===t.remoteId));n>=0&&e.splice(n,1)})),e}},watch:{displayedEvents(){window.setTimeout((()=>{this.adjustEditingEventsZIndex()}),200)},connectedConnector(){this.retrieveRemoteEvents()}},created(){this.event.timeZoneId||(this.event.timeZoneId=this.$agendaUtils.USER_TIMEZONE_ID),this.$agendaUtils.initEventForm(this.event,!0),this.$root.$emit("agenda-connectors-init")},mounted(){this.$refs.calendar&&(this.currentTimeTop=this.$refs.calendar.timeToY(this.nowTimeOptions)),this.scrollToEvent()},methods:{adjustEditingEventsZIndex(){$("div:has(>.editing-event)").css("z-index","1")},scrollToEvent(){const e=this.event.dateOptions&&this.event.dateOptions.length&&this.event.dateOptions[0]||this.event,t=e&&e.startDate||Date.now(),n=this.$agendaUtils.toDate(t);this.scrollToTimeTop=this.$refs.calendar.timeToY({hour:n.getHours(),minute:n.getMinutes()}),this.dayToDisplay=n.getTime(),this.$refs.calendar.updateTimes(),this.scrollToTime()},scrollToTime(){this.$nextTick().then((()=>{const e=document.querySelector(".v-calendar-daily__scroll-area");if(e){const t=this.scrollToTimeTop-e.offsetHeight/2;e.scrollTo(0,t)}}))},deleteDateOption(e){const t=e.event,n=this.event.dateOptions.indexOf(t);n>=0&&(this.event.dateOptions.splice(n,1),this.$emit("date-option-deleted"),this.$nextTick().then((()=>{this.refreshEventsToDisplay(),this.$refs.calendar.updateTimes(),this.$forceUpdate()})))},cancelClick({nativeEvent:e}){e.stopPropagation(),e.preventDefault()},startTime(e){const t=this.$agendaUtils.toDateTime(e),n=t+this.$agendaUtils.MINIMUM_TIME_INTERVAL_MS,a={dateOption:!0,eventId:this.event.id,summary:this.event.summary,color:this.getEventColor(this.event,!0),occurrence:this.event.occurrence,parent:{id:this.event.parent&&this.event.parent.id},allDay:!e.hasTime,startDate:t,endDate:n};this.newStartedEvent=a,this.event.dateOptions.push(a),this.$emit("date-option-added"),this.$nextTick().then((()=>{this.refreshEventsToDisplay(),this.$refs.calendar.updateTimes(),this.$forceUpdate()}))},mouseMove(e){if(this.newStartedEvent){const t=this.$agendaUtils.toDateTime(e);let n=this.$agendaUtils.roundTime(t);this.newStartedEvent.endDate!==n&&this.$nextTick().then((()=>{this.refreshEventsToDisplay()})),n-this.newStartedEvent.startDate<this.$agendaUtils.MINIMUM_TIME_INTERVAL_MS&&(n=this.newStartedEvent.startDate+this.$agendaUtils.MINIMUM_TIME_INTERVAL_MS),this.newStartedEvent.endDate=n,this.$refs.calendar.updateTimes(),this.$forceUpdate()}},endDrag(){this.newStartedEvent&&(this.newStartedEvent.start=this.$agendaUtils.toRFC3339(this.newStartedEvent.startDate),this.newStartedEvent.end=this.$agendaUtils.toRFC3339(this.newStartedEvent.endDate),this.newStartedEvent=null,this.$nextTick().then((()=>{this.refreshEventsToDisplay(),this.$refs.calendar.updateTimes(),this.$forceUpdate()})))},isShortEvent(e){const t=e&&e.event||e;return!(t&&t.startDate&&t.endDate)||this.$agendaUtils.isShortEvent(t)},isSameEvent(e){return e===this.event||e.id&&e.id===this.event.id||e.eventId&&e.eventId===this.event.id||e.parent&&this.event.parent&&e.parent.id===this.event.parent.id&&e.occurrence&&this.event.occurrence&&e.occurrence.id===this.event.occurrence.id},getEventColor(e,t){const n=e&&(e.color||e.calendar&&e.calendar.color)||"#2196F3";return t||e.dateOption||this.isSameEvent(e)?n:this.$agendaUtils.addOpacity(n,40)},isEventTimed:e=>e&&!e.allDay,nextDate(){this.$refs.calendar&&this.$refs.calendar.next()},prevDate(){this.$refs.calendar&&this.$refs.calendar.prev()},retrieveEvents(e){e&&(this.retrievePeriod(e),this.retrieveEventsFromStore(),this.retrieveRemoteEvents()),this.$forceUpdate()},retrievePeriod(e){e.end=JSON.parse(JSON.stringify(e.end)),e.end.hour=23,e.end.minute=59,e.start.hour=0,e.start.minute=0,this.period=this.$agendaUtils.convertVuetifyRangeToPeriod(e),this.period&&(this.period.title=this.$refs.calendar.title,this.periodTitle=this.$agendaUtils.generateCalendarTitle("week",this.$agendaUtils.toDate(this.period.start),this.period.title,this.$t("agenda.week")))},agendaIntervalStyle(e){if(this.workingTime.showWorkingTime){const t=0===e.weekday||6===e.weekday||e.time<this.workingTime.workingTimeStart||e.time>=this.workingTime.workingTimeEnd,n=0===e.minute,a=this.dark,i=a?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)";return{backgroundColor:t?a?"rgba(0,0,0,0.4)":"rgba(0,0,0,0.05)":null,borderTop:n?null:`1px dashed ${i}`}}return null},retrieveRemoteEvents(){if(this.connectedConnector){const e=this.$agendaUtils.toRFC3339(this.period.start,!1,!0),t=this.$agendaUtils.toRFC3339(this.period.end,!1,!0);this.loading=!0,this.connectedConnector.getEvents(e,t).then((e=>{e.forEach((e=>{this.$agendaUtils.convertDates(e)})),this.remoteEvents=e,this.loading=!1})).catch((e=>{console.error("Error retrieving remote events",e),this.loading=!1})).finally((()=>this.refreshEventsToDisplay()))}else this.remoteEvents=[],this.refreshEventsToDisplay()},retrieveEventsFromStore(){const e="myEvents"===this.eventType&&eXo.env.portal.userIdentityId||null,t=this.event&&this.event.calendar&&this.event.calendar.owner;let n=null;n=t&&t.remoteId&&t.providerId?this.$identityService.getIdentityByProviderIdAndRemoteId(t.providerId,t.remoteId):Promise.resolve(t),n.then((t=>{const n=t&&t.id?[t.id]:[];return this.$eventService.getEvents(null,n,e,this.$agendaUtils.toRFC3339(this.period.start,!0),this.$agendaUtils.toRFC3339(this.period.end),this.limit,null)})).then((e=>{const t=e&&e.events||[];return t.forEach((e=>{e.name=e.summary,this.$agendaUtils.convertDates(e)})),this.spaceEvents=t,this.$nextTick()})).catch((e=>{console.error("Error retrieving events",e)})).finally((()=>this.refreshEventsToDisplay()))},refreshEventsToDisplay(){const e=this.event.dateOptions||[];this.displayedEvents=[...e,...this.spaceEventsToDisplay,...this.remoteEventsToDisplay]}}},oe,[],!1,null,null,null).exports;var ce=function(){var e=this,t=e._self._c;return e.event?t("div",{staticClass:"d-flex flex-column flex-grow-1"},[e._t("startDateLabel"),e._v(" "),t("div",{staticClass:"d-flex flex-row flex-grow-1"},[e.startDate?t("date-picker",{staticClass:"flex-grow-1 my-auto",attrs:{top:e.datePickerTop},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}}):e._e(),e._v(" "),e.event.allDay?e._e():t("div",{staticClass:"d-flex flex-row flex-grow-0"},[e._t("startDateTime"),e._v(" "),t("time-picker",{staticClass:"event-time-picker",model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})],2)],1),e._v(" "),e._t("endDateLabel"),e._v(" "),t("div",{staticClass:"d-flex flex-row",class:!e.$slots.endDateLabel&&"mt-4"},[e.endDate?t("date-picker",{staticClass:"flex-grow-1 my-auto",attrs:{top:e.datePickerTop,"min-value":e.minimumEndDate},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}}):e._e(),e._v(" "),e.event.allDay?e._e():t("div",{staticClass:"flex-grow-0"},[e._t("endTimeLabel"),e._v(" "),t("time-picker",{staticClass:"event-time-picker",attrs:{min:e.minimumEndTime},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],2)],1),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("v-switch",{attrs:{label:e.$t("agenda.allDay")},model:{value:e.event.allDay,callback:function(t){e.$set(e.event,"allDay",t)},expression:"event.allDay"}})],1)],2):e._e()};ce._withStripped=!0;const de=v({props:{event:{type:Object,default:()=>null},eventStart:{type:String,default:()=>"startDate"},eventEnd:{type:String,default:()=>"endDate"},datePickerTop:{type:Boolean,default:!1}},data:()=>({startDate:null,startTime:null,endDate:null,endTime:null,duration:null}),computed:{minimumEndDate(){return this.startDate?new Date(this.startDate):null},minimumEndTime(){return this.startDate&&this.endDate&&this.startTime&&this.endTime&&this.$agendaUtils.areDatesOnSameDay(this.startDate,this.endDate)?new Date(this.startTime.getTime()+18e5):null}},watch:{event(e,t){t||this.reset()},startDate(e,t){if(!this.event||!e||!t||new Date(e).getTime()===new Date(t).getTime())return;const n=this.$agendaUtils.toDate(this.startDate),a=this.$agendaUtils.toDate(this.event.startDate),i=n.getDate();a.setDate(1),a.setMonth(n.getMonth()),a.setFullYear(n.getFullYear()),a.setDate(i),this.event.startDate=a,this.event.start=this.$agendaUtils.toRFC3339(this.event.startDate),this.endDate=this.$agendaUtils.toDate(a.getTime()+this.duration),this.endTime=this.$agendaUtils.toDate(a.getTime()+this.duration)},startTime(e,t){if(!this.event||!e||!t||new Date(e).getTime()===new Date(t).getTime())return;const n=this.$agendaUtils.toDate(this.event.startDate);n.setHours(this.startTime.getHours()),n.setMinutes(this.startTime.getMinutes()),n.setSeconds(0),this.event.startDate=n,this.event.start=this.$agendaUtils.toRFC3339(this.event.startDate),this.endDate=this.$agendaUtils.toDate(n.getTime()+this.duration),this.endTime=this.$agendaUtils.toDate(n.getTime()+this.duration)},endDate(e,t){if(!this.event||!e||!t||new Date(e).getTime()===new Date(t).getTime())return;const n=this.$agendaUtils.toDate(this.endDate),a=this.$agendaUtils.toDate(this.event.endDate);a.setFullYear(n.getFullYear()),a.setDate(n.getDate()),a.setMonth(n.getMonth()),this.event.endDate=a,this.event.end=this.$agendaUtils.toRFC3339(this.event.endDate),this.duration=a.getTime()-this.$agendaUtils.toDate(this.event.startDate).getTime(),this.endTime&&(this.endTime=new Date(this.endTime),this.endTime.setFullYear(a.getFullYear()),this.endTime.setMonth(a.getMonth()),this.endTime.setDate(a.getDate()))},endTime(e,t){if(!this.event||!e||!t||new Date(e).getTime()===new Date(t).getTime())return;const n=this.$agendaUtils.toDate(this.event.endDate);n.setHours(this.endTime.getHours()),n.setMinutes(this.endTime.getMinutes()),n.setSeconds(0),this.event.endDate=n,this.event.end=this.$agendaUtils.toRFC3339(this.event.endDate),this.duration=n.getTime()-this.$agendaUtils.toDate(this.event.startDate).getTime(),this.$emit("changed",this.event)}},mounted(){this.reset()},methods:{reset(){this.event&&(this.startDate=null,this.startTime=null,this.endDate=null,this.endTime=null,this.$nextTick().then((()=>{this.event.startDate||(this.event.startDate=new Date),this.event.endDate||(this.event.endDate=new Date),this.startDate=this.$agendaUtils.toDate(this.event.startDate).getTime(),this.startTime=this.$agendaUtils.toDate(this.event.startDate),this.endDate=this.$agendaUtils.toDate(this.event.endDate).getTime(),this.endTime=this.$agendaUtils.toDate(this.event.endDate),this.duration=this.endTime.getTime()-this.startTime.getTime()})))}}},ce,[],!1,null,null,null).exports;var ve=function(){var e=this,t=e._self._c;return t("v-list",{staticClass:"flex-grow-1 d-flex flex-column pa-0"},[e._l(e.event.reminders,(function(n,a){return t("v-list-item",{key:a,staticClass:"ps-0"},[t("label",{staticClass:"subtitle-1 float-left me-4"},[e._v(e._s(e.$t("agenda.label.notifyMe")))]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:n.before,expression:"reminder.before"}],ref:"timeNotification",refInFor:!0,staticClass:"subtitle-1 ignore-vuetify-classes my-3 time-notification",attrs:{type:"number",name:"timeNotification",required:"",numeric:""},domProps:{value:n.before},on:{input:function(t){t.target.composing||e.$set(n,"before",t.target.value)}}}),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:n.beforePeriodType,expression:"reminder.beforePeriodType"}],staticClass:"width-auto my-auto ms-4 pe-2 subtitle-1 ignore-vuetify-classes notification-date-option",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(n,"beforePeriodType",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:"MINUTE"}},[e._v(e._s(e.$t("agenda.option.minutes")))]),e._v(" "),t("option",{attrs:{value:"HOUR"}},[e._v(e._s(e.$t("agenda.option.hours")))]),e._v(" "),t("option",{attrs:{value:"DAY"}},[e._v(e._s(e.$t("agenda.option.days")))]),e._v(" "),t("option",{attrs:{value:"WEEK"}},[e._v(e._s(e.$t("agenda.option.weeks")))])]),e._v(" "),t("span",{staticClass:"subtitle-1 ms-4"},[e._v(e._s(e.$t("agenda.label.beforeStart")))]),e._v(" "),t("v-btn",{attrs:{color:"grey",icon:"",dark:""},on:{click:function(t){return e.removeReminder(a)}}},[t("v-icon",[e._v("\n        mdi-close\n      ")])],1)],1)})),e._v(" "),t("v-list-item",{staticClass:"ps-0 my-auto"},[t("a",{staticClass:"text-subtitle-1 font-weight-regular add-notification-link",on:{click:e.addReminder}},[e._v(e._s(e.$t("agenda.addReminder")))])])],2)};ve._withStripped=!0;const ue=v({props:{event:{type:Object,default:()=>({})}},methods:{addReminder(){this.event.reminders.push({before:10,beforePeriodType:"MINUTE"})},removeReminder(e){this.event.reminders.splice(e,1)}}},ve,[],!1,null,null,null).exports;var he=function(){var e=this,t=e._self._c;return t("v-tabs",{staticClass:"text-capitalize",attrs:{"align-with-title":"",centered:""},model:{value:e.calendarType,callback:function(t){e.calendarType=t},expression:"calendarType"}},[t("v-tab",{attrs:{href:"#day",dark:""}},[e._v("\n    "+e._s(e.$t("agenda.label.viewDay"))+"\n  ")]),e._v(" "),t("v-tab",{attrs:{href:"#week",dark:""}},[e._v("\n    "+e._s(e.$t("agenda.label.viewWeek"))+"\n  ")]),e._v(" "),t("v-tab",{attrs:{href:"#month",dark:""}},[e._v("\n    "+e._s(e.$t("agenda.label.viewMonth"))+"\n  ")])],1)};he._withStripped=!0;const pe=v({props:{calendarType:{type:String,default:null}},watch:{calendarType(e,t){t&&this.$root.$emit("agenda-change-period-type",this.calendarType)}}},he,[],!1,null,null,null).exports;var me=function(){var e=this,t=e._self._c;return t("v-list",[e._l(e.attachments,(function(n){return t("agenda-event-form-attachment-item",{key:n.id||n.uploadId,attrs:{attachment:n,"upload-progress":n&&n.control&&n.control.uploadProgress},on:{deleteFile:e.deleteFile}})})),e._v(" "),t("v-list-item",[e.attachments.length<e.maxFilesCount?t("a",{staticClass:"text-subtitle-1 font-weight-regular attach-file-link",on:{click:e.openUploadWindow}},[e._v("\n      "+e._s(e.$t("agenda.attachFile"))+"\n    ")]):e._e(),e._v(" "),t("div",{staticClass:"hidden"},[t("input",{ref:"uploadInput",staticClass:"file",staticStyle:{display:"none"},attrs:{name:"file",type:"file",multiple:"multiple"},on:{change:function(t){return e.handleFileUpload(e.$refs.uploadInput.files)}}})])]),e._v(" "),e.errors.length?t("v-list-item",{staticClass:"flex-column"},e._l(e.errors,(function(n,a){return t("v-alert",{key:a,attrs:{type:"error"}},[e._v("\n      "+e._s(n)+"\n    ")])})),1):e._e()],2)};me._withStripped=!0;const ge=v({props:{event:{type:Object,default:()=>({})}},data:()=>({maxFilesCount:5,maxFileSize:10,errors:[]}),computed:{attachments(){return this.event.attachments||[]}},methods:{openUploadWindow(){this.$refs.uploadInput.click()},handleFileUpload:function(e){if(!e||!e.length)return;const t=1024*this.maxFileSize*1024;for(const n of e){if(this.event.attachments.length>=this.maxFilesCount){const e=this.$t("agenda.maxFilesAttachementsExceeded",{0:this.maxFilesCount,1:n.name});this.addError(e);continue}if(n.size>t){const e=this.$t("agenda.maxFileSizeExceeded",{0:n.name,1:this.maxFileSize});this.addError(e);continue}const e=`${Math.round(1e3*Math.random())}-${Date.now()}`,a={name:n.name,size:n.size,mimeType:n.type,uploadId:e};this.event.attachments.push(a);const i=new AbortController,s=i.signal;a.control={uploaded:!1,uploadId:e,file:n,controller:i,signal:s},a.control.uploadProgress=0,this.uploadFile(a)}},deleteFile(e){const t=this.event.attachments.indexOf(e);t>=0&&(this.event.attachments.splice(t,1),e.control&&e.control.uploadProgress<100&&e.control.controller&&(e.control.controller.abort(),this.$uploadService.deleteUpload(e.uploadId)))},uploadFile(e){const t=e.control;t.uploaded=!0,this.$uploadService.upload(t.file,t.uploadId,t.signal).catch((t=>{this.addError(t),this.deleteFile(e)})),this.controlUpload(e)},controlUpload(e){window.setTimeout((()=>{this.$uploadService.getUploadProgress(e.uploadId).then((t=>{e.control.uploadProgress=Number(t),e.control.uploadProgress<100?this.controlUpload(e):window.setTimeout((()=>{delete e.control}),1e3),this.$forceUpdate()})).catch((t=>{this.addError(t),this.deleteFile(e)}))}),200)},addError(e){this.errors.push(String(e)),window.setTimeout((()=>{const t=this.errors.indexOf(e);t>=0&&this.errors.splice(t,1)}),5e3)}}},me,[],!1,null,null,null).exports;var fe=function(){var e=this,t=e._self._c;return t("v-list-item",{staticClass:"d-flex flex-row"},[t("i",{class:e.getIconClassFromFileMimeType}),e._v(" "),t("div",{staticClass:"d-flex flex-column ms-2"},[t("a",{staticClass:"my-auto",attrs:{href:e.attachment.url||""}},[e._v(e._s(e.attachment.name)+" ("+e._s(e.formattedFileSize)+")")]),e._v(" "),e.attachment.control&&e.uploadProgress<100?t("v-progress-linear",{staticClass:"my-auto",attrs:{value:e.uploadProgress}}):e._e()],1),e._v(" "),t("v-btn",{attrs:{color:"grey",icon:"",dark:""},on:{click:function(t){return e.$emit("deleteFile",e.attachment)}}},[t("v-icon",[e._v("\n      mdi-close\n    ")])],1)],1)};fe._withStripped=!0;const ye=v({props:{attachment:{type:Object,default:null},uploadProgress:{type:Number,default:null}},data:()=>({megabyte:1048576,kilobyte:1024}),computed:{formattedFileSize(){if(this.attachment.size<this.megabyte){const e=Number(this.attachment.size/this.kilobyte).toFixed(2);return this.$t("agenda.sizeInKB",{0:e})}{const e=Number(this.attachment.size/this.megabyte).toFixed(2);return this.$t("agenda.sizeInMB",{0:e})}},getIconClassFromFileMimeType(){if(this.attachment){const e=this.attachment.mimeType.replace(/\./g,"").replace("/","").replace("\\","");return this.attachment.mimeType?`uiIcon32x32${this.attachment.mimeType.replace(/[/.]/g,"")}`:`uiIconFileType${e} uiIconFileTypeDefault`}return""}}},fe,[],!1,null,null,null).exports;var $e=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.recurrenceType,expression:"recurrenceType"}],staticClass:"subtitle-1 my-auto ignore-vuetify-classes",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.recurrenceType=t.target.multiple?n:n[0]}}},e._l(e.recurrenceOptions,(function(n){return t("option",{key:n.value,domProps:{value:n.value}},[e._v("\n      "+e._s(n.text)+"\n    ")])})),0),e._v(" "),"CUSTOM"===e.recurrenceType?t("v-btn",{staticClass:"ms-2 my-auto",attrs:{icon:"",small:""},on:{click:e.openCustomRecurrenceForm}},[t("i",{staticClass:"uiIcon uiIconEdit primary--text"})]):e._e(),e._v(" "),t("agenda-event-form-recurrence-drawer",{ref:"customRecurrentEventDrawer",on:{apply:e.applyCustomEventRecurrence,cancel:e.cancelCustomEventRecurrence}})],1)};$e._withStripped=!0;const Ce=v({props:{event:{type:Object,default:()=>null}},data:()=>({recurrenceType:"NO_REPEAT"}),computed:{recurrenceOptions(){const e=this.dayNumberInMonth,t=this.localizedMonthFromDate,n=this.localizedDayNamefromDate;return[{text:this.$t("agenda.doNotRepeat"),value:"NO_REPEAT"},{text:this.$t("agenda.daily"),value:"DAILY"},{text:this.$t("agenda.workingWeekDay"),value:"WEEK_DAYS"},{text:this.$t("agenda.weekly",{0:n}),value:"WEEKLY"},{text:this.$t("agenda.monthly",{0:e}),value:"MONTHLY"},{text:this.$t("agenda.yearly",{0:t,1:e}),value:"YEARLY"},{text:this.$t("agenda.custom"),value:"CUSTOM"}]},localizedDayNamefromDate(){const e=this.event.start;return this.$agendaUtils.getDayNameFromDate(e,eXo.env.portal.language)},localizedMonthFromDate(){const e=this.event.start;return this.$agendaUtils.getMonthFromDate(e,eXo.env.portal.language)},startDate(){return this.event.startDate?new Date(this.event.startDate):this.event.start?this.$agendaUtils.toDate(this.event.start):new Date},dayNamefromDate(){return this.$agendaUtils.getDayNameFromDate(this.startDate)},monthFromDate(){return this.$agendaUtils.getMonthFromDate(this.startDate)},monthNumberFromDate(){return this.$agendaUtils.getMonthNumberFromDate(this.startDate)},dayNumberInMonth(){return this.startDate.getDate()}},watch:{recurrenceType(e,t){e&&t&&e!==t&&("CUSTOM"===this.recurrenceType?this.openCustomRecurrenceForm():"NO_REPEAT"===this.recurrenceType?(this.event.recurrence=null,this.event.parent&&(this.event.parent.recurrence=null)):(this.event.recurrence={type:this.recurrenceType,frequency:this.recurrenceType,interval:1},"WEEK_DAYS"===this.recurrenceType?(this.event.recurrence.frequency="WEEKLY",this.event.recurrence.byDay=["MO","TU","WE","TH","FR"]):"WEEKLY"===this.recurrenceType?this.event.recurrence.byDay=[this.dayNamefromDate.substring(0,2).toUpperCase()]:"MONTHLY"===this.recurrenceType?this.event.recurrence.byMonthDay=[this.dayNumberInMonth]:"YEARLY"===this.recurrenceType&&(this.event.recurrence.byMonthDay=[this.dayNumberInMonth],this.event.recurrence.byMonth=[this.monthNumberFromDate])))}},created(){this.$root.$on("agenda-event-form-opened",(()=>{this.$nextTick().then((()=>this.reset()))}))},methods:{applyCustomEventRecurrence(e){this.$set(this.event,"recurrence",JSON.parse(JSON.stringify(e))),this.event.recurrence.type="CUSTOM"},cancelCustomEventRecurrence(){this.event.recurrence&&"CUSTOM"!==this.event.recurrence.type&&this.reset()},reset(){this.resetRecurrenceType()},resetRecurrenceType(){this.recurrenceType=null,this.$nextTick().then((()=>{const e=this.event&&this.event.recurrence||this.event.parent&&this.event.parent.recurrence;this.recurrenceType=e&&e.type||"NO_REPEAT",this.$forceUpdate()}))},openCustomRecurrenceForm(){let e=null;const t=this.event&&this.event.recurrence||this.event.parent&&this.event.parent.recurrence;e=t?JSON.parse(JSON.stringify(t)):{frequency:"WEEKLY",interval:1,byDay:["SU","MO","TU","WE","TH","FR","SA"]},this.$refs.customRecurrentEventDrawer.open(e)}}},$e,[],!1,null,null,null).exports;var _e=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"customRecurrentEventDrawer",staticClass:"customRecurrentEventDrawer",attrs:{right:"","body-classes":"hide-scroll"},on:{closed:function(t){return e.$emit("cancel")}}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("agenda.title.addEventRecurrent"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("form",{ref:"form",staticClass:"ma-5"},[t("div",{staticClass:"flex d-flex flex-row"},[t("label",{staticClass:"text-subtitle-1 my-auto"},[e._v("\n          "+e._s(e.$t("agenda.label.repeatEvery"))+"\n        ")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.eventRecurrence.interval,expression:"eventRecurrence.interval"}],staticClass:"recurrenceInterval ignore-vuetify-classes my-auto recurrence-interval mx-4",attrs:{type:"Number",min:"1",name:"recurrenceInterval",autofocus:"",required:""},domProps:{value:e.eventRecurrence.interval},on:{input:function(t){t.target.composing||e.$set(e.eventRecurrence,"interval",t.target.value)}}}),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.eventRecurrence.frequency,expression:"eventRecurrence.frequency"}],staticClass:"flex-end ignore-vuetify-classes width-auto my-auto",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.eventRecurrence,"frequency",t.target.multiple?n:n[0])}}},[t("option",{attrs:{value:"DAILY"}},[e._v(e._s(e.$t("agenda.day")))]),e._v(" "),t("option",{attrs:{value:"WEEKLY"}},[e._v(e._s(e.$t("agenda.week")))]),e._v(" "),t("option",{attrs:{value:"MONTHLY"}},[e._v(e._s(e.$t("agenda.month")))]),e._v(" "),t("option",{attrs:{value:"YEARLY"}},[e._v(e._s(e.$t("agenda.year")))])])]),e._v(" "),"WEEKLY"===e.eventRecurrence.frequency?t("div",{staticClass:"d-flex flex-column recurrenceDays mt-4"},[t("label",{staticClass:"float-left text-subtitle-1 d-none d-md-inline"},[e._v("\n          "+e._s(e.$t("agenda.label.repeatOn"))+"\n        ")]),e._v(" "),t("v-chip-group",{staticClass:"mx-auto",attrs:{"show-arrows":!1,"next-icon":"","prev-icon":"","active-class":"primary white--text",multiple:"",mandatory:""},model:{value:e.eventRecurrence.byDay,callback:function(t){e.$set(e.eventRecurrence,"byDay",t)},expression:"eventRecurrence.byDay"}},e._l(e.days,(function(n){return t("v-chip",{key:n.value,staticClass:"me-1",attrs:{value:n.value}},[t("span",{staticClass:"text-uppercase"},[e._v("\n              "+e._s(n.text)+"\n            ")])])})),1)],1):e._e(),e._v(" "),t("div",{staticClass:"control-group"},[t("div",{staticClass:"d-flex flex-column mt-3"},[t("div",{staticClass:"control-label text-subtitle-1"},[e._v(e._s(e.$t("agenda.label.endRepeat"))+":")]),e._v(" "),t("div",{staticClass:"controls ms-5"},[t("v-radio-group",{model:{value:e.recurrentEventDate,callback:function(t){e.recurrentEventDate=t},expression:"recurrentEventDate"}},[t("v-radio",{staticClass:"py-2",attrs:{label:e.$t("agenda.label.never"),value:"never"}}),e._v(" "),t("v-radio",{attrs:{value:"count"}},[t("template",{slot:"label"},[t("div",{staticClass:"d-flex flex-row align-center"},[t("div",{staticClass:"flex-grow-0"},[e._v("\n                      "+e._s(e.$t("agenda.label.after"))+"\n                    ")]),e._v(" "),t("div",{staticClass:"ps-5 pe-2"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.eventRecurrence.count,expression:"eventRecurrence.count"}],staticClass:"recurrenceCount ignore-vuetify-classes",attrs:{disabled:"count"!==e.recurrentEventDate,type:"Number",min:"1",required:""},domProps:{value:e.eventRecurrence.count},on:{input:function(t){t.target.composing||e.$set(e.eventRecurrence,"count",t.target.value)}}})]),e._v(" "),t("div",{staticClass:"ps-0"},[e._v("\n                      "+e._s(e.$t("agenda.label.events"))+"\n                    ")])])])],2),e._v(" "),t("v-radio",{attrs:{value:"date"}},[t("template",{slot:"label"},[t("div",{staticClass:"d-flex flex-row align-center"},[t("div",{staticClass:"flex-grow-0"},[e._v("\n                      "+e._s(e.$t("agenda.label.untilDate"))+"\n                    ")]),e._v(" "),t("div",{staticClass:"ps-5 pe-2"},[t("date-picker",{attrs:{disabled:"date"!==e.recurrentEventDate},model:{value:e.untilDate,callback:function(t){e.untilDate=t},expression:"untilDate"}})],1)])])],2)],1)],1)])])])]),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex"},[t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn ms-2",on:{click:e.close}},[e._v("\n        "+e._s(e.$t("agenda.button.cancel"))+"\n      ")]),e._v(" "),t("v-btn",{staticClass:"btn btn-primary ms-2",on:{click:e.apply}},[e._v("\n        "+e._s(e.$t("agenda.button.apply"))+"\n      ")])],1)])],2)};_e._withStripped=!0;const we=v({data:()=>({eventRecurrence:{},recurrentEventDate:"never",untilDate:null}),computed:{eventRecurrenceByDay(){return this.eventRecurrence&&this.eventRecurrence.byDay},days(){return[{text:this.getWeekDayLabel(0),value:"SU"},{text:this.getWeekDayLabel(1),value:"MO"},{text:this.getWeekDayLabel(2),value:"TU"},{text:this.getWeekDayLabel(3),value:"WE"},{text:this.getWeekDayLabel(4),value:"TH"},{text:this.getWeekDayLabel(5),value:"FR"},{text:this.getWeekDayLabel(6),value:"SA"}]}},watch:{eventRecurrenceByDay(){this.$root.$forceUpdate()},recurrentEventDate(){"date"===this.recurrentEventDate?this.eventRecurrence.count="":"count"===this.recurrentEventDate?(this.eventRecurrence.count=1,this.eventRecurrence.until=null):(this.eventRecurrence.until=null,this.eventRecurrence.count="")}},methods:{getWeekDayLabel(e){const t=new Date(`2020-11-0${e+1}`).toLocaleDateString(eXo.env.portal.language,{weekday:"short"});return t.length>3?t.substring(0,3):t},apply(){this.$refs.form.reportValidity()&&("date"===this.recurrentEventDate?(this.eventRecurrence.until=this.$agendaUtils.toRFC3339(this.untilDate),this.eventRecurrence.count=""):"count"===this.recurrentEventDate?this.eventRecurrence.until=null:(this.eventRecurrence.until=null,this.eventRecurrence.count=""),this.$emit("apply",this.eventRecurrence),this.$refs.customRecurrentEventDrawer.close())},close(){this.$refs.customRecurrentEventDrawer.close()},open(e){this.eventRecurrence=e||{},this.eventRecurrence.until?(this.recurrentEventDate="date",this.untilDate=this.$agendaUtils.toDate(this.eventRecurrence.until),this.eventRecurrence.count=null):this.eventRecurrence.count>0?(this.recurrentEventDate="count",this.eventRecurrence.count||(this.eventRecurrence.count=1),this.eventRecurrence.until=null):(this.recurrentEventDate="never",this.eventRecurrence.until=null,this.eventRecurrence.count=null),this.$refs.customRecurrentEventDrawer.open()}}},_e,[],!1,null,null,null).exports;var De=function(){var e=this,t=e._self._c;return t("v-flex",{staticClass:"user-suggester text-truncate"},[t("form",{ref:"form",on:{keypress:function(t){return e.checkGuestInvitation(t)}}},[t("exo-identity-suggester",{ref:"invitedAttendeeAutoComplete",attrs:{labels:e.participantSuggesterLabels,title:e.suggesterStatus,disabled:e.disableAttendeeSuggester,"ignore-items":e.ignoredMembers,"search-options":e.searchOptions,name:"inviteAttendee","no-redactor-space":"","include-users":"","include-spaces":""},model:{value:e.invitedAttendee,callback:function(t){e.invitedAttendee=t},expression:"invitedAttendee"}}),e._v(" "),e.disableAttendeeSuggester?t("span",{staticClass:"error--text"},[e._v("\n      "+e._s(e.$t("agenda.suggesterRequired"))+"\n    ")]):e._e()],1),e._v(" "),e.displayAlert?t("agenda-notification-alerts",{attrs:{name:"event-form"}}):e._e(),e._v(" "),e.event.attendees?t("div",{staticClass:"identitySuggester no-border mt-0"},e._l(e.event.attendees,(function(n){return t("agenda-event-form-attendee-item",{key:n.identity.id,attrs:{attendee:n,creator:e.event.creator},on:{"remove-attendee":e.removeAttendee}})})),1):e._e()],1)};De._withStripped=!0;const be=v({props:{event:{type:Object,default:()=>({})}},data:()=>({currentUser:null,invitedAttendee:[]}),computed:{searchOptions(){return{currentUser:"",spaceURL:this.event&&this.event.calendar&&this.event.calendar.owner&&this.event.calendar.owner.remoteId}},participantSuggesterLabels(){return{searchPlaceholder:this.$t("agenda.searchPlaceholder"),placeholder:this.$t("agenda.addParticipants"),noDataLabel:this.$t("agenda.noDataLabel")}},ignoredMembers(){return this.event.attendees.map((e=>`${e.identity.providerId}:${e.identity.remoteId}`))},disableAttendeeSuggester(){return!(this.event.calendar&&this.event.calendar.owner&&this.event.calendar.owner.remoteId)},suggesterStatus(){return this.disableAttendeeSuggester?this.$t("agenda.suggesterRequired.tooltip"):""}},watch:{currentUser(){this.reset()},invitedAttendee(){this.invitedAttendee?(this.event.attendees||(this.event.attendees=[]),this.event.attendees.find((e=>e.identity.remoteId===this.invitedAttendee.remoteId&&e.identity.providerId===this.invitedAttendee.providerId))||this.event.attendees.push({identity:this.$suggesterService.convertSuggesterItemToIdentity(this.invitedAttendee)}),this.invitedAttendee=null):this.$nextTick(this.$refs.invitedAttendeeAutoComplete.$refs.selectAutoComplete.deleteCurrentItem)}},mounted(){this.reset(),this.$userService.getUser(eXo.env.portal.userName).then((e=>{this.currentUser=e,this.$root.$emit("current-user",this.currentUser)}))},methods:{reset(){this.event.id||this.event.occurrence||this.event.attendees&&this.event.attendees.length||(this.currentUser?this.event.attendees=[{identity:{id:eXo.env.portal.userIdentityId,providerId:"organization",remoteId:eXo.env.portal.userName,profile:{avatar:this.currentUser.avatar,fullname:this.currentUser.fullname,external:"true"===this.currentUser.external}}}]:this.event.attendees=[]),this.$emit("initialized")},removeAttendee(e){const t=this.event.attendees.findIndex((t=>e.identity.remoteId===t.identity.remoteId&&e.identity.providerId===t.identity.providerId));t>=0&&this.event.attendees.splice(t,1)},checkGuestInvitation(e){const t=this;$("form").on("focusout",(function(e){setTimeout((function(){e.delegateTarget.contains(document.activeElement)||t.saveGuestEmail(e)}),1)})),"Enter"==e.key&&(e.preventDefault(),this.saveGuestEmail(e)),"32"==e.keyCode&&this.saveGuestEmail(e)},saveGuestEmail(){const e=this.$refs.invitedAttendeeAutoComplete.searchTerm,t=null!==e?e.split(" "):"",n=t[t.length-1];/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,24}))$/.test(n)&&this.event.attendees.push({identity:{id:`${n}`,remoteId:n,identityId:n,providerId:"GUEST_USER",profile:{fullName:n,avatarUrl:"/portal/rest/v1/social/users/default-image/avatar"}}}),this.$refs.invitedAttendeeAutoComplete.clear()}}},De,[],!1,null,null,null).exports;var Ee=function(){var e=this,t=e._self._c;return t("v-chip",{staticClass:"identitySuggesterItem me-4 mt-4",attrs:{close:e.canRemoveAttendee},on:{"click:close":function(t){return e.$emit("remove-attendee",e.attendee)}}},[t("v-avatar",{attrs:{left:""}},[t("v-img",{attrs:{src:e.avatarUrl}})],1),e._v(" "),t("span",{staticClass:"text-truncate"},[e._v("\n    "+e._s(e.displayName)+"\n  ")])],1)};Ee._withStripped=!0;const xe=v({props:{attendee:{type:Object,default:()=>({})},creator:{type:Object,default:()=>({})}},computed:{canRemoveAttendee(){return this.creator&&this.creator.id?Number(this.attendee.identity.id)!==Number(this.creator.id):Number(this.attendee.identity.id)!==Number(eXo.env.portal.userIdentityId)},avatarUrl(){const e=this.attendee.identity&&(this.attendee.identity.profile||this.attendee.identity.space);return e&&(e.avatarUrl||e.avatar||"/portal/rest/v1/social/users/default-image/avatar")},displayName(){const e=this.attendee.identity&&(this.attendee.identity.profile||this.attendee.identity.space),t=e&&(e.displayName||e.fullname||e.fullName);return this.isExternal?`${t} (${this.$t("profile.External")})`:t},isExternal(){const e=this.attendee.identity&&this.attendee.identity.profile;return e&&(e.dataEntity&&"true"===e.dataEntity.external||e.external)}}},Ee,[],!1,null,null,null).exports;var Te=function(){var e=this;return(0,e._self._c)("exo-identity-suggester",{ref:"calendarOwnerSuggester",staticClass:"user-suggester calendarOwnerAutocomplete",attrs:{labels:e.calendarSuggesterLabels,"include-users":!1,disabled:e.currentSpace,width:220,name:"calendarOwnerAutocomplete","include-spaces":"","only-redactor":"",required:""},model:{value:e.calendarOwner,callback:function(t){e.calendarOwner=t},expression:"calendarOwner"}})};Te._withStripped=!0;const Ie=v({props:{event:{type:Object,default:()=>({})},currentSpace:{type:Object,default:()=>null}},data:()=>({calendarOwner:null,currentUser:null}),computed:{calendarSuggesterLabels(){return{searchPlaceholder:this.$t("agenda.searchPlaceholder"),placeholder:this.$t("agenda.chooseCalendar"),noDataLabel:this.$t("agenda.noDataLabel")}}},watch:{calendarOwner(){this.resetCustomValidity(),this.calendarOwner?(this.event.calendar.owner={remoteId:this.calendarOwner.remoteId,providerId:this.calendarOwner.providerId},this.calendarOwner.profile&&(this.event.calendar.owner.profile={avatarUrl:this.calendarOwner.profile.avatarUrl,fullName:this.calendarOwner.profile.fullName})):(this.event.calendar.owner=null,this.currentUser&&(this.event.attendees=[{identity:{id:eXo.env.portal.userIdentityId,providerId:"organization",remoteId:eXo.env.portal.userName,profile:{avatar:this.currentUser.avatar,fullname:this.currentUser.fullname}}}]))}},mounted(){this.$root.$once("agenda-event-form-opened",(()=>{this.$nextTick().then((()=>this.reset()))})),this.$root.$on("current-user",(e=>{this.currentUser=e}))},methods:{resetCustomValidity(){this.$refs.calendarOwnerSuggester&&this.$refs.calendarOwnerSuggester.$el.querySelector("input").setCustomValidity("")},validateForm(){this.resetCustomValidity(),(!this.$refs.calendarOwnerSuggester||this.event.calendar.owner)&&(this.event.calendar.owner.id||this.event.calendar.owner.providerId&&this.event.calendar.owner.remoteId)||this.$refs.calendarOwnerSuggester.$el.querySelector("input").setCustomValidity(this.$t("agenda.message.missingSpaceName"))},reset(){this.event.id||this.event.occurrence||this.event.calendar&&this.event.calendar.owner&&(this.event.calendar.owner.id||this.event.calendar.owner.remoteId&&this.event.calendar.owner.providerId)?(this.calendarOwner=this.$suggesterService.convertIdentityToSuggesterItem(this.event.calendar.owner),window.setTimeout((()=>{this.$refs.calendarOwnerSuggester&&(this.$refs.calendarOwnerSuggester.items=[this.calendarOwner]),this.$emit("initialized")}),200)):(this.currentSpace?(this.calendarOwner=this.event.calendar.owner={id:`space:${this.currentSpace.prettyName}`,remoteId:this.currentSpace.prettyName,providerId:"space",profile:{avatarUrl:this.currentSpace.avatarUrl,fullName:this.currentSpace.displayName}},this.$refs.calendarOwnerSuggester&&(this.$refs.calendarOwnerSuggester.items=[this.calendarOwner])):(this.$refs.calendarOwnerSuggester&&(this.$refs.calendarOwnerSuggester.items=[]),this.calendarOwner={}),this.$emit("initialized")),this.$forceUpdate()}}},Te,[],!1,null,null,null).exports;var Ae=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex flex-row"},[e.isConferenceEnabled?t("div",{staticClass:"d-flex flex-row my-auto"},[e.eventConference?[e.eventConferenceUrl?t("div",{directives:[{name:"autolinker",rawName:"v-autolinker",value:e.eventConferenceUrl,expression:"eventConferenceUrl"}],staticClass:"my-auto"}):t("v-chip",{staticClass:"my-auto",attrs:{color:"primary",outlined:""}},[t("span",{staticClass:"primary--text"},[e._v("\n          "+e._s(e.$t("agenda.webConferenceScheduled"))+"\n        ")])]),e._v(" "),t("v-btn",{staticClass:"ms-auto",attrs:{loading:e.loading,title:e.$t("agenda.deleteEventConference"),color:"grey",icon:"",dark:""},on:{click:e.deleteCallURL}},[t("v-icon",[e._v("\n          mdi-close\n        ")])],1)]:t("v-btn",{staticClass:"btn btn-primary border-radius my-auto",attrs:{loading:e.loading},on:{click:e.createCallUrl}},[e._v("\n      "+e._s(e.$t("agenda.createEventConference"))+"\n    ")])],2):t("div",{staticClass:"d-flex flex-row my-auto"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.conferenceURL,expression:"conferenceURL"}],ref:"eventCallURL",staticClass:"ignore-vuetify-classes my-3 location-event-input",attrs:{id:"eventCallURL",placeholder:e.$t("agenda.webConferenceURL"),type:"text",name:"locationEvent"},domProps:{value:e.conferenceURL},on:{input:function(t){t.target.composing||(e.conferenceURL=t.target.value)}}})])])};Ae._withStripped=!0;const Se=v({props:{event:{type:Object,default:()=>({})},settings:{type:Object,default:()=>null},currentSpace:{type:Object,default:()=>null},conferenceProvider:{type:Object,default:()=>null}},data:()=>({loading:!1,conferenceURL:null}),computed:{isConferenceEnabled(){return this.conferenceProvider&&(!this.eventConferenceType||this.conferenceProvider.getType()===this.eventConferenceType)},eventConferences(){return this.event&&this.event.conferences},eventConference(){return this.eventConferences&&this.eventConferences.length&&this.eventConferences[0]},eventConferenceId(){return this.eventConference&&this.eventConference.id},eventConferenceType(){return this.eventConference&&this.eventConference.type},eventConferenceUrl(){return this.eventConference&&this.eventConference.url}},watch:{conferenceURL(e){this.event.conferences=e?[{url:e,type:"manual"}]:[]}},mounted(){this.event&&this.event.conferences&&this.event.conferences.length&&(this.conferenceURL=this.event.conferences[0].url)},methods:{createCallUrl(){this.$set(this.event,"conferences",[{type:this.conferenceProvider.getType()}])},deleteCallURL(){this.$set(this.event,"conferences",null)}}},Ae,[],!1,null,null,null).exports;var ke=function(){var e=this,t=e._self._c;return e.event?t("v-card",{staticClass:"event-details event-poll-details d-flex flex-column",attrs:{loading:e.loading,flat:""}},[e.isMobile?t("agenda-event-date-poll-details-mobile",{attrs:{event:e.event,"voted-date-polls":e.votedDatePolls,"date-options":e.dateOptions,voters:e.voters,"current-user-votes":e.currentUserVotes,"attendees-count":e.attendeesCount,"voted-attendees-count":e.votedAttendeesCount,"can-select-date":e.canSelectDate,"is-voting":e.isVoting,"selected-date-option-index":e.selectedDateOptionIndex},on:{selectDate:function(t){return e.selectDate(t)},enableVoteButton:function(t){return e.enableVoteButton()}}}):t("agenda-event-date-poll-details-desktop",{attrs:{event:e.event,"voted-date-polls":e.votedDatePolls,"date-options":e.dateOptions,voters:e.voters,"attendees-count":e.attendeesCount,"voted-attendees-count":e.votedAttendeesCount,"can-select-date":e.canSelectDate,"is-voting":e.isVoting,"selected-date-option-index":e.selectedDateOptionIndex},on:{selectDate:function(t){return e.selectDate(t)},enableVoteButton:function(t){return e.enableVoteButton()}}}),e._v(" "),e.isAttendee?t("v-row",{staticClass:"mx-6 mb-6",attrs:{"no-gutters":""}},[t("v-col",{staticClass:"d-flex justify-end"},[t("agenda-date-poll-action-buttons",{attrs:{"is-voting":e.isVoting,"sending-votes":e.sendingVotes,"current-user-votes":e.currentUserVotes,"date-options":e.dateOptions,event:e.event,"disable-vote-button":e.disableVoteButton,voters:e.voters,"selected-date-index":e.selectedDateOptionIndex}})],1)],1):e._e(),e._v(" "),t("agenda-date-option-conflict-drawer")],1):e._e()};ke._withStripped=!0;const Oe=v({props:{event:{type:Object,default:()=>null}},data:()=>({voters:null,loading:!1,sendingVotes:!1,selectedDateOptionIndex:-1,isVoting:!1,hasVoted:!1,votedDatePolls:null,disableVoteButton:!0,originalUserVotes:null,currentUserId:Number(eXo.env.portal.userIdentityId)}),computed:{isCreator(){return this.event&&this.event.creator&&Number(this.event.creator.id)===this.currentUserId},canSelectDate(){return this.isCreator&&!this.isVoting},dateOptions(){return this.event&&this.event.dateOptions||[]},attendees(){return this.event&&this.event.attendees||[]},attendeesCount(){return this.attendees.filter((e=>e.identity&&e.identity.profile)).length},votedAttendeesCount(){return this.voters&&this.voters.filter((e=>e.hasVoted)).length||0},isAttendee(){return this.event&&this.event.acl&&this.event.acl.attendee},currentUserAttendee(){return this.attendees.find((e=>e&&e.identity&&Number(e.identity.id)===this.currentUserId))},currentUserVotes(){return this.currentUserAttendee&&this.currentUserAttendee.identity},isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}},watch:{event(){this.event&&(this.isVoting&&window.setTimeout((()=>{this.sendingVotes=!1,this.hasVoted=!0,this.isVoting=!1,this.originalUserVotes=this.currentUserVotes.dateOptionVotes.slice(),this.enableVoteButton()}),200),this.voters=this.$datePollUtils.computeVoters(this.event))},isVoting(){this.isVoting?this.selectedDateOptionIndex=-1:this.isCreator&&this.preselectDateOption(),this.enableVoteButton()},voters(){this.currentUserAttendee&&this.currentUserAttendee.identity&&(this.originalUserVotes=this.currentUserAttendee.identity.dateOptionVotes.slice(),this.hasVoted=this.hasVoted||"TENTATIVE"===this.currentUserAttendee.response,"TENTATIVE"!==this.currentUserAttendee.response&&(this.isVoting=!0))},dateOptions(){this.isCreator&&this.dateOptions&&this.preselectDateOption()}},created(){this.$root.$on("agenda-date-poll-change-vote",(()=>{this.isVoting=!0})),this.$root.$on("agenda-date-poll-voted",(()=>{this.$emit("refresh-event")})),this.$root.$on("agenda-date-poll-canceled",(()=>{this.voters=this.$datePollUtils.computeVoters(this.event),this.isVoting=!1})),this.currentUserAttendee||!this.isAttendee?this.voters=this.$datePollUtils.computeVoters(this.event):(this.loading=!0,this.$identityService.getIdentityById(this.currentUserId).then((e=>{this.event.attendees.push({identity:e,response:this.hasVoted?"TENTATIVE":"NEEDS_ACTION"}),this.voters=this.$datePollUtils.computeVoters(this.event)})).finally((()=>this.loading=!1))),this.$eventService.getDatePollsByDates(this.event.start,this.event.end,"dateOptions,response").then((e=>{const t=e&&e.events;t&&t.length&&(this.votedDatePolls=[],t.forEach((e=>{e.id!==this.event.id&&e.attendees&&e.attendees.length&&"TENTATIVE"===e.attendees[0].response&&e.dateOptions&&e.dateOptions.length&&e.dateOptions.forEach((t=>{if(t.voters&&t.voters.indexOf(this.currentUserId)>=0){const n=JSON.parse(JSON.stringify(e));n.start=t.start,n.end=t.end,this.votedDatePolls.push(n)}}))})))}))},methods:{preselectDateOption(){if(this.dateOptions&&this.isCreator&&this.hasVoted){let e=null,t=null,n=0;this.dateOptions.forEach(((a,i)=>{a.voters&&a.voters.length>n&&(e=a,t=i,n=a.voters.length)})),e&&(this.selectedDateOptionIndex=t)}},enableVoteButton(){this.disableVoteButton=this.hasVoted&&this.originalUserVotes.join("")===this.currentUserVotes.dateOptionVotes.join("")},selectDate(e){this.isCreator&&!this.isVoting&&(this.selectedDateOptionIndex===e?this.selectedDateOptionIndex=-1:this.selectedDateOptionIndex=e)}}},ke,[],!1,null,null,null).exports;var Pe=function(){var e=this,t=e._self._c;return t("v-flex",{staticClass:"agenda-date-poll-details-mobile"},[t("div",{staticClass:"ms-3 mt-5 mb-3 grey--text text-subtitle-2"},[e._v("\n    "+e._s(e.$t("agenda.votePreferredDates"))+"\n  ")]),e._v(" "),t("agenda-event-date-poll-item-mobile",{attrs:{event:e.event,"voted-date-polls":e.votedDatePolls,"date-options":e.dateOptions,voters:e.voters,"current-user-votes":e.currentUserVotes,"is-voting":e.isVoting,"can-select-date":e.canSelectDate},on:{selectDate:function(t){return e.$emit("selectDate",t)},"votes-changed":function(t){return e.$emit("enableVoteButton")}}}),e._v(" "),t("agenda-date-poll-participants-drawer-mobile",{attrs:{"event-title":e.event.summary}})],1)};Pe._withStripped=!0;const Ue=v({props:{event:{type:Object,default:()=>null},votedDatePolls:{type:Array,default:()=>null},dateOptions:{type:Array,default:()=>null},voters:{type:Array,default:()=>null},currentUserVotes:{type:Object,default:()=>null},canSelectDate:{type:Boolean,default:!1},isVoting:{type:Boolean,default:!1}}},Pe,[],!1,null,null,null).exports;var Re=function(){var e=this,t=e._self._c;return t("td",{staticClass:"event-date-options-cell",class:e.dateOptionHeaderClass,attrs:{title:e.dateOptionHeaderTitle},on:{click:function(t){return e.$emit("select")}}},[t("v-card",{staticClass:"py-2 px-7",attrs:{dark:e.selected,flat:""}},[t("v-card-title",{staticClass:"pa-2 justify-center"},[t("div",{staticClass:"d-inline-flex"},[t("date-format",{staticClass:"text-no-wrap me-1",attrs:{value:e.dateOption.start,format:e.dateDayFormat}}),e._v(" "),e.sameDayDates?e._e():[e._v("\n          -\n          "),t("date-format",{staticClass:"ms-1",attrs:{value:e.dateOption.end,format:e.dateDayFormat}})]],2)]),e._v(" "),t("v-card-text",{staticClass:"pa-2 d-flex justify-center"},[e.dateOption.allDay?[e._v("\n        "+e._s(e.$t("agenda.allDay"))+"\n      ")]:[t("date-format",{staticClass:"me-1",attrs:{value:e.dateOption.start,format:e.dateTimeFormat}}),e._v("\n        -\n        "),t("date-format",{staticClass:"ms-1 me-2",attrs:{value:e.dateOption.end,format:e.dateTimeFormat}})]],2),e._v(" "),t("v-fab-transition",[t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"selected"}],attrs:{title:e.$t("agenda.finalDate"),absolute:"",top:"",right:"",icon:"",fab:"","x-small":""}},[t("v-icon",{attrs:{color:"#f8b441"}},[e._v("fa-trophy")])],1)],1)],1)],1)};Re._withStripped=!0;const Ne=v({props:{dateOption:{type:Object,default:()=>null},canSelect:{type:Boolean,default:!1},selected:{type:Boolean,default:!1}},data:()=>({currentYear:`${(new Date).getYear()+1900}`,dateShortDayFormat:{month:"long",day:"numeric"},dateFullDayFormat:{year:"numeric",month:"numeric",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{startThisYear(){return this.currentYear===this.dateOption.start.substring(0,4)},endThisYear(){return this.currentYear===this.dateOption.end.substring(0,4)},sameDayDates(){return this.dateOption.start.substring(0,10)===this.dateOption.end.substring(0,10)},dateDayFormat(){return this.startThisYear&&this.endThisYear&&this.dateShortDayFormat||this.dateFullDayFormat},dateOptionHeaderTitle(){return this.canSelect&&this.$t("agenda.clickToSelectDate")||""},dateOptionHeaderClass(){let e="";return this.canSelect&&(e+="clickable"),this.selected&&(e+=" event-date-option-header-selected"),e}}},Re,[],!1,null,null,null).exports;var Fe=function(){var e=this,t=e._self._c;return t("tr",[t("th",{staticClass:"event-date-options-voter-cell justify-center",class:e.voter.profile?"":"no-vote"},[t("v-card",{staticClass:"d-flex fill-height border-box-sizing me-3",attrs:{flat:""}},[t("div",{staticClass:"my-auto text-center text-truncate pa-3"},[e.voter.space?t("exo-space-avatar",{attrs:{space:e.voter.space,popover:""}}):e.voter.profile?t("exo-user-avatar",{attrs:{identity:e.voter.profile,"extra-class":"d-inline-block date-poll-participant","link-style":"",popover:""}}):e._e()],1),e._v(" "),e.isCreator?t("v-icon",{staticClass:"mb-2",attrs:{title:e.$t("agenda.eventCreator"),size:16}},[e._v("\n        fa-crown\n      ")]):e._e(),e._v(" "),e.isCurrentUser?t("v-btn",{staticClass:"ma-auto border-box-sizing",class:e.isVoting&&"hide-edit-vote",attrs:{title:e.$t("agenda.changeVote"),icon:"",transparent:""},on:{click:function(t){return e.$root.$emit("agenda-date-poll-change-vote")}}},[t("i",{staticClass:"uiIconEditInfo uiIcon16x16 darkGreyIcon pb-2"})]):e._e()],1)],1),e._v(" "),e._l(e.voter.dateOptionVotes,(function(n,a){return t("td",{key:`${a}_${n}`,staticClass:"event-date-options-voter-cell",class:`${e.selectedDateIndex===a?"event-date-option-cell-selected":""} ${e.voter.profile?"":"disabled"}`},[t("v-card",{staticClass:"d-flex fill-height text-center border-box-sizing",attrs:{flat:""}},[t("v-card-text",{staticClass:"d-flex ma-auto text-center"},[e.voter.profile?t("agenda-event-date-option-vote",{staticClass:"flex-grow-0 mx-auto",attrs:{"voted-date-polls":e.votedDatePolls,voter:e.voter,"date-option":e.dateOptions[a],vote:n,"is-voting":e.isVoting},on:{change:function(t){return e.changeVote(a,t)}}}):e._e()],1)],1)],1)}))],2)};Fe._withStripped=!0;const Me=v({props:{dateOptions:{type:Object,default:()=>null},votedDatePolls:{type:Array,default:()=>null},voter:{type:Object,default:()=>null},isVoting:{type:Boolean,default:!1},selectedDateIndex:{type:Boolean,default:!1},eventCreatorId:{type:Number,default:()=>null}},computed:{isCurrentUser(){return this.voter&&this.voter.isCurrentUser},isCreator(){return this.voter&&Number(this.voter.id)===Number(this.eventCreatorId)},labels(){return{CancelRequest:this.$t("profile.CancelRequest"),Confirm:this.$t("profile.Confirm"),Connect:this.$t("profile.Connect"),Ignore:this.$t("profile.Ignore"),RemoveConnection:this.$t("profile.RemoveConnection"),External:this.$t("profile.External"),StatusTitle:this.$t("profile.StatusTitle"),join:this.$t("space.join"),leave:this.$t("space.leave"),members:this.$t("space.members")}}},methods:{changeVote(e,t){this.voter.dateOptionVotes[e]=t,this.$forceUpdate(),this.$emit("changed")}}},Fe,[],!1,null,null,null).exports;var Ve=function(){var e=this,t=e._self._c;return t("div",{staticClass:"event-date-poll-vote-choice d-flex flex-row flex-nowrap"},[t("div",{staticClass:"my-auto d-inline"},[e.isCurrentUserVoting?t("v-checkbox",{staticClass:"event-checkbox-vote pa-0",attrs:{disabled:e.disabled||!e.isCurrentUser,"hide-details":""},on:{change:function(t){return e.$emit("change",e.vote)}},model:{value:e.vote,callback:function(t){e.vote=t},expression:"vote"}}):[e.hasVoted?e.vote?t("i",{staticClass:"uiIcon py-1 uiIconColorValidate"}):t("i",{staticClass:"uiIcon py-1 uiIconColorError"}):t("span")]],2),e._v(" "),t("v-fab-transition",[t("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.conflictWithOtherEvent,expression:"conflictWithOtherEvent"}],staticClass:"event-conflicted",class:e.isMobile?"ms-2 mb-3":"ms-8",attrs:{title:e.$t("agenda.conflictWithOtherEvent"),absolute:!e.isMobile,small:e.isMobile,icon:""},on:{click:function(t){return e.$root.$emit("agenda-conflict-events-drawer-open",e.dateOption,e.conflictEvents,e.conflictingDatePolls)}}},[t("v-icon",{attrs:{size:"20px",color:"#f8b441"}},[e._v("warning")])],1)],1)],1)};Ve._withStripped=!0;const Le=v({props:{votedDatePolls:{type:Array,default:()=>null},voter:{type:Object,default:()=>null},dateOption:{type:Object,default:()=>null},isVoting:{type:Boolean,default:!1},vote:{type:Boolean,default:!1}},data:()=>({conflictEvents:null}),computed:{isCurrentUser(){return this.voter&&this.voter.isCurrentUser},isCurrentUserVoting(){return this.isCurrentUser&&this.isVoting},hasVoted(){return this.voter&&this.voter.hasVoted},conflictWithOtherEvent(){return this.conflictEvents&&this.conflictEvents.length||this.conflictingDatePolls&&this.conflictingDatePolls.length},conflictingDatePolls(){if(!this.isCurrentUser)return null;const e=[],t=new Date(this.dateOption.start),n=new Date(this.dateOption.end);return this.votedDatePolls&&this.votedDatePolls.length&&this.votedDatePolls.forEach((a=>{const i=new Date(a.start),s=new Date(a.end);i.getTime()<n.getTime()&&s.getTime()>t.getTime()&&e.push(a)})),e},isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}},mounted(){this.computeEventConflicts()},methods:{computeEventConflicts(){if(this.isCurrentUser){const e=this.$agendaUtils.toRFC3339(this.dateOption.start,this.dateOption.allDay,!0),t=this.$agendaUtils.toRFC3339(this.dateOption.end,this.dateOption.allDay,!0).replace("00:00:00","23:59:59");this.$eventService.getEvents(null,null,eXo.env.portal.userIdentityId,e,t,10,["ACCEPTED","TENTATIVE"]).then((e=>this.conflictEvents=e&&e.events))}}}},Ve,[],!1,null,null,null).exports;var je=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"conflictEventsDrawer",attrs:{right:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("agenda.schedulingConflict"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[e.dateOption?t("div",{staticClass:"text-center text-subtitle-2 font-weight-bold pt-2"},[t("div",{staticClass:"d-inline-flex"},[t("date-format",{staticClass:"me-1",attrs:{value:e.dateOption.start,format:e.dateFormat}}),e._v(" "),e.sameDayDates?e._e():[e._v("\n          -\n          "),t("date-format",{staticClass:"ms-1",attrs:{value:e.dateOption.end,format:e.dateFormat}})]],2),e._v(" "),t("div",{staticClass:"d-inline-flex"},[e.dateOption.allDay?[e._v("\n          "+e._s(e.$t("agenda.allDay"))+"\n        ")]:[t("date-format",{staticClass:"me-1",attrs:{value:e.dateOption.start,format:e.timeFormat}}),e._v("\n          -\n          "),t("date-format",{staticClass:"ms-1 me-2",attrs:{value:e.dateOption.end,format:e.timeFormat}})]],2)]):e._e(),e._v(" "),t("v-list",[e._l(e.events,(function(e){return t("agenda-date-option-conflict-item",{key:e.id,staticClass:"mx-2 px-2 py-0 mb-2",attrs:{event:e}})})),e._v(" "),e._l(e.votedDatePolls,(function(e){return t("agenda-date-option-conflict-item",{key:e.id,staticClass:"mx-2 px-2 py-0 mb-2",attrs:{event:e}})}))],2)],1)],2)};je._withStripped=!0;const Be=v({data:()=>({events:[],votedDatePolls:[],dateOption:null,dateFormat:{year:"numeric",month:"short",day:"numeric"},timeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{sameDayDates(){return this.dateOption.start&&this.dateOption.end&&this.$agendaUtils.areDatesOnSameDay(this.dateOption.start,this.dateOption.end)}},created(){this.$root.$on("agenda-conflict-events-drawer-open",((e,t,n)=>{this.dateOption=e,this.events=t,this.votedDatePolls=n,this.open()}))},methods:{open(){this.$refs.conflictEventsDrawer&&this.$refs.conflictEventsDrawer.open()}}},je,[],!1,null,null,null).exports;var ze=function(){var e=this,t=e._self._c;return t("v-list-item",{staticClass:"pending-invitation-item border-radius",style:e.eventStyle,attrs:{"two-line":"",dense:""}},[t("v-list-item-content",{staticClass:"pa-0"},[t("v-list-item-title",{staticClass:"white--text text-truncate subtitle-1",style:e.textStyle},[e._v("\n      "+e._s(e.event.summary)+"\n    ")]),e._v(" "),t("v-list-item-subtitle",{staticClass:"text-truncate d-flex caption mt-1"},[t("div",{staticClass:"d-inline-flex",style:e.textStyle},[t("date-format",{staticClass:"me-1",attrs:{value:e.event.start,format:e.dateFormat}}),e._v(" "),e.sameDayDates?e._e():[e._v("\n          -\n          "),t("date-format",{staticClass:"ms-1",attrs:{value:e.event.end,format:e.dateFormat}})]],2),e._v(" "),t("div",{staticClass:"d-inline-flex",style:e.textStyle},[e.event.allDay?[e._v("\n          "+e._s(e.$t("agenda.allDay"))+"\n        ")]:[t("date-format",{staticClass:"ms-1 me-1",attrs:{value:e.event.start,format:e.timeFormat}}),e._v("\n          -\n          "),t("date-format",{staticClass:"ms-1 me-2",attrs:{value:e.event.end,format:e.timeFormat}})]],2)])],1),e._v(" "),e.isDatePoll?t("v-list-item-action",{staticClass:"my-1 py-0",attrs:{title:e.$t("agenda.votedDatePollOption")}},[t("i",{staticClass:"uiIcon32x32 uiIconPLFFont align-self-center d-flex mb-1 me-1",class:e.eventIcon,style:e.textStyle})]):e._e()],1)};ze._withStripped=!0;const Xe=v({props:{event:{type:Object,default:()=>({})}},data:()=>({dateFormat:{year:"numeric",month:"short",day:"numeric"},timeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{textStyle(){return this.event?"color: #fff !important":`color: ${this.eventColor} !important`},sameDayDates(){return this.event.start&&this.event.end&&this.$agendaUtils.areDatesOnSameDay(this.event.start,this.event.end)},eventColor(){return this.event&&this.event.calendar&&this.event.calendar.color||"#2196F3"},eventStyle(){return`background: ${this.eventColor};`},isDatePoll(){return"TENTATIVE"===this.event.status},eventIcon(){return this.isDatePoll?"uiIconStatistics":"uiIconCalendarEmpty"}}},ze,[],!1,null,null,null).exports;var qe=function(){var e=this,t=e._self._c;return e.dateOption?t("div",{staticClass:"d-flex flex-nowrap"},[t("div",{staticClass:"d-inline-flex font-weight-bold"},[t("date-format",{staticClass:"text-no-wrap me-1",attrs:{value:e.dateOption.start,format:e.dateDayFormat}}),e._v(" "),e.sameDayDates?e._e():[e._v("\n      -\n      "),t("date-format",{staticClass:"ms-1",attrs:{value:e.dateOption.end,format:e.dateDayFormat}})]],2),e._v(" "),e.dateOption.allDay?[e._v("\n    "+e._s(e.$t("agenda.allDay"))+"\n  ")]:[t("date-format",{staticClass:"me-1",attrs:{value:e.dateOption.start,format:e.dateTimeFormat}}),e._v("\n    -\n    "),t("date-format",{staticClass:"ms-1 me-2",attrs:{value:e.dateOption.end,format:e.dateTimeFormat}})]],2):e._e()};qe._withStripped=!0;const Ye=v({props:{dateOption:{type:Object,default:()=>null},canSelect:{type:Boolean,default:!1}},data:()=>({currentYear:`${(new Date).getYear()+1900}`,dateShortDayFormat:{month:"long",day:"numeric"},dateFullDayFormat:{year:"numeric",month:"numeric",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{startThisYear(){return this.currentYear===this.dateOption.start.substring(0,4)},endThisYear(){return this.currentYear===this.dateOption.end.substring(0,4)},sameDayDates(){return this.dateOption.start.substring(0,10)===this.dateOption.end.substring(0,10)},dateDayFormat(){return this.startThisYear&&this.endThisYear&&this.dateShortDayFormat||this.dateFullDayFormat}}},qe,[],!1,null,null,null).exports;var Ge=function(){var e=this,t=e._self._c;return t("v-list",[t("v-list-item-group",{attrs:{color:"primary"},on:{change:function(t){return e.$emit("selectDate",e.selectedDateOptionIndex)}},model:{value:e.selectedDateOptionIndex,callback:function(t){e.selectedDateOptionIndex=t},expression:"selectedDateOptionIndex"}},e._l(e.dateOptions,(function(n,a){return t("v-list-item",{key:a,attrs:{disabled:!e.canSelectDate&&!e.isVoting},on:{click:function(t){return e.$root.$emit("agenda-select-date-option",n,a)}},scopedSlots:e._u([{key:"default",fn:function({active:i}){return[e.currentUserVotes?t("agenda-event-date-option-vote",{staticClass:"my-auto",attrs:{"voted-date-polls":e.votedDatePolls,"date-option":n,voter:e.currentUserVotes,vote:e.currentUserVotes.dateOptionVotes[a],"is-voting":e.isVoting},on:{change:function(t){return e.changeVote(a,t)}}}):e._e(),e._v(" "),t("agenda-event-date-option-period-mobile",{staticClass:"text--primary my-auto flex-grow-1 ms-4",attrs:{"date-option":n,"can-select":e.canSelectDate}}),e._v(" "),t("v-list-item-content",{staticClass:"text--primary my-auto flex-grow-0 flex-shrink-0 pe-1 date-poll-voters-avatar"},[t("agenda-event-date-option-voter-mobile",{attrs:{"date-option":n}})],1),e._v(" "),i?e.canSelectDate&&i?t("div",{staticClass:"my-auto"},[t("v-btn",{attrs:{title:e.$t("agenda.finalDate"),icon:"",right:"",fab:"","x-small":""}},[t("v-icon",{attrs:{color:"#f8b441"}},[e._v("fa-trophy")])],1)],1):t("div",[t("v-btn",{attrs:{title:e.$t("agenda.finalDate"),icon:"",right:"",fab:"","x-small":""}},[t("v-icon",{attrs:{color:"grey lighten-1"}},[e._v("fa-trophy")])],1)],1):t("div",{staticClass:"my-auto"},[t("v-btn",{attrs:{title:e.$t("agenda.finalDate"),icon:"",right:"",fab:"","x-small":""}},[t("v-icon",{attrs:{color:"grey lighten-1"}},[e._v("fa-trophy")])],1)],1)]}}],null,!0)})})),1)],1)};Ge._withStripped=!0;const Je=v({props:{event:{type:Object,default:()=>null},votedDatePolls:{type:Array,default:()=>null},dateOptions:{type:Array,default:()=>null},currentUserVotes:{type:Object,default:()=>null},canSelectDate:{type:Boolean,default:!1},selectedDateOptionIndex:{type:Number,default:()=>-1},isVoting:{type:Boolean,default:!1}},methods:{changeVote(e,t){this.currentUserVotes.dateOptionVotes[e]=t,this.$forceUpdate(),this.$emit("votes-changed")}}},Ge,[],!1,null,null,null).exports;var He=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"datePollParticipantsDrawer",attrs:{right:""}},[t("template",{slot:"title"},[t("div",{staticClass:"d-flex flex-grow-1"},[t("div",{staticClass:"my-auto body-1 flex-grow-0 me-2"},[t("v-icon",{on:{click:function(t){return e.close()}}},[e._v("mdi-keyboard-backspace")])],1),e._v(" "),t("div",{staticClass:"flex-grow-0 d-flex flex-column"},[t("div",{staticClass:"flex-grow-0 d-flex flex-row body-2 font-weight-bold"},[t("div",{staticClass:"me-1"},[e._v("\n            "+e._s(e.$t("agenda.datePollVoters"))+"\n          ")]),e._v(" "),t("div",{staticClass:"my-auto text-truncate"},[e.dateOption?t("div",{staticClass:"d-flex flex-nowrap flex-grow-0",on:{click:function(t){return e.$emit("select")}}},[t("div",{staticClass:"d-inline-flex"},[t("date-format",{staticClass:"text-no-wrap me-1",attrs:{value:e.dateOption.start,format:e.dateDayFormat}}),e._v(" "),e.sameDayDates?e._e():[e._v("\n                  -\n                  "),t("date-format",{staticClass:"ms-1",attrs:{value:e.dateOption.end,format:e.dateDayFormat}})]],2),e._v(" "),e.dateOption.allDay?[e._v("\n                "+e._s(e.$t("agenda.allDay"))+"\n              ")]:[t("date-format",{staticClass:"me-1",attrs:{value:e.dateOption.start,format:e.dateTimeFormat}}),e._v("\n                -\n                "),t("date-format",{staticClass:"ms-1 me-2",attrs:{value:e.dateOption.end,format:e.dateTimeFormat}})]],2):e._e()])]),e._v(" "),t("div",{staticClass:"text-subtitle-2 text-truncate text-capitalize"},[e._v(" "+e._s(e.eventTitle))])])])]),e._v(" "),t("template",{slot:"content"},[t("v-list",e._l(e.voters,(function(n,a){return t("v-list-item",{key:a},[n.space?t("exo-space-avatar",{attrs:{space:n.space,popover:""}}):n?t("exo-user-avatar",{attrs:{identity:n,"extra-class":"d-inline-block date-poll-participant","link-style":"",popover:""}}):e._e()],1)})),1)],1)],2)};He._withStripped=!0;const We=v({props:{eventTitle:{type:String,default:()=>null}},data:()=>({voters:[],dateOption:null,currentYear:`${(new Date).getYear()+1900}`,dateShortDayFormat:{month:"long",day:"numeric"},dateFullDayFormat:{year:"numeric",month:"numeric",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{startThisYear(){return this.currentYear===this.dateOption.start.substring(0,4)},endThisYear(){return this.currentYear===this.dateOption.end.substring(0,4)},sameDayDates(){return this.dateOption.start.substring(0,10)===this.dateOption.end.substring(0,10)},dateDayFormat(){return this.startThisYear&&this.endThisYear&&this.dateShortDayFormat||this.dateFullDayFormat}},created(){this.$root.$on("agenda-display-voters",(e=>{this.voters=e,this.open()})),this.$root.$on("agenda-select-date-option",(e=>{this.dateOption=e}))},methods:{open(){this.$refs.datePollParticipantsDrawer.open()},close(){this.$refs.datePollParticipantsDrawer.close()}}},He,[],!1,null,null,null).exports;var Ze=function(){var e=this;return(0,e._self._c)("exo-user-avatars-list",{attrs:{users:e.votersAcceptedDatePoll,max:2,"icon-size":28},on:{"open-detail":function(t){return e.$root.$emit("agenda-display-voters",e.votersAcceptedDatePoll)}}})};Ze._withStripped=!0;const Ke=v({props:{voters:{type:Array,default:()=>null},dateOption:{type:Object,default:()=>null}},data:()=>({votersAcceptedDatePoll:[]}),created(){this.computeVoters(this.dateOption)},methods:{computeVoters(e){e.voters.forEach((e=>{this.computeVoterFromIdentity(e)}))},computeVoterFromIdentity(e){const t=[];return this.$identityService.getIdentityById(Number(e)).then((e=>{t.username=e.profile.username,t.fullname=e.profile.fullname,this.votersAcceptedDatePoll.push(t)}))}}},Ze,[],!1,null,null,null).exports;var Qe=function(){var e=this,t=e._self._c;return t("div",[e.isVoting?[t("v-btn",{staticClass:"btn ms-auto me-2",attrs:{disabled:e.sendingVotes},on:{click:function(t){return e.$root.$emit("agenda-date-poll-canceled")}}},[e._v("\n      "+e._s(e.$t("agenda.button.cancel"))+"\n    ")]),e._v(" "),e.currentUserVotes?t("v-btn",{staticClass:"btn btn-primary",attrs:{loading:e.sendingVotes,disabled:e.sendingVotes||e.disableVoteButton},on:{click:e.sendVotes}},[e._v("\n      "+e._s(e.$t("agenda.button.vote"))+"\n    ")]):e._e()]:e.isCreator?t("v-btn",{staticClass:"btn btn-primary ms-auto",attrs:{loading:e.creatingEvent,disabled:e.disableCreateButton},on:{click:e.createEvent}},[e._v("\n    "+e._s(e.$t("agenda.button.createEvent"))+"\n  ")]):e._e()],2)};Qe._withStripped=!0;const et=v({props:{event:{type:Object,default:()=>null},currentUserVotes:{type:Object,default:()=>null},isVoting:{type:Boolean,default:!1},sendingVotes:{type:Boolean,default:!1},selectedDateIndex:{type:Number,default:-1},disableVoteButton:{type:Boolean,default:!0},voters:{type:Array,default:()=>null},dateOptions:{type:Array,default:()=>null}},data:()=>({creatingEvent:!1,currentUserId:Number(eXo.env.portal.userIdentityId)}),computed:{isCreator(){return this.event&&this.event.creator&&Number(this.event.creator.id)===this.currentUserId},disableCreateButton(){return this.selectedDateIndex<0||this.creatingEvent}},created(){this.$root.$on("agenda-date-poll-voted",(()=>{this.isVoting=!1,this.sendingVotes=!1}))},methods:{createEvent(){const e=this.dateOptions[this.selectedDateIndex];return this.creatingEvent=!0,this.$eventService.selectEventDate(e.eventId,e.id).then((()=>{this.$root.$emit("agenda-refresh"),window.setTimeout((()=>this.$root.$emit("agenda-event-details",this.event)),200)})).finally((()=>{window.setTimeout((()=>{this.creatingEvent=!1}),200)}))},sendVotes(){const e=this.event.id,t=[];for(const e in this.dateOptions){const n=this.dateOptions[e].id;this.currentUserVotes.dateOptionVotes[e]&&t.push(n)}this.sendingVotes=!0,this.$eventService.saveEventVotes(e,t).then((()=>{this.$emit("refresh-event"),window.setTimeout((()=>{this.$root.$emit("agenda-date-poll-voted")}),500)}))}}},Qe,[],!1,null,null,null).exports;var tt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex flex-row ma-6 overflow-auto"},[t("v-spacer"),e._v(" "),t("div",{staticClass:"d-inline"},[t("table",{staticClass:"event-date-options-table mx-auto",attrs:{id:"event-date-options-table",description:"Event date options table"}},[t("caption",[e.event.description?t("em",[t("div",{staticClass:"text-center font-italic subtitle-1 text-wrap pb-4"},[e._v("\n            "+e._s(e.event.description)+"\n          ")])]):e._e()]),e._v(" "),t("tr",[t("th",{staticClass:"event-date-options-cell justify-center",attrs:{id:"participantsTitle"}},[t("v-card",{staticClass:"d-flex fill-height border-box-sizing",attrs:{flat:""}},[t("v-card-title",{staticClass:"ma-auto text-no-wrap text-center"},[e._v("\n              "+e._s(e.$t("agenda.participants"))+"\n            ")])],1)],1),e._v(" "),e._l(e.dateOptions,(function(n,a){return t("agenda-event-date-option-period",{key:a,attrs:{"date-option":n,"can-select":e.canSelectDate,selected:e.selectedDateOptionIndex===a},on:{select:function(t){return e.$emit("selectDate",a)}}})}))],2),e._v(" "),t("tr",[t("th",{staticClass:"event-date-options-cell justify-center",attrs:{id:"participantsCount"}},[t("v-card",{staticClass:"d-flex fill-height border-box-sizing",attrs:{flat:""}},[t("v-card-text",{staticClass:"ma-auto text-center text-no-wrap"},[e._v("\n              "+e._s(e.votedAttendeesCount)+"\n              /\n              "+e._s(e.attendeesCount)+"\n              "+e._s(e.$t("agenda.participants"))+"\n            ")])],1)],1),e._v(" "),e._l(e.dateOptions,(function(n,a){return t("th",{key:a,staticClass:"event-date-options-cell",class:e.selectedDateOptionIndex===a?"event-date-option-cell-selected":"",attrs:{id:`dateOption_${a}`}},[t("v-card",{staticClass:"d-flex fill-height text-center border-box-sizing",attrs:{flat:""}},[t("v-card-text",{staticClass:"ma-auto text-center"},[e._v("\n              "+e._s(n.voters&&n.voters.length||0)+"\n            ")])],1)],1)}))],2),e._v(" "),e.voters?e._l(e.voters,(function(n,a){return t("agenda-event-date-option-voter",{key:a,attrs:{voter:n,"voted-date-polls":e.votedDatePolls,"date-options":e.dateOptions,"selected-date-index":e.selectedDateOptionIndex,"is-voting":e.isVoting,"event-creator-id":e.event.creator.id},on:{changed:function(t){return e.$emit("enableVoteButton")}}})})):e._e()],2)]),e._v(" "),t("v-spacer")],1)};tt._withStripped=!0;const nt=v({props:{event:{type:Object,default:()=>null},votedDatePolls:{type:Array,default:()=>null},dateOptions:{type:Array,default:()=>null},voters:{type:Array,default:()=>null},selectedDateOptionIndex:{type:Number,default:()=>-1},votedAttendeesCount:{type:Number,default:()=>-1},attendeesCount:{type:Number,default:()=>-1},canSelectDate:{type:Boolean,default:!1},isVoting:{type:Boolean,default:!1}}},tt,[],!1,null,null,null).exports;var at=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"UserSettingAgendaDrawer",staticClass:"UserSettingAgendaDrawer",attrs:{"confirm-close":e.confirmClose,"confirm-close-labels":e.confirmCloseLabels,"body-classes":"hide-scroll decrease-z-index-more",right:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("agenda.settings.drawer.title"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("v-form",{ref:"agendaSettingsForm",staticClass:"flex",attrs:{flat:""}},[t("v-layout",{staticClass:"ma-5 d-flex flex-column"},[t("div",{staticClass:"d-flex flex-column mb-5"},[t("label",{staticClass:"switch-label-text mt-1 text-subtitle-1"},[e._v(e._s(e.$t("agenda.settings.drawer.label.DefaultView"))+":")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.userSettingsForm.agendaDefaultView,expression:"userSettingsForm.agendaDefaultView"}],staticClass:"width-auto my-auto pe-2 ignore-vuetify-classes d-none d-sm-inline",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.userSettingsForm,"agendaDefaultView",t.target.multiple?n:n[0])}}},[t("option",{attrs:{value:"day"}},[e._v(e._s(e.$t("agenda.label.viewDay")))]),e._v(" "),t("option",{attrs:{value:"week"}},[e._v(e._s(e.$t("agenda.label.viewWeek")))]),e._v(" "),t("option",{attrs:{value:"month"}},[e._v(e._s(e.$t("agenda.label.viewMonth")))])])]),e._v(" "),t("div",{staticClass:"d-flex flex-column mb-5"},[t("label",{staticClass:"switch-label-text mt-1 text-subtitle-1"},[e._v(e._s(e.$t("agenda.settings.drawer.label.WeekStartOn"))+":")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.userSettingsForm.agendaWeekStartOn,expression:"userSettingsForm.agendaWeekStartOn"}],staticClass:"width-auto my-auto pe-2 ignore-vuetify-classes d-none d-sm-inline",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.userSettingsForm,"agendaWeekStartOn",t.target.multiple?n:n[0])}}},e._l(e.DAYS_ABBREVIATIONS,(function(n){return t("option",{key:n,domProps:{value:n}},[e._v("\n              "+e._s(e.DAY_NAME_BY_ABBREVIATION[n])+"\n            ")])})),0)]),e._v(" "),t("div",{staticClass:"d-flex flex-row"},[t("label",{staticClass:"switch-label-text mt-1 text-subtitle-1"},[e._v(e._s(e.$t("agenda.settings.drawer.label.showWorkingTime"))+":")]),e._v(" "),t("v-switch",{staticClass:"mt-0 ms-4",model:{value:e.userSettingsForm.showWorkingTime,callback:function(t){e.$set(e.userSettingsForm,"showWorkingTime",t)},expression:"userSettingsForm.showWorkingTime"}})],1),e._v(" "),e.userSettingsForm.showWorkingTime?t("div",{staticClass:"workingTime d-flex flex-row align-center"},[t("time-picker",{attrs:{"interval-minutes":e.$agendaUtils.MINIMUM_TIME_INTERVAL},model:{value:e.userSettingsForm.workingTimeStart,callback:function(t){e.$set(e.userSettingsForm,"workingTimeStart",t)},expression:"userSettingsForm.workingTimeStart"}}),e._v(" "),t("label",{staticClass:"switch-label-text mx-5 text-subtitle-1"},[e._v(e._s(e.$t("agenda.label.to")))]),e._v(" "),t("time-picker",{attrs:{"interval-minutes":e.$agendaUtils.MINIMUM_TIME_INTERVAL},model:{value:e.userSettingsForm.workingTimeEnd,callback:function(t){e.$set(e.userSettingsForm,"workingTimeEnd",t)},expression:"userSettingsForm.workingTimeEnd"}})],1):e._e(),e._v(" "),t("label",{staticClass:"subtitle-1 float-left mt-5 me-4"},[e._v("\n          "+e._s(e.$t("agenda.label.defaultReminders"))+"\n        ")]),e._v(" "),t("agenda-reminder-user-settings",{ref:"reminders",attrs:{reminders:e.userSettingsForm.reminders}})],1)],1),e._v(" "),t("exo-confirm-dialog",{ref:"CancelSavingChangesDialog",attrs:{message:e.$t("agenda.settings.drawer.confirmCancelChanges"),title:e.$t("agenda.settings.drawer.confirmCancelChanges.title"),"ok-label":e.$t("agenda.button.ok"),"cancel-label":e.$t("agenda.button.cancel")},on:{ok:function(t){return e.confirmCancelSavingChanges()}}})],1),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex"},[t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn me-2",on:{click:e.close}},[[e._v("\n          "+e._s(e.$t("agenda.button.cancel"))+"\n        ")]],2),e._v(" "),t("v-btn",{staticClass:"btn btn-primary",on:{click:e.save}},[e._v("\n        "+e._s(e.$t("agenda.button.save"))+"\n      ")])],1)])],2)};at._withStripped=!0;const it=v({props:{settings:{type:Object,default:()=>({})}},data:()=>({DAYS_ABBREVIATIONS:["SU","MO","TU","WE","TH","FR","SA"],userSettingsForm:{},saved:!1}),computed:{DAY_NAME_BY_ABBREVIATION(){return{MO:this.getDayFromAbbreviation("MO"),TU:this.getDayFromAbbreviation("TU"),WE:this.getDayFromAbbreviation("WE"),TH:this.getDayFromAbbreviation("TH"),FR:this.getDayFromAbbreviation("FR"),SA:this.getDayFromAbbreviation("SA"),SU:this.getDayFromAbbreviation("SU")}},confirmCloseLabels(){return{title:this.$t("agenda.settings.drawer.confirmCancelChanges.title"),message:this.$t("agenda.settings.drawer.confirmCancelChanges"),ok:this.$t("agenda.button.yes"),cancel:this.$t("agenda.button.no")}},confirmClose(){return!this.saved&&!this.$agendaUtils.areSameObjects(this.userSettingsForm,this.settings)},showWorkingTime(){return this.userSettingsForm.showWorkingTime}},watch:{showWorkingTime(e,t){e&&!t&&(this.userSettingsForm.workingTimeStart=this.settings.workingTimeStart||"09:00",this.userSettingsForm.workingTimeEnd=this.settings.workingTimeEnd||"18:00")}},created(){document.dispatchEvent(new CustomEvent("hideTopBarLoading")),this.$root.$on("user-settings-agenda-drawer-open",this.open)},methods:{open(){this.userSettingsForm=this.settings&&JSON.parse(JSON.stringify(this.settings))||{},this.saved=!1,this.$refs.UserSettingAgendaDrawer.open()},close(){this.$refs.UserSettingAgendaDrawer.close()},save(){this.validateForm()&&(this.$refs.UserSettingAgendaDrawer.startLoading(),this.$settingsService.saveUserSettings(this.userSettingsForm).then((()=>(this.saved=!0,this.$nextTick()))).then((()=>{this.$root.$emit("agenda-settings-refresh",this.userSettingsForm),this.$refs.UserSettingAgendaDrawer.close()})).finally((()=>{this.$refs.UserSettingAgendaDrawer.endLoading()})))},getDayFromAbbreviation(e){return this.$agendaUtils.getDayNameFromDayAbbreviation(e,eXo.env.portal.language)},validateForm(){if(this.$refs.agendaSettingsForm.validate()&&this.$refs.agendaSettingsForm.$el.reportValidity())return!0},confirmCancelSavingChanges(){this.$refs.UserSettingAgendaDrawer.close()}}},at,[],!1,null,null,null).exports;var st=function(){var e=this,t=e._self._c;return t("v-list",{staticClass:"flex-grow-1 d-flex flex-column pa-0",attrs:{dense:""}},[e.reminders&&e.reminders.length?e._e():t("v-list-item",{staticClass:"px-0 reminder-list-item",attrs:{dense:""}},[t("label",{staticClass:"text-sub-title font-italic mx-auto"},[e._v("\n      "+e._s(e.$t("agenda.noRemindersYet"))+"\n    ")])]),e._v(" "),e._l(e.reminders,(function(n,a){return t("agenda-reminder-user-setting-item",{key:a,attrs:{reminder:n},on:{remove:function(t){return e.removeReminder(n)}}})})),e._v(" "),e.canAddReminder?t("v-list-item",{staticClass:"ps-0 my-auto reminder-list-item",attrs:{dense:""}},[t("a",{staticClass:"text-subtitle-1 font-weight-regular add-notification-link",on:{click:e.addReminder}},[e._v("\n      "+e._s(e.$t("agenda.addReminder"))+"\n    ")])]):e._e()],2)};st._withStripped=!0;const rt=v({props:{reminders:{type:Array,default:()=>[]}},computed:{canAddReminder(){return this.reminders.length<5}},methods:{addReminder(){this.reminders.push({before:0,beforePeriodType:"MINUTE"})},removeReminder(e){this.reminders.splice(this.reminders.indexOf(e),1)}}},st,[],!1,null,null,null).exports;var ot=function(){var e=this,t=e._self._c;return t("v-list-item",{staticClass:"px-0 reminder-list-item",attrs:{dense:""}},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.reminder.before,expression:"reminder.before",modifiers:{number:!0}}],ref:"beforeInput",staticClass:"reminder-time ignore-vuetify-classes my-auto",attrs:{type:"number",min:"0",required:"",numeric:""},domProps:{value:e.reminder.before},on:{input:function(t){t.target.composing||e.$set(e.reminder,"before",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.reminder.beforePeriodType,expression:"reminder.beforePeriodType"}],ref:"periodTypeInput",staticClass:"reminder-period-type width-auto my-auto ms-4 pe-2 ignore-vuetify-classes",attrs:{required:""},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.reminder,"beforePeriodType",t.target.multiple?n:n[0])}}},[t("option",{attrs:{value:"MINUTE"}},[e._v(e._s(e.$t("agenda.option.minutes")))]),e._v(" "),t("option",{attrs:{value:"HOUR"}},[e._v(e._s(e.$t("agenda.option.hours")))]),e._v(" "),t("option",{attrs:{value:"DAY"}},[e._v(e._s(e.$t("agenda.option.days")))])]),e._v(" "),t("span",{staticClass:"ms-4"},[e._v("\n    "+e._s(e.$t("agenda.label.beforeStart"))+"\n  ")]),e._v(" "),t("v-btn",{staticClass:"ms-auto",attrs:{color:"grey",icon:"",dark:""},on:{click:function(t){return e.$emit("remove")}}},[t("v-icon",[e._v("\n      mdi-close\n    ")])],1)],1)};ot._withStripped=!0;const lt=v({props:{reminder:{type:Object,default:()=>({})}},computed:{before(){return this.reminder&&this.reminder.before},periodType(){return this.reminder&&this.reminder.beforePeriodType}},watch:{before(){this.validateForm()},periodType(){this.validateForm()}},methods:{validateForm(){try{if(this.before<0)return void this.$refs.beforeInput.setCustomValidity(this.$t("agenda.warning.reminder.noNegativeNumber"));if("MINUTE"===this.periodType){if(this.before>1440)return void this.$refs.beforeInput.setCustomValidity(this.$t("agenda.warning.reminder.maxMinutes",{0:1440}))}else if("HOUR"===this.periodType){if(this.before>24)return void this.$refs.beforeInput.setCustomValidity(this.$t("agenda.warning.reminder.maxHours",{0:24}))}else if("DAY"===this.periodType&&this.before>1)return void this.$refs.beforeInput.setCustomValidity(this.$t("agenda.warning.reminder.maxDays",{0:1}));this.$refs.beforeInput.setCustomValidity("")}finally{this.$refs.beforeInput.reportValidity()}}}},ot,[],!1,null,null,null).exports;var ct=function(){var e=this,t=e._self._c;return e.event?t("v-card",{staticClass:"event-details d-flex flex-column",attrs:{flat:""}},[e.isMobile&&!e.isDatePoll?t("agenda-event-details-mobile-toolbar",{attrs:{event:e.event,"connected-connector":e.connectedConnector},on:{close:function(t){return e.$emit("close")},edit:function(t){return e.$root.$emit("agenda-event-form",e.event)},delete:e.deleteConfirmDialog}}):e.isMobile&&e.isDatePoll?t("agenda-date-poll-details-mobile-toolbar",{attrs:{event:e.event},on:{close:function(t){return e.$emit("close")},edit:function(t){return e.$root.$emit("agenda-event-form",e.event)}}}):t("agenda-event-details-toolbar",{attrs:{event:e.event,"connected-connector":e.connectedConnector,"is-attendee":e.isAttendee},on:{close:function(t){return e.$emit("close")},edit:function(t){return e.$root.$emit("agenda-event-form",e.event)},delete:e.deleteConfirmDialog}}),e._v(" "),e._t("top-bar-message"),e._v(" "),t("v-divider",{staticClass:"flex-grow-0"}),e._v(" "),e.isDatePoll?t("agenda-event-date-poll-details",{attrs:{event:e.event},on:{"refresh-event":function(t){return e.$emit("refresh-event")}}}):e.isDatePoll?e._e():[t("agenda-event-details-body",{attrs:{settings:e.settings,event:e.event,connectors:e.connectors,"conference-provider":e.conferenceProvider}}),e._v(" "),e.isAttendee&&e.isMobile?[t("v-divider"),e._v(" "),t("agenda-event-attendee-buttons",{ref:"eventAttendeeButtons",staticClass:"flex-grow-0 my-2",class:e.isMobile?"me-1":"me-10",attrs:{event:e.event}})]:e._e()],e._v(" "),e.event.occurrence?t("agenda-recurrent-event-delete-confirm-dialog",{ref:"deleteConfirmDialog",attrs:{event:e.event}}):t("exo-confirm-dialog",{ref:"deleteConfirmDialog",attrs:{message:e.$t("agenda.message.confirmDeleteEvent"),title:e.$t("agenda.title.confirmDeleteEvent"),"ok-label":e.$t("agenda.button.ok"),"cancel-label":e.$t("agenda.button.cancel")},on:{ok:e.deleteEvent}})],2):e._e()};ct._withStripped=!0;const dt=v({props:{settings:{type:Object,default:()=>null},event:{type:Object,default:()=>({})},connectors:{type:Array,default:()=>[]},conferenceProvider:{type:Object,default:()=>null}},computed:{connectedConnector(){return this.connectors&&this.connectors.find((e=>e.connected))},isDatePoll(){return this.event&&"TENTATIVE"===this.event.status},isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},isAttendee(){return this.event.acl&&this.event.acl.attendee}},methods:{deleteConfirmDialog(){this.$refs.deleteConfirmDialog.open()},deleteEvent(){this.$eventService.deleteEvent(this.event.id,10).then((()=>this.$root.$emit("agenda-event-deleted",this.event)))}}},ct,[],!1,null,null,null).exports;var vt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"event-details-body overflow-auto flex-grow-1 d-flex flex-column flex-md-row pa-4 mt-5"},[t("div",{staticClass:"flex-grow-1 flex-shrink-0 event-details-body-left",class:{"d-flex":!e.isMobile}},[t("div",{staticClass:"mx-auto"},[t("div",{staticClass:"event-date align-center d-flex pb-5"},[t("i",{staticClass:"uiIconDatePicker darkGreyIcon uiIcon32x32 pe-5"}),e._v(" "),t("div",{staticClass:"d-inline-flex"},[t("date-format",{staticClass:"me-1",attrs:{value:e.event.startDate,format:e.fullDateFormat}}),e._v(" "),e.sameDayDates?e._e():[e._v("\n            -\n            "),t("date-format",{staticClass:"ms-1",attrs:{value:e.event.endDate,format:e.fullDateFormat}})]],2)]),e._v(" "),t("div",{staticClass:"event-time align-center d-flex pb-5"},[t("i",{staticClass:"uiIconClock darkGreyIcon uiIcon32x32 pe-5"}),e._v(" "),t("div",{staticClass:"d-inline-flex"},[e.event.allDay?[e._v("\n            "+e._s(e.$t("agenda.allDay"))+"\n          ")]:[t("date-format",{staticClass:"me-1",attrs:{value:e.event.startDate,format:e.dateTimeFormat}}),e._v("\n            -\n            "),t("date-format",{staticClass:"ms-1 me-2",attrs:{value:e.event.endDate,format:e.dateTimeFormat}})],e._v(" "),[e._v("\n            ( "+e._s(e.timeZoneName)+" )\n          ")]],2)]),e._v(" "),e.hasRecurrence?t("div",{staticClass:"event-recurrence align-center d-flex ps-1 pb-5 text-truncate"},[t("i",{staticClass:"uiIconRefresh darkGreyIcon uiIcon32x32 pe-5"}),e._v(" "),t("agenda-event-recurrence",{staticClass:"text-wrap text-left",attrs:{event:e.event}})],1):e._e(),e._v(" "),e.canAddReminders?t("div",{staticClass:"event-reminders align-center d-flex pb-5 text-truncate"},[t("i",{staticClass:"uiIcon32x32 notifIcon darkGreyIcon pe-5 mt-1 mb-auto"}),e._v(" "),t("v-list",{staticClass:"py-0 text-truncate",attrs:{dense:""}},[e.event.reminders&&e.event.reminders.length?e._l(e.event.reminders,(function(n,a){return t("v-list-item",{key:a,staticClass:"ps-0",attrs:{dense:""}},[t("v-chip",{staticClass:"mt-1 mb-2 me-2",attrs:{color:"primary",outlined:""}},[t("span",{staticClass:"text--primary text-truncate"},[n.before?[e._v("\n                    "+e._s(e.$t("agenda.label.notifyMeBefore",{0:n.before,1:e.$t(`agenda.option.${n.beforePeriodType.toLowerCase()}s`).toLowerCase()}))+"\n                  ")]:[e._v("\n                    "+e._s(e.$t("agenda.label.notifyMeWhenEventStarts"))+"\n                  ")]],2)])],1)})):t("v-list-item",[t("label",{staticClass:"text-sub-title font-italic mx-auto"},[e._v("\n              "+e._s(e.$t("agenda.noRemindersYet"))+"\n            ")])])],2),e._v(" "),t("v-btn",{staticClass:"mb-auto border-box-sizing",attrs:{icon:"",transparent:""},on:{click:function(t){return e.$refs.reminders.open()}}},[t("i",{staticClass:"uiIconEditInfo uiIcon16x16 darkGreyIcon pt-2"})])],1):e._e(),e._v(" "),e.isConferenceEnabled?t("div",{staticClass:"event-conference flex d-flex flex-grow-0 flex-shrink-1 pb-5"},[t("i",{staticClass:"uiIconVideo darkGreyIcon uiIcon32x32 pe-5"}),e._v(" "),t("v-btn",{staticClass:"text-lowercase text-truncate primary--text flex-shrink-1 flex-grow-1 d-inline pt-2",attrs:{title:e.eventConferenceUrl,href:e.eventConferenceUrl,link:"",text:""}},[t("template",{slot:"default"},[e._v("\n            "+e._s(e.eventConferenceUrl)+"\n          ")])],2)],1):e._e(),e._v(" "),e.event.location?t("div",{staticClass:"event-location d-flex flex-grow-0 flex-shrink-1 pb-5"},[t("i",{staticClass:"uiIconCheckin darkGreyIcon uiIcon32x32 pe-5"}),e._v(" "),t("span",{directives:[{name:"autolinker",rawName:"v-autolinker",value:e.event.location,expression:"event.location"}],staticClass:"align-self-center text-break"})]):e._e(),e._v(" "),e.event.description?t("div",{staticClass:"event-description d-flex flex-grow-0 flex-shrink-1 pb-5"},[t("i",{staticClass:"uiIconDescription darkGreyIcon uiIcon32x32 pe-5"}),e._v(" "),t("span",{directives:[{name:"autolinker",rawName:"v-autolinker:[autolinkerArgs]",value:e.event.description,expression:"event.description",arg:e.autolinkerArgs}],staticClass:"mt-1 align-self-center text-wrap text-left text-break"})]):e._e(),e._v(" "),e.event.attachments&&0!==e.event.attachments.length?t("div",{staticClass:"event-attachments align-center d-flex pb-5"},[t("i",{staticClass:"uiIconAttach darkGreyIcon uiIcon32x32 pe-5"}),e._v(" "),e._l(e.event.attachments,(function(e){return t("div",{key:e.name,staticClass:"uploadedFilesItem"},[t("div",{staticClass:"showFile"},[t("exo-attachment-item",{attrs:{file:e}})],1)])}))],2):e._e()])]),e._v(" "),t("div",{staticClass:"flex-grow-0 mx-5 d-none d-md-block"},[t("v-divider",{staticClass:"event-details-body-divider",attrs:{vertical:""}})],1),e._v(" "),t("div",{staticClass:"flex-grow-1 flex-shrink-0 d-flex event-details-body-right"},[t("div",{staticClass:"mx-10"},[t("agenda-event-attendees",{ref:"agendaAttendees",attrs:{event:e.event}}),e._v(" "),t("agenda-connector-contemporary-events",{staticClass:"mt-5",class:!e.isAcceptedEvent&&"agenda-hidden-connectors",attrs:{settings:e.settings,event:e.event,connectors:e.connectors}})],1)]),e._v(" "),e.canAddReminders?t("agenda-event-reminder-drawer",{ref:"reminders",attrs:{event:e.event}}):e._e()],1)};vt._withStripped=!0;const ut=v({props:{settings:{type:Object,default:()=>null},event:{type:Object,default:()=>({})},connectors:{type:Array,default:()=>[]},conferenceProvider:{type:Object,default:()=>null}},data:()=>({fullDateFormat:{year:"numeric",month:"short",day:"numeric"},dateDayFormat:{month:"short",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"},timeZoneName:null}),computed:{connectedConnector(){return this.connectors&&this.connectors.find((e=>e.connected))},isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},isConferenceEnabled(){return"manual"===this.eventConferenceType||this.conferenceProvider&&this.eventConferenceType&&this.conferenceProvider.getType()===this.eventConferenceType},eventConferences(){return this.event&&this.event.conferences},eventConference(){return this.eventConferences&&this.eventConferences.length&&this.eventConferences[0]},eventConferenceType(){return this.eventConference&&this.eventConference.type},eventConferenceUrl(){return this.eventConference&&this.eventConference.url},calendarOwnerLink(){if(this.owner){if("organization"===this.owner.providerId)return`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.owner.remoteId}`;if("space"===this.owner.providerId)return`${eXo.env.portal.context}/g/:spaces:${this.owner.remoteId}/`}return""},hasRecurrence(){return this.event.recurrence||this.event.parent&&this.event.parent.recurrence},isAttendee(){return this.event.acl&&this.event.acl.attendee},isAcceptedEvent(){if(!this.isAttendee)return!1;const e=this.event.attendees.find((e=>e&&e.identity.remoteId===eXo.env.portal.userName));return e&&"DECLINED"!==e.response},owner(){return this.event&&this.event.calendar&&this.event.calendar.owner},ownerProfile(){return this.owner&&(this.owner.profile||this.owner.space)},ownerAvatarUrl(){return this.ownerProfile&&(this.ownerProfile.avatar||this.ownerProfile.avatarUrl)},ownerDisplayName(){return this.ownerProfile&&(this.ownerProfile.displayName||this.ownerProfile.fullname||this.ownerProfile.fullName)},sameDayDates(){return this.event.startDate&&this.event.endDate&&this.$agendaUtils.areDatesOnSameDay(this.event.startDate,this.event.endDate)},canAddReminders(){if(!this.isAttendee)return!1;const e=this.event.attendees.find((e=>e&&e.identity.remoteId===eXo.env.portal.userName));return e&&("ACCEPTED"===e.response||"TENTATIVE"===e.response)},acceptedResponsesCount(){return this.event&&this.event.attendees&&this.event.attendees.length?this.event.attendees.filter((e=>e&&"ACCEPTED"===e.response)).length:0},refusedResponsesCount(){return this.event&&this.event.attendees&&this.event.attendees.length?this.event.attendees.filter((e=>e&&"DECLINED"===e.response)).length:0},tentativeResponsesCount(){return this.event&&this.event.attendees&&this.event.attendees.length?this.event.attendees.filter((e=>e&&"TENTATIVE"===e.response)).length:0},needsActionResponsesCount(){return this.event&&this.event.attendees&&this.event.attendees.length?this.event.attendees.filter((e=>e&&"NEEDS_ACTION"===e.response)).length:0},attendeesResponsesTitle(){return this.$t("agenda.attendeesResponsesOverview",{0:this.acceptedResponsesCount,1:this.refusedResponsesCount,2:this.needsActionResponsesCount,3:this.tentativeResponsesCount})}},created(){this.timeZoneName=this.$agendaUtils.getTimeZoneNameFromTimeZoneId(this.$agendaUtils.USER_TIMEZONE_ID)},methods:{closeDialog(){this.$emit("close")}}},vt,[],!1,null,null,null).exports;var ht=function(){var e=this,t=e._self._c;return t("v-row",{staticClass:"event-details-header d-flex align-center flex-nowrap text-left col-12 mx-0"},[t("v-col",{staticClass:"event-title title text-truncate col-auto ps-4 mx-2",attrs:{title:e.event.summary}},[e._v("\n    "+e._s(e.event.summary)+"\n  ")]),e._v(" "),t("v-col",{staticClass:"flex-grow-0 flex-shrink-0 px-0 mx-2"},[e._v("\n    "+e._s(e.$t("agenda.label.in"))+"\n  ")]),e._v(" "),t("v-col",{staticClass:"flex-grow-1 text-truncate flex-shrink-0 d-flex px-0 mx-2"},[t("exo-space-avatar",{attrs:{space:e.ownerProfile,size:32,popover:""}})],1),e._v(" "),t("v-col",{staticClass:"px-0 flex-grow-1 flex-shrink-0 mx-2"},[e.isTentativeEvent||!e.isAttendee||e.isMobile?e._e():[t("agenda-event-attendee-buttons",{ref:"eventAttendeeButtons",attrs:{event:e.event}})]],2),e._v(" "),t("v-col",{staticClass:"px-0 flex-grow-0 flex-shrink-0 text-right mx-2"},[e.canEdit?t("v-menu",{attrs:{eager:"",bottom:"",left:"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:a}){return[t("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",a,!1),n),[t("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!1,3221905750),model:{value:e.eventMenu,callback:function(t){e.eventMenu=t},expression:"eventMenu"}},[e._v(" "),t("v-list",[e.canEdit?t("v-list-item",{on:{click:function(t){return e.$emit("edit")}}},[t("v-list-item-title",[e._v("\n            "+e._s(e.$t("agenda.details.header.menu.edit"))+"\n          ")])],1):e._e(),e._v(" "),e.canEdit?t("v-list-item",{on:{click:function(t){return e.$emit("delete")}}},[t("v-list-item-title",[e._v("\n            "+e._s(e.$t("agenda.details.header.menu.delete"))+"\n          ")])],1):e._e()],1)],1):e._e()],1),e._v(" "),t("v-col",{staticClass:"px-0 flex-grow-0 flex-shrink-0 me-2"},[t("v-btn",{attrs:{color:"grey",icon:""},on:{click:function(t){return e.$emit("close")}}},[t("v-icon",[e._v("\n        mdi-close\n      ")])],1)],1)],1)};ht._withStripped=!0;const pt=v({props:{event:{type:Object,default:()=>({})},connectedConnector:{type:Object,default:()=>null},isAttendee:{type:Boolean,default:!1}},data:()=>({eventMenu:null}),computed:{isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name},calendarOwnerLink(){if(this.owner){if("organization"===this.owner.providerId)return`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.owner.remoteId}`;if("space"===this.owner.providerId)return`${eXo.env.portal.context}/g/:spaces:${this.owner.remoteId}/`}return""},canEdit(){return this.event.acl&&this.event.acl.canEdit},owner(){return this.event&&this.event.calendar&&this.event.calendar.owner},ownerProfile(){return this.owner&&(this.owner.profile||this.owner.space)},ownerAvatarUrl(){return this.ownerProfile&&(this.ownerProfile.avatar||this.ownerProfile.avatarUrl)},ownerDisplayName(){return this.ownerProfile&&(this.ownerProfile.displayName||this.ownerProfile.fullname||this.ownerProfile.fullName)},labels(){return{CancelRequest:this.$t("profile.CancelRequest"),Confirm:this.$t("profile.Confirm"),Connect:this.$t("profile.Connect"),Ignore:this.$t("profile.Ignore"),RemoveConnection:this.$t("profile.RemoveConnection"),StatusTitle:this.$t("profile.StatusTitle"),join:this.$t("space.join"),leave:this.$t("space.leave"),members:this.$t("space.members")}},isTentativeEvent(){return this.event&&"TENTATIVE"===this.event.status}},mounted(){$(".agendaEventDialog").parent().click((()=>{this.eventMenu=!1}))}},ht,[],!1,null,null,null).exports;var mt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex flex-row py-2"},[t("v-avatar",{staticClass:"mx-3 my-auto spaceAvatar space-avatar-header",attrs:{height:"32","min-height":"32",width:"32","min-width":"32","max-width":"32",size:"32"}},[t("v-img",{attrs:{src:e.ownerAvatarUrl}})],1),e._v(" "),t("div",{staticClass:"d-block text-truncate flex-grow-1 align-left"},[t("strong",{staticClass:"event-header-title text-truncate",attrs:{title:e.event.summary}},[e._v("\n      "+e._s(e.event.summary)+"\n    ")]),e._v(" "),t("div",{staticClass:"text-truncate d-flex"},[t("span",[e._v(e._s(e.$t("agenda.label.in")))]),e._v(" "),t("a",{staticClass:"text-truncate calendar-owner-link ps-1",attrs:{href:e.calendarOwnerLink}},[e._v(e._s(e.ownerDisplayName))])])]),e._v(" "),t("div",{staticClass:"d-flex flex-grow-0"},[e.canEdit?t("v-menu",{attrs:{bottom:"",left:"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:a}){return[t("v-btn",e._g(e._b({staticClass:"my-auto me-2",attrs:{icon:""}},"v-btn",a,!1),n),[t("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!1,3580313111)},[e._v(" "),t("v-list",[e.canEdit?t("v-list-item",{on:{click:function(t){return e.$emit("edit")}}},[t("v-list-item-title",[e._v("\n            "+e._s(e.$t("agenda.details.header.menu.edit"))+"\n          ")])],1):e._e(),e._v(" "),e.canEdit?t("v-list-item",{on:{click:function(t){return e.$emit("delete")}}},[t("v-list-item-title",[e._v("\n            "+e._s(e.$t("agenda.details.header.menu.delete"))+"\n          ")])],1):e._e()],1)],1):e._e()],1),e._v(" "),t("div",{staticClass:"d-flex flex-grow-0"},[t("v-btn",{staticClass:"my-auto me-2",attrs:{color:"grey",icon:""},on:{click:function(t){return e.$emit("close")}}},[t("v-icon",[e._v("\n        mdi-close\n      ")])],1)],1)],1)};mt._withStripped=!0;const gt=v({props:{event:{type:Object,default:()=>({})},connectedConnector:{type:Object,default:()=>null}},computed:{calendarOwnerLink(){if(this.owner){if("organization"===this.owner.providerId)return`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.owner.remoteId}`;if("space"===this.owner.providerId)return`${eXo.env.portal.context}/g/:spaces:${this.owner.remoteId}/`}return""},canEdit(){return this.event.acl&&this.event.acl.canEdit},owner(){return this.event&&this.event.calendar&&this.event.calendar.owner},ownerProfile(){return this.owner&&(this.owner.profile||this.owner.space)},ownerAvatarUrl(){return this.ownerProfile&&(this.ownerProfile.avatar||this.ownerProfile.avatarUrl)},ownerDisplayName(){return this.ownerProfile&&(this.ownerProfile.displayName||this.ownerProfile.fullname||this.ownerProfile.fullName)}}},mt,[],!1,null,null,null).exports;var ft=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex flex-row py-2"},[t("v-avatar",{staticClass:"mx-3 my-auto spaceAvatar space-avatar-header",attrs:{height:"32","min-height":"32",width:"32","min-width":"32","max-width":"32",size:"32"}},[t("v-img",{attrs:{src:e.ownerAvatarUrl}})],1),e._v(" "),t("div",{staticClass:"event-header-title d-flex flex-grow-1 flex-column align-left"},[t("strong",{staticClass:"text-truncate"},[e._v("\n      "+e._s(e.event.summary)+"\n    ")]),e._v(" "),t("div",{staticClass:"text-truncate caption"},[e._v("\n      "+e._s(e.$t("agenda.label.createdBy",{0:e.creatorFullName}))+"\n    ")])]),e._v(" "),t("div",{staticClass:"d-flex flex-grow-0"},[e.isAttendee?t("v-menu",{attrs:{bottom:"",left:"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:n,attrs:a}){return[t("v-btn",e._g(e._b({staticClass:"my-auto me-2",attrs:{icon:""}},"v-btn",a,!1),n),[t("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!1,3580313111)},[e._v(" "),t("v-list",[e.canEdit?t("v-list-item",{on:{click:function(t){return e.$emit("edit")}}},[t("v-list-item-title",[e._v("\n            "+e._s(e.$t("agenda.details.header.menu.edit"))+"\n          ")])],1):e._e(),e._v(" "),e.isAttendee?t("v-list-item",{on:{click:function(t){return e.$root.$emit("agenda-date-poll-change-vote")}}},[t("v-list-item-title",[e._v("\n            "+e._s(e.$t("agenda.changeVote"))+"\n          ")])],1):e._e()],1)],1):e._e()],1),e._v(" "),t("div",{staticClass:"d-flex flex-grow-0"},[t("v-btn",{staticClass:"my-auto me-2",attrs:{color:"grey",icon:""},on:{click:function(t){return e.$emit("close")}}},[t("v-icon",[e._v("\n        mdi-close\n      ")])],1)],1)],1)};ft._withStripped=!0;const yt=v({props:{event:{type:Object,default:()=>({})}},data:()=>({fullDateFormat:{year:"numeric",month:"short",day:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{isAttendee(){return this.event.acl&&this.event.acl.attendee},canEdit(){return this.event.acl&&this.event.acl.canEdit},owner(){return this.event&&this.event.calendar&&this.event.calendar.owner},ownerProfile(){return this.owner&&(this.owner.profile||this.owner.space)},ownerAvatarUrl(){return this.ownerProfile&&(this.ownerProfile.avatar||this.ownerProfile.avatarUrl)},creatorFullName(){return this.event&&this.event.creator&&this.event.creator.profile&&this.event.creator.profile.fullname||""}}},ft,[],!1,null,null,null).exports;var $t=function(){var e=this;return(0,e._self._c)("div",[e._v("\n  "+e._s(e.recurrenceLabel)+"\n  "),e.endLabel?[e._v("\n    ( "+e._s(e.endLabel)+" )\n  ")]:e._e()],2)};$t._withStripped=!0;const Ct=v({props:{event:{type:Object,default:null}},computed:{recurrence(){return this.event.recurrence||this.event.parent&&this.event.parent.recurrence},recurrenceFrequency(){return this.recurrence&&this.recurrence.frequency},endLabel(){if(this.recurrence){if(this.recurrence.count>0)return this.$t("agenda.endsAfterEvents",{0:this.recurrence.count});if(this.recurrence.until)return this.$t("agenda.endsAt",{0:this.$dateUtil.formatDateObjectToDisplay(this.$agendaUtils.toDate(this.recurrence.until),{year:"numeric",month:"long",day:"numeric"},eXo.env.portal.language)})}return null},recurrenceLabel(){if(!this.recurrenceFrequency)return"";switch(this.recurrenceFrequency){case"DAILY":return 1===this.recurrence.interval?this.$t("agenda.daily"):this.$t("agenda.dailyByInterval",{0:this.recurrence.interval});case"WEEKLY":if(1===this.recurrence.interval&&1===this.recurrence.byDay.length){const e=this.recurrence.byDay[0],t=this.$agendaUtils.getDayNameFromDayAbbreviation(e,eXo.env.portal.language);return this.$t("agenda.weekly",{0:t})}if(1===this.recurrence.interval&&this.recurrence.byDay.length>1){const e=this.recurrence.byDay.map((e=>this.$agendaUtils.getDayNameFromDayAbbreviation(e,eXo.env.portal.language))).join(" , ").replace(/,([^,]*)$/,`${this.$t("agenda.and")}$1`);return this.$t("agenda.weekly",{0:e})}if(1===this.recurrence.byDay.length){const e=this.recurrence.byDay[0],t=this.$agendaUtils.getDayNameFromDayAbbreviation(e,eXo.env.portal.language);return this.$t("agenda.weeklyByInterval",{0:this.recurrence.interval,1:t})}{const e=this.recurrence.byDay.map((e=>this.$agendaUtils.getDayNameFromDayAbbreviation(e,eXo.env.portal.language))).join(" , ").replace(/,([^,]*)$/,`${this.$t("agenda.and")}$1`);return this.$t("agenda.weeklyByInterval",{0:this.recurrence.interval,1:e})}case"MONTHLY":if(1===this.recurrence.interval){const e=this.recurrence.byMonthDay&&this.recurrence.byMonthDay[0];return this.$t("agenda.monthly",{0:e})}{const e=this.recurrence.byMonthDay[0];return this.$t("agenda.monthlyByInterval",{0:this.recurrence.interval,1:e})}case"YEARLY":if(1===this.recurrence.interval){const e=this.recurrence.byMonthDay&&this.recurrence.byMonthDay[0],t=this.recurrence.byMonth&&this.recurrence.byMonth[0],n=t&&this.$agendaUtils.getMonthNameFromMonthNumber(t-1)||"";return this.$t("agenda.yearly",{0:n,1:e})}{const e=this.recurrence.byMonthDay[0],t=this.recurrence.byMonth[0],n=this.$agendaUtils.getMonthNameFromMonthNumber(t-1);return this.$t("agenda.yearlyByInterval",{0:this.recurrence.interval,1:n,2:e})}}return""}}},$t,[],!1,null,null,null).exports;var _t=function(){var e=this,t=e._self._c;return e.isPastEvent?e._e():t("div",{staticClass:"d-flex flex-column"},[t("div",{staticClass:"title d-md-none mt-2 mb-3 mx-4"},[e._v("\n    "+e._s(e.$t("agenda.doYouParticipate"))+"\n  ")]),e._v(" "),t("div",{staticClass:"event-attendees-responses d-flex ms-auto"},[t("v-btn",{staticClass:"btn border-radius",class:"ACCEPTED"===e.eventResponse&&"btn-primary",attrs:{loading:"ACCEPTED"===e.savingResponse,disabled:e.savingResponse,value:"ACCEPTED"},on:{click:function(t){return e.changeResponse("ACCEPTED")}}},[t("v-icon",{staticClass:"me-4",attrs:{size:"20"}},[e._v("fas fa-check-circle")]),e._v("\n      "+e._s(e.$t("agenda.button.yes"))+"\n    ")],1),e._v(" "),t("v-btn",{staticClass:"btn border-radius mx-2",class:"DECLINED"===e.eventResponse&&"btn-primary",attrs:{loading:"DECLINED"===e.savingResponse,disabled:e.savingResponse,value:"DECLINED"},on:{click:function(t){return e.changeResponse("DECLINED")}}},[t("v-icon",{staticClass:"me-4",attrs:{size:"20"}},[e._v("fas fa-times-circle")]),e._v("\n      "+e._s(e.$t("agenda.button.no"))+"\n    ")],1),e._v(" "),t("v-btn",{staticClass:"btn border-radius",class:"TENTATIVE"===e.eventResponse&&"btn-primary",attrs:{loading:"TENTATIVE"===e.savingResponse,disabled:e.savingResponse,value:"TENTATIVE"},on:{click:function(t){return e.changeResponse("TENTATIVE")}}},[t("v-icon",{staticClass:"me-4",attrs:{size:"20"}},[e._v("fas fa-info-circle")]),e._v("\n      "+e._s(e.$t("agenda.button.maybe"))+"\n    ")],1),e._v(" "),e.event.occurrence?t("agenda-recurrent-event-response-confirm-dialog",{ref:"responseConfirmDialog",attrs:{event:e.event}}):e._e()],1)])};_t._withStripped=!0;const wt=v({props:{event:{type:Object,default:()=>null}},data:()=>({savingResponse:!1}),computed:{isPastEvent(){return!this.event||!(!this.event.start||!this.event.end)&&this.$agendaUtils.toDate(this.event.end).getTime()<Date.now()},userAttendee(){return this.event&&this.event.attendees&&this.event.attendees.length?this.event.attendees.find((e=>e.identity&&Number(e.identity.id)===Number(eXo.env.portal.userIdentityId))):null},eventResponse(){return this.userAttendee&&this.userAttendee.response||"NEEDS_ACTION"}},methods:{changeResponse(e){this.event.occurrence&&this.event.parent&&(!this.event.parent.acl||this.event.parent.acl.attendee)?this.$refs.responseConfirmDialog.open(e):(this.savingResponse=e,this.$eventService.sendEventResponse(this.event.id,null,e).then((()=>this.$root.$emit("agenda-event-response-sent",this.event,null,e))).finally((()=>this.savingResponse=!1)))}}},_t,[],!1,null,null,null).exports;var Dt=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"event-attendees-responses align-center d-flex"},[t("i",{staticClass:"uiIconGroup darkGreyIcon uiIcon32x32 pe-5"}),e._v(" "),t("span",[e._v(e._s(e.attendeesResponsesTitle))])]),e._v(" "),t("div",{staticClass:"event-attendees ps-5 ms-7 mt-2 flex-column"},e._l(e.displayedAttendees,(function(n){return t("agenda-event-attendee-item",{key:n,staticClass:"mb-4",attrs:{attendee:n,creator:e.event.creator}})})),1)])};Dt._withStripped=!0;const bt=v({props:{event:{type:Object,default:()=>null}},computed:{attendees(){return this.event&&this.event.attendees||[]},creatorAttendee(){return this.event&&this.attendees&&this.attendees.length?this.attendees.find((e=>e.identity.id===this.event.creator.id)):null},creatorAttendeeResponse(){return this.creatorAttendee&&this.creatorAttendee.response},participatingAttendees(){return this.creatorAttendee?this.attendees.filter((e=>e.identity.id!==this.creatorAttendee.identity.id)):this.attendees},participatingUserAttendees(){return this.participatingAttendees.filter((e=>e.identity.profile))},participatingSpaceAttendees(){return this.participatingAttendees.filter((e=>e.identity.space)).sort(this.sortAttendees)},acceptedResponses(){return this.participatingUserAttendees.filter((e=>e&&"ACCEPTED"===e.response)).sort(this.sortAttendees)},tentativeResponses(){return this.participatingUserAttendees.filter((e=>e&&"TENTATIVE"===e.response)).sort(this.sortAttendees)},refusedResponses(){return this.participatingUserAttendees.filter((e=>e&&"DECLINED"===e.response)).sort(this.sortAttendees)},needsActionResponses(){return this.participatingUserAttendees.filter((e=>e&&"NEEDS_ACTION"===e.response)).sort(this.sortAttendees)},acceptedResponsesCount(){return this.acceptedResponses.length+("ACCEPTED"===this.creatorAttendeeResponse?1:0)},tentativeResponsesCount(){return this.tentativeResponses.length+("TENTATIVE"===this.creatorAttendeeResponse?1:0)},refusedResponsesCount(){return this.refusedResponses.length+("DECLINED"===this.creatorAttendeeResponse?1:0)},needsActionResponsesCount(){return this.needsActionResponses.length+("NEEDS_ACTION"===this.creatorAttendeeResponse?1:0)},displayedAttendees(){return[this.creatorAttendee,...this.acceptedResponses,...this.tentativeResponses,...this.refusedResponses,...this.needsActionResponses,...this.participatingSpaceAttendees]},attendeesResponsesTitle(){return this.$t("agenda.attendeesResponsesOverview",{0:this.acceptedResponsesCount,1:this.refusedResponsesCount,2:this.needsActionResponsesCount,3:this.tentativeResponsesCount})}},methods:{sortAttendees(e,t){const n=e.identity.profile&&e.identity.profile.fullname||e.identity.space&&e.identity.space.displayName||"",a=t.identity.profile&&t.identity.profile.fullname||t.identity.space&&t.identity.space.displayName||"";return n.localeCompare(a)}}},Dt,[],!1,null,null,null).exports;var Et=function(){var e=this,t=e._self._c;return e.isAttendeeUser?t("exo-user-avatar",{attrs:{identity:e.attendeeIdentity,url:e.attendeeProfileLink,size:32,"avatar-class":"border-color","extra-class":"attendee mb-4",popover:"","link-style":""}},[t("template",{slot:"actions"},[t("div",{staticClass:"my-auto flex-grow-1 text-right",attrs:{title:e.responseIconTooltip}},[e.isCreator?t("v-icon",{staticClass:"mb-2",attrs:{title:e.$t("agenda.eventCreator"),size:16}},[e._v("\n        fa-crown\n      ")]):e._e(),e._v(" "),t("span",{class:e.responseIconResponse})],1)])],2):e.isAttendeeSpace?t("div",{staticClass:"attendee"},[t("exo-space-avatar",{attrs:{space:e.attendeeSpace,size:32,popover:""}}),e._v(" "),t("span",{staticClass:"my-auto text-right",class:e.responseIconResponse,attrs:{title:e.responseIconTooltip}})],1):e.isAttendeeGuest?t("div",{staticClass:"attendee"},[t("v-avatar",{staticClass:"mx-0 my-auto",attrs:{left:"",size:"32"}},[t("v-img",{attrs:{src:"/portal/rest/v1/social/users/default-image/avatar"}})],1),e._v(" "),t("span",{staticClass:"mx-1 my-auto primary--text"},[e._v("\n    "+e._s(this.attendee.identity.remoteId)+" ("+e._s(e.$t("agenda.label.guest"))+")\n  ")])],1):e._e()};Et._withStripped=!0;const xt=v({props:{attendee:{type:Object,default:()=>({})},creator:{type:Object,default:()=>null}},computed:{isCreator(){return this.creator&&this.attendee.identity&&Number(this.creator.id)===Number(this.attendee.identity.id)},responseIconResponse(){return this.attendee&&this.attendee.response&&`attendee-response attendee-response-${this.attendee.response.toLowerCase()}`},responseIconTooltip(){return this.attendee&&this.attendee.response&&this.$t(`agenda.${this.attendee.response.toLowerCase()}`)},isAttendeeUser(){return this.attendee&&this.attendee.identity&&"organization"===this.attendee.identity.providerId},isAttendeeSpace(){return this.attendee&&this.attendee.identity&&"space"===this.attendee.identity.providerId},isAttendeeGuest(){return this.attendee&&this.attendee.identity&&"GUEST_USER"===this.attendee.identity.providerId},attendeeSpace(){return this.isAttendeeSpace?this.attendee.identity.space:null},attendeeProfileLink(){if(this.isAttendeeUser)return`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.attendee.identity.remoteId}`;if(this.isAttendeeSpace){let e=this.attendee.identity.space.groupId;if(e)return e=e.replace(/\//g,":"),`${eXo.env.portal.context}/g/${e}/`}return""},attendeeIdentity(){return this.attendee&&this.attendee.identity&&this.attendee.identity.profile},labels(){return{CancelRequest:this.$t("profile.CancelRequest"),Confirm:this.$t("profile.Confirm"),Connect:this.$t("profile.Connect"),Ignore:this.$t("profile.Ignore"),RemoveConnection:this.$t("profile.RemoveConnection"),StatusTitle:this.$t("profile.StatusTitle"),join:this.$t("space.join"),leave:this.$t("space.leave"),External:this.$t("agenda.label.external"),Disabled:this.$t("agenda.label.disabled"),members:this.$t("space.members")}}}},Et,[],!1,null,null,null).exports;var Tt=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"drawer",attrs:{"confirm-close":e.confirmClose,"confirm-close-labels":e.confirmCloseLabels,"body-classes":"hide-scroll decrease-z-index-more",right:"",persistent:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("agenda.title.eventReminders"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("v-form",{ref:"agendaSettingsForm",staticClass:"flex",attrs:{flat:""}},[t("v-layout",{staticClass:"ma-5 d-flex flex-column"},[t("agenda-reminder-user-settings",{ref:"reminders",attrs:{reminders:e.eventReminders}})],1)],1),e._v(" "),e.event.occurrence&&e.event.occurrence.id?t("agenda-recurrent-event-reminders-confirm-dialog",{ref:"remindersConfirmDialog",attrs:{event:e.event}}):e._e()],1),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex"},[t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn me-2",on:{click:e.close}},[[e._v("\n          "+e._s(e.$t("agenda.button.cancel"))+"\n        ")]],2),e._v(" "),t("v-btn",{staticClass:"btn btn-primary",on:{click:e.save}},[e._v("\n        "+e._s(e.$t("agenda.button.save"))+"\n      ")])],1)])],2)};Tt._withStripped=!0;const It=v({props:{event:{type:Object,default:null}},data:()=>({eventReminders:[],saved:!1}),computed:{confirmCloseLabels(){return{title:this.$t("agenda.settings.drawer.confirmCancelChanges.title"),message:this.$t("agenda.settings.drawer.confirmCancelChanges"),ok:this.$t("agenda.button.yes"),cancel:this.$t("agenda.button.no")}},confirmClose(){return!this.saved&&!this.$agendaUtils.areSameObjects(this.event.reminders,this.eventReminders)}},created(){this.$root.$on("agenda-event-reminders-saved",(()=>{this.$nextTick().then((()=>this.$refs.drawer&&this.$refs.drawer.close()))}))},methods:{open(){this.eventReminders=this.event.reminders&&JSON.parse(JSON.stringify(this.event.reminders))||[],this.saved=!1,this.$refs.drawer.open()},close(){this.$refs.drawer.close()},save(){if(this.validateForm()){if(!this.event.occurrence||!this.event.occurrence.id)return this.$refs.drawer.startLoading(),this.$eventService.saveEventReminders(this.event.id,null,this.eventReminders).then((()=>(this.saved=!0,this.$nextTick()))).then((()=>{this.$root.$emit("agenda-event-reminders-saved",this.event,null,this.eventReminders),this.$refs.drawer.close()})).finally((()=>{this.$refs.drawer.endLoading()}));this.$refs.remindersConfirmDialog.open(this.eventReminders)}},validateForm(){if(this.$refs.agendaSettingsForm.validate()&&this.$refs.agendaSettingsForm.$el.reportValidity())return!0}}},Tt,[],!1,null,null,null).exports;var At=function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{"content-class":"uiPopup",width:"300"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",{staticClass:"elevation-12"},[t("div",{staticClass:"ignore-vuetify-classes popupHeader ClearFix"},[t("a",{staticClass:"uiIconClose pull-right",attrs:{"aria-hidden":"true"},on:{click:e.close}}),e._v(" "),t("span",{staticClass:"ignore-vuetify-classes PopupTitle popupTitle text-truncate"},[e._v("\n        "+e._s(e.$t("agenda.confirmSaveRecurrentEventTitle"))+"\n      ")])]),e._v(" "),t("v-card-text",[t("v-radio-group",{model:{value:e.recurrenceModificationType,callback:function(t){e.recurrenceModificationType=t},expression:"recurrenceModificationType"}},[t("v-radio",{attrs:{label:e.$t("agenda.onlyThisEvent"),value:"single"}}),e._v(" "),t("v-radio",{attrs:{label:e.$t("agenda.thisAndUpcomingEvents"),value:"upcoming"}}),e._v(" "),t("v-radio",{attrs:{label:e.$t("agenda.allEvents"),value:"all"}})],1)],1),e._v(" "),t("v-card-actions",{staticClass:"d-flex flex-wrap justify-center center"},[t("button",{staticClass:"ignore-vuetify-classes btn me-2 mb-1",attrs:{disabled:e.loading,loading:e.loading},on:{click:e.close}},[e._v("\n        "+e._s(e.$t("agenda.button.cancel"))+"\n      ")]),e._v(" "),t("button",{staticClass:"ignore-vuetify-classes btn-primary ms-2 mb-1",attrs:{disabled:e.loading,loading:e.loading},on:{click:e.saveRecurrentEventChoice}},[e._v("\n        "+e._s(e.$t("agenda.button.save"))+"\n      ")])])],1)],1)};At._withStripped=!0;const St=v({data:()=>({event:null,changeDatesOnly:!1,recurrenceModificationType:"single",loading:!1,dialog:!1}),watch:{dialog(){this.dialog?this.$emit("dialog-opened"):this.$emit("dialog-closed")}},created(){$(document).on("keydown",(e=>{"Escape"===e.key&&(this.dialog=!1)}))},methods:{saveRecurrentEventChoice(e){e&&(e.preventDefault(),e.stopPropagation()),"single"===this.recurrenceModificationType?this.saveOccurrenceEvent():"all"===this.recurrenceModificationType?this.saveRecurrentEvent():"upcoming"===this.recurrenceModificationType&&this.saveUpcomingEvents()},saveUpcomingEvents(e){e&&(e.preventDefault(),e.stopPropagation());let t=this.event.parent;this.$eventService.getEventById(t.id,"all").then((e=>{t=JSON.parse(JSON.stringify(e));const n=new Date(this.event.occurrence.id);return n.setDate(n.getDate()-1),n.setHours(23),n.setMinutes(59),n.setSeconds(59),new Date(t.start)>=n?this.saveRecurrentEvent():(e.recurrence.until=this.$agendaUtils.toRFC3339(n),e.sendInvitation=!1,this.$eventService.updateEvent(e).then((()=>(t.start=this.event.start,t.end=this.event.end,t.attachments=this.event.attachments,t.attendees=this.event.attendees,t.conferences=this.event.conferences,t.description=this.event.description,t.location=this.event.location,t.summary=this.event.summary,t.recurrence=this.event.recurrence,delete t.id,this.$eventService.createEvent(t)))).then((()=>{this.close(),this.$root.$emit("agenda-event-saved",t)})))}))},saveRecurrentEvent(e){e&&(e.preventDefault(),e.stopPropagation());const t=JSON.parse(JSON.stringify(this.event));t.id=this.event.parent.id,t.remoteId=t.parent&&t.parent.remoteId||"",t.remoteProviderId=t.parent&&t.parent.remoteProviderId||0,t.recurrence=this.event.recurrence||this.event.parent.recurrence,t.occurrence=null,t.parent=null,t.start=this.$agendaUtils.getSameTime(this.event.parent.start,this.event.start),t.end=this.$agendaUtils.getSameTime(this.event.parent.end,this.event.end),this.$emit("save-event",t,this.changeDatesOnly)},saveOccurrenceEvent(e){e&&(e.preventDefault(),e.stopPropagation());const t=JSON.parse(JSON.stringify(this.event));this.$emit("save-event",t,this.changeDatesOnly)},close(e){e&&(e.preventDefault(),e.stopPropagation()),this.dialog=!1},open(e,t){this.event=e,this.recurrenceModificationType="single",this.changeDatesOnly=t,this.dialog=!0}}},At,[],!1,null,null,null).exports;var kt=function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{"content-class":"uiPopup width-auto",width:"300"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",{staticClass:"elevation-12"},[t("div",{staticClass:"ignore-vuetify-classes popupHeader ClearFix"},[t("a",{staticClass:"uiIconClose pull-right",attrs:{"aria-hidden":"true"},on:{click:e.close}}),e._v(" "),t("span",{staticClass:"ignore-vuetify-classes PopupTitle popupTitle text-truncate"},[e._v("\n        "+e._s(e.$t("agenda.confirmCancelRecurrentEventTitle"))+"\n      ")])]),e._v(" "),t("v-card-text",[t("v-radio-group",{model:{value:e.recurrenceModificationType,callback:function(t){e.recurrenceModificationType=t},expression:"recurrenceModificationType"}},[t("v-radio",{attrs:{label:e.$t("agenda.onlyThisEvent"),value:"single"}}),e._v(" "),t("v-radio",{attrs:{label:e.$t("agenda.thisAndUpcomingEvents"),value:"upcoming"}}),e._v(" "),t("v-radio",{attrs:{label:e.$t("agenda.allEvents"),value:"all"}})],1)],1),e._v(" "),t("v-card-actions",{staticClass:"d-flex flex-wrap justify-center center"},[t("button",{staticClass:"ignore-vuetify-classes btn me-2 mb-1",attrs:{disabled:e.loading,loading:e.loading},on:{click:e.close}},[e._v("\n        "+e._s(e.$t("agenda.button.cancel"))+"\n      ")]),e._v(" "),t("button",{staticClass:"ignore-vuetify-classes btn-primary ms-2 mb-1",attrs:{disabled:e.loading,loading:e.loading},on:{click:e.deleteRecurrentEventChoice}},[e._v("\n        "+e._s(e.$t("agenda.button.save"))+"\n      ")])])],1)],1)};kt._withStripped=!0;const Ot=v({props:{event:{type:Object,default:function(){return null}}},data:()=>({loading:!1,recurrenceModificationType:"single",dialog:!1}),watch:{dialog(){this.dialog?this.$emit("dialog-opened"):this.$emit("dialog-closed")}},created(){$(document).on("keydown",(e=>{"Escape"===e.key&&(this.dialog=!1)}))},methods:{deleteRecurrentEventChoice(e){e&&(e.preventDefault(),e.stopPropagation()),"single"===this.recurrenceModificationType?this.deleteOccurrenceEvent():"all"===this.recurrenceModificationType?this.deleteRecurrentEvent():"upcoming"===this.recurrenceModificationType&&this.deleteUpcomingEvents()},deleteUpcomingEvents(e){e&&(e.preventDefault(),e.stopPropagation());let t=this.event.parent;return this.$eventService.getEventById(t.id,"all").then((e=>{t=JSON.parse(JSON.stringify(e));const n=new Date(this.event.occurrence.id);return n.setDate(n.getDate()-1),n.setHours(23),n.setMinutes(59),n.setSeconds(59),new Date(t.start)>=n?this.deleteRecurrentEvent():(e.recurrence.until=this.$agendaUtils.toRFC3339(n),this.$eventService.updateEvent(e).then((e=>{this.$root.$emit("agenda-event-deleted",e,!0),this.close()})))}))},deleteRecurrentEvent(e){return e&&(e.preventDefault(),e.stopPropagation()),this.loading=!0,this.$eventService.deleteEvent(this.event.parent.id).then((()=>{this.$root.$emit("agenda-event-deleted",this.event.parent),this.close()})).finally((()=>this.loading=!1))},deleteOccurrenceEvent(e){e&&(e.preventDefault(),e.stopPropagation());let t=null;t=this.event.id?this.$eventService.updateEvent:this.$eventService.createEvent;const n=JSON.parse(JSON.stringify(this.event));return delete n.recurrence,n.status="CANCELLED",this.loading=!0,t(n).then((e=>{this.$root.$emit("agenda-event-deleted",e),this.dialog=!1})).finally((()=>this.loading=!1))},close(e){e&&(e.preventDefault(),e.stopPropagation()),this.dialog=!1},open(){this.dialog=!0}}},kt,[],!1,null,null,null).exports;var Pt=function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{width:e.width,"content-class":"uiPopup width-auto","max-width":"100vw"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",{staticClass:"elevation-12"},[t("div",{staticClass:"ignore-vuetify-classes popupHeader ClearFix"},[t("a",{staticClass:"uiIconClose pull-right",attrs:{"aria-hidden":"true"},on:{click:e.close}}),e._v(" "),t("span",{staticClass:"ignore-vuetify-classes PopupTitle popupTitle text-truncate"},[e._v("\n        "+e._s(e.$t("agenda.title.confirmSaveRecurrentEvent"))+"\n      ")])]),e._v(" "),t("v-card-text",[t("v-radio-group",{model:{value:e.recurrenceResponseType,callback:function(t){e.recurrenceResponseType=t},expression:"recurrenceResponseType"}},[t("v-radio",{attrs:{label:e.$t("agenda.onlyThisEvent"),value:"single"}}),e._v(" "),t("v-radio",{attrs:{label:e.$t("agenda.thisAndUpcomingEvents"),value:"upcoming"}}),e._v(" "),t("v-radio",{attrs:{label:e.$t("agenda.allEvents"),value:"all"}})],1)],1),e._v(" "),t("v-card-actions",{staticClass:"d-flex flex-wrap justify-center center"},[t("button",{staticClass:"ignore-vuetify-classes btn me-2 mb-1",attrs:{disabled:e.loading,loading:e.loading},on:{click:e.close}},[e._v("\n        "+e._s(e.$t("agenda.button.cancel"))+"\n      ")]),e._v(" "),t("button",{staticClass:"ignore-vuetify-classes btn-primary ms-2 mb-1",attrs:{disabled:e.loading,loading:e.loading},on:{click:e.sendRecurrentEventChoice}},[e._v("\n        "+e._s(e.$t("agenda.button.save"))+"\n      ")])])],1)],1)};Pt._withStripped=!0;const Ut=v({props:{event:{type:Object,default:function(){return null}}},data:()=>({loading:!1,recurrenceResponseType:"single",dialog:!1,eventResponse:null}),watch:{dialog(){this.dialog?this.$emit("dialog-opened"):this.$emit("dialog-closed")}},created(){$(document).on("keydown",(e=>{"Escape"===e.key&&(this.dialog=!1)}))},methods:{sendRecurrentEventChoice(e){e&&(e.preventDefault(),e.stopPropagation()),"single"===this.recurrenceResponseType?this.confirmOccurrenceEvent():"all"===this.recurrenceResponseType?this.confirmRecurrentEvent():"upcoming"===this.recurrenceResponseType&&this.confirmUpcomingEvent()},confirmUpcomingEvent(){this.loading=!0,this.$eventService.sendEventResponse(this.event.parent.id,this.event.occurrence.id,this.eventResponse,!0).then((()=>{this.$root.$emit("agenda-event-response-sent",this.event.parent,null,this.eventResponse),this.dialog=!1})).finally((()=>this.loading=!1))},confirmRecurrentEvent(){this.loading=!0,this.$eventService.sendEventResponse(this.event.parent.id,null,this.eventResponse).then((()=>{this.$root.$emit("agenda-event-response-sent",this.event.parent,null,this.eventResponse),this.dialog=!1})).finally((()=>this.loading=!1))},confirmOccurrenceEvent(){this.loading=!0,this.$eventService.sendEventResponse(this.event.parent.id,this.event.occurrence.id,this.eventResponse).then((()=>{this.$root.$emit("agenda-event-response-sent",this.event,this.event.occurrence.id,this.eventResponse),this.dialog=!1})).finally((()=>this.loading=!1))},close(e){e.preventDefault(),e.stopPropagation(),this.dialog=!1},open(e){this.eventResponse=e,this.dialog=!0}}},Pt,[],!1,null,null,null).exports;var Rt=function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{width:e.width,"content-class":"uiPopup width-auto","max-width":"100vw"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",{staticClass:"elevation-12"},[t("div",{staticClass:"ignore-vuetify-classes popupHeader ClearFix"},[t("a",{staticClass:"uiIconClose pull-right",attrs:{"aria-hidden":"true"},on:{click:e.close}}),e._v(" "),t("span",{staticClass:"ignore-vuetify-classes PopupTitle popupTitle text-truncate"},[e._v("\n        "+e._s(e.$t("agenda.confirmSaveRecurrentEventTitle"))+"\n      ")])]),e._v(" "),t("v-card-text",[t("v-radio-group",{model:{value:e.recurrenceModificationType,callback:function(t){e.recurrenceModificationType=t},expression:"recurrenceModificationType"}},[t("v-radio",{attrs:{label:e.$t("agenda.onlyThisEvent"),value:"single"}}),e._v(" "),t("v-radio",{attrs:{label:e.$t("agenda.thisAndUpcomingEvents"),value:"upcoming"}}),e._v(" "),t("v-radio",{attrs:{label:e.$t("agenda.allEvents"),value:"all"}})],1)],1),e._v(" "),t("v-card-actions",{staticClass:"d-flex flex-wrap justify-center center"},[t("button",{staticClass:"ignore-vuetify-classes btn me-2 mb-1",attrs:{disabled:e.loading,loading:e.loading},on:{click:e.close}},[e._v("\n        "+e._s(e.$t("agenda.button.cancel"))+"\n      ")]),e._v(" "),t("button",{staticClass:"ignore-vuetify-classes btn-primary ms-2 mb-1",attrs:{disabled:e.loading,loading:e.loading},on:{click:e.saveRecurrentEventChoice}},[e._v("\n        "+e._s(e.$t("agenda.button.save"))+"\n      ")])])],1)],1)};Rt._withStripped=!0;const Nt=v({props:{event:{type:Object,default:function(){return null}}},data:()=>({recurrenceModificationType:"single",loading:!1,dialog:!1,reminders:null}),watch:{dialog(){this.dialog?this.$emit("dialog-opened"):this.$emit("dialog-closed")}},created(){$(document).on("keydown",(e=>{"Escape"===e.key&&(this.dialog=!1)}))},methods:{saveRecurrentEventChoice(e){e&&(e.preventDefault(),e.stopPropagation()),"single"===this.recurrenceModificationType?this.confirmOccurrenceEvent():"all"===this.recurrenceModificationType?this.confirmRecurrentEvent():"upcoming"===this.recurrenceModificationType&&this.confirmUpcomingEvents()},confirmUpcomingEvents(e){e&&(e.preventDefault(),e.stopPropagation()),this.loading=!0,this.$eventService.saveEventReminders(this.event.parent.id,this.event.occurrence.id,this.reminders,!0).then((()=>{this.$root.$emit("agenda-event-reminders-saved",this.event,null,this.reminders),this.dialog=!1})).finally((()=>this.loading=!1))},confirmRecurrentEvent(e){e&&(e.preventDefault(),e.stopPropagation()),this.loading=!0,this.$eventService.saveEventReminders(this.event.parent.id,null,this.reminders).then((()=>{this.$root.$emit("agenda-event-reminders-saved",this.event,null,this.reminders),this.dialog=!1})).finally((()=>this.loading=!1))},confirmOccurrenceEvent(e){e&&(e.preventDefault(),e.stopPropagation()),this.loading=!0,this.$eventService.saveEventReminders(this.event.parent.id,this.event.occurrence.id,this.reminders).then((()=>{this.$root.$emit("agenda-event-reminders-saved",this.event,this.event.occurrence.id,this.reminders),this.dialog=!1})).finally((()=>this.loading=!1))},close(e){e&&(e.preventDefault(),e.stopPropagation()),this.dialog=!1},open(e){this.reminders=e,this.dialog=!0}}},Rt,[],!1,null,null,null).exports,Ft=v({props:{settings:{type:Object,default:()=>null},connectors:{type:Object,default:()=>null}},data:()=>({loading:!1}),computed:{remoteProviders(){return this.settings&&this.settings.remoteProviders},connectedConnectorUser(){return this.connectedConnector&&this.connectedConnector.user},connectedConnector(){return this.connectors&&this.connectors.find((e=>e.connected))}},watch:{remoteProviders(){this.remoteProviders&&this.refreshConnectorsList()}},created(){document.addEventListener("agenda-connectors-refresh",this.refreshConnectorsList),this.$root.$on("agenda-connectors-init",this.initConnectors),this.$root.$on("agenda-connector-connect",this.connect),this.$root.$on("agenda-connector-disconnect",this.disconnect),this.$root.$on("agenda-event-saved",this.pushEvent),this.$root.$on("agenda-event-deleted",this.deleteEvent),this.$root.$on("agenda-event-response-updated",this.pushEventResponse)},mounted(){this.refreshConnectorsList()},methods:{refreshConnectorsList(){const e=extensionRegistry.loadExtensions("agenda","connectors")||[];this.remoteProviders&&this.remoteProviders.length?e.forEach((e=>{const t=this.remoteProviders.find((t=>t.name===e.name));e.enabled=t&&t.enabled||!1,e.apiKey=t&&t.apiKey||"",e.secretKey=t&&t.secretKey||"",e.connected=e.enabled&&this.settings.connectedRemoteProvider===t.name,e.user=e.connected&&this.settings.connectedRemoteUserId||""})):e.forEach((e=>e.enabled=!1)),this.initConnectors(),this.$emit("connectors-loaded",e)},initConnectors(){this.connectors.forEach((e=>{e.init&&!e.initialized&&e.enabled&&e.apiKey&&e.init(this.connectionStatusChanged,this.connectionLoading,e.apiKey,e.secretKey)}))},connect(e){this.errorMessage=null;const t=[];return this.connectors.forEach((n=>{e.name!==n.name&&(n.user||n.isSignedIn)&&t.push(this.disconnect(n))})),this.$set(e,"loading",!0),Promise.all(t).then((()=>e.connect(this.settings&&this.settings.automaticPushEvents))).then((t=>this.$settingsService.saveUserConnector(e.name,t).then((()=>{this.$set(e,"isSignedIn",!0),this.$set(e,"user",t)})))).then((()=>{this.$set(e,"loading",!1),this.$root.$emit("agenda-settings-refresh")})).catch((t=>{console.error("Connected - error",e.name,t),this.$set(e,"loading",!1),"popup_closed_by_user"!==t.error&&(console.error("Error while connecting to remote account: ",t),this.errorMessage=this.$t("agenda.connectionFailure"))}))},disconnect(e){return e.isSignedIn?e.disconnect().then((()=>this.resetConnector(e))):this.resetConnector(e)},resetConnector(e){return this.$set(e,"loading",!0),this.$settingsService.resetUserConnector().then((()=>{this.$set(e,"isSignedIn",!1),this.$set(e,"connected",!1),this.$set(e,"user",null),this.$set(e,"canPush",!1),this.$root.$emit("agenda-settings-refresh")})).finally((()=>{this.$set(e,"loading",!1)}))},connectionLoading(e,t){this.$set(e,"loading",t),t?(this.$set(e,"error",""),this.loading++):this.loading&&this.loading--},connectionStatusChanged(e,t,n){if(t)this.$set(e,"error",""),this.$root.$emit("agenda-connector-connected",e);else if(n){const t=n.details||n.error||n.message||String(n);this.$set(e,"error",t)}else this.cleanConnectorStatus(e,t)},cleanConnectorStatus(e,t){this.$set(e,"error",""),this.connectedConnectorUser?t&&t.user!==this.connectedConnectorUser&&e.disconnect():e&&e.isSignedIn&&e.disconnect(),this.refreshConnectorsList()},deleteEvent(e){if(this.settings&&this.settings.automaticPushEvents&&this.connectedConnector&&this.connectedConnector.canPush)return this.$remoteEventConnector.removeEventFromConnector(this.connectedConnector,e,!!e.recurrence).finally((()=>this.$root.$emit("agenda-refresh")))},pushEvent(e){if(e&&e.acl&&e.acl.attendee){const t=e.attendees.find((e=>e.identity&&e.identity.id===eXo.env.portal.userIdentityId));this.pushEventResponse(e,null,t&&t.response)}},pushEventResponse(e,t,n){if(e&&n&&this.settings&&this.settings.automaticPushEvents&&this.connectedConnector&&this.connectedConnector.canPush)return e.start=this.$agendaUtils.toRFC3339(e.start),e.end=this.$agendaUtils.toRFC3339(e.end),"accepted"===n.toLowerCase()?this.$remoteEventConnector.pushEventToConnector(this.connectedConnector,e,!!e.recurrence).finally((()=>this.$root.$emit("agenda-refresh"))):this.$remoteEventConnector.removeEventFromConnector(this.connectedConnector,e,!!e.recurrence).finally((()=>this.$root.$emit("agenda-refresh")))}}},void 0,void 0,!1,null,null,null).exports;var Mt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"connector-status"},[e.connectedConnectorUser?t("div",{staticClass:"connector-connected d-flex"},[t("v-avatar",{attrs:{tile:"",size:"24"}},[t("img",{attrs:{src:e.connectedConnectorAvatar}})]),e._v(" "),t("a",{staticClass:"mx-2 my-auto",on:{click:e.openPersonalCalendarDrawer}},[e._v("\n      "+e._s(e.connectedConnectorUser)+"\n    ")])],1):t("div",{staticClass:"connect-button",on:{click:e.openPersonalCalendarDrawer}},[e._t("connectButton")],2)])};Mt._withStripped=!0;const Vt=v({props:{connectors:{type:Array,default:()=>null}},computed:{connectedConnector(){return this.connectors.find((e=>e.user))},connectedConnectorName(){return this.connectedConnector&&this.connectedConnector.name||""},connectedConnectorUser(){return this.connectedConnector&&this.connectedConnector.user||""},connectedConnectorAvatar(){return this.connectedConnector&&this.connectedConnector.avatar||""}},methods:{openPersonalCalendarDrawer(){this.$root.$emit("agenda-connectors-drawer-open")}}},Mt,[],!1,null,null,null).exports;var Lt=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"d-flex"},[e.connectedConnector?t("v-avatar",{staticClass:"me-2 pt-1",attrs:{tile:"",size:"32"}},[t("img",{attrs:{src:e.connectedConnectorAvatar}})]):t("i",{staticClass:"uiIconCalRemoteCalendar darkGreyIcon uiIcon24x24 pe-2 pt-2"}),e._v(" "),t("div",{staticClass:"d-flex flex-column"},[t("div",{staticClass:"d-flex text-no-wrap text-truncate"},[e._v("\n        "+e._s(e.$t("agenda.personalCalendar"))+"\n        "+e._s(" ( ")+"\n        "),t("date-format",{staticClass:"me-1 text-wrap center",attrs:{value:e.event.startDate,format:e.fullDateFormat}}),e._v("\n        "+e._s(" ) ")+"\n      ")],1),e._v(" "),e.connectedConnector?t("a",{on:{click:e.openPersonalCalendarDrawer}},[e._v("\n        "+e._s(e.connectedConnectorUser)+"\n      ")]):t("a",{on:{click:e.openPersonalCalendarDrawer}},[e._v("\n        "+e._s(e.$t("agenda.connectYourPersonalAgendaSubTitle"))+"\n      ")]),e._v(" "),e.loading||e.connectedConnectorLoading?[t("v-progress-linear",{attrs:{indeterminate:""}})]:e._e(),e._v(" "),e.connectedConnector?[e.hasRemoteEvents?e._l(e.displayedRemoteEvents,(function(n){return t("agenda-connector-remote-event-item",{key:n,staticClass:"mt-5 remote-events-details",attrs:{"remote-event":n,avatar:e.connectedConnectorAvatar,event:e.event,"is-events-list":""}})})):e.connectedConnectorSignedOut?t("v-chip",{staticClass:"border-radius my-2",attrs:{color:"primary",outlined:""}},[t("v-icon",{staticClass:"me-4",attrs:{size:"20",color:"primary",depressed:""}},[e._v("\n            fa-info-circle\n          ")]),e._v(" "),t("span",{staticClass:"text--primary text-wrap"},[e._v("\n            "+e._s(e.$t("agenda.signedOutConnector"))+"\n          ")])],1):e.connectedConnector.loading||e.loading?e._e():t("v-chip",{staticClass:"border-radius my-2",attrs:{color:"primary",outlined:""}},[t("v-icon",{staticClass:"me-4",attrs:{size:"20",color:"primary",depressed:""}},[e._v("\n            fa-info-circle\n          ")]),e._v(" "),t("span",{staticClass:"text--primary text-wrap"},[e._v("\n            "+e._s(e.$t("agenda.noRemoteEvents"))+"\n          ")])],1)]:e._e()],2)],1),e._v(" "),t("agenda-connectors-drawer",{attrs:{connectors:e.connectors}})],1)};Lt._withStripped=!0;const jt=v({props:{settings:{type:Object,default:()=>null},connectors:{type:Array,default:()=>null},event:{type:Object,default:()=>({})}},data:()=>({loading:!1,remoteEvents:[],fullDateFormat:{year:"numeric",month:"long",day:"numeric"},timeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{connectedConnector(){return this.connectors&&this.connectors.find((e=>e.connected))},connectorStatus(){return this.connectedConnector?this.connectedConnector.isSignedIn?1:2:0},connectedConnectorUser(){return this.connectedConnector&&this.connectedConnector.user||""},connectedConnectorAvatar(){return this.connectedConnector&&this.connectedConnector.avatar||""},connectedConnectorLoading(){return this.connectedConnector&&this.connectedConnector.loading},connectedConnectorSignedOut(){return this.connectedConnector&&!this.connectedConnector.isSignedIn&&!this.connectedConnectorLoading&&!this.loading},hasRemoteEvents(){return this.displayedRemoteEvents&&this.displayedRemoteEvents.length},displayedRemoteEvents(){const e=this.remoteEvents&&this.remoteEvents.slice()||[];if(e.length){const t=e.findIndex((e=>e.id&&e.id===this.event.remoteId||e.recurringEventId===this.event.remoteId||this.event.parent&&e.recurringEventId===this.event.parent.remoteId));t>=0&&e.splice(t,1),e.push(this.event),e.sort(((e,t)=>this.$agendaUtils.toDate(e.start||e.startDate).getTime()-this.$agendaUtils.toDate(t.start||t.startDate).getTime()))}return e}},watch:{connectorStatus(){this.refreshRemoteEvents()}},created(){this.$root.$emit("agenda-connectors-init"),this.refreshRemoteEvents()},methods:{openPersonalCalendarDrawer(){this.$root.$emit("agenda-connectors-drawer-open")},refreshRemoteEvents(){this.retrieveRemoteEvents(this.connectedConnector)},retrieveRemoteEvents(e){if(1===this.connectorStatus){const t=this.event.startDate,n=this.event.endDate;t.setHours(0),t.setMinutes(0),n.setHours(23),n.setMinutes(59);const a=this.$agendaUtils.toRFC3339(t,!1,!0),i=this.$agendaUtils.toRFC3339(n,!1,!0);this.loading=!0,e.getEvents(a,i).then((e=>{e&&e.forEach((e=>{e.startDate=e.start&&this.$agendaUtils.toDate(e.start)||null,e.endDate=e.end&&this.$agendaUtils.toDate(e.end)||null})),this.remoteEvents=e||[],this.loading=!1})).catch((e=>{this.remoteEvents=[],this.loading=!1,console.error("Error retrieving remote events",e)}))}else this.remoteEvents=[]}}},Lt,[],!1,null,null,null).exports;var Bt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"v-event-draggable remote-event rounded v-event-draggable-parent",class:{"no-date-event":!e.displayEventDate,primary:e.currentEvent}},[t("p",{staticClass:"text-truncate my-auto ms-2 caption font-weight-bold",class:e.textClass,attrs:{title:e.remoteEvent.summary}},[e._v("\n    "+e._s(e.remoteEvent.summary)+"\n  ")]),e._v(" "),e.displayEventDate?e._e():[t("v-avatar",{staticClass:"me-1 my-auto",attrs:{tile:"",size:"16"}},[t("img",{attrs:{src:e.avatar}})])],e._v(" "),e.displayEventDate?t("div",{staticClass:"d-flex"},[t("date-format",{staticClass:"v-event-draggable ms-2",class:e.textClass,attrs:{value:e.remoteEvent.start||e.remoteEvent.startDate,format:e.timeFormat}}),e._v(" "),t("strong",{staticClass:"mx-1",class:e.textClass},[e._v("-")]),e._v(" "),t("date-format",{staticClass:"v-event-draggable me-2",class:e.textClass,attrs:{value:e.remoteEvent.end||e.remoteEvent.endDate,format:e.timeFormat}}),e._v(" "),e.currentEvent?e._e():t("v-avatar",{staticClass:"white ms-auto me-1",attrs:{tile:"",size:"16"}},[t("img",{attrs:{src:e.avatar}})])],1):e._e()],2)};Bt._withStripped=!0;const zt=v({props:{remoteEvent:{type:Object,default:()=>({})},event:{type:Object,default:()=>null},avatar:{type:String,default:""},isEventsList:{type:Boolean,default:!1}},data:()=>({timeFormat:{hour:"2-digit",minute:"2-digit"}}),computed:{currentEvent(){return this.event&&this.event.id===this.remoteEvent.id},textClass(){return this.currentEvent?"white-text":"primary--text"},isShortEvent(){return this.$agendaUtils.isShortEvent(this.remoteEvent)},displayEventDate(){return!this.remoteEvent.allDay&&!this.isShortEvent||this.isEventsList&&!this.remoteEvent.allDay}}},Bt,[],!1,null,null,null).exports;var Xt=function(){var e=this,t=e._self._c;return t("div",[t("exo-drawer",{ref:"agendaConnectorsDrawer",staticClass:"agendaConnectorsDrawer",attrs:{"body-classes":"hide-scroll decrease-z-index-more",right:""}},[t("template",{slot:"title"},[e._v("\n      "+e._s(e.$t("agenda.connectYourPersonalAgenda"))+"\n    ")]),e._v(" "),t("template",{slot:"content"},[e.enabledConnectors&&0!==e.enabledConnectors.length?t("v-list",{attrs:{"two-line":""}},[e._l(e.enabledConnectors,(function(n){return t("v-list-item",{key:n.name},[t("v-list-item-avatar",{staticClass:"rounded-0"},[t("v-avatar",{attrs:{tile:"",size:"40"}},[t("img",{attrs:{src:n.avatar}})])],1),e._v(" "),t("v-list-item-content",[n.canConnect?n.connected?[t("v-list-item-title",[e._v("\n                "+e._s(e.$t("agenda.connectedAccountWith"))+":\n              ")]),e._v(" "),t("v-list-item-subtitle",{staticClass:"font-italic",attrs:{title:n.user}},[e._v("\n                "+e._s(n.user)+"\n              ")])]:[t("v-list-item-title",{staticClass:"title"},[e._v("\n                "+e._s(e.$t(n.name))+"\n              ")])]:t("v-alert",{staticClass:"my-auto",attrs:{type:"error"}},[e._v("\n              "+e._s(e.$t("agenda.connectoInitializationFailed"))+"\n            ")])],2),e._v(" "),n.canConnect?t("v-list-item-action",[n.isSignedIn&&n.user?t("v-btn",{staticClass:"btn",attrs:{loading:n.loading},on:{click:function(t){return e.disconnect(n)}}},[e._v("\n              "+e._s(e.$t("agenda.disconnect"))+"\n            ")]):t("v-btn",{staticClass:"btn",attrs:{loading:n.loading},on:{click:function(t){return e.connect(n)}}},[e._v("\n              "+e._s(e.$t("agenda.connect"))+"\n            ")])],1):e._e()],1)})),e._v(" "),t("v-list-item",[t("v-list-item-content",[t("div",{staticClass:"d-flex"},[t("span",{staticClass:"my-auto pe-4"},[t("v-icon",{staticClass:"text-light-color",attrs:{size:"16",depressed:""}},[e._v("\n                  fa-info-circle\n                ")])],1),e._v(" "),t("span",{staticClass:"my-auto me-auto font-italic text-light-color"},[e._v("\n                "+e._s(e.$t("agenda.allowedToConnectOnlyOneConnector"))+"\n              ")])])])],1),e._v(" "),t("v-card-text",{directives:[{name:"show",rawName:"v-show",value:e.errorMessage,expression:"errorMessage"}],staticClass:"errorMessage"},[t("v-alert",{attrs:{type:"error"}},[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])],1)],2):t("div",{staticClass:"noEnabledConnectors d-flex flex-column align-center"},[t("i",{staticClass:"uiIconCalRemoteCalendar darkGreyIcon ma-5"}),e._v(" "),t("p",[e._v(e._s(e.$t("agenda.noActiveConnectors")))])])],1)],2),e._v(" "),t("exo-confirm-dialog",{ref:"confirmConnectDialog",attrs:{title:e.confirmConnectDialogLabels.title,message:e.confirmConnectDialogLabels.message,"ok-label":e.confirmConnectDialogLabels.ok,"cancel-label":e.confirmConnectDialogLabels.cancel},on:{ok:e.confirmConnect}})],1)};Xt._withStripped=!0;const qt=v({props:{connectors:{type:Array,default:()=>[]}},data:()=>({connectionInProgress:!1,errorMessage:"",selectedConnector:null}),computed:{enabledConnectors(){return this.connectors&&this.connectors.slice().filter((e=>e.enabled))||[]},confirmConnectDialogLabels(){return{title:this.$t("agenda.agendaConnectors.confirmConnectDialog.title"),message:this.$t("agenda.agendaConnectors.confirmConnectDialog.message"),ok:this.$t("agenda.agendaConnectors.confirmConnectDialog.ok"),cancel:this.$t("agenda.agendaConnectors.confirmConnectDialog.cancel")}}},created(){this.$root.$on("agenda-connectors-drawer-open",this.open),this.$root.$on("agenda-connector-connected",(()=>{this.connectionInProgress&&this.close()}))},methods:{open(){this.connectionInProgress=!1,this.$root.$emit("agenda-connectors-init"),this.$refs.agendaConnectorsDrawer&&this.$refs.agendaConnectorsDrawer.open()},close(){this.$refs.agendaConnectorsDrawer&&this.$refs.agendaConnectorsDrawer.close()},connect(e){this.connectionInProgress=!0,this.selectedConnector=e,this.enabledConnectors.some((e=>e.isSignedIn&&e.user))?this.$refs.confirmConnectDialog.open():this.confirmConnect()},confirmConnect(){this.$root.$emit("agenda-connector-connect",this.selectedConnector)},disconnect(e){this.connectionInProgress=!0,this.$root.$emit("agenda-connector-disconnect",e)}}},Xt,[],!1,null,null,null).exports;var Yt=function(){var e=this,t=e._self._c;return t("v-alert",{staticClass:"white",attrs:{type:e.alertType,border:"left",elevation:"2",dismissible:"","colored-border":"",outlined:""},scopedSlots:e._u([{key:"close",fn:function({toggle:n}){return t("v-btn",{attrs:{icon:"",small:"",light:""},on:{click:n}},[t("v-icon",[e._v("close")])],1)}}]),model:{value:e.displayAlert,callback:function(t){e.displayAlert=t},expression:"displayAlert"}},[t("span",{staticClass:"text-color"},[e._v("\n    "+e._s(e.alertMessage)+"\n  ")]),e._v(" "),e.alert.click?t("v-btn",{staticClass:"primary--text",attrs:{text:""},on:{click:e.alert.click}},[e._v("\n    "+e._s(e.alert.clickMessage)+"\n  ")]):e._e()],1)};Yt._withStripped=!0;const Gt=v({props:{alert:{type:Object,default:null}},data:()=>({displayAlert:!0}),computed:{alertMessage(){return this.alert.message},alertType(){return this.alert.type}},watch:{displayAlert(){this.displayAlert||this.$emit("dismissed")}}},Yt,[],!1,null,null,null).exports;var Jt=function(){var e=this,t=e._self._c;return t("v-snackbar",{attrs:{value:e.displayAlerts,color:"transparent",elevation:"0",absolute:"",app:"",left:""}},e._l(e.alerts,(function(n){return t("agenda-notification-alert",{key:n.message,attrs:{alert:n},on:{dismissed:function(t){return e.deleteAlert(n)}}})})),1)};Jt._withStripped=!0;const Ht=v({props:{name:{type:String,default:null}},data:()=>({alerts:[]}),computed:{displayAlerts(){return this.alerts&&this.alerts.length}},created(){this.$root.$on("agenda-notification-alert",this.addAlert);const e=this;this.$root.$on("agenda-event-saved",((t,n)=>{if((n===e.name||!e.name&&!e.name==!n)&&t&&t.id){const n="TENTATIVE"===t.status,a=!t.updated,i=n&&(a&&e.$t("agenda.datePollCreationSuccess")||e.$t("agenda.datePollUpdateSuccess"))||a&&e.$t("agenda.eventCreationSuccess")||e.$t("agenda.eventUpdateSuccess"),s=n&&e.$t("agenda.viewDatePoll")||e.$t("agenda.viewEvent");e.addAlert({message:i,type:"success",click:()=>e.$root.$emit("agenda-event-details",t),clickMessage:s})}})),e.$root.$on("agenda-event-deleted",((t,n)=>{if(t&&t.id){const a="TENTATIVE"===t.status,i={message:a&&e.$t("agenda.datePollDeleteSuccess")||n&&e.$t("agenda.eventRecurrenceUntilDateUpdated")||e.$t("agenda.eventDeleteSuccess"),type:"success"};!a&&n||(i.clickMessage=e.$t("agenda.undoRemoveEvent"),i.click=()=>e.undoDeleteEvent(t,i)),e.addAlert(i)}}))},methods:{addAlert(e){e&&(this.alerts.push(e),window.setTimeout((()=>this.deleteAlert(e)),5e3))},deleteAlert(e){const t=this.alerts.indexOf(e);this.alerts.splice(t,1),this.$forceUpdate()},undoDeleteEvent(e,t){return e.occurrence&&e.occurrence.id?this.$eventService.updateEventFields(e.id,{status:"CONFIRMED"},!1,!0).then((()=>{this.$root.$emit("agenda-refresh",e),this.deleteAlert(t),this.addAlert({message:this.$t("agenda.eventDeletionCanceled"),type:"success"})})):this.$eventService.undoDeleteEvent(e.id).then((()=>{this.$root.$emit("agenda-refresh",e),this.deleteAlert(t),this.addAlert({message:this.$t("agenda.eventDeletionCanceled"),type:"success"})}))}}},Jt,[],!1,null,null,null).exports,Wt=JSON.parse('["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmara","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Asia/Oral","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Asia/Yekaterinburg","Africa/Djibouti","Africa/Douala","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/El_Aaiun","Africa/Johannesburg","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Kigali","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Maseru","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Tunis","Africa/Sao_Tome","Africa/Tripoli","Africa/Windhoek","America/Adak","America/Argentina/Salta","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Aruba","America/Argentina/Ushuaia","America/Asuncion","America/Bahia_Banderas","America/Atikokan","America/Bahia","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Coral_Harbour","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Vincennes","America/Indiana/Winamac","America/Inuvik","America/Iqaluit","America/La_Paz","America/Jamaica","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/Kralendijk","America/Lima","America/Managua","America/Manaus","America/Los_Angeles","America/Lower_Princes","America/Maceio","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Menominee","America/Mexico_City","America/Merida","America/Metlakatla","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Scoresbysund","America/Sao_Paulo","America/Sitka","America/St_Barthelemy","America/St_Johns","America/Thule","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Macquarie","Arctic/Longyearbyen","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Baghdad","Asia/Bahrain","Asia/Bangkok","Asia/Baku","Asia/Chongqing","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Choibalsan","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Gaza","Asia/Harbin","Asia/Hebron","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Kabul","Asia/Jerusalem","Asia/Kamchatka","Asia/Karachi","Asia/Kashgar","Asia/Kathmandu","Asia/Calcutta","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Athens","Europe/Belgrade","Europe/Bucharest","Europe/Berlin","Europe/Budapest","Europe/Chisinau","Europe/Bratislava","Europe/Brussels","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Chatham","Pacific/Chuuk","Pacific/Easter","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Efate","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Kwajalein","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Majuro","Pacific/Midway","Pacific/Marquesas","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Pohnpei","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Wake","Pacific/Wallis"]'),Zt=(new window.Intl.DateTimeFormat).resolvedOptions().timeZone,Kt=[],Qt=30,en=60*Qt*1e3;function tn(e,t){e.timeZoneId||(e.timeZoneId=Zt),e.calendar||(e.calendar={}),e.calendar.owner||(e.calendar.owner={}),e.reminders||(e.reminders=[]),e.attachments||(e.attachments=[]),e.attendees||(e.attendees=[]),e.dateOptions||(e.dateOptions=[]),!e.startDate&&e.start&&(e.startDate=e.start&&dn(e.start)||new Date,e.startDate=In(new Date(e.startDate).getTime())),!e.endDate&&e.end&&(e.endDate=dn(e.end).getTime()),"TENTATIVE"===e.status?e.dateOptions.forEach((e=>{e.startDate||(e.startDate=e.start&&dn(e.start)||new Date,e.startDate=In(new Date(e.startDate).getTime())),e.endDate||(e.end?e.endDate=dn(e.end).getTime():e.start&&(e.endDate=new Date(e.startDate).getTime()+en))})):e.startDate&&e.endDate&&(e.dateOptions=[{allDay:e.allDay,start:e.start,startDate:e.startDate,end:e.end,endDate:e.endDate}]);const n=e&&(e.color||e.calendar&&e.calendar.color)||"#2196F3";e.dateOptions.forEach((t=>{t.dateOption=!0,t.eventId=e.id,t.summary=e.summary,t.color=n,t.occurrence=e.occurrence,t.parent={id:e.parent&&e.parent.id}})),t&&(e.start=null,e.startDate=null,e.end=null,e.endDate=null,e.allDay=!1)}function nn(){const e=-(new Date).getTimezoneOffset();let t=Math.abs(parseInt(e/60)),n=Math.abs(parseInt(e%60));return t=t<10?`0${t}`:t,n=n<10?`0${n}`:n,`${e>=0?"+":"-"}${t}:${n}`}function an(){if(Kt.length)return Kt;const e=new Date(0);return Wt.forEach((t=>{const n=new Intl.DateTimeFormat(eXo.env.portal.language,{timeZoneName:"long",second:"numeric",timeZone:t}).format(e);Kt.push({value:t,text:`${n.charAt(2).toUpperCase()+n.substring(3,n.length)} (${t})`})})),Kt}function sn(e){const t=new Date(0),n=new Intl.DateTimeFormat(eXo.env.portal.language,{timeZoneName:"long",second:"numeric",timeZone:e}).format(t);return`${n.charAt(2).toUpperCase()+n.substring(3,n.length)} (${e})`}function rn(e){const t=e.start.hour<10?`0${e.start.hour}`:e.start.hour,n=e.start.minute<10?`0${e.start.minute}`:e.start.minute,a=e.end.hour<10?`0${e.end.hour}`:e.end.hour,i=e.end.minute<10?`0${e.end.minute}`:e.end.minute;return{start:`${e.start.date}T${t}:${n}:00.000`,end:`${e.end.date}T${a}:${i}:00.000`}}function on(e){const t=(e.getDay()+6)%7;e.setDate(e.getDate()-t+3);const n=e.valueOf();return e.setMonth(0,1),4!==e.getDay()&&e.setMonth(0,1+(4-e.getDay()+7)%7),Math.ceil((n-e.valueOf())/6048e5)+1}function ln(e){return`${e.getFullYear()}-${_n(e.getMonth()+1)}-${_n(e.getDate())} ${_n(e.getHours())}:${_n(e.getMinutes())}`}function cn(e,t,n){if(!e)return null;let a;return"number"==typeof e?e=new Date(e):"string"==typeof e&&(10===e.indexOf("T")&&e.length>19&&(e=e.substring(0,19)),e=new Date(e)),a=t?`${e.getFullYear()}-${_n(e.getMonth()+1)}-${_n(e.getDate())}T00:00:00`:`${e.getFullYear()}-${_n(e.getMonth()+1)}-${_n(e.getDate())}T${_n(e.getHours())}:${_n(e.getMinutes())}:${_n(e.getSeconds())}`,n?`${a}${nn()}`:a}function dn(e){return e?"number"==typeof e?new Date(e):"string"==typeof e?10===e.indexOf("T")&&e.length>19?new Date(e.substring(0,19)):10===e.length?new Date(`${e} 00:00:00`):new Date(e):"object"==typeof e?new Date(e):void 0:null}function vn(e){return e.startDate=e.start&&dn(e.start)||null,e.endDate=e.end&&dn(e.end)||null,e}function un(e,t,n,a){return"week"===e?`${n} - ${a} ${on(t)}`:"day"===e?`${n} - ${t.getDate()}`:"month"===e?n:void 0}function hn(e,t){let n=null;return n=e?dn(e):new Date,n.toLocaleDateString(t||"en",{weekday:"long"})}const pn=["SU","MO","TU","WE","TH","FR","SA"];function mn(e,t){const n=new Date(15842268e5),a=pn.indexOf(e);return n.setDate(a+1),n.toLocaleDateString(t||"en",{weekday:"long"})}function gn(e){let t=null;return t=e?new Date(e):new Date,t.getDay()}function fn(e,t){let n=null;return n=e?new Date(e):new Date,n.toLocaleDateString(t||"en",{month:"long"})}function yn(e,t){const n=new Date;return n.setMonth(e),n.toLocaleDateString(t||"en",{month:"long"})}function $n(e){let t=null;return t=e?new Date(e):new Date,t.getMonth()+1}function Cn(e){let t=null;t=e?new Date(e):new Date;const n=(new Date).setFullYear((new Date).getFullYear(),0,1),a=Math.floor(n/864e5);return Math.ceil(t.getTime()/864e5)-a}function _n(e){return e<10&&`0${e}`||e}function wn(e,t){const n="string"==typeof e;return"string"==typeof t&&(t=new Date(t)),"string"==typeof e&&(e=new Date(e)),e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),n&&e||cn(e)}function Dn(e,t){return e===t||!e||!t||("object"!=typeof e&&(e=new Date(e)),"object"!=typeof t&&(t=new Date(t)),e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())}function bn(e){switch(e){case"MO":default:return[1,2,3,4,5,6,0];case"TU":return[2,3,4,5,6,0,1];case"WE":return[3,4,5,6,0,1,2];case"TH":return[4,5,6,0,1,2,3];case"FR":return[5,6,0,1,2,3,4];case"SA":return[6,0,1,2,3,4,5];case"SU":return[0,1,2,3,4,5,6]}}function En(e,t){const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const a of n)if((e[a]&&"object"==typeof e[a]?JSON.stringify(e[a]):e[a])!==(t[a]&&"object"==typeof t[a]?JSON.stringify(t[a]):t[a]))return!1;return!0}function xn(e){return Math.floor(dn(e.endDate).getTime()/6e4)-Math.floor(dn(e.startDate).getTime()/6e4)<60}function Tn(e,t){const n=(e=e.replace("#","")).length<6,a=n&&`${e[0]}${e[0]}`||`${e[0]}${e[1]}`,i=n&&`${e[1]}${e[1]}`||`${e[2]}${e[3]}`,s=n&&`${e[2]}${e[2]}`||`${e[4]}${e[5]}`;return`rgba(${parseInt(a,16)},${parseInt(i,16)},${parseInt(s,16)},${t/100})`}function In(e,t=!0){return t?e-e%en:e+(en-e%en)}function An(e,t=!0){return In(new Date(e.year,e.month-1,e.day,e.hour,e.minute).getTime(),t)}function Sn(){return Nn()}function kn(){return Sn().then((t=>t&&e.g.webConferencing.getAllProviders()||null))}function On(t){return t&&t.type&&e.g.webConferencing&&e.g.webConferencing.deleteCall&&t.url?(n=t.url,e.g.webConferencing.getCallId(n).then((t=>{if(t)return e.g.webConferencing.deleteCall(t)}))):Promise.resolve(null);var n}function Pn(t,n){const a=n&&n.type;return a?"manual"===a?Promise.resolve(n):e.g.webConferencing?n.url?e.g.webConferencing.updateCall?function(t,n){let a=null;return e.g.webConferencing.findCallId(n.url,n.type).then((e=>{if(!e)throw new Error(`Conference with url ${n.url} doesn't exist. Creating new one.`);return a=e,Rn(t.attendees)})).then((i=>{const s=i.filter((e=>e&&"organization"===e.providerId)).map((e=>e.remoteId)),r=i.filter((e=>e&&"space"===e.providerId)).map((e=>e.remoteId)),o=new Date(t.startDate),l=t.endDate&&new Date(t.endDate)||t.recurrence&&t.recurrence.until&&new Date(t.recurrence.until)||null;return e.g.webConferencing.updateCall(a,{title:t.title,owner:t.calendar.owner.id,ownerType:"space_event",provider:n.type,participants:s&&s.join(";")||null,spaces:r&&r.join(";")||null,group:!0,startDate:o,endDate:l})})).then((e=>(n.url=e.inviteId?`${e.url}?inviteId=${e.inviteId}`:n.url,n))).catch((()=>Un(t,n)))}(t,n):Promise.resolve(null):e.g.webConferencing.addCall?Un(t,n):Promise.resolve(null):Promise.resolve(null):Promise.resolve(null)}function Un(t,n){return Rn(t.attendees).then((a=>{const i=a.filter((e=>e&&"organization"===e.providerId)).map((e=>e.remoteId)),s=a.filter((e=>e&&"space"===e.providerId)).map((e=>e.remoteId)),r=new Date(t.startDate),o=t.endDate&&new Date(t.endDate)||t.recurrence&&t.recurrence.until&&new Date(t.recurrence.until)||null;return e.g.webConferencing.addCall({title:t.title,owner:t.calendar.owner.id,ownerType:"space_event",provider:n.type,participants:i&&i.join(";")||null,spaces:s&&s.join(";")||null,group:!0,startDate:r,endDate:o})})).then((e=>(n.url=`${e.url}?inviteId=${e.inviteId}`,n)))}function Rn(e){const t=[];return e.forEach((e=>{t.push(Vue.prototype.$identityService.getIdentityByProviderIdAndRemoteId(e.identity.providerId,e.identity.remoteId))})),Promise.all(t)}function Nn(){return new Promise((t=>(window.require.defined("SHARED/webConferencing")&&window.require(["SHARED/webConferencing"],(n=>(e.g.webConferencing=n,t(!!n)))),t(!!e.g.webConferencing))))}function Fn(e,t,n,a,i,s,r,o){"object"==typeof a&&(a=cn(a));let l={query:e||"",start:a,timeZoneId:Zt};return t&&t.length&&(l.ownerIds=t),i&&(i=cn(i),l.end=i),s&&s>0&&(l.limit=s),o&&(l.expand=o),n&&(l.attendeeIdentityId=n),r&&(l.responseTypes=r),l=$.param(l,!0),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events?${l}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting event list")})).then((e=>{let t=e&&e.events||[],n=localStorage.getItem("agendaDeletedEvents");return n&&(n=Number(n),t=t.filter((e=>Number(e.id)!==n&&(!e.parent||Number(e.parent.id)!==n))),e.events=t),e}))}function Mn(e,t,n){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}?expand=${t||""}&timeZoneId=${Zt}&firstOccurrence=${n||!1}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting event")})).then((e=>(e.startDate=dn(e.start),e.endDate=dn(e.end),e)))}function Vn(e,t,n){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/occurrence/${e}/${t}?expand=${n||""}&timeZoneId=${Zt}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting occurrence of event")})).then((e=>(e.startDate=dn(e.start),e.endDate=dn(e.end),e)))}function Ln(e,t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}/exceptionalOccurrences?expand=${t||""}&timeZoneId=${Zt}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting occurrence of event")}))}function jn(e){Object.prototype.hasOwnProperty.call(e,"sendInvitation")||(e.sendInvitation=!0);const t=ra(e=sa(e));return Promise.all(t).catch((e=>{console.error("Error saving web conferencing, delete them",e)})).then((t=>(e.conferences=t&&t.filter((e=>!!e)),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})))).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error creating event")}))}function Bn(e){Object.prototype.hasOwnProperty.call(e,"sendInvitation")||(e.sendInvitation=!0);const t=ra(e=sa(e));return Promise.all(t).catch((e=>{console.error("Error updating web conferencing, delete them",e)})).then((t=>(e.conferences=t&&t.filter((e=>!!e)),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})))).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error updating event")}))}function zn(e,t,n,a){t=sa(t);const i=new FormData;return Object.keys(t).forEach((e=>{i.append(e,t[e])})),n=!!n,a=!!a,fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}?updateAllOccurrences=${n}&timeZoneId=${Zt}&sendInvitations=${a}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(i).toString()}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error patching event")}))}function Xn(e,t,n,a){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}/response/send?response=${n}&occurrenceId=${t||""}&upcoming=${a||!1}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then((e=>{if(!e||!e.ok)throw new Error("Error sending event response")}))}function qn(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error retrieving reminders settings")}))}function Yn(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(!e||!e.ok)throw new Error("Error sending default reminders settings")}))}function Gn(e,t,n,a){const i=n&&JSON.parse(JSON.stringify(n))||[];return i.forEach((e=>delete e.datetime)),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}/reminders?occurrenceId=${t||""}&upcoming=${a||!1}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((e=>{if(!e||!e.ok)throw new Error("Error sending event reminders")}))}function Jn(e,t){return t>0&&localStorage.setItem("agendaDeletedEvents",e),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}?timeZoneId=${Zt}&delay=${t||0}`,{method:"DELETE",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error deleting event")})).then((e=>{if(e){const t=function(e){const t=[];return e.conferences&&e.conferences.length&&e.conferences.forEach((n=>{const a=On(e);t.push(a)})),t}(e);return Promise.all(t).finally((()=>e))}}))}function Hn(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}/undoDelete`,{method:"POST",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Error undoing deleting event");localStorage.removeItem("agendaDeletedEvents")}))}function Wn(e,t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}/votes/${t}`,{method:"POST",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Error voting on event")}))}function Zn(e,t){const n=new FormData;return Object.keys(t).forEach((e=>{n.append("dateOptionId",t[e])})),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}/votes`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n).toString()}).then((e=>{if(!e||!e.ok)throw new Error("Error voting on event")}))}function Kn(e,t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}/selectDateOption/${t}`,{method:"POST",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Error selecting an event date")}))}function Qn(e,t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/${e}/votes/${t}`,{method:"DELETE",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Error voting on event")}))}function ea(e,t,n,a){t=t||0,n=n||0,a=a||"";const i=new FormData;i.append("offset",t),i.append("limit",n),i.append("expand",a),e&&i.append("ownerIds",e);const s=new URLSearchParams(i).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/datePolls?${s}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting pending date poll list")})).then((e=>{let t=e&&e.events||[],n=localStorage.getItem("agendaDeletedEvents");return n&&(n=Number(n),t=t.filter((e=>Number(e.id)!==n&&(!e.parent||Number(e.parent.id)!==n))),e.events=t),e}))}function ta(e,t,n){n=n||"";const a=new FormData;a.append("start",e),a.append("end",t),a.append("expand",n);const i=new URLSearchParams(a).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/datePolls?${i}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting pending date poll list")})).then((e=>{let t=e&&e.events||[],n=localStorage.getItem("agendaDeletedEvents");return n&&(n=Number(n),t=t.filter((e=>Number(e.id)!==n&&(!e.parent||Number(e.parent.id)!==n))),e.events=t),e}))}function na(e){const t=new FormData;e&&t.append("ownerIds",e);const n=new URLSearchParams(t).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/datePolls?${n}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting pending date poll count")})).then((e=>e&&e.size||0))}function aa(e,t,n,a){t=t||0,n=n||0,a=a||"";const i=new FormData;i.append("offset",t),i.append("limit",n),i.append("expand",a),e&&i.append("ownerIds",e);const s=new URLSearchParams(i).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/pending?${s}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting pending event list")})).then((e=>{let t=e&&e.events||[],n=localStorage.getItem("agendaDeletedEvents");return n&&(n=Number(n),t=t.filter((e=>Number(e.id)!==n&&(!e.parent||Number(e.parent.id)!==n))),e.events=t),e}))}function ia(e){const t=new FormData;e&&t.append("ownerIds",e);const n=new URLSearchParams(t).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/events/pending?${n}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting pending event count")})).then((e=>e&&e.size||0))}function sa(e){return(e=Object.assign({},e)).start&&(e.start=cn(e.start)),e.end&&(e.end=cn(e.end)),(e=JSON.parse(JSON.stringify(e))).calendar&&function(e){e.calendar=JSON.parse(JSON.stringify(e.calendar)),e.calendar.owner=e.calendar.owner&&{id:e.calendar.owner.id,providerId:e.calendar.owner.providerId,remoteId:e.calendar.owner.remoteId}}(e),e.parent&&function(e){e.parent&&(e.parent={id:e.parent.id},e.recurrence=null)}(e),e.attendees&&function(e){e.attendees&&e.attendees.length&&e.attendees.forEach((e=>{e.identity={id:e.identity.id||0,providerId:e.identity.providerId,remoteId:e.identity.remoteId}}))}(e),e.recurrence&&function(e){if(e.recurrence){const t=e.recurrence,n=dn(e.start);if("WEEKLY"===t.frequency)t.byMonthDay=null,t.byMonth=null,t.byDay&&t.byDay.length||(t.byDay=[hn(n).substring(0,2).toUpperCase()]);else if("MONTHLY"===t.frequency){t.byDay=null,t.byMonth=null;const e=n.getDate();t.byMonthDay=[e]}else if("YEARLY"===t.frequency){t.byDay=null;const e=n.getDate();t.byMonthDay=[e];const a=$n(n);t.byMonth=[a]}else t.byMonthDay=null,t.byMonth=null,t.byDay=null}}(e),e.creator&&delete e.creator,e}function ra(e){const t=[];return e.conferences&&e.conferences.length&&e.conferences.forEach((n=>{const a=Pn(e,n);t.push(a)})),t}function oa(e,t,n,a){let i={offset:e,limit:t,returnSize:!!n};return a&&a.length&&(i.ownerIds=a),i=$.param(i,!0),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/calendars?${i}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error retrieving list of calendars")}))}function la(e){return e.owner=e.owner&&{id:e.owner.id,providerId:e.owner.providerId,remoteId:e.owner.remoteId},fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/calendars`,{method:e.id?"PUT":"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(!e||!e.ok)throw new Error("Error saving calendar")}))}function ca(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings`,{method:"PUT",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))}function da(e,t,n){const a=new FormData;return a.append("connectorName",e),a.append("enabled",!!t),a.append("isOauth",n),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings/connector/status`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a).toString()}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function va(e,t){const n=new FormData;return n.append("connectorName",e),n.append("apiKey",t||""),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings/connector/apiKey`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n).toString()}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function ua(e,t){const n=new FormData;return n.append("connectorName",e),n.append("secretKey",t||""),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings/connector/secretKey`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n).toString()}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error while saving connector secretKey")}))}function ha(e){const t=new FormData;return t.append("providerName",e),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings/webConferencing`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t).toString()}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))}function pa(e){const t=new FormData;return t.append("timeZoneId",e),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings/timeZone`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t).toString()}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))}function ma(e,t){const n=new FormData;return n.append("connectorName",e),n.append("connectorUserId",t),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings/connector`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n).toString()}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))}function ga(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings/connector`,{method:"DELETE",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))}function fa(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/agenda/settings`,{method:"GET",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error getting settings",e)})).then((e=>(!e||e.timeZoneId&&e.timeZoneId===Zt||(e.timeZoneId=Zt,pa(Zt)),e))).then((e=>e))}function ya(e){const t=e&&e.dateOptions||[],n=e&&e.attendees||[];return t&&t.sort(((e,t)=>e.start.localeCompare(t.start))),n.length?function(e,t,n){const a=[],i=Number(eXo.env.portal.userIdentityId);return t.forEach((e=>{!function(e,t,n,a){const i=a.identity;i.fullName=i.profile&&i.profile.fullname||i.space&&i.space.displayName||"",Number(i.id)===e&&(i.isCurrentUser=!0),i.hasVoted="TENTATIVE"===a.response,i.dateOptionVotes=[],t.forEach((e=>{const t=e&&e.voters&&e.voters.indexOf(Number(i.id))>=0||!1;i.dateOptionVotes.push(t)})),n.push(i)}(i,n,a,e)})),a.sort(((t,n)=>(Number(t.id)===i?-1:Number(n.id)===i&&1)||Number(t.id)===i&&-1||Number(t.id)===e&&-1||Number(n.id)===e&&1||t.space&&!n.space&&1||n.space&&!t.space&&-1||t.hasVoted&&!n.hasVoted&&-1||n.hasVoted&&!t.hasVoted&&1||t.fullName.localeCompare(n.fullName))),a}(Number(e.creator.id),n,t):Promise.resolve([])}function $a(e,t,n){return _a(e,t,n,!0)}function Ca(e,t,n){return _a(e,t,n,!1)}function _a(e,t,n,a){if(!e)return Promise.reject(new Error("Connector is mandatory"));if(!e.connected||!e.user||!e.isSignedIn)return Promise.reject(new Error("Connector is not connected"));if(!t)return Promise.reject(new Error("Event is mandatory"));t=n&&t.parent?t.parent:t;let i=null;e.pushing=!0;const s=t.parent&&t.parent.remoteId||null,r=a?e.deleteEvent:e.pushEvent;return r.apply(e,[t,s]).then((n=>(i=n,wa(e,t,i)))).then((t=>{if(n&&t.recurrence)return Ln(t.id).then((t=>{if(t&&t.length){const n=[];return t.forEach((t=>{const o=r.apply(e,[t,i&&i.id||s]).then((n=>{if(a||n)return wa(e,t,n)}));n.push(o)})),Promise.all(n)}}))})).finally((()=>e.pushing=!1))}function wa(e,t,n){const a=t&&t.id,i=n&&n.id||"",s=n&&e&&e.name||"";if(a)return zn(a,{remoteId:i,remoteProviderName:s}).then((()=>(t.remoteId=i,t.remoteProviderName=s,t)));{const e=Object.assign({},t);return e.remoteId=i,e.remoteProviderName=s,jn(e)}}function Da(e,t,n){const a=window.location;cCometd.configure({url:`${a.protocol}//${a.hostname}${a.port?":":""}${a.port||""}/${e}/cometd`,exoId:eXo.env.portal.userName,exoToken:t}),cCometd.subscribe("/eXo/Application/Addons/Agenda",null,(e=>{const t=e.data&&JSON.parse(e.data);t&&n(t.wsEventName,t.params&&t.params.agendaeventmodification||t.params)}))}Nn();const ba={"agenda-header":u,"agenda-body":p,"agenda-calendar":g,"agenda-mobile-header":x,"agenda-timeline":I,"agenda-empty-timeline":S,"agenda-events-updater":b,"agenda-event-mobile-form":O,"agenda-filter-calendar-drawer":M,"agenda-filter-calendar-list":L,"agenda-filter-calendar-item":B,"agenda-filter-calendar-search":X,"agenda-create-event-button":U,"agenda-calendar-filter-button":N,"agenda-event-dialog":ee,"agenda-event-form":ne,"agenda-toolbar":y,"agenda-event-preview-dialog":_,"agenda-event-save":K,"agenda-switch-view":pe,"agenda-event-form-basic-information":ie,"agenda-event-quick-form-drawer":re,"agenda-event-form-dates":le,"agenda-event-form-date-pickers":de,"agenda-event-form-reminders":ue,"agenda-event-form-attachments":ge,"agenda-event-form-attachment-item":ye,"agenda-event-details":dt,"agenda-event-details-body":ut,"agenda-event-details-toolbar":pt,"agenda-event-details-mobile-toolbar":gt,"agenda-date-poll-details-mobile-toolbar":yt,"agenda-event-recurrence":Ct,"agenda-event-attendees":bt,"agenda-event-attendee-item":xt,"agenda-event-attendee-buttons":wt,"agenda-event-reminder-drawer":It,"agenda-recurrent-event-delete-confirm-dialog":Ot,"agenda-event-form-recurrence":Ce,"agenda-event-form-recurrence-drawer":we,"agenda-event-form-attendees":be,"agenda-event-form-attendee-item":xe,"agenda-event-form-calendar-owner":Ie,"agenda-event-form-conference":Se,"agenda-event-date-poll-details":Oe,"agenda-event-date-poll-details-desktop":nt,"agenda-event-date-poll-details-mobile":Ue,"agenda-event-date-option-period":Ne,"agenda-event-date-option-voter":Me,"agenda-event-date-option-vote":Le,"agenda-event-date-poll-item-mobile":Je,"agenda-event-date-option-period-mobile":Ye,"agenda-event-date-option-voter-mobile":Ke,"agenda-date-poll-action-buttons":et,"agenda-date-poll-participants-drawer-mobile":We,"agenda-recurrent-event-save-confirm-dialog":St,"agenda-recurrent-event-response-confirm-dialog":Ut,"agenda-recurrent-event-reminders-confirm-dialog":Nt,"agenda-user-setting-drawer":it,"agenda-connectors-drawer":qt,"agenda-pending-invitation-drawer":Y,"agenda-pending-invitation-item":J,"agenda-pending-invitation-badge":W,"agenda-reminder-user-settings":rt,"agenda-reminder-user-setting-item":lt,"agenda-date-option-conflict-drawer":Be,"agenda-date-option-conflict-item":Xe,"agenda-connector":Ft,"agenda-connector-status":Vt,"agenda-connector-contemporary-events":jt,"agenda-connector-remote-event-item":zt,"agenda-time-zone-select-box":D,"agenda-notification-alert":Gt,"agenda-notification-alerts":Ht};for(const e in ba)Vue.component(e,ba[e]);const Ea=Zt;if(Vue.prototype.$calendarService||window.Object.defineProperty(Vue.prototype,"$calendarService",{value:s}),Vue.prototype.$eventService||window.Object.defineProperty(Vue.prototype,"$eventService",{value:i}),Vue.prototype.$settingsService||window.Object.defineProperty(Vue.prototype,"$settingsService",{value:r}),Vue.prototype.$agendaUtils||window.Object.defineProperty(Vue.prototype,"$agendaUtils",{value:n}),Vue.prototype.$datePollUtils||window.Object.defineProperty(Vue.prototype,"$datePollUtils",{value:o}),Vue.prototype.$userTimeZoneId||window.Object.defineProperty(Vue.prototype,"$userTimeZoneId",{value:Ea}),Vue.prototype.$webConferencingService||window.Object.defineProperty(Vue.prototype,"$webConferencingService",{value:a}),Vue.prototype.$remoteEventConnector||window.Object.defineProperty(Vue.prototype,"$remoteEventConnector",{value:l}),Vue.prototype.$agendaWebSocket||window.Object.defineProperty(Vue.prototype,"$agendaWebSocket",{value:c}),extensionRegistry){const e=extensionRegistry.loadComponents("Agenda");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}return t})()));