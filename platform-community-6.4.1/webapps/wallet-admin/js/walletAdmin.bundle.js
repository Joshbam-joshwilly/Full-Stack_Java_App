define((()=>(()=>{"use strict";var t={d:(e,a)=>{for(var l in a)t.o(a,l)&&!t.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:a[l]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{init:()=>b});var a=function(){var t=this,e=t._self._c;return e("v-app",{staticClass:"VuetifyApp",attrs:{id:"WalletAdminApp",color:"transaprent",flat:""}},[e("main",[e("v-layout",{attrs:{column:""}},[e("v-app",{staticClass:"mb-4 application-toolbar"},[e("v-tabs",{attrs:{"slider-size":"4"},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[e("v-tab",{key:"wallets",attrs:{href:"#wallets"}},[t._v("\n            "+t._s(t.$t("exoplatform.wallet.title.walletAdministrationTab"))+"\n          ")]),t._v(" "),e("v-tab",{key:"funds",attrs:{href:"#funds"}},[t._v("\n            "+t._s(t.$t("exoplatform.wallet.title.initialFundsTab"))+"\n          ")])],1),t._v(" "),e("v-tabs-items",{staticClass:"tabs-content",model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[e("v-tab-item",{attrs:{id:"wallets",value:"wallets",eager:""}},[e("v-flex",{staticClass:"white text-center mt-4",attrs:{flat:""}},[t.error&&!t.loading?e("div",{staticClass:"alert alert-error v-content"},[e("i",{staticClass:"uiIconError"}),t._v(t._s(t.error)+"\n              ")]):t._e(),t._v(" "),e("v-dialog",{attrs:{persistent:"","hide-overlay":"",width:"300"},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[e("v-card",{attrs:{color:"primary",dark:""}},[e("v-card-text",[t._v("\n                    "+t._s(t.$t("exoplatform.wallet.label.loading"))+" ...\n                    "),e("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1),t._v(" "),e("wallet-tab",{ref:"walletsTab",attrs:{"wallet-address":t.walletAddress,loading:t.loading,"fiat-symbol":t.fiatSymbol,"refresh-index":t.refreshIndex,"address-etherscan-link":t.addressEtherscanLink,"contract-details":t.contractDetails},on:{"wallets-loaded":function(e){t.wallets=e}}})],1),t._v(" "),e("v-tab-item",{attrs:{id:"funds",value:"funds",eager:""}},[e("wallet-initial-funds-tab",{ref:"fundsTab",attrs:{loading:t.loading,settings:t.settings,"contract-details":t.contractDetails},on:{saved:t.refreshSettings}})],1)],1)],1)],1),t._v(" "),e("div",{attrs:{id:"walletDialogsParent"}})],1)])};function l(t,e,a,l,s,n,i,r){var o,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=a,d._compiled=!0),l&&(d.functional=!0),n&&(d._scopeId="data-v-"+n),i?(o=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},d._ssrRegister=o):s&&(o=r?function(){s.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:s),o)if(d.functional){d._injectStyles=o;var c=d.render;d.render=function(t,e){return o.call(e),c(t,e)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,o):[o]}return{exports:t,options:d}}a._withStripped=!0;const s=l({data:()=>({loading:!1,selectedTab:"wallets",fiatSymbol:"$",settings:null,wallet:null,refreshIndex:1,contractDetails:null,addressEtherscanLink:null,wallets:[],anchor:document.URL.indexOf("#")>=0?document.URL.split("#")[1]:null}),computed:{walletAddress(){return this.wallet&&this.wallet.address&&this.wallet.address.toLowerCase()}},created(){document.addEventListener("exo.wallet.modified",this.walletUpdated),document.addEventListener("exo.contract.modified",this.reloadContract),this.init().then((()=>{this.addressEtherscanLink=this.walletUtils.getAddressEtherscanlink()}))},methods:{init(){return this.loading=!0,this.forceUpdate(),this.error=null,this.walletUtils.initSettings(!1,!0,!0).then((()=>{if(!window.walletSettings)throw this.forceUpdate(),new Error(this.$t("exoplatform.wallet.error.emptySettings"));this.settings=window.walletSettings,this.fiatSymbol=window.walletSettings.fiatSymbol||"$",this.wallet=window.walletSettings.wallet})).then((()=>this.walletUtils.initWeb3(!1,!0))).then((()=>{this.walletAddress=this.wallet.address})).catch((t=>{String(t).indexOf(this.constants.ERROR_WALLET_NOT_CONFIGURED)<0&&(console.error("Error connecting to network",t),this.error=this.$t("exoplatform.wallet.warning.networkConnectionFailure"))})).then((()=>{if(this.contractDetails)return this.tokenUtils.reloadContractDetails(this.walletAddress).then((t=>this.contractDetails=t));this.contractDetails=this.tokenUtils.getContractDetails(this.walletAddress)})).then((()=>this.$refs.walletsTab.init())).catch((t=>{String(t).indexOf(this.constants.ERROR_WALLET_NOT_CONFIGURED)<0?(console.error(t),this.error||(this.error=String(t))):this.error=this.$t("exoplatform.wallet.warning.walletNotConfigured")})).catch((t=>{console.error("init method - error",t),this.error=String(t)})).finally((()=>{this.loading=!1,this.forceUpdate()}))},walletUpdated(t){if(t&&t.detail&&t.detail.string){const e=t.detail.string.toLowerCase();this.walletAddress===e&&this.refreshWallet(this.wallet);const a=this.wallets.find((t=>t&&t.address&&t.address.toLowerCase()===e));a&&this.refreshWallet(a)}},reloadContract(){return this.tokenUtils.reloadContractDetails(this.walletAddress).then((t=>this.contractDetails=t))},pendingTransaction(t){const e=t.to.toLowerCase(),a=this.wallets.find((t=>t&&t.address&&t.address===e));a&&(t.contractAddress?(this.$set(a,"loadingTokenBalance",!0),this.walletUtils.watchTransactionStatus(t.hash,(()=>this.refreshWallet(a).then((()=>{this.$set(a,"loadingTokenBalance",!1)}))))):(this.$set(a,"loadingBalance",!0),this.walletUtils.watchTransactionStatus(t.hash,(()=>this.refreshWallet(a).then((()=>{this.$set(a,"loadingBalance",!1)}))))))},refreshWallet(t){return this.addressRegistry.refreshWallet(t).then((()=>{t.fiatBalance=t.fiatBalance||t.etherBalance&&this.walletUtils.etherToFiat(t.etherBalance)}))},forceUpdate(){this.refreshIndex++,this.$forceUpdate()},refreshSettings(){this.init()}}},a,[],!1,null,null,null).exports;var n=function(){var t=this,e=t._self._c;return e("v-card",{staticClass:"text-center pe-3 ps-3 pt-2",attrs:{flat:""}},[e("v-card-title",{staticClass:"subtitle-1"},[t._v("\n    "+t._s(t.$t("exoplatform.wallet.info.initialFundsIntroduction",{0:t.contractDetails&&t.contractDetails.name}))+"\n  ")]),t._v(" "),e("v-card-text",[e("v-text-field",{attrs:{title:t.$t("exoplatform.wallet.message.etherInitialFunds"),label:t.$t("exoplatform.wallet.label.etherInitialFunds"),placeholder:t.$t("exoplatform.wallet.label.etherInitialFundsPlaceholder"),name:"etherAmount",required:"",readonly:""},on:{input:function(e){return t.$emit("amount-selected",t.amount)}},model:{value:t.etherAmountLabel,callback:function(e){t.etherAmountLabel=e},expression:"etherAmountLabel"}}),t._v(" "),e("v-text-field",{attrs:{label:t.$t("exoplatform.wallet.label.tokenInitialFunds",{0:t.contractDetails&&t.contractDetails.name}),placeholder:t.$t("exoplatform.wallet.label.tokenInitialFundsPlaceholder"),disabled:t.loading,name:"tokenAmount",required:""},on:{input:function(e){return t.$emit("amount-selected",t.amount)}},model:{value:t.tokenAmount,callback:function(e){t.tokenAmount=t._n(e)},expression:"tokenAmount"}}),t._v(" "),e("v-textarea",{staticClass:"mb-0",attrs:{id:"requestMessage",label:t.$t("exoplatform.wallet.label.initialFundsMessageInputPlaceholder"),placeholder:t.$t("exoplatform.wallet.label.initialFundsMessageInputPlaceholder"),name:"requestMessage",rows:"7",flat:"","no-resize":""},model:{value:t.requestMessage,callback:function(e){t.requestMessage=e},expression:"requestMessage"}})],1),t._v(" "),e("v-card-actions",[e("v-spacer"),t._v(" "),e("button",{staticClass:"ignore-vuetify-classes btn btn-primary mb-3",on:{click:t.save}},[t._v("\n      "+t._s(t.$t("exoplatform.wallet.button.save"))+"\n    ")]),t._v(" "),e("v-spacer")],1)],1)};n._withStripped=!0;const i=l({props:{loading:{type:Boolean,default:function(){return!1}},contractDetails:{type:Object,default:function(){return null}},settings:{type:Object,default:function(){return null}}},data:()=>({etherAmount:0,tokenAmount:0,requestMessage:null}),computed:{etherAmountLabel(){return this.etherAmountInFiat?`${this.etherAmount} (${this.etherAmountInFiat} ${window.walletSettings.fiatSymbol})`:this.etherAmount},etherAmountInFiat(){return this.etherAmount&&this.walletUtils.etherToFiat(this.etherAmount)||0},initialFunds(){return this.settings&&this.settings.initialFunds}},watch:{initialFunds(){this.reloadInitialFunds()}},methods:{reloadInitialFunds(){this.etherAmount=this.initialFunds&&this.initialFunds.etherAmount||0,this.tokenAmount=this.initialFunds&&this.initialFunds.tokenAmount||0,this.requestMessage=this.initialFunds&&this.initialFunds.requestMessage||""},save(){const t={requestMessage:this.requestMessage,etherAmount:this.etherAmount,tokenAmount:this.tokenAmount};return this.loading=!0,fetch("/portal/rest/wallet/api/settings/saveInitialFunds",{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(t&&t.ok)return t.text();throw new Error("Error saving settings")})).then((()=>this.$emit("saved",t))).catch((t=>{this.loading=!1,console.error("fetch settings - error",t),this.error=this.$t("exoplatform.wallet.warning.errorSavingSettings")}))}}},n,[],!1,null,null,null).exports;var r=function(){var t=this,e=t._self._c;return e("v-dialog",{attrs:{disabled:t.disabled,"content-class":"uiPopup with-overflow walletDialog",width:"500px","max-width":"100vw",persistent:""},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.dialog=!1}},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e("v-card",{staticClass:"elevation-12"},[e("div",{staticClass:"ignore-vuetify-classes popupHeader ClearFix"},[e("a",{staticClass:"uiIconClose pull-right",attrs:{"aria-hidden":"true"},on:{click:function(e){t.dialog=!1}}}),t._v(" "),e("span",{staticClass:"ignore-vuetify-classes PopupTitle popupTitle"},[t.wallet&&t.wallet.name?[t._v("\n          "+t._s(t.$t("exoplatform.wallet.title.sendEtherModalForWallet",{0:t.wallet.name}))+"\n        ")]:[t._v("\n          "+t._s(t.$t("exoplatform.wallet.title.sendEtherModal"))+"\n        ")]],2)]),t._v(" "),t.error&&!t.loading?e("div",{staticClass:"alert alert-error v-content"},[e("i",{staticClass:"uiIconError"}),t._v(t._s(t.error)+"\n    ")]):t._e(),t._v(" "),e("v-card",{attrs:{flat:""}},[e("v-card-text",{staticClass:"pt-0"},[e("v-form",{on:{submit:function(t){t.preventDefault(),t.stopPropagation()}}},[t.dialog?e("v-text-field",{attrs:{autofocus:t.dialog,label:t.$t("exoplatform.wallet.label.etherAmountPlaceholder"),placeholder:t.$t("exoplatform.wallet.label.etherAmount"),name:"etherAmount"},model:{value:t.etherAmount,callback:function(e){t.etherAmount=e},expression:"etherAmount"}}):t._e(),t._v(" "),t.dialog?e("v-text-field",{attrs:{disabled:t.loading,label:t.$t("exoplatform.wallet.label.transactionLabelPlaceholder"),placeholder:t.$t("exoplatform.wallet.label.transactionLabel"),name:"transactionLabel",type:"text"},model:{value:t.transactionLabel,callback:function(e){t.transactionLabel=e},expression:"transactionLabel"}}):t._e(),t._v(" "),e("v-textarea",{attrs:{disabled:t.loading,label:t.$t("exoplatform.wallet.label.transactionMessage"),placeholder:t.$t("exoplatform.wallet.label.transactionMessagePlaceholder"),name:"transactionMessage",rows:"3",flat:"","no-resize":""},model:{value:t.transactionMessage,callback:function(e){t.transactionMessage=e},expression:"transactionMessage"}})],1)],1),t._v(" "),e("v-card-actions",[e("v-spacer"),t._v(" "),e("button",{staticClass:"ignore-vuetify-classes btn btn-primary me-1",attrs:{disabled:t.loading,loading:t.loading},on:{click:t.send}},[t._v("\n          "+t._s(t.$t("exoplatform.wallet.button.send"))+"\n        ")]),t._v(" "),e("button",{staticClass:"ignore-vuetify-classes btn",attrs:{disabled:t.loading,color:"secondary"},on:{click:function(e){t.dialog=!1}}},[t._v("\n          "+t._s(t.$t("exoplatform.wallet.button.close"))+"\n        ")]),t._v(" "),e("v-spacer")],1)],1)],1)],1)};r._withStripped=!0;const o=l({data:()=>({dialog:null,loading:!1,wallet:null,etherAmount:null,transactionLabel:null,transactionMessage:null,error:null}),computed:{etherAmountLabel(){return this.etherAmountInFiat?`${this.etherAmount} (${this.etherAmountInFiat} ${window.walletSettings.fiatSymbol})`:this.etherAmount},etherAmountInFiat(){return this.etherAmount&&this.walletUtils.etherToFiat(this.etherAmount)||0}},methods:{open(t,e,a){t&&(this.wallet=t,this.etherAmount=a,this.transactionLabel=`Send ether for wallet of ${this.wallet.type} ${this.wallet.name}`,this.transactionMessage=e,this.error=null,this.loading=!1,this.dialog=!0)},send(){this.loading=!0,fetch("/portal/rest/wallet/api/admin/transaction/sendEther",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:$.param({receiver:this.wallet.address,etherAmount:this.etherAmount,transactionLabel:this.transactionLabel,transactionMessage:this.transactionMessage})}).then((t=>{if(t&&t.ok)return t.text();throw new Error(`Error sending ether to wallet ${this.wallet.address}`)})).then((t=>{this.$emit("sent",t),this.dialog=!1})).catch((t=>{this.error=String(t)})).finally((()=>{this.loading=!1}))}}},r,[],!1,null,null,null).exports;var d=function(){var t=this,e=t._self._c;return e("v-dialog",{attrs:{disabled:t.disabled,"content-class":"uiPopup with-overflow walletDialog",width:"500px","max-width":"100vw",persistent:""},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.dialog=!1}},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e("v-card",{staticClass:"elevation-12"},[e("div",{staticClass:"ignore-vuetify-classes popupHeader ClearFix"},[e("a",{staticClass:"uiIconClose pull-right",attrs:{"aria-hidden":"true"},on:{click:function(e){t.dialog=!1}}}),t._v(" "),e("span",{staticClass:"ignore-vuetify-classes PopupTitle popupTitle"},[t.wallet&&t.wallet.name?[t._v("\n          "+t._s(t.$t("exoplatform.wallet.title.sendTokenModalForWallet",{0:t.contractDetails&&t.contractDetails.name,1:t.wallet.name}))+"\n        ")]:[t._v("\n          "+t._s(t.$t("exoplatform.wallet.title.sendToken",{0:t.contractDetails&&t.contractDetails.name}))+"\n        ")]],2)]),t._v(" "),t.error&&!t.loading?e("div",{staticClass:"alert alert-error v-content"},[e("i",{staticClass:"uiIconError"}),t._v(t._s(t.error)+"\n    ")]):t._e(),t._v(" "),e("v-card",{attrs:{flat:""}},[e("v-card-text",{staticClass:"pt-0"},[e("v-form",{on:{submit:function(t){t.preventDefault(),t.stopPropagation()}}},[t.dialog?e("v-text-field",{attrs:{autofocus:t.dialog,label:t.$t("exoplatform.wallet.label.tokenAmount",{0:t.contractDetails&&t.contractDetails.name}),placeholder:t.$t("exoplatform.wallet.label.tokenAmountPlaceholder",{0:t.contractDetails&&t.contractDetails.name}),name:"tokenAmount"},model:{value:t.tokenAmount,callback:function(e){t.tokenAmount=e},expression:"tokenAmount"}}):t._e(),t._v(" "),t.dialog?e("v-text-field",{attrs:{disabled:t.loading,label:t.$t("exoplatform.wallet.label.transactionLabel"),placeholder:t.$t("exoplatform.wallet.label.transactionLabelPlaceholder"),name:"transactionLabel",type:"text"},model:{value:t.transactionLabel,callback:function(e){t.transactionLabel=e},expression:"transactionLabel"}}):t._e(),t._v(" "),e("v-textarea",{attrs:{disabled:t.loading,label:t.$t("exoplatform.wallet.label.transactionMessage"),placeholder:t.$t("exoplatform.wallet.label.transactionMessagePlaceholder"),name:"transactionMessage",rows:"3",flat:"","no-resize":""},model:{value:t.transactionMessage,callback:function(e){t.transactionMessage=e},expression:"transactionMessage"}})],1)],1),t._v(" "),e("v-card-actions",[e("v-spacer"),t._v(" "),e("button",{staticClass:"ignore-vuetify-classes btn btn-primary me-1",attrs:{disabled:t.loading,loading:t.loading},on:{click:t.send}},[t._v("\n          "+t._s(t.$t("exoplatform.wallet.button.send"))+"\n        ")]),t._v(" "),e("button",{staticClass:"ignore-vuetify-classes btn",attrs:{disabled:t.loading,color:"secondary"},on:{click:function(e){t.dialog=!1}}},[t._v("\n          "+t._s(t.$t("exoplatform.wallet.button.close"))+"\n        ")]),t._v(" "),e("v-spacer")],1)],1)],1)],1)};d._withStripped=!0;const c=l({props:{contractDetails:{type:Object,default:function(){return null}}},data:()=>({dialog:null,loading:!1,wallet:null,tokenAmount:null,transactionLabel:null,transactionMessage:null,error:null}),methods:{open(t,e,a){t&&(this.wallet=t,this.tokenAmount=a,this.transactionLabel=`Send tokens for wallet of ${this.wallet.type} ${this.wallet.name}`,this.transactionMessage=e,this.error=null,this.loading=!1,this.dialog=!0)},send(){this.loading=!0,fetch("/portal/rest/wallet/api/admin/transaction/sendToken",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:$.param({receiver:this.wallet.address,transactionLabel:this.transactionLabel,transactionMessage:this.transactionMessage,tokenAmount:this.tokenAmount})}).then((t=>{if(t&&t.ok)return t.text();throw new Error(`Error sending token to wallet ${this.wallet.address}`)})).then((t=>{this.$emit("sent",t),this.dialog=!1})).catch((t=>{this.error=String(t)})).finally((()=>{this.loading=!1}))}}},d,[],!1,null,null,null).exports;var u=function(){var t=this,e=t._self._c;return e("v-layout",{staticClass:"mt-8 adminWallet",attrs:{wrap:""}},[e("div",{staticClass:"mx-4"},[e("v-btn",{attrs:{outlined:"",href:t.requestFundsLink,target:"_blank"}},[t._v("\n      "+t._s(t.$t("exoplatform.wallet.button.requestFunds"))+"\n    ")])],1),t._v(" "),e("div",{staticClass:"text-center no-wrap mx-4 title"},[e("span",{staticClass:"labels"},[t._v(" "+t._s(t.tokenName)+": ")]),t._v(" "),t.loadingBalances?e("v-progress-circular",{staticClass:"me-4",attrs:{color:"primary",indeterminate:"",size:"20"}}):[e("span",{staticClass:"symbol fundsLabels"},[t._v(" "+t._s(t.tokenSymbol)+" ")]),t._v(" "),e("span",{staticClass:"fundsLabels"},[t._v(" "+t._s(t.tokenBalance)+" ")]),t._v(" "),t.adminBalanceTooLow?e("v-icon",{attrs:{color:"orange",title:t.$t("exoplatform.wallet.label.adminBalanceTooLow")}},[t._v("\n        warning\n      ")]):t._e()]],2),t._v(" "),e("v-divider",{staticClass:"mx-4",attrs:{width:"100",vertical:""}}),t._v(" "),e("div",{staticClass:"no-wrap mx-4 title"},[e("span",{staticClass:"labels"},[t._v(" "+t._s(t.$t("exoplatform.wallet.label.ethers"))+": ")]),t._v(" "),t.loadingBalances?e("v-progress-circular",{staticClass:"me-4",attrs:{color:"primary",indeterminate:"",size:"20"}}):[e("span",{staticClass:"fundsLabels"},[t._v(" "+t._s(t.etherBalanceLabel)+" ")])]],2),t._v(" "),e("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:l}){return[e("a",t._g(t._b({staticClass:"no-wrap mx-5 title",attrs:{target:"_blank"}},"a",l,!1),a),[e("span",{staticClass:"ethereumAddress"},[t._v(" "+t._s(t.$t("exoplatform.wallet.label.ethereumAddress")))])])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t._v(" "),e("v-card",[e("v-card-title",{staticClass:"ethereumAddressTitle grey lighten-2"},[t._v("\n        "+t._s(t.$t("exoplatform.wallet.label.ethereumAddress"))+"\n      ")]),t._v(" "),e("v-card-text",{staticClass:"mt-4"},[t._v("\n        "+t._s(t.adminWalletAddress)+"\n      ")])],1)],1)],1)};u._withStripped=!0;const h=l({props:{contractDetails:{type:Object,default:function(){return null}},initialTokenAmount:{type:Number,default:function(){return 0}},adminWallet:{type:Object,default:function(){return null}}},data:()=>({dialog:!1}),computed:{adminBalance(){return this.adminWallet&&this.walletUtils.toFixed(this.adminWallet.tokenBalance)||0},adminBalanceTooLow(){return this.adminBalance<this.initialTokenAmount},requestFundsLink(){return this.adminWalletAddress&&`https://www.exoplatform.com/rewarding-program?address=${this.adminWalletAddress}`||"#"},adminWalletAddress(){return this.adminWallet&&this.adminWallet.address||""},tokenName(){return this.contractDetails&&this.contractDetails.name||""},tokenSymbol(){return this.contractDetails&&this.contractDetails.symbol||""},loadingBalances(){return this.adminWallet&&this.adminWallet.loading||!1},tokenBalance(){return this.adminWallet&&this.adminWallet.tokenBalance||0},etherBalance(){return this.adminWallet&&this.adminWallet.etherBalance||0},etherBalanceLabel(){return`${this.walletUtils.toFixed(this.etherBalance)} ${this.contractDetails.cryptocurrency}`}}},u,[],!1,null,null,null).exports;var m=function(){var t=this,e=t._self._c;return e("v-flex",{attrs:{flat:""}},[e("wallet-reward-confirm-dialog",{ref:"informationModal",attrs:{loading:t.loading,title:t.informationTitle,message:t.informationMessage,"hide-default-footer":t.hideConfirmActions,width:"400px"},on:{ok:t.proceessAction}}),t._v(" "),t.error?e("div",{staticClass:"alert alert-error v-content"},[e("i",{staticClass:"uiIconError"}),t._v(t._s(t.error)+"\n  ")]):t._e(),t._v(" "),t.loading||t.useWalletAdmin?t._e():e("div",{staticClass:"red--text wrap title"},[e("div",[t._v(t._s(t.$t("exoplatform.wallet.warning.adminWalletNotInitializedPart1")))]),t._v(" "),e("div",[t._v(t._s(t.$t("exoplatform.wallet.warning.adminWalletNotInitializedPart2")))])]),t._v(" "),t.loading?t._e():e("wallet-admin-wallet",{attrs:{"admin-wallet":t.walletAdmin,"initial-token-amount":t.tokenAmount,"contract-details":t.contractDetails},on:{"refresh-balance":function(e){return t.refreshWallet(t.walletAdmin,!0)}}}),t._v(" "),e("v-toolbar",{staticClass:"border-box-sizing mx-0 infoMenu",attrs:{color:"transparent",flat:""}},[e("v-spacer"),t._v(" "),e("v-text-field",{staticClass:"pt-0 border-box-sizing walletTextField text-truncate mb-n4",attrs:{placeholder:t.$t("exoplatform.wallet.label.searchInWalletPlaceholder"),"prepend-inner-icon":"fa-filter"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),e("v-menu",{staticClass:"border-box-sizing dropDownFilter",attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e("button",t._g({staticClass:"btn mx-4",on:{blur:t.closeMenu}},a),[t._v("\n          "+t._s(t.newsFilterLabel)+"\n          "),e("i",{staticClass:"uiIconMiniArrowDown uiIconLightGray"})])]}}]),model:{value:t.showMenu,callback:function(e){t.showMenu=e},expression:"showMenu"}},[t._v(" "),e("v-list",[e("v-list-item",{on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"filterLabel",on:{click:function(e){t.filterWallet="all"}}},[t._v(t._s(t.$t("exoplatform.wallet.label.All")))])],1),t._v(" "),e("v-list-item",{on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"filterLabel",on:{click:function(e){t.filterWallet="DisabledWallets"}}},[t._v(t._s(t.$t("exoplatform.wallet.label.disabledWalletsByAdmin")))])],1),t._v(" "),e("v-list-item",{on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"filterLabel",on:{click:function(e){t.filterWallet="DisabledUsersWallets"}}},[t._v(" "+t._s(t.$t("exoplatform.wallet.label.disabledUsersWallets"))+"  ")])],1),t._v(" "),e("v-list-item",{on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"filterLabel",on:{click:function(e){t.filterWallet="DeletedWallets"}}},[t._v(" "+t._s(t.$t("exoplatform.wallet.label.deletedWallets"))+"  ")])],1)],1)],1)],1),t._v(" "),e("v-data-table",{attrs:{headers:t.walletTableHeaders,items:t.displayedWallets,"items-per-page":t.limit,loading:t.loadingWallets},scopedSlots:t._u([{key:"item",fn:function(a){return[e("transition",{attrs:{name:"fade"}},[e("tr",{directives:[{name:"show",rawName:"v-show",value:t.wallets,expression:"wallets"}]},[e("td",{staticClass:"text-truncate"},[e("v-avatar",{staticClass:"mx-1 clickable",attrs:{size:"29"},on:{click:function(e){return t.openAccountDetail(a.item)}}},[a.item.avatar?e("img",{attrs:{src:a.item.avatar,onerror:"this.src = '/eXoSkin/skin/images/system/SpaceAvtDefault.png'"}}):e("v-icon",{attrs:{size:"29"}},[t._v("fa-cog")])],1),t._v(" "),e("wallet-reward-profile-chip",{attrs:{address:a.item.address,"profile-id":a.item.id,"profile-technical-id":a.item.technicalId,"space-id":a.item.spaceId,"profile-type":a.item.type,"display-name":a.item.name,enabled:a.item.enabled,"deleted-user":a.item.deletedUser,"disabled-user":a.item.disabledUser,avatar:a.item.avatar,"display-no-address":"","no-status":""}})],1),t._v(" "),e("td",{staticClass:"clickable text-center",on:{click:function(e){return t.openAccountDetail(a.item)}}},[[a.item.deletedUser?[t._v(t._s(t.$t("exoplatform.wallet.label.deletedIdentity")))]:a.item.disabledUser?[t._v(t._s(t.$t("exoplatform.wallet.label.disabledUser")))]:a.item.enabled?"NEW"===a.item.initializationState?[t._v(t._s(t.$t("exoplatform.wallet.label.newWallet")))]:"DELETED"===a.item.initializationState?[t._v(t._s(t.$t("exoplatform.wallet.label.DeletedWallet")))]:[0===Number(a.item.etherBalance)||t.etherAmount&&t.walletUtils.toFixed(a.item.etherBalance)<Number(t.etherAmount)?[e("v-icon",{attrs:{color:"orange"}},[t._v("\n                    warning\n                  ")]),t._v("\n                  "+t._s(t.$t("exoplatform.wallet.warning.lowEtherAmount"))+"\n                ")]:0===Number(a.item.tokenBalance)?[e("v-icon",{attrs:{color:"orange"}},[t._v("\n                    warning\n                  ")]),t._v("\n                  "+t._s(t.$t("exoplatform.wallet.warning.lowTokenAmount",{0:t.contractDetails&&t.contractDetails.name}))+"\n                ")]:[t._v("\n                  "+t._s(t.$t("exoplatform.wallet.label.initializedWallet"))+"\n                ")]]:[t._v(t._s(t.$t("exoplatform.wallet.label.disabledWallet")))]]],2),t._v(" "),t.contractDetails?e("td",{staticClass:"clickable text-center",on:{click:function(e){return t.openAccountDetail(a.item)}}},[a.item.loading?e("v-progress-circular",{staticClass:"me-4",attrs:{color:"primary",indeterminate:"",size:"20"}}):[t._v("\n              "+t._s(t.walletUtils.toFixed(a.item.tokenBalance)||0)+" "+t._s(t.contractDetails&&t.contractDetails.symbol?t.contractDetails.symbol:"")+"\n            ")]],2):t._e(),t._v(" "),e("td",{staticClass:"clickable text-center",on:{click:function(e){return t.openAccountDetail(a.item)}}},[a.item.loading?e("v-progress-circular",{staticClass:"me-4",attrs:{color:"primary",indeterminate:"",size:"20"}}):[t._v("\n              "+t._s(t.walletUtils.toFixed(a.item.etherBalance)||0)+" "+t._s(t.contractDetails.cryptocurrency)+"\n            ")]],2),t._v(" "),e("td",{staticClass:"text-center"},[a.item.pendingTransaction||a.item.loading?e("v-progress-circular",{staticClass:"me-4",attrs:{title:t.$t("exoplatform.wallet.message.transactionInProgress"),color:"primary",indeterminate:"",size:"20"}}):e("v-menu",{attrs:{attach:"",bottom:"",left:t.rtlDisplay,value:t.actionSelectedWallet===a.item},scopedSlots:t._u([{key:"activator",fn:function({on:l}){return[e("v-btn",t._g({staticClass:"actionsButton",attrs:{icon:"",small:""},on:{click:function(e){t.actionSelectedWallet=a.item},blur:t.closeActionsMenu}},l),[e("v-icon",{attrs:{size:"20px"}},[t._v("fa-ellipsis-v")])],1)]}}],null,!0)},[t._v(" "),e("v-list",{staticClass:"pt-0 pb-0",attrs:{flat:""}},[[e("v-list-item",{on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"options",on:{click:function(e){return t.refreshWallet(a.item,!0)}}},[t._v(t._s(t.$t("exoplatform.wallet.button.refreshWallet")))])],1),t._v(" "),e("v-divider"),t._v(" "),"user"===a.item.type||"space"===a.item.type?[t.useWalletAdmin?[!a.item.disabledUser&&!a.item.deletedUser&&a.item.enabled&&(0===Number(a.item.etherBalance)||t.etherAmount&&t.walletUtils.toFixed(a.item.etherBalance)<Number(t.etherAmount))?[e("v-list-item",{attrs:{disabled:t.adminNotHavingEnoughEther},on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"options",on:{click:function(e){return t.openSendEtherModal(a.item)}}},[t._v(t._s(t.$t("exoplatform.wallet.button.sendEther")))])],1),t._v(" "),e("v-divider")]:t._e(),t._v(" "),!a.item.disabledUser&&!a.item.deletedUser&&a.item.enabled&&t.tokenAmount>0?e("v-list-item",{attrs:{disabled:t.adminNotHavingEnoughToken},on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"options",on:{click:function(e){return t.openSendTokenModal(a.item)}}},[t._v(t._s(t.$t("exoplatform.wallet.button.sendToken",{0:t.contractDetails&&t.contractDetails.name})))])],1):t._e(),t._v(" "),e("v-divider")]:t._e(),t._v(" "),a.item.enabled?e("v-list-item",{on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"options",on:{click:function(e){return t.openDisableWalletModal(a.item)}}},[t._v(t._s(t.$t("exoplatform.wallet.button.disableWallet")))])],1):a.item.disabledUser||a.item.deletedUser?t._e():e("v-list-item",{on:{mousedown:function(t){return t.preventDefault()}}},[e("v-list-item-title",{staticClass:"options",on:{click:function(e){return t.enableWallet(a.item,!0)}}},[t._v(t._s(t.$t("exoplatform.wallet.button.enableWallet")))])],1)]:t._e()]],2)],1)],1)])])]}}])}),t._v(" "),e("wallet-send-token-modal",{ref:"sendTokenModal",attrs:{"contract-details":t.contractDetails},on:{sent:t.walletPendingTransaction}}),t._v(" "),e("wallet-send-ether-modal",{ref:"sendEtherModal",on:{sent:t.walletPendingTransaction}}),t._v(" "),e("wallet-reward-account-detail",{ref:"accountDetail",attrs:{"fiat-symbol":t.fiatSymbol,wallet:t.selectedWallet,"contract-details":t.selectedWalletDetails,"selected-transaction-hash":t.selectedTransactionHash,"is-read-only":"","is-display-only":"","is-administration":""},on:{back:function(e){return t.back()}}})],1)};m._withStripped=!0;const p={"wallet-initial-funds-tab":i,"wallet-send-ether-modal":o,"wallet-send-token-modal":c,"wallet-admin-wallet":h,"wallet-tab":l({props:{loading:{type:Boolean,default:function(){return!1}},fiatSymbol:{type:String,default:function(){return null}},walletAddress:{type:String,default:function(){return null}},addressEtherscanLink:{type:String,default:function(){return null}},contractDetails:{type:Object,default:function(){return null}}},data:()=>({search:null,newsFilterLabel:"",filterWallet:"",showMenu:!1,loadingWallets:!1,selectedTransactionHash:null,seeAccountDetails:!1,seeAccountDetailsPermanent:!1,selectedWalletAddress:null,selectedWallet:null,selectedWalletDetails:null,actionSelectedWallet:{},informationTitle:null,informationMessage:null,hideConfirmActions:null,confirmAction:null,error:null,wallets:[],walletToProcess:null,etherAmount:null,tokenAmount:null,limit:5,walletTypes:["user","space","admin"],walletStatuses:["Approved"]}),computed:{walletHeaders(){return[{text:this.$t("exoplatform.wallet.label.name"),align:"center",sortable:!0,value:"name"},{text:this.$t("exoplatform.wallet.label.walletStatus"),align:"center",sortable:!1,value:"isApproved"},{text:this.$t("exoplatform.wallet.label.tokenBalance",{0:this.contractDetails&&this.contractDetails.name}),align:"center",value:"tokenBalance"},{text:this.$t("exoplatform.wallet.label.etherBalance"),align:"center",value:"etherBalance"},{text:this.$t("exoplatform.wallet.label.actions"),align:"center",sortable:!1,value:""}]},walletAdmin(){return this.wallets&&this.wallets.find((t=>t&&"admin"===t.type))},adminNotHavingEnoughToken(){return this.walletAdmin&&this.walletAdmin.tokenBalance<this.tokenAmount},adminNotHavingEnoughEther(){return this.walletAdmin&&this.walletAdmin.etherBalance<this.etherAmount},useWalletAdmin(){return this.walletAdmin&&this.walletAdmin.etherBalance&&Number(this.walletAdmin.etherBalance)>=.002&&this.walletAdmin.tokenBalance&&Number(this.walletAdmin.tokenBalance)>=.02},displayUsers(){return this.walletTypes&&this.walletTypes.includes("user")},displaySpaces(){return this.walletTypes&&this.walletTypes.includes("space")},displayAdmin(){return this.walletTypes&&this.walletTypes.includes("admin")},displayDisabledWallets(){return this.walletStatuses&&this.walletStatuses.includes("disabledWallet")},displayDisabledUserWallets(){return this.walletStatuses&&this.walletStatuses.includes("disabledUser")},displayDeletedWallets(){return this.walletStatuses&&this.walletStatuses.includes("deletedWallet")},displayAllWallets(){return this.walletStatuses&&this.walletStatuses.includes("all")},etherAccountDetails(){return{title:"ether",icon:"ether",symbol:"ether",isContract:!1,balance:10,address:this.walletAddress}},walletTableHeaders(){const t=this.walletHeaders.slice();return this.contractDetails||(t.splice(4,1),t.splice(2,1)),t},displayedWallets(){return this.wallets.filter(this.isDisplayWallet)},rtlDisplay(){return!this.$vuetify.rtl}},watch:{seeAccountDetails(){if(this.seeAccountDetails){$("body").addClass("hide-scroll");const t=this;setTimeout((()=>{t.seeAccountDetailsPermanent=!0}),200)}else $("body").removeClass("hide-scroll"),this.seeAccountDetailsPermanent=!1},filterWallet(){"DisabledWallets"===this.filterWallet?(this.walletStatuses=["disabledWallet"],this.newsFilterLabel=this.$t("exoplatform.wallet.label.disabledWalletsByAdmin")):"DisabledUsersWallets"===this.filterWallet?(this.walletStatuses=["disabledUser"],this.newsFilterLabel=this.$t("exoplatform.wallet.label.disabledUsersWallets")):"DeletedWallets"===this.filterWallet?(this.walletStatuses=["deletedWallet"],this.newsFilterLabel=this.$t("exoplatform.wallet.label.deletedWallets")):(this.newsFilterLabel=this.$t("exoplatform.wallet.label.All"),this.walletStatuses=["all"]),this.showMenu=!1}},created(){this.newsFilterLabel=this.$t("exoplatform.wallet.label.All")},methods:{init(){if(this.loadingWallets)return;const t=window.walletSettings.initialFunds||{};return this.etherAmount=t.etherAmount||0,this.tokenAmount=t.tokenAmount||0,this.walletUtils.getWallets().then((t=>(t.forEach((t=>{t.loading=!0})),this.wallets=t.sort(this.sortByName),this.wallets.forEach((t=>{t.fiatBalance=t.fiatBalance||t.etherBalance&&this.walletUtils.etherToFiat(t.etherBalance),t.loading=!1})),this.$nextTick()))).then((()=>{this.$emit("wallets-loaded",this.wallets)})).finally((()=>{this.loadingWallets=!1}))},sortByName(t,e){const a=t.name&&t.name.toLocaleLowerCase(),l=e.name&&e.name.toLocaleLowerCase();return(a>l?1:a<l&&-1)||0},isDisplayWallet(t){return this.displayDisabledWallets?t&&t.address&&(this.displayUsers||"user"!==t.type)&&(this.displaySpaces||"space"!==t.type)&&(this.displayAdmin||"admin"!==t.type)&&this.displayDisabledWallets&&!t.enabled&&!t.disabledUser&&(!this.search||t.name.toLowerCase().indexOf(this.search.toLowerCase())>=0||t.address.toLowerCase().indexOf(this.search.toLowerCase())>=0):this.displayDisabledUserWallets?t&&t.address&&(this.displayUsers||"user"!==t.type)&&(this.displaySpaces||"space"!==t.type)&&(this.displayAdmin||"admin"!==t.type)&&this.displayDisabledUserWallets&&t.disabledUser&&(!this.search||t.name.toLowerCase().indexOf(this.search.toLowerCase())>=0||t.address.toLowerCase().indexOf(this.search.toLowerCase())>=0):this.displayDeletedWallets?t&&t.address&&(this.displayUsers||"user"!==t.type)&&(this.displaySpaces||"space"!==t.type)&&(this.displayAdmin||"admin"!==t.type)&&this.displayDeletedWallets&&"DELETED"===t.initializationState&&(!this.search||t.name.toLowerCase().indexOf(this.search.toLowerCase())>=0||t.address.toLowerCase().indexOf(this.search.toLowerCase())>=0):this.displayAllWallets?t&&t.address&&(!this.search||t.name.toLowerCase().indexOf(this.search.toLowerCase())>=0||t.address.toLowerCase().indexOf(this.search.toLowerCase())>=0):t&&t.address&&(this.displayUsers||"user"!==t.type)&&(this.displaySpaces||"space"!==t.type)&&(this.displayAdmin||"admin"!==t.type)&&(this.displayDisabledWallets||t.enabled&&!t.disabledUser)&&(this.displayDisabledUserWallets||!t.disabledUser)&&"DELETED"!==t.initializationState&&(!this.search||t.name.toLowerCase().indexOf(this.search.toLowerCase())>=0||t.address.toLowerCase().indexOf(this.search.toLowerCase())>=0)},refreshWallet(t,e){return t.loading=!0,this.addressRegistry.refreshWallet(t,e).then((()=>{t.fiatBalance=t.fiatBalance||t.etherBalance&&this.walletUtils.etherToFiat(t.etherBalance)})).finally((()=>{t.loading=!1}))},openAccountDetail(t,e){this.selectedTransactionHash=e,this.selectedWalletAddress=t.address,this.selectedWallet=t,this.selectedWalletDetails={title:"ether",icon:"fab fa-ethereum",symbol:"ether",address:this.selectedWalletAddress,balance:t.etherBalance,balanceFiat:t.fiatBalance,details:t},this.seeAccountDetails=!0,this.$refs.accountDetail.open(),this.$nextTick((()=>{const t=this;$(".v-overlay").off("click").on("click",(()=>t.back()))}))},back(){this.seeAccountDetails=!1,this.seeAccountDetailsPermanent=!1,this.selectedWalletAddress=null,this.selectedWalletDetails=null},enableWallet(t,e){return this.error=null,this.walletUtils.enableWallet(t.address,e).then((a=>{if(a)return this.addressRegistry.refreshWallet(t);this.error=e&&this.$t("exoplatform.wallet.error.errorEnablingWallet",{0:t.name})||this.$t("exoplatform.wallet.error.errorDisablingWallet",{0:t.name})})).catch((t=>this.error=String(t)))},walletPendingTransaction(t){this.$emit("pending",t),this.error=null,t&&(this.$set(this.walletToProcess,"pendingTransaction",(this.walletToProcess.pendingTransaction||0)+1),this.watchWalletTransaction(this.walletToProcess,t))},openSendTokenModal(t){this.walletToProcess=t,this.$refs.sendTokenModal.open(t,null,this.tokenAmount)},openSendEtherModal(t){this.walletToProcess=t;const e=this.walletUtils.toFixed(this.etherAmount)-Number(t&&t.etherBalance);e&&e>0&&Number.isFinite(e)&&this.$refs.sendEtherModal.open(t,null,e)},openDisableWalletModal(t){this.walletToProcess=t,this.informationTitle=this.$t("exoplatform.wallet.title.disableWalletConfirmationModal"),this.informationMessage=this.$t("exoplatform.wallet.message.disableWalletConfirmation",{0:t.type,1:`<strong>${t.name}</strong>`}),this.hideConfirmActions=!1,this.confirmAction="disable",this.$refs.informationModal.open()},changeWalletInitializationStatus(t,e){if(t)return this.walletUtils.saveWalletInitializationStatus(t.address,e).then((()=>this.refreshWallet(t))).catch((t=>{this.error=String(t)}))},watchWalletTransaction(t,e){this.walletUtils.watchTransactionStatus(e,(()=>{this.$set(t,"pendingTransaction",(t.pendingTransaction||1)-1),this.refreshWallet(t)}))},proceessAction(){"disable"===this.confirmAction&&this.enableWallet(this.walletToProcess,!1)},closeMenu(){this.showMenu=!1},closeActionsMenu(){this.actionSelectedWallet={}}}},m,[],!1,null,null,null).exports};for(const t in p)Vue.component(t,p[t]);Vue.use(Vuetify),Vue.use(WalletCommon);const f=new Vuetify(eXo.env.portal.vuetifyPreset),w=eXo&&eXo.env&&eXo.env.portal&&eXo.env.portal.language||"en",v=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.addon.Wallet-${w}.json`;function b(){exoi18n.loadLanguageAsync(w,v).then((t=>{new Vue({render:t=>t(s),i18n:t,vuetify:f}).$mount("#WalletAdminApp")}))}return e})()));