define((()=>(()=>{"use strict";var e={d:(t,r)=>{for(var o in r)e.o(r,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:r[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>C});var r={};e.r(r),e.d(r,{cancelExportNotes:()=>j,createNote:()=>$,deleteDraftNote:()=>T,deleteNotes:()=>E,exportNotes:()=>_,getDraftNoteById:()=>l,getExportStatus:()=>S,getExportedZip:()=>x,getFullNoteTree:()=>f,getLatestDraftOfPage:()=>d,getNote:()=>c,getNoteById:()=>p,getNoteTree:()=>h,getNoteVersionsByNoteId:()=>b,getPathByNoteOwner:()=>y,getSeparator:()=>u,importZipNotes:()=>N,moveNotes:()=>k,restoreNoteVersion:()=>g,saveDraftNote:()=>m,updateNote:()=>v,updateNoteById:()=>w});var o=function(){var e=this,t=e._self._c;return t("v-list-item",{staticClass:"clickable",attrs:{href:e.noteUrl}},[t("v-list-item-icon",{staticClass:"me-3 my-auto"},[t("v-img",{attrs:{src:e.noteImg,"max-height":"28","max-width":"25"}})],1),e._v(" "),t("v-list-item-content",[t("v-list-item-title",{staticClass:"text-color body-2 text-truncate"},[e._v(e._s(e.noteTitle))])],1),e._v(" "),t("v-list-item-action",[t("favorite-button",{attrs:{id:e.id,favorite:e.isFavorite,top:e.top,right:e.right,type:"notes","type-label":"notes"},on:{removed:e.removed,"remove-error":e.removeError}})],1)],1)};o._withStripped=!0;var n=function(e,t,r,o,n,i,s,a){var c,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=r,l._compiled=!0),o&&(l.functional=!0),i&&(l._scopeId="data-v-"+i),s?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=c):n&&(c=a?function(){n.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:n),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(e,t){return c.call(t),d(e,t)}}else{var p=l.beforeCreate;l.beforeCreate=p?[].concat(p,c):[c]}return{exports:e,options:l}}({props:{id:{type:String,default:()=>null}},data:()=>({isFavorite:!0,note:{},noteImg:"/notes/images/notes-appicon.png"}),computed:{noteTitle(){return this.note?.title||""},noteUrl(){return this.note?.url||"#"}},created(){this.$notesService.getNoteById(this.id).then((e=>{this.note=e}))},methods:{removed(){this.isFavorite=!this.isFavorite,this.displayAlert(this.$t("Favorite.tooltip.SuccessfullyDeletedFavorite")),this.$emit("removed"),this.$root.$emit("refresh-favorite-list")},removeError(){this.displayAlert(this.$t("Favorite.tooltip.ErrorDeletingFavorite","note"),"error")},displayAlert(e,t){document.dispatchEvent(new CustomEvent("notification-alert",{detail:{message:e,type:t||"success"}}))}}},o,[],!1,null,null,null);const i={"notes-favorite-item":n.exports};for(const e in i)Vue.component(e,i[e]);eXo.env.portal;const s=eXo.env.portal.context||"",a=(eXo.env.portal.portalName,eXo.env.portal.context,eXo.env.server.portalBaseURL,eXo.env.portal.rest);eXo.env.portal.containerName,eXo.env.portal.language;function c(e,t,r,o){let n=`${s}/${a}/notes/note/${e}/${t}/${r}`;return o&&(n=`${n}?source=${o}`),fetch(n,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function l(e){return fetch(`${s}/${a}/notes/draftNote/${e}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function d(e){return fetch(`${s}/${a}/notes/latestDraftNote/${e}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function p(e,t,r,o,n){let i=`${s}/${a}/notes/note/${e}`;return t&&(i=`${i}${u(i)}source=${t}`),r&&(i=`${i}${u(i)}noteBookType=${r}`),o&&(i=`${i}${u(i)}noteBookOwner=${o}`),n&&(i=`${i}${u(i)}withChildren=${n}`),fetch(i,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function u(e){return-1!==e.indexOf("?")?"&":"?"}function h(e,t,r,o){return fetch(`${s}/${a}/notes/tree/${o}?path=${e}/${t}/${r}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function f(e,t,r,o){return fetch(`${s}/${a}/notes/tree/full?path=${e}/${t}/${r}&withDrafts=${o}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function $(e){return fetch(`${s}/${a}/notes/note`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",credentials:"include",body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw 409===e.status?new Error("error.duplicate.title",e):new Error("error",e)}))}function m(e,t){return t&&(e.parentPageId=t),fetch(`${s}/${a}/notes/saveDraft`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",credentials:"include",body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw 409===e.status?new Error("error.duplicate.title",e):new Error("error",e)}))}function v(e){return fetch(`${s}/${a}/notes/note/${e.wikiType}/${e.wikiOwner}/${e.name}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PUT",body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw 409===e.status?new Error("error.duplicate.title",e):new Error("error",e)}))}function w(e){return fetch(`${s}/${a}/notes/note/${e.id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw 409===e.status?new Error("error.duplicate.title",e):new Error("error",e)}))}function g(e,t){return fetch(`${s}/${a}/notes/restore/${t}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw 409===e.status?new Error("error.duplicate.title",e):new Error("error",e)}))}function y(e,t){if(t||(t="notes"),"group"===e.wikiType){const r=e.wikiOwner.split("/spaces/")[1],o=e.url.split(`/portal/g/:spaces:${r}/`)[1].split("/")[0];return`${eXo.env.portal.context}/g/:spaces:${r}/${o}/${t}/${e.id}`}return`${eXo.env.portal.context}/${eXo.env.portal.portalName}/notes/${e.id}`}function E(e){return fetch(`${s}/${a}/notes/note/${e.id}`,{credentials:"include",method:"DELETE"}).then((e=>{if(e&&e.ok)return e;throw new Error("Error when deleting notes")}))}function T(e){return fetch(`${s}/${a}/notes/draftNote/${e.id}`,{credentials:"include",method:"DELETE"}).then((e=>{if(e&&e.ok)return e;throw new Error("Error when deleting draft")}))}function k(e,t){return fetch(`${s}/${a}/notes/note/move/${e.id}/${t.id}`,{credentials:"include",method:"PATCH"}).then((e=>{if(e&&e.ok)return e;throw new Error("Error when moving notes")}))}function N(e,t,r){return fetch(`${s}/${a}/notes/note/import/${e}/${t}?conflict=${r}`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",credentials:"include"}).then((e=>{if(e&&e.ok)return e;throw new Error("error",e)}))}function _(e,t,r){fetch(`${s}/${a}/notes/note/export/${r}/${e}?exportAll=${t}`,{credentials:"include",method:"GET"}).then((e=>{if(!e||!e.ok)throw new Error("error",e)}))}function x(e){return fetch(`${s}/${a}/notes/note/export/zip/${e}`,{credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e;throw new Error("Error when getting exported notes")}))}function S(e){return fetch(`${s}/${a}/notes/note/export/status/${e}`,{credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting export status")}))}function j(e){return fetch(`${s}/${a}/notes/note/export/cancel/${e}`,{credentials:"include",method:"GET"}).then((e=>{if(!e||!e.ok)throw new Error("error",e)}))}function b(e){return fetch(`${s}/${a}/notes/versions/${e}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function C(){extensionRegistry.registerExtension("activity","type",{type:"ks-wiki:spaces",options:{name:"notes",canEdit:()=>!1,supportsThumbnail:!0,useSameViewForMobile:!0,thumbnailProperties:{height:"90px",width:"90px",noBorder:!0},getThumbnail:()=>"/notes/images/wiki.png",getTitle:e=>e&&e.title||"",getSummary:e=>e.templateParams&&Vue.prototype.$utils.htmlToText(e.templateParams.page_exceprt),getSourceLink:e=>{try{const t=e.templateParams||{};if("group"===t.page_type&&e.activityStream&&e.activityStream.space)return`${t.page_url}`;if("portal"===t.page_type)return`${eXo.env.portal.context}/${t.page_owner}/wiki/${t.page_id}`}catch(e){console.warn("It seems that notes URL building is compromised. The activity will be displayed anyway with empty link",e)}return"#"},canShare:()=>!0}}),extensionRegistry.registerComponent("favorite-notes","favorite-drawer-item",{id:"notes",vueComponent:Vue.options.components["notes-favorite-item"]})}return Vue.prototype.$notesService||window.Object.defineProperty(Vue.prototype,"$notesService",{value:r}),t})()));