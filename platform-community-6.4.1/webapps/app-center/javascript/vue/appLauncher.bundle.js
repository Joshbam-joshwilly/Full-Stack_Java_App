define((()=>(()=>{"use strict";var t={d:(e,i)=>{for(var a in i)t.o(i,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:i[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{init:()=>p});var i=function(){var t=this,e=t._self._c;return e("v-app",{attrs:{flat:""}},[e("v-container",{attrs:{"px-0":"","py-0":""}},[e("v-layout",{staticClass:"transparent"},[e("v-btn",{staticClass:"text-xs-center",attrs:{id:"appcenterLauncherButton",title:t.$t("appCenter.appLauncher.topbarIcon.tooltip"),icon:""},on:{click:function(e){return t.toggleDrawer()}}},[e("v-icon",{staticClass:"appCenterLauncherButtonIcon icon-large-size icon-default-color"},[t._v("\n          mdi-dots-grid\n        ")])],1)],1)],1),t._v(" "),e("exo-drawer",{ref:"appLauncherDrawer",staticClass:"appCenterDrawer",attrs:{right:!t.$vuetify.rtl,"body-classes":"hide-scroll"}},[e("template",{slot:"title"},[t._v("\n      "+t._s(t.applicationsLoaded&&t.$t("appCenter.appLauncher.drawer.title")||"")+"\n    ")]),t._v(" "),e("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[t.mandatoryApplicationsList.length>0?e("v-row",{staticClass:"mandatory appsContainer"},[e("v-col",{staticClass:"appLauncherList",model:{value:t.mandatoryApplicationsList,callback:function(e){t.mandatoryApplicationsList=e},expression:"mandatoryApplicationsList"}},t._l(t.mandatoryApplicationsList,(function(i,a){return e("div",{key:a,staticClass:"appLauncherItemContainer",attrs:{id:"Pos-"+a}},[e("div",{staticClass:"appLauncherItem",attrs:{id:"App-"+a}},[e("a",{attrs:{id:i.id,target:i.target,href:i.computedUrl},on:{click:function(e){return t.logOpenApplication(i.id)}}},[i.imageFileId&&i.imageFileName||t.defaultAppImage.fileBody?e("img",{staticClass:"appLauncherImage",attrs:{referrerpolicy:"no-referrer",src:`/portal/rest/app-center/applications/illustration/${i.id}?v=${i.imageLastModified}`}}):e("img",{staticClass:"appLauncherImage",attrs:{referrerpolicy:"no-referrer",src:"/app-center/skin/images/defaultApp.png"}}),t._v(" "),e("span",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:i.title.length>22?i.title:"",expression:"application.title.length > 22 ? application.title : ''",modifiers:{bottom:!0,body:!0}}],staticClass:"appLauncherTitle"},[t._v("\n                  "+t._s(i.title)+"\n                ")])])])])})),0)],1):t._e(),t._v(" "),t.favoriteApplicationsList.length>0&&t.mandatoryApplicationsList.length>0?e("v-row",{staticClass:"appsContainer"},[e("v-divider")],1):t._e(),t._v(" "),e("v-layout",{staticClass:"favorite appsContainer"},[e("draggable",{staticClass:"appLauncherList",on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1}},model:{value:t.favoriteApplicationsList,callback:function(e){t.favoriteApplicationsList=e},expression:"favoriteApplicationsList"}},t._l(t.favoriteApplicationsList,(function(i,a){return e("div",{key:a,staticClass:"appLauncherItemContainer",attrs:{id:"Pos-"+a}},[e("div",{staticClass:"appLauncherItem",attrs:{id:"App-"+a}},[e("a",{attrs:{id:i.id,target:i.target,href:i.computedUrl},on:{click:function(e){return t.logOpenApplication(i.id)}}},[i.imageFileId&&i.imageFileName||t.defaultAppImage.fileBody?e("img",{staticClass:"appLauncherImage",attrs:{referrerpolicy:"no-referrer",src:`/portal/rest/app-center/applications/illustration/${i.id}?v=${i.imageLastModified}`}}):e("img",{staticClass:"appLauncherImage",attrs:{referrerpolicy:"no-referrer",src:"/app-center/skin/images/defaultApp.png"}}),t._v(" "),e("span",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:i.title.length>22?i.title:"",expression:"application.title.length > 22 ? application.title : ''",modifiers:{bottom:!0,body:!0}}],staticClass:"appLauncherTitle"},[t._v("\n                  "+t._s(i.title)+"\n                ")])])])])})),0)],1)],1),t._v(" "),t.applicationsLoaded?e("div",{attrs:{slot:"footer"},slot:"footer"},[e("v-card",{staticClass:"d-flex flex justify-end mx-2 px-1",attrs:{flat:"",tile:""}},[e("v-btn",{staticClass:"text-uppercase caption primary--text seeAllApplicationsBtn",attrs:{outlined:"",small:"",href:t.appCenterLink},on:{click:function(e){return t.navigateTo("appCenterUserSetup/")},mouseup:function(e){return"button"in e&&1!==e.button?null:t.navigateTo("appCenterUserSetup/")},contextmenu:function(e){return t.navigateTo("appCenterUserSetup/")}}},[t._v("\n          "+t._s(t.$t("appCenter.appLauncher.drawer.viewAll"))+"\n        ")])],1)],1):t._e()],2)],1)};i._withStripped=!0;const a={props:{i18nPromise:{type:Object,default:null}},data:()=>({defaultAppImage:{fileBody:"",fileName:"",invalidSize:!1,invalidImage:!1},isMobileDevice:!1,applicationsLoaded:!1,mandatoryApplicationsList:[],favoriteApplicationsList:[],applicationsOrder:null,appCenterUserSetupLink:"",loading:!0,draggedElementIndex:null,alphabeticalOrder:!0,appCenterLink:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/appCenterUserSetup/`}),watch:{favoriteApplicationsList(){if(this.alphabeticalOrder){const t={};this.favoriteApplicationsList.forEach((e=>{t[`${e.id}`]=this.favoriteApplicationsList.indexOf(e)})),JSON.stringify(this.applicationsOrder)!==JSON.stringify(t)&&(this.alphabeticalOrder=!1)}if(!this.alphabeticalOrder){const t=[];if(this.favoriteApplicationsList.forEach((e=>{this.applicationsOrder[`${e.id}`]!==this.favoriteApplicationsList.indexOf(e)&&(t.push(e),this.applicationsOrder[`${e.id}`]=this.favoriteApplicationsList.indexOf(e))})),t.length){const e=t.map((t=>({id:t.id,order:this.applicationsOrder[`${t.id}`]})));this.updateApplicationsOrder(e)}}}},created(){this.isMobileDevice=this.detectMobile(),this.appCenterUserSetupLink=`${eXo.env.portal.context}/${eXo.env.portal.portalName}/appCenterUserSetup`,this.applicationsLoaded=!1,this.getAppGeneralSettings().then((()=>this.getMandatoryAndFavoriteApplications())).then((()=>this.i18nPromise)).finally((()=>{this.applicationsLoaded=!0,this.$root.$applicationLoaded(),this.$refs.appLauncherDrawer&&this.$refs.appLauncherDrawer.endLoading()}))},mounted(){this.applicationsLoaded||this.$refs.appLauncherDrawer.startLoading(),this.toggleDrawer()},methods:{detectMobile:()=>[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((t=>navigator.userAgent.match(t))),toggleDrawer(){this.$refs.appLauncherDrawer.open()},getMandatoryAndFavoriteApplications(){return fetch("/portal/rest/app-center/applications/favorites",{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error getting favorite applications list")})).then((t=>{t.applications.forEach((e=>{if(e.system){const i=/\s/.test(e.title)?e.title.replace(/ /g,".").toLowerCase():e.title.toLowerCase();this.$t(`appCenter.system.application.${i}`).startsWith("appCenter.system.application")||(t.applications[this.getAppIndex(t.applications,e.id)].title=this.$t(`appCenter.system.application.${i}`))}}));const e=[];this.isMobileDevice?e.push(...t.applications.filter((t=>t.mobile))):e.push(...t.applications),this.mandatoryApplicationsList=e.filter((t=>t.mandatory&&!t.favorite)),this.mandatoryApplicationsList.sort(((t,e)=>t.title<e.title?-1:t.title>e.title?1:0)),this.favoriteApplicationsList=e.filter((t=>t.favorite&&!t.mandatory)),this.favoriteApplicationsList.some((t=>null!==t.order))?this.alphabeticalOrder=!1:this.favoriteApplicationsList.sort(((t,e)=>t.title<e.title?-1:t.title>e.title?1:0)),this.applicationsOrder={},this.favoriteApplicationsList.forEach((t=>{this.applicationsOrder[`${t.id}`]=this.favoriteApplicationsList.indexOf(t)})),this.mandatoryApplicationsList.forEach((t=>{t.computedUrl=t.url.replace(/^\.\//,`${eXo.env.portal.context}/${eXo.env.portal.portalName}/`),t.computedUrl=t.computedUrl.replace("@user@",eXo.env.portal.userName),t.target=0===t.computedUrl.indexOf("/")?"_self":"_blank"})),this.favoriteApplicationsList.forEach((t=>{t.computedUrl=t.url.replace(/^\.\//,`${eXo.env.portal.context}/${eXo.env.portal.portalName}/`),t.computedUrl=t.computedUrl.replace("@user@",eXo.env.portal.userName),t.target=0===t.computedUrl.indexOf("/")?"_self":"_blank"}))})).finally((()=>this.loading=!1))},updateApplicationsOrder:t=>fetch("/portal/rest/app-center/applications/favorites",{headers:{"Content-Type":"application/json"},credentials:"include",method:"PUT",body:JSON.stringify(t)}),logOpenApplication(t){fetch(`/portal/rest/app-center/applications/logClickApplication/${t}`,{method:"GET",credentials:"include"})},navigateTo(t){"appCenterUserSetup/"===t&&fetch("/portal/rest/app-center/applications/logClickAllApplications",{method:"GET",credentials:"include"})},getAppGeneralSettings(){return fetch("/portal/rest/app-center/settings",{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error getting favorite applications list")})).then((t=>{Object.assign(this.defaultAppImage,t&&t.defaultApplicationImage)}))},getAppIndex:(t,e)=>t.findIndex((t=>t.id===e))}};var r=function(t,e,i,a,r,n,o,p){var s,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=[],l._compiled=!0),s)if(l.functional){l._injectStyles=s;var c=l.render;l.render=function(t,e){return s.call(e),c(t,e)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,s):[s]}return{exports:t,options:l}}(a,i);const n={"app-center-launcher-drawer":r.exports};for(const t in n)Vue.component(t,n[t]);const o="appLauncher";function p(){const t=eXo&&eXo.env&&eXo.env.portal&&eXo.env.portal.language||"en",e=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.addon.appcenter-${t}.json`,i=exoi18n.loadLanguageAsync(t,e);Vue.createApp({data:{i18nPromise:i},template:`<app-center-launcher-drawer id="${o}" :i18n-promise="i18nPromise" />`,vuetify:Vue.prototype.vuetifyOptions,i18n:exoi18n.i18n},`#${o}`,"Application Center Drawer")}return e})()));