define((()=>(()=>{"use strict";var t={d:(e,i)=>{for(var a in i)t.o(i,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:i[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{init:()=>v});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"authorizedApplications"},[t.loading?e("div",[e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"table-heading"}})],1):e("div",[e("v-row",{staticClass:"authorizedApplicationsHeader"},[e("v-col",{staticClass:"applicationCenterTitle",attrs:{sm:"8"}},[e("div",{staticClass:"userApplicationTitle"},[t._v("\n          "+t._s(t.$t("appCenter.userSetup.appCenter"))+"\n        ")])]),t._v(" "),e("v-col",{staticClass:"applicationCenterActions"},[e("v-row",[e("v-col",{staticClass:"appSearch"},[e("v-text-field",{attrs:{placeholder:`${t.$t("appCenter.adminSetupList.filter")} ...`,"prepend-inner-icon":"mdi-filter","append-outer-icon":"mdi-close","hide-details":""},on:{"click:append-outer":t.closeSearch},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1)],1)],1)],1)],1),t._v(" "),t.loading?e("div",{staticClass:"userAuthorizedApplications"},t._l(12,(function(t){return e("div",{key:t},[e("v-skeleton-loader",{key:t,staticClass:"authorizedApplication",attrs:{type:"card"}})],1)})),0):e("div",[e("div",{staticClass:"userAuthorizedApplications"},[t.authorizedApplicationsList&&t.authorizedApplicationsList.length?t._e():e("div",{staticClass:"noApp"},[t._v("\n        "+t._s(t.$t("appCenter.adminSetupForm.noApp"))+"\n      ")]),t._v(" "),e("v-row",{attrs:{"no-gutters":""}},t._l(t.authorizedApplicationsList,(function(i){return e("v-col",{key:i.id,attrs:{cols:"12",sm:"6",lg:"4",xl:"3"}},[e("v-card",{staticClass:"authorizedApplication",attrs:{outlined:"",hover:""}},[e("div",{staticClass:"authorisedAppContent"},[e("v-list-item",{staticClass:"applicationHeader"},[e("div",{staticClass:"image"},[e("a",{attrs:{target:i.target,href:i.computedUrl},on:{click:function(e){return t.logOpenApplication(i.id)}}},[i.imageFileId&&i.imageFileName||t.defaultAppImage.fileBody?e("img",{staticClass:"appImage",attrs:{referrerpolicy:"no-referrer",src:`/portal/rest/app-center/applications/illustration/${i.id}?v=${i.imageLastModified}`}}):e("img",{staticClass:"appImage",attrs:{referrerpolicy:"no-referrer",src:"/app-center/skin/images/defaultApp.png"}})])]),t._v(" "),e("v-list-item-content",[e("a",{attrs:{target:i.target,href:i.computedUrl},on:{click:function(e){return t.logOpenApplication(i.id)}}},[e("h5",{staticClass:"tooltipContent"},[e("div",{staticClass:"appTitle",class:i.helpPageURL?"":"noHelpPage",attrs:{title:i.title.length>10?i.title:""}},[t._v("\n                        "+t._s(i.title)+"\n                      ")])])])]),t._v(" "),i.helpPageURL?[e("v-list-item-action",{staticClass:"appHelp"},[e("v-btn",{attrs:{small:"",icon:""},on:{click:function(e){return t.navigateTo(i.helpPageURL)}}},[e("v-icon",{attrs:{"x-small":""}},[t._v("\n                        mdi-help\n                      ")])],1)],1)]:t._e()],2),t._v(" "),e("v-card-text",{staticClass:"userAppDescription"},[e("div",{staticClass:"description",attrs:{title:i.description.length>105?i.description:""}},[t._v("\n                  "+t._s(i.description)+"\n                ")])]),t._v(" "),e("v-divider"),t._v(" "),e("v-card-actions",{staticClass:"applicationActions"},[e("a",{attrs:{target:i.target,href:i.computedUrl},on:{click:function(e){return t.logOpenApplication(i.id)}}},[t._v(t._s(t.$t("appCenter.userSetup.authorized.open")))]),t._v(" "),e("div",{attrs:{title:t.getTooltip(i)}},[i.mandatory?e("v-btn",{staticClass:"mandatory",attrs:{icon:"",disabled:""}},[e("v-icon",{attrs:{small:"",color:"red"}},[t._v("\n                      mdi-star\n                    ")])],1):e("v-btn",{class:i.mandatory||i.favorite?"favorite":"",attrs:{icon:"",disabled:i.mandatory||!i.favorite&&!t.canAddFavorite},on:{click:function(e){return e.stopPropagation(),t.addOrDeleteFavoriteApplication(i)}}},[e("v-icon",{attrs:{small:"",color:"red"}},[t._v("\n                      "+t._s(i.mandatory||i.favorite?"mdi-star":"mdi-star-outline")+"\n                    ")])],1)],1)])],1)])],1)})),1)],1)]),t._v(" "),e("v-row",{staticClass:"loadMoreContainer",attrs:{align:"center"}},[e("v-col",[t.showPaginator&&!t.loading?e("v-btn",{staticClass:"loadMoreApplicationsBtn",attrs:{loading:t.loadingApplications,disabled:t.loadingApplications,block:""},on:{click:t.loadNextPage}},[t._v("\n        "+t._s(t.$t("appCenter.userSetup.authorized.showMore"))+"\n      ")]):t._e()],1)],1)],1)};i._withStripped=!0;const a={name:"UserAuthorizedApplications",props:{canAddFavorite:{type:Boolean,default:!0},defaultAppImage:{type:Object,default:function(){return{}}}},data(){return{loading:!0,systemAppNames:["Agenda","Drives","Forum","News","Notes","Tasks","Wallet","Wiki"],isMobileDevice:!1,authorizedApplicationsList:[],applicationsListSize:null,pageSize:12,offset:0,loadingApplications:!0,searchText:"",searchApp:"",searchDelay:300,maxFavoriteApps:"",authorizedApplicationsListMsg:this.$t("appCenter.userSetup.loading")}},computed:{showPaginator(){return parseInt(this.pageSize)===this.applicationsListSize}},watch:{searchText(){this.searchText&&this.searchText.trim().length?(document.getElementsByClassName("v-input__icon--append-outer")[0].style.display="block",clearTimeout(this.searchApp),this.searchApp=setTimeout((()=>{this.searchAuthorizedApplicationsList()}),this.searchDelay)):this.searchText&&this.searchText.length===this.searchText.split(" ").length-1||(document.getElementsByClassName("v-input__icon--append-outer")[0].style.display="none",this.getAuthorizedApplicationsList(!1,!0))}},created(){this.isMobileDevice=this.detectMobile(),Promise.all([this.getMaxFavoriteApps(),this.getAuthorizedApplicationsList()]).finally((()=>this.$root.$applicationLoaded()))},methods:{closeSearch(){document.getElementsByClassName("v-input__icon--append-outer")[0].style.display="none",this.searchText=""},detectMobile:()=>[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((t=>navigator.userAgent.match(t))),getAuthorizedApplicationsList(t,e){e&&(this.authorizedApplicationsList=[],this.offset=0),this.loadingApplications=!0;let i=this.offset,a=this.pageSize;return t&&(i=0,a=0),fetch(`/portal/rest/app-center/applications/authorized?offset=${i}&limit=${a}&keyword=${this.searchText}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting authorized applications list")})).then((t=>{const e=[];t.applications.forEach((e=>{if(e.system){const i=/\s/.test(e.title)?e.title.replace(/ /g,".").toLowerCase():e.title.toLowerCase();this.$t(`appCenter.system.application.${i}`).startsWith("appCenter.system.application")||(t.applications[this.getAppIndex(t.applications,e.id)].title=this.$t(`appCenter.system.application.${i}`))}})),t&&(this.isMobileDevice?e.push(...t.applications.filter((t=>t.mobile))):e.push(...t.applications)),this.authorizedApplicationsList=this.authorizedApplicationsList.concat(e),this.authorizedApplicationsList.forEach((t=>{t.computedUrl=t.url.replace(/^\.\//,`${eXo.env.portal.context}/${eXo.env.portal.portalName}/`),t.computedUrl=t.computedUrl.replace("@user@",eXo.env.portal.userName),t.target=0===t.computedUrl.indexOf("/")?"_self":"_blank"})),this.applicationsListSize=t.size,this.offset+=t.size})).finally((()=>{this.loadingApplications=!1,this.loading=!1}))},addOrDeleteFavoriteApplication(t){if(!t.favorite)return fetch(`/portal/rest/app-center/applications/favorites/${t.id}`,{credentials:"include",method:t.favorite?"DELETE":"POST"}).then((()=>(t.favorite=!t.favorite,this.$parent.$children[1].getFavoriteApplicationsList())));this.$parent.$children[1].deleteFavoriteApplication(t.id)},loadNextPage(){this.getAuthorizedApplicationsList()},getMaxFavoriteApps(){return fetch("/portal/rest/app-center/settings",{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting the general applications list")})).then((t=>{this.maxFavoriteApps=t.maxFavoriteApps}))},searchAuthorizedApplicationsList(){this.authorizedApplicationsList=[],this.getAuthorizedApplicationsList(!0)},logOpenApplication(t){fetch(`/portal/rest/app-center/applications/logClickApplication/${t}`,{method:"GET",credentials:"include"})},navigateTo(t){window.open(t)},getAppIndex:(t,e)=>t.findIndex((t=>t.id===e)),getTooltip(t){return t.mandatory?this.$t("appCenter.userSetup.mandatory"):t.favorite?this.$t("appCenter.userSetup.remove.from.favorite"):this.$t("appCenter.userSetup.add.to.favorite")}}};function s(t,e,i,a,s,r,o,n){var p,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),a&&(l.functional=!0),r&&(l._scopeId="data-v-"+r),o?(p=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},l._ssrRegister=p):s&&(p=n?function(){s.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:s),p)if(l.functional){l._injectStyles=p;var c=l.render;l.render=function(t,e){return p.call(e),c(t,e)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,p):[p]}return{exports:t,options:l}}const r=s(a,i,[],!1,null,null,null).exports;var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"userFavoriteApplications"},[t.loading?e("div",{staticClass:"favoriteAppsTitle"},[e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"card-heading"}})],1):e("div",[e("div",{staticClass:"favoriteAppsTitle"},[t._v("\n      "+t._s(t.$t("appCenter.userSetup.favorite"))+"\n    ")])]),t._v(" "),t.loading?e("div",t._l(8,(function(t){return e("div",{key:t},[e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"table-heading"}})],1)})),0):e("div",t._l(t.favoriteApplicationsList,(function(i,a){return e("v-card",{key:a,staticClass:"favoriteApplication",attrs:{height:"65","max-width":"auto",outlined:""}},[e("v-list-item",[e("div",{staticClass:"favoriteAppImage"},[e("a",{attrs:{target:i.target,href:i.computedUrl},on:{click:function(e){return t.logOpenApplication(i.id)}}},[i.imageFileId&&i.imageFileName||t.defaultAppImage.fileBody?e("img",{staticClass:"appImage",attrs:{referrerpolicy:"no-referrer",src:`/portal/rest/app-center/applications/illustration/${i.id}?v=${i.imageLastModified}`}}):e("img",{staticClass:"appImage",attrs:{referrerpolicy:"no-referrer",src:"/app-center/skin/images/defaultApp.png"}})])]),t._v(" "),e("v-list-item-content",[e("a",{staticClass:"favoriteAppUrl",attrs:{target:i.target,href:i.computedUrl},on:{click:function(e){return t.logOpenApplication(i.id)}}},[e("div",{staticClass:"favAppTitle",attrs:{title:i.title.length>20?i.title:""}},[t._v("\n              "+t._s(i.title)+"\n            ")])])]),t._v(" "),e("v-list-item-action",{staticClass:"favoriteAppRemove",attrs:{title:i.mandatory?t.$t("appCenter.userSetup.mandatory"):t.$t("appCenter.userSetup.remove.from.favorite")}},[e("v-btn",{class:i.mandatory?"mandatory":"",attrs:{disabled:i.mandatory,icon:""},on:{click:function(e){return e.stopPropagation(),t.deleteFavoriteApplication(i.id)}}},[e("v-icon",[t._v("mdi-star")])],1)],1)],1)],1)})),1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}]},[t.canAddFavorite?e("div",{staticClass:"maxFavorite"},[e("v-icon",{staticClass:"notReached"},[t._v("\n        info\n      ")]),t._v(" "),e("span",[t._v(t._s(t.$t("appCenter.userSetup.maxFavoriteApps.not.reached",{0:t.$parent.$children[0].maxFavoriteApps})))])],1):e("div",{staticClass:"maxFavorite reached"},[e("v-icon",[t._v("\n        mdi-alert\n      ")]),t._v(" "),e("span",[t._v(t._s(t.$t("appCenter.userSetup.maxFavoriteApps.reached")))])],1)])])};o._withStripped=!0;const n={name:"UserFavoriteApplications",props:{defaultAppImage:{type:Object,default:function(){return{}}}},data:()=>({isMobileDevice:!1,favoriteApplicationsList:[],loading:!0,canAddFavorite:!1}),created(){this.isMobileDevice=this.detectMobile(),this.getFavoriteApplicationsList()},methods:{detectMobile:()=>[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((t=>navigator.userAgent.match(t))),getFavoriteApplicationsList(){return fetch("/portal/rest/app-center/applications/favorites",{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting the general applications list")})).then((t=>{t.applications.forEach((e=>{if(e.system){const i=/\s/.test(e.title)?e.title.replace(/ /g,".").toLowerCase():e.title.toLowerCase();this.$t(`appCenter.system.application.${i}`).startsWith("appCenter.system.application")||(t.applications[this.getAppIndex(t.applications,e.id)].title=this.$t(`appCenter.system.application.${i}`))}})),this.canAddFavorite=t.canAddFavorite;const e=[];t&&(this.isMobileDevice?e.push(...t.applications.filter((t=>t.mobile))):e.push(...t.applications));const i=e.filter((t=>t.mandatory&&!t.favorite)),a=e.filter((t=>t.favorite&&!t.mandatory));return i.sort(((t,e)=>t.title<e.title?-1:t.title>e.title?1:0)),a.some((t=>null!==t.order))||a.sort(((t,e)=>t.title<e.title?-1:t.title>e.title?1:0)),this.favoriteApplicationsList=[],this.favoriteApplicationsList.push(...i),this.favoriteApplicationsList.push(...a),this.favoriteApplicationsList.forEach((t=>{t.computedUrl=t.url.replace(/^\.\//,`${eXo.env.portal.context}/${eXo.env.portal.portalName}/`),t.computedUrl=t.computedUrl.replace("@user@",eXo.env.portal.userName),t.target=0===t.computedUrl.indexOf("/")?"_self":"_blank"})),this.$emit("canAddFavorite",this.canAddFavorite),this.favoriteApplicationsList})).finally((()=>this.loading=!1))},logOpenApplication(t){fetch(`/portal/rest/app-center/applications/logClickApplication/${t}`,{method:"GET",credentials:"include"})},deleteFavoriteApplication(t){return fetch(`/portal/rest/app-center/applications/favorites/${t}`,{method:"DELETE",credentials:"include"}).then((()=>this.getFavoriteApplicationsList())).then((()=>{const e=this.$parent.$children[0].authorizedApplicationsList.findIndex((e=>e.id===t));this.$parent.$children[0].authorizedApplicationsList[e].favorite=!1}))},getAppIndex:(t,e)=>t.findIndex((t=>t.id===e))}},p=s(n,o,[],!1,null,null,null).exports;var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"userApplications"},[e("v-row",{attrs:{dense:""}},[e("v-col",{staticClass:"authorizedApplicationsContainer"},[e("user-authorizedApplications",{attrs:{"can-add-favorite":t.canAddFavorite,"default-app-image":t.defaultAppImage}})],1),t._v(" "),e("v-col",{staticClass:"userFavoriteApplicationsContainer",attrs:{sm:"3"}},[e("user-favoriteApplications",{attrs:{"default-app-image":t.defaultAppImage},on:{canAddFavorite:t.setCanAddFavorite}})],1)],1)],1)};l._withStripped=!0;const c={"user-authorizedApplications":r,"user-favoriteApplications":p,"app-center-user-setup":s({props:{preferences:{type:Object,default:null}},data:()=>({defaultAppImage:{fileBody:"",fileName:"",invalidSize:!1,invalidImage:!1},canAddFavorite:!1}),created(){this.getAppGeneralSettings(),this.pageSize=this.preferences.pageSize},methods:{setCanAddFavorite(t){this.canAddFavorite=t},getAppGeneralSettings(){return fetch("/portal/rest/app-center/settings",{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error getting favorite applications list")})).then((t=>(Object.assign(this.defaultAppImage,t&&t.defaultApplicationImage),this.$nextTick())))}}},l,[],!1,null,null,null).exports};for(const t in c)Vue.component(t,c[t]);const d=eXo&&eXo.env&&eXo.env.portal&&eXo.env.portal.language||"en",h=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.addon.appcenter-${d}.json`,u="userSetup";function v(t){exoi18n.loadLanguageAsync(d,h).then((e=>{const i=document.createElement("div");i.id=u,Vue.createApp({data:{preferences:t},template:`<app-center-user-setup\n                   id="${u}"\n                   :preferences="preferences"\n                   v-cacheable />`,i18n:e},i,"User Settings Application Center")}))}return e})()));