define((()=>(()=>{"use strict";var t={d:(e,a)=>{for(var i in a)t.o(a,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:a[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e);var a={};t.r(a),t.d(a,{exportFile:()=>j,getAllDomains:()=>B,getAllRealizations:()=>F,updateRealization:()=>N});var i={};t.r(i),t.d(i,{canAddProgram:()=>X,deleteProgram:()=>G,getProgramById:()=>K,retrievePrograms:()=>V,saveProgram:()=>U,updateProgram:()=>H});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{staticClass:"Realizations border-box-sizing"},[a("div",{staticClass:"d-flex px-7 pt-5",attrs:{flat:""}},[t.isMobile?t._e():a("v-toolbar-title",{staticClass:"d-flex"},[a("v-btn",{staticClass:"btn btn-primary export",on:{click:function(e){return t.exportFile()}}},[a("span",{staticClass:"ms-2 d-none d-lg-inline"},[t._v("\n          "+t._s(t.$t("realization.label.export"))+"\n        ")])])],1),t._v(" "),t.isMobile?t._e():a("v-spacer"),t._v(" "),a("div",{staticClass:"mt-1 ml-n4 pe-3"},[a("select-period",{staticClass:"mx-2",attrs:{left:!t.isMobile},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}})],1),t._v(" "),t.isMobile?a("v-spacer"):t._e(),t._v(" "),a("div",[a("v-btn",{staticClass:"btn px-2 mt-1 btn-primary filterTasksSetting",attrs:{outlined:""},on:{click:t.openRealizationsFilterDrawer}},[a("i",{staticClass:"uiIcon uiIcon24x24 settingsIcon primary--text mr-1"}),t._v(" "),a("span",{staticClass:"d-none font-weight-regular caption d-sm-inline"},[t._v("\n          "+t._s(t.$t("profile.label.search.openSearch"))+"\n        ")])])],1)],1),t._v(" "),t.displaySearchResult?t._e():a("engagement-center-no-results",{attrs:{info:t.$t("exoplatform.gamification.gamificationinformation.domain.search.noResults"),"info-message":t.$t("exoplatform.gamification.gamificationinformation.domain.search.noResultsMessage")}}),t._v(" "),t.displaySearchResult&&!t.isMobile?a("v-data-table",{staticClass:"mx-6 mt-6 realizationsTable",attrs:{headers:t.realizationsHeaders,items:t.realizationsToDisplay,loading:t.loading,"sort-by":t.sortBy,"sort-desc":t.sortDescending,"disable-pagination":"","hide-default-footer":"","must-sort":""},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDescending=e},"update:sort-desc":function(e){t.sortDescending=e}},scopedSlots:t._u([{key:"item",fn:function(e){return[a("realization-item",{attrs:{realization:e.item,"date-format":t.dateFormat,"is-administrator":t.isAdministrator,"action-value-extensions":t.actionValueExtensions},on:{updated:t.realizationUpdated}})]}}],null,!1,353682167)}):t._e(),t._v(" "),t.displaySearchResult&&t.isMobile?a("v-card",{staticClass:"ms-3 me-7 mb-4",attrs:{flat:"",width:"auto"}},[a("v-select",{ref:"select",staticClass:"pt-0",attrs:{items:t.availableSortBy,label:t.$t("realization.label.sortBy")},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1):t._e(),t._v(" "),t._l(t.realizationsToDisplay,(function(e){return[t.displaySearchResult&&t.isMobile?a("realization-item-mobile",{key:e.id,attrs:{headers:t.realizationsHeaders,realization:e,"is-administrator":t.isAdministrator,"date-format":t.mobileDateFormat,"action-value-extensions":t.actionValueExtensions}}):t._e()]})),t._v(" "),a("v-toolbar",{staticClass:"pa-2 mb-4",attrs:{color:"transparent",flat:""}},[t.hasMore?a("v-btn",{staticClass:"btn",attrs:{loading:t.loading,disabled:t.loading,block:""},on:{click:t.loadMore}},[a("span",{staticClass:"ms-2 d-inline"},[t._v("\n        "+t._s(t.$t("realization.label.loadMore"))+"\n      ")])]):t._e()],1),t._v(" "),a("edit-realization-drawer",{ref:"editRealizationDrawer",on:{updated:t.realizationUpdated}}),t._v(" "),a("filter-realizations-drawer",{attrs:{"is-administrator":t.isAdministrator},on:{selectionConfirmed:t.filterByPrograms}})],2)};function n(t,e,a,i,s,n,r,o){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=a,c._compiled=!0),i&&(c.functional=!0),n&&(c._scopeId="data-v-"+n),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=l):s&&(l=o?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}s._withStripped=!0;var r=n({props:{earnerId:{type:Number,default:()=>0},isAdministrator:{type:Boolean,default:!1},actionValueExtensions:{type:Object,default:function(){return null}}},data:()=>({displaySearchResult:!1,realizations:[],availableSortBy:[],searchList:[],earnerIds:[],offset:0,limit:25,pageSize:25,totalSize:0,loading:!0,sortBy:"date",sortDescending:!0,limitReached:!1,toDate:(new Date).toISOString(),fromDate:null,selectedPeriod:null,dateFormat:{year:"numeric",month:"short",day:"numeric"},mobileDateFormat:{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"},isMobile:!1,selected:"Date"}),beforeDestroy(){"undefined"!=typeof window&&window.removeEventListener("resize",this.onResize,{passive:!0})},mounted(){this.onResize(),window.addEventListener("resize",this.onResize,{passive:!0})},created(){this.realizationsHeaders.map((t=>{t.sortable&&"type"!==t.value&&this.availableSortBy.push(t)})),$(document).mousedown((()=>{this.$refs.select&&window.setTimeout((()=>{this.$refs.select.blur()}),200)}))},computed:{hasMore(){return this.limit<this.totalSize},earnerIdToRetrieve(){return this.isAdministrator?this.earnerIds:[this.earnerId]},realizationsToDisplay(){return this.realizations.slice(0,this.limit)},realizationsHeaders(){const t=[{text:this.$t("realization.label.actionLabel"),sortable:!1,value:"actionLabel",class:"actionHeader",width:"188"},{text:this.$t("realization.label.programLabel"),sortable:!1,value:"programLabel",class:"actionHeader",width:"110"},{text:this.$t("realization.label.date"),sortable:!0,value:"date",class:"actionHeader",width:"120"},{text:this.$t("realization.label.actionType"),sortable:!0,align:"center",value:"type",class:"actionHeader",width:"85"},{text:this.$t("realization.label.points"),sortable:!1,align:"center",value:"points",class:"actionHeader",width:"80"},{text:this.$t("realization.label.status"),sortable:!0,align:"center",value:"status",class:"actionHeader",width:"95"}];return this.isAdministrator&&(t.push({text:this.$t("realization.label.actions"),sortable:!1,class:"actionHeader",width:"80"}),t.splice(3,0,{text:this.$t("realization.label.grantee"),sortable:!1,align:"center",value:"grantee",class:"actionHeader",width:"70"})),t}},watch:{selectedPeriod(t){t&&(this.fromDate=new Date(t.min).toISOString(),this.toDate=new Date(t.max).toISOString(),this.loadRealizations())},sortBy(t,e){t!==e&&(this.sortDescending&&(this.sortDescending=!1),this.sortUpdated())},sortDescending(t,e){t!==e&&this.sortUpdated()},selected(t,e){e!==t&&(this.sortBy=e)},isMobile(t){t?(this.limit=9,this.pageSize=9):(this.limit=25,this.pageSize=25)}},methods:{sortUpdated(){this.loading||(this.loading=!0,this.loadRealizations())},loadMore(){return this.limit+=this.pageSize,this.loadRealizations()},loadRealizations(){return this.loading=!0,this.getRealizations().finally((()=>{this.loading=!1,this.$root.$applicationLoaded()}))},getRealizations(){return this.$realizationsServices.getAllRealizations(this.fromDate,this.toDate,this.earnerIdToRetrieve,this.sortBy,this.sortDescending,this.offset,this.limit+1,this.searchList).then((t=>{this.realizations=t?.realizations||[],this.totalSize=t?.size||this.totalSize,this.displaySearchResult=this.searchList?.length>=0&&this.realizations.length>0}))},exportFile(){return this.$realizationsServices.exportFile(this.fromDate,this.toDate,this.earnerIdToRetrieve)},realizationUpdated(t){const e=this.realizations&&this.realizations.findIndex((e=>e.id===t.id));this.realizations[e]=t,this.$set(this.realizations,e,t)},openRealizationsFilterDrawer(){this.$root.$emit("realization-open-filter-drawer")},filterByPrograms(t,e){this.searchList=t.map((t=>t.id)),this.earnerIds=e.map((t=>t.identity.identityId)),this.loadRealizations()},onResize(){this.isMobile=window.innerWidth<1020}}},s,[],!1,null,null,null);r.options.__file="src/main/webapp/vue-app/realizations/components/Realizations.vue";const o=r.exports;var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{attrs:{id:"GamificationRealizationItem"+t.realization.id}},[a("td",[a("div",{staticClass:"d-flex"},[t.isAutomaticType?a("div",{staticClass:"width-fit-content"},[t.actionValueExtension?a("rule-action-value",{attrs:{"action-label":t.actionLabel,"action-u-r-l":t.actionURL,"action-icon":t.actionIcon}}):a("a",{staticClass:"text-color",class:t.actionLabelClass,attrs:{href:t.realization.url}},[a("span",{staticClass:"actionDescription"},[t._v("\n            "+t._s(t.actionLabel)+"\n          ")])])],1):a("challenge-action-value",{staticClass:"width-fit-content",attrs:{"action-label":t.actionLabel,"action-u-r-l":t.actionURL}}),t._v(" "),t.ruleTitleChanged?a("v-tooltip",{attrs:{"z-index":"4","max-width":"300",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-icon",t._g(t._b({staticClass:"primary--text ms-1",attrs:{size:"14"}},"v-icon",s,!1),i),[t._v("\n            fas fa-info-circle\n          ")])]}}],null,!1,1268372933)},[t._v(" "),a("span",[t._v(t._s(t.$t("realization.label.previouslyNamed"))+": "+t._s(t.realizationActionLabel))])]):t._e()],1)]),t._v(" "),a("td",[a("div",{staticClass:"d-flex"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("a",t._g({staticClass:"width-fit-content",on:{click:t.openProgramDetail}},i),[a("div",{staticClass:"text-truncate"},[t._v(t._s(t.programTitle)+"\n            ")])])]}}])},[t._v(" "),a("span",{domProps:{innerHTML:t._s(t.programTitle)}})]),t._v(" "),t.programLabelChanged?a("v-tooltip",{attrs:{"z-index":"4","max-width":"300",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-icon",t._g(t._b({staticClass:"primary--text ms-1",attrs:{size:"14"}},"v-icon",s,!1),i),[t._v("\n            fas fa-info-circle\n          ")])]}}],null,!1,1268372933)},[t._v(" "),a("span",[t._v(t._s(t.$t("realization.label.previouslyNamed"))+": "+t._s(t.programLabel))])]):t._e()],1)]),t._v(" "),a("td",{staticClass:"wrap"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("div",t._g(t._b({},"div",s,!1),i),[a("date-format",{attrs:{format:t.dateFormat,value:t.realization.createdDate}})],1)]}}])},[t._v(" "),a("span",[a("date-format",{attrs:{format:t.tooltipDateFormat,value:t.realization.createdDate}})],1)])],1),t._v(" "),t.isAdministrator?a("td",{staticClass:"text-truncate align-center"},[a("exo-user-avatar",{attrs:{identity:t.earner,size:28,"extra-class":"d-inline-block","link-style":"",popover:"",avatar:""}})],1):t._e(),t._v(" "),a("td",{staticClass:"text-truncate align-center"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-icon",t._g(t._b({staticClass:"me-1",class:t.statusIconClass,attrs:{size:"16"}},"v-icon",s,!1),i),[t._v("\n          "+t._s(t.actionTypeIcon)+"\n        ")])]}}])},[t._v(" "),a("span",[t._v(t._s(t.isAutomaticTypeLabel))])])],1),t._v(" "),a("td",{staticClass:"text-truncate align-center"},[t._v("\n    "+t._s(t.score)+"\n  ")]),t._v(" "),a("td",{staticClass:"text-truncate align-center"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-icon",t._g(t._b({staticClass:"me-1",class:t.statusIconClass,attrs:{size:"16"}},"v-icon",s,!1),i),[t._v("\n          "+t._s(t.statusIcon)+"\n        ")])]}}])},[t._v(" "),a("span",[t._v(t._s(t.isAcceptedLabel))])])],1),t._v(" "),t.isAdministrator?a("td",{staticClass:"text-truncate actions align-center"},[t.hasActions?a("v-menu",{attrs:{left:!t.$vuetify.rtl,right:t.$vuetify.rtl,bottom:"","offset-y":"",attach:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"me-2",attrs:{icon:"",small:""}},"v-btn",s,!1),i),[a("v-icon",{staticClass:"icon-default-color",attrs:{size:"16"}},[t._v("fas fa-ellipsis-v")])],1)]}}],null,!1,4003305141),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[t._v(" "),a("v-list",{staticClass:"pa-0",attrs:{dense:""}},[[t.canEdit?a("v-list-item",{attrs:{dense:""},on:{click:t.editRealization}},[a("v-icon",{staticClass:"dark-grey-color",attrs:{size:"13"}},[t._v("fas fa-edit")]),t._v(" "),a("v-list-item-title",{staticClass:"text-justify ps-3"},[t._v("\n              "+t._s(t.$t("realization.label.edit"))+"\n            ")])],1):t._e(),t._v(" "),t.canAccept?a("v-list-item",{attrs:{dense:""},on:{click:function(e){return t.updateRealizations("ACCEPTED")}}},[a("v-icon",{staticClass:"dark-grey-color",attrs:{size:"13"}},[t._v("fas fa-check")]),t._v(" "),a("v-list-item-title",{staticClass:"text-justify ps-3"},[t._v("\n              "+t._s(t.$t("realization.label.accept"))+"\n            ")])],1):t._e(),t._v(" "),t.canReject?a("v-list-item",{attrs:{dense:""},on:{click:function(e){return t.updateRealizations("REJECTED")}}},[a("v-icon",{staticClass:"dark-grey-color",attrs:{size:"13"}},[t._v("fas fa-ban")]),t._v(" "),a("v-list-item-title",{staticClass:"text-justify ps-3"},[t._v("\n              "+t._s(t.$t("realization.label.reject"))+"\n            ")])],1):t._e()]],2)],1):t._e()],1):t._e()])};l._withStripped=!0;var c=n({props:{realization:{type:Object,default:null},dateFormat:{type:Object,default:null},isAdministrator:{type:Boolean,default:!1},actionValueExtensions:{type:Object,default:function(){return null}}},data:()=>({menu:!1,tooltipDateFormat:{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}}),computed:{earner(){return this.realization?.earner?.profile},actionURL(){return this.realization?.url},isAutomaticType(){return"AUTOMATIC"===this.realization?.action?.type},actionLabel(){if(this.isAutomaticType){const t=`exoplatform.gamification.gamificationinformation.rule.title.${this.realization.action.title}`;if(this.$te(t))return this.$t(t)}return this.realization.action.title},eventName(){return this.realization?.action?.event},program(){return this.realization?.domain},programTitle(){return this.program?.title||"-"},score(){return this.realization?.score||"-"},status(){return this.realization.status},statusIcon(){return"ACCEPTED"===this.status?"fas fa-check-circle":"fas fa-times-circle"},statusIconClass(){return"ACCEPTED"===this.status?"primary--text":"secondary--text"},actionTypeIcon(){return this.isAutomaticType?"fas fa-cogs":"fas fa-hand-pointer"},actionLabelClass(){return this.realization.url?"":"defaultCursor"},canReject(){return"ACCEPTED"===this.status||"EDITED"===this.status},canAccept(){return"REJECTED"===this.status},isAccepted(){return"ACCEPTED"===this.status},canEdit(){return this.realization.action&&"MANUAL"===this.realization.action.type},hasActions(){return this.canReject||this.canAccept||this.canEdit},actionIcon(){return this.actionValueExtension?.icon},extendedActionValueComponent(){return this.actionValueExtension&&{componentName:"action-value",componentOptions:{vueComponent:this.actionValueExtension.vueComponent}}||null},actionValueExtension(){return this.actionValueExtensions&&Object.values(this.actionValueExtensions).sort(((t,e)=>(t.rank||0)-(e.rank||0))).find((t=>t.match&&t.match(this.eventName)))||null},isAutomaticTypeLabel(){return this.isAutomaticType?this.$t("gamification.label.automatic"):this.$t("realization.label.manual")},isAcceptedLabel(){return this.isAccepted?this.$t("realization.label.accepted"):this.$t("realization.label.rejected")},realizationActionLabel(){return this.realization?.actionLabel},ruleTitleChanged(){return this.isAutomaticType?this.realizationActionLabel!==this.eventName&&this.realizationActionLabel!==this.actionLabel:this.realizationActionLabel!==this.actionLabel},programLabel(){return this.realization?.domainLabel},programLabelChanged(){return this.programLabel!==this.programTitle}},created(){$(document).mousedown((()=>{this.menu&&window.setTimeout((()=>{this.menu=!1}),200)}))},methods:{updateRealizations(t){this.$realizationsServices.updateRealization(this.realization.id,t).then((t=>this.$emit("updated",t)))},editRealization(){this.$root.$emit("realization-open-edit-drawer",this.realization,this.actionLabel)},openProgramDetail(){this.$programsServices.getProgramById(this.program.id).then((t=>{t&&t.id&&(this.$root.$emit("open-program-detail",t),window.history.replaceState("programs",this.$t("engagementCenter.label.programs"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs/${this.program.id}`))}))}}},l,[],!1,null,null,null);c.options.__file="src/main/webapp/vue-app/realizations/components/RealizationItem.vue";const d=c.exports;var u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-item",{staticClass:"d-block"},[a("v-list-content",[a("v-row",[a("v-col",{staticClass:"col-sm-4 col-4"},[a("span",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.headers[2].text))])]),t._v(" "),a("v-col",{staticClass:"col-sm-8 col-8"},[a("date-format",{attrs:{format:t.dateFormat,value:t.realization.createdDate}})],1)],1),t._v(" "),t.isAdministrator?a("v-row",{staticClass:"text-truncate align-center"},[a("v-col",{staticClass:"col-sm-4 col-4"},[a("span",{staticClass:"font-weight-bold d-flex"},[t._v(" "+t._s(t.headers[3].text))])]),t._v(" "),a("v-col",{staticClass:"col-sm-8 col-8"},[a("exo-user-avatar",{attrs:{identity:t.earner,size:28,"link-style":"",popover:""}})],1)],1):t._e(),t._v(" "),a("v-row",[a("v-col",{staticClass:"col-sm-4 col-4"},[a("span",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.headers[1].text))])]),t._v(" "),a("v-col",{staticClass:"col-sm-8 col-8"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("a",t._g({on:{click:t.openProgramDetail}},i),[a("div",{staticClass:"text-truncate"},[t._v(t._s(t.programTitle)+"\n              ")])])]}}])},[t._v(" "),a("span",{domProps:{innerHTML:t._s(t.programTitle)}})])],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"col-sm-4 col-4"},[a("span",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.headers[0].text))])]),t._v(" "),a("v-col",{staticClass:"col-sm-8 col-8"},[t.isAutomaticType?a("div",[t.actionValueExtension?a("rule-action-value",{attrs:{"action-label":t.actionLabel,"action-u-r-l":t.actionURL,"action-icon":t.actionIcon}}):a("a",{staticClass:"text-color",class:t.actionLabelClass,attrs:{href:t.realization.url}},[a("span",{staticClass:"actionDescription"},[t._v("\n              "+t._s(t.actionLabel)+"\n            ")])])],1):a("challenge-action-value",{attrs:{"action-label":t.actionLabel,"action-u-r-l":t.actionURL}})],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"col-sm-4 col-4"},[a("span",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t.isAdministrator?t.headers[6].text:t.headers[5].text))])]),t._v(" "),a("v-col",{staticClass:"col-sm-8 col-8"},[a("v-icon",{staticClass:"me-1",class:t.statusIconClass,attrs:{size:"16"}},[t._v("\n          "+t._s(t.statusIcon)+"\n        ")])],1)],1),t._v(" "),a("v-divider",{staticClass:"my-2"})],1)],1)};u._withStripped=!0;var m=n({props:{headers:{type:Object,default:null},realization:{type:Object,default:null},dateFormat:{type:Object,default:null},isAdministrator:{type:Boolean,default:!1},actionValueExtensions:{type:Object,default:function(){return null}}},data:()=>({menu:!1}),computed:{earner(){return this.realization?.earner?.profile},actionURL(){return this.realization?.url},isAutomaticType(){return"AUTOMATIC"===this.realization?.action?.type},actionLabel(){if(this.isAutomaticType){const t=`exoplatform.gamification.gamificationinformation.rule.description.${this.realization.actionLabel}`;if(this.$te(t))return this.$t(t)}return this.realization.actionLabel},program(){return this.realization?.domain},programTitle(){return this.program?.title||"-"},score(){return this.realization?.score||"-"},status(){return this.realization.status},statusIcon(){return"ACCEPTED"===this.status?"fas fa-check-circle":"fas fa-times-circle"},statusIconClass(){return"ACCEPTED"===this.status?"primary--text":"secondary--text"},actionTypeIcon(){return this.isAutomaticType?"fas fa-cogs":"fas fa-hand-pointer"},actionLabelClass(){return this.realization.url?"":"defaultCursor"},eventName(){return this.realization?.action?.event},actionValueExtension(){return this.actionValueExtensions&&Object.values(this.actionValueExtensions).sort(((t,e)=>(t.rank||0)-(e.rank||0))).find((t=>t.match&&t.match(this.eventName)))||null},actionIcon(){return this.actionValueExtension?.icon}},methods:{openProgramDetail(){this.$root.$emit("open-program-detail",this.program),window.history.replaceState("programs",this.$t("engagementCenter.label.programs"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs/${this.program.id}`)}}},u,[],!1,null,null,null);m.options.__file="src/main/webapp/vue-app/realizations/components/RealizationItemMobile.vue";const p=m.exports;var h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{staticClass:"selected-period-menu",attrs:{"content-class":t.menuId+" white selected-period-menu-content","close-on-content-click":!1,transition:"scale-transition",left:t.left,right:t.right,"offset-y":"",attach:"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,s=e.attrs;return[a("v-text-field",t._g(t._b({staticClass:"selected-period-input pt-0 mt-0",attrs:{value:t.rangeDate,title:t.rangeDateTimeTitle,"prepend-inner-icon":"mdi-calendar",rel:"tooltip",readonly:""}},"v-text-field",s,!1),i))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[t._v(" "),a("div",{staticClass:"d-flex flex-column"},[a("v-date-picker",{staticClass:"DatePicker pb-2",attrs:{locale:t.lang,max:t.maxDate,width:"100%","show-current":"","show-week":"","first-day-of-week":"1",range:"",scrollable:""},on:{input:t.selectCustomDates},model:{value:t.dates,callback:function(e){t.dates=e},expression:"dates"}}),t._v(" "),a("v-divider"),t._v(" "),a("v-btn-toggle",{staticClass:"d-flex flex-wrap justify-space-between period-selection",attrs:{tile:"",color:"primary","background-color":"primary",group:""},model:{value:t.selectedPeriodName,callback:function(e){t.selectedPeriodName=e},expression:"selectedPeriodName"}},t._l(t.periodOptions,(function(e,i){return a("v-btn",{key:i,staticClass:"ma-0",attrs:{value:e.value,small:""},on:{click:function(a){return t.selectPeriodItem(e.value)}}},[a("div",[t._v(t._s(e.text))])])})),1),t._v(" "),a("v-divider"),t._v(" "),a("div",{staticClass:"date-time-selection caption mx-auto pa-2 text-center muted "},[a("span",{staticClass:"text-capitalize"},[t._v(t._s(t.$t("realization.label.from")))]),t._v(" "),a("span",{staticClass:"primary--text"},[t._v(t._s(t.fromDateTitle))]),t._v(" "),a("span",{staticClass:"text-capitalize"},[t._v(t._s(t.$t("realization.label.to")))]),t._v(" "),a("span",{staticClass:"primary--text"},[t._v(t._s(t.toDateTitle))])])],1)])};h._withStripped=!0;var g=n({props:{value:{type:String,default:function(){return null}},right:{type:Boolean,default:!1},left:{type:Boolean,default:!1}},data:()=>({menu:!1,lang:eXo.env.portal.language,dates:[],fromTime:"00:00",toTime:"23:59",selectedPeriodName:"thisMonth",menuId:`DatePickerMenu${parseInt(1e4*Math.random()).toString()}`,shortDateFormat:{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},dateFormat:{year:"numeric",month:"short",day:"numeric"}}),computed:{periodOptions(){return[{value:"thisYear",text:this.$t("realization.label.thisYear")},{value:"thisSemester",text:this.$t("realization.label.thisSemester")},{value:"thisQuarter",text:this.$t("realization.label.thisQuarter")},{value:"thisMonth",text:this.$t("realization.label.thisMonth")},{value:"thisWeek",text:this.$t("realization.label.thisWeek")},{value:"today",text:this.$t("realization.label.today")}]},fromDate(){return this.value&&new Date(this.value.min)},toDate(){return this.value&&new Date(this.value.max)},maxDate:()=>(new Date).toLocaleDateString("sv-SV"),maxDateTime(){const t=new Date;return t.setHours(23),t.setMinutes(59),t},fromDateTitle(){return this.fromDate&&this.fromDate.toLocaleString(this.lang,this.dateFormat)},toDateTitle(){return this.toDate&&this.toDate.toLocaleString(this.lang,this.dateFormat)},rangeDateTimeTitle(){return this.$t("realization.label.period",{0:this.fromFullDateFormat,1:this.toFullDateFormat})},rangeDate(){return this.fromDate&&this.toDate?`${this.fromDate.toLocaleString(this.lang,this.dateFormat)}~${this.toDate.toLocaleString(this.lang,this.dateFormat)}`:""},fromFullDateFormat(){return this.fromDate&&this.fromDate.toLocaleString(this.lang,this.shortDateFormat)},toFullDateFormat(){return this.toDate&&this.toDate.toLocaleString(this.lang,this.shortDateFormat)}},watch:{menu(t,e){t&&!e&&t!==e&&this.value&&(this.dates=[this.fromDate.toLocaleDateString("sv-SV"),this.toDate.toLocaleDateString("sv-SV")])}},mounted(){$(document).on("click",(t=>{t.target&&!$(t.target).parents(`.${this.menuId}`).length&&this.close()})),this.selectPeriodItem(this.selectedPeriodName)},methods:{selectDates(){const t={};if(this.selectedPeriodName){t.period=this.selectedPeriodName;const e=new Date;switch(this.selectedPeriodName){case"today":{const t=e.toISOString().slice(0,10);this.dates=[t,t];break}case"thisWeek":{const t=e.getDay(),a=e.getDate()-t+(0===t?-6:1),i=new Date((new Date).setDate(a));let s=new Date(new Date(i).setDate(i.getDate()+6));s>this.maxDateTime&&(s=this.maxDateTime),this.dates=[i.toISOString().slice(0,10),s.toISOString().slice(0,10)];break}case"thisMonth":{const t=new Date((new Date).setDate(1));let a=new Date(new Date((new Date).setMonth(e.getMonth()+1)).setDate(0));a>this.maxDateTime&&(a=this.maxDateTime),this.dates=[t.toISOString().slice(0,10),a.toISOString().slice(0,10)];break}case"thisQuarter":{const t=e.getMonth()-(e.getMonth()-1)%3-1,a=new Date(new Date((new Date).setMonth(t)).setDate(1));let i=new Date(new Date(new Date(a).setMonth(t+3)).setDate(0));i>this.maxDateTime&&(i=this.maxDateTime),this.dates=[a.toISOString().slice(0,10),i.toISOString().slice(0,10)];break}case"thisSemester":{const t=e.getMonth()-(e.getMonth()-1)%6-1,a=new Date(new Date((new Date).setMonth(t)).setDate(1));let i=new Date(new Date(new Date(a).setMonth(t+6)).setDate(0));i>this.maxDateTime&&(i=this.maxDateTime),this.dates=[a.toISOString().slice(0,10),i.toISOString().slice(0,10)];break}case"thisYear":this.dates=[`${e.getYear()+1900}-01-01`,this.maxDate]}}if(this.dates&&2===this.dates.length){if(new Date(this.dates[0])>new Date(this.dates[1])){const t=this.dates[0];this.dates[0]=this.dates[1],this.dates[1]=t}return t.min=new Date(`${this.dates[0]}T${this.fromTime}`).getTime(),t.max=new Date(`${this.dates[1]}T${this.toTime}`).getTime(),this.$emit("input",t),!0}return!1},selectCustomDates(){this.selectedPeriodName=null,this.selectDates()},selectPeriodItem(t){this.selectedPeriodName=t,this.selectDates()&&this.close()},close(){this.$nextTick().then((()=>{this.menu=!1}))}}},h,[],!1,null,null,null);g.options.__file="src/main/webapp/vue-app/realizations/components/SelectPeriod.vue";const v=g.exports;var f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-flex",{staticClass:"searchNoResults justify-center d-flex border-box-sizing emptyChallenges"},[a("div",{staticClass:"d-flex flex-column"},[a("img",{staticClass:"mx-auto mb-2",attrs:{src:"/gamification-portlets/skin/images/challenge_not_found_filter_image.png",alt:t.$t("challenges.search.noResults"),width:"230px",loading:"lazy"}}),t._v(" "),a("div",{staticClass:"d-flex flex-column text-center text-sub-title"},[t.info?a("span",{staticClass:"text-header-title text-light-color"},[t._v(t._s(t.info))]):t._e(),t._v(" "),t.infoMessage?a("span",{staticClass:"text-sub-title subtitle-1 text-light-color"},[t._v(t._s(t.infoMessage))]):t._e()])])])};f._withStripped=!0;var b=n({props:{info:{type:String,default:""},infoMessage:{type:String,default:""}}},f,[],!1,null,null,null);b.options.__file="src/main/webapp/vue-app/engagement-center/components/common/NoResultFound.vue";const _=b.exports;var y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-flex",{attrs:{id:t.id}},[a("v-autocomplete",{ref:"selectAutoComplete",staticClass:"identitySuggester identitySuggesterInputStyle",attrs:{label:t.labels.label,placeholder:t.labels.placeholder,items:t.domains,loading:t.loadingSuggestions,multiple:t.multiple,"hide-no-data":"","append-icon":"","menu-props":"closeOnClick, closeOnContentClick, maxHeight = 100","content-class":"identitySuggesterContent",width:"100%","max-width":"100%","item-text":"title","item-value":"id","return-object":"","persistent-hint":"","hide-selected":"",chips:"","cache-items":"",dense:"",flat:"",required:"",attach:""},on:{"update:search-input":function(e){t.searchTerm=e}},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.item,s=e.selected;return[a("v-chip",{staticClass:"identitySuggesterItem",attrs:{"input-value":s,close:!0},on:{"click:close":function(e){t.program=null}}},[a("span",{staticClass:"text-truncate"},[t._v("\n          "+t._s(i.title)+"\n        ")])])]}},{key:"item",fn:function(e){return[a("v-list-item-title",{staticClass:"text-truncate identitySuggestionMenuItemText",domProps:{textContent:t._s(e.item.title)}})]}}]),model:{value:t.program,callback:function(e){t.program=e},expression:"program"}},[a("template",{slot:"no-data"},[a("v-list-item",{staticClass:"pa-0"},[a("v-list-item-title",{staticClass:"px-2"},[t._v("\n          "+t._s(t.labels.searchPlaceholder)+"\n        ")])],1)],1)],2)],1)};y._withStripped=!0;var x=n({props:{multiple:{type:Boolean,default:function(){return!1}},onlyOwned:{type:Boolean,default:!1},value:{type:Object,default:null},labels:{type:Object,default:()=>({label:"",placeholder:"",searchPlaceholder:"",noDataLabel:""})},includeDeleted:{type:Boolean,default:function(){return!1}},includeDisabled:{type:Boolean,default:function(){return!1}}},data:()=>({id:`AutoComplete${parseInt(1e4*Math.random())}`,domains:[],program:null,searchTerm:null,loadingSuggestions:!1,broadcast:!0,startSearchAfterInMilliseconds:300,endTypingKeywordTimeout:50,startTypingKeywordTimeout:0,typing:!1}),watch:{searchTerm(){this.startTypingKeywordTimeout=Date.now()+this.startSearchAfterInMilliseconds,this.typing||(this.typing=!0,this.waitForEndTyping())},program(){this.program!==this.value&&this.$emit("input",this.program)},value(){!this.domains.length&&this.value&&this.domains.push(this.value)},includeDeleted(){this.$refs.selectAutoComplete.cachedItems=[]}},created(){this.program=this.value,this.program&&(this.domains=[this.program])},mounted(){$(`#${this.id} input`).on("blur",(()=>{this.$refs.selectAutoComplete.isFocused=!1}))},methods:{remove(t){this.value=null,this.$emit("removeProgram",t.title)},waitForEndTyping(){window.setTimeout((()=>{Date.now()>this.startTypingKeywordTimeout?(this.typing=!1,this.searchPrograms()):this.waitForEndTyping()}),this.endTypingKeywordTimeout)},focus(){this.$refs.selectAutoComplete.focus()},searchPrograms(){this.searchTerm&&this.searchTerm.length?(this.focus(),this.previousSearchTerm&&this.previousSearchTerm===this.searchTerm||(this.loadingSuggestions=0,this.domains=[],this.$programsServices.retrievePrograms(0,10,"ALL",this.includeDisabled?"ALL":"ENABLED",this.searchTerm,this.includeDeleted).then((t=>{this.onlyOwned?this.domains=t?.domains.filter((t=>t?.owners.find((t=>t.id===eXo.env.portal.userIdentityId)))):this.domains=t.domains}))),this.previousSearchTerm=this.searchTerm):this.domains=[]}}},y,[],!1,null,null,null);x.options.__file="src/main/webapp/vue-app/engagement-center/components/common/ProgramSuggester.vue";const z=x.exports;var C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("exo-drawer",{ref:"editRealizationDrawer",staticClass:"editRealizationDrawer",attrs:{right:!t.$vuetify.rtl,eager:""},on:{closed:t.close}},[a("template",{slot:"title"},[a("span",{staticClass:"pb-2"},[t._v(" "+t._s(t.$t("realization.label.editRealization"))+" ")])]),t._v(" "),a("template",{slot:"content"},[a("v-card-text",[a("div",{staticClass:"mb-2"},[a("span",{staticClass:"subtitle-1 labels"},[t._v(" "+t._s(t.$t("challenges.label.reward")))]),t._v(" "),a("v-text-field",{staticClass:"pointsRealization",attrs:{label:t.$t("realization.label.points"),rules:[t.rules.value],placeholder:t.$t("realization.label.points"),type:"number",outlined:"",required:""},model:{value:t.points,callback:function(e){t.points=e},expression:"points"}})],1),t._v(" "),a("span",{staticClass:"subtitle-1 labels"},[t._v(" "+t._s(t.$t("realization.label.actionLabel")))]),t._v(" "),a("div",{staticClass:"actionLabel"},[a("v-textarea",{staticClass:"pl-0 pt-0 actionLabel",attrs:{placeholder:t.$t("realization.label.actionLabel"),rules:[t.rules.length],name:"actionLabel","auto-grow":"",required:"",autofocus:"",rows:"5"},model:{value:t.actionLabel,callback:function(e){t.actionLabel=e},expression:"actionLabel"}}),t._v(" "),a("span",{staticClass:"tooManyChars mt-n2"},[t._v("\n          "+t._s(t.charsCount)+t._s(t.maxLength>-1?" / "+t.maxLength:"")+"\n          "),a("i",{staticClass:"uiIconMessageLength"})])],1),t._v(" "),a("div",{staticClass:"mt-2"},[a("span",{staticClass:"subtitle-1 labels"},[t._v(" "+t._s(t.$t("realization.label.program")))]),t._v(" "),a("v-flex",[a("v-autocomplete",{ref:"selectAutoComplete",staticClass:"identitySuggester identitySuggesterInputStyle",attrs:{label:t.labels.label,placeholder:t.labels.placeholder,items:t.domains,loading:t.loadingSuggestions,"prepend-inner-icon":t.prependInnerIcon,"hide-no-data":"","append-icon":"","menu-props":"closeOnClick, closeOnContentClick, maxHeight = 100","content-class":"identitySuggesterContent",width:"100%","max-width":"100%","item-text":"title","item-value":"id","return-object":"","persistent-hint":"","hide-selected":"",chips:"","cache-items":"",dense:"",flat:"",required:""},on:{"update:search-input":function(e){t.searchTerm=e}},scopedSlots:t._u([{key:"selection",fn:function(e){var i=e.item,s=e.selected;return[a("v-chip",{staticClass:"identitySuggesterItem",attrs:{"input-value":s,close:!0},on:{"click:close":function(e){t.program=null}}},[a("span",{staticClass:"text-truncate"},[t._v("\n                  "+t._s(i.title)+"\n                ")])])]}},{key:"item",fn:function(e){return[a("v-list-item-title",{staticClass:"text-truncate identitySuggestionMenuItemText",domProps:{textContent:t._s(e.item.title)}})]}}]),model:{value:t.program,callback:function(e){t.program=e},expression:"program"}},[a("template",{slot:"no-data"},[a("v-list-item",{staticClass:"pa-0"},[a("v-list-item-title",{staticClass:"px-2"},[t._v("\n                  "+t._s(t.labels.searchPlaceholder)+"\n                ")])],1)],1)],2)],1)],1)])],1),t._v(" "),a("template",{slot:"footer"},[a("div",{staticClass:"d-flex mr-2"},[a("v-spacer"),t._v(" "),a("button",{staticClass:"ignore-vuetify-classes btn mx-1",on:{click:t.close}},[t._v("\n        "+t._s(t.$t("realization.label.cancel"))+"\n      ")]),t._v(" "),a("button",{staticClass:"ignore-vuetify-classes btn btn-primary",attrs:{disabled:t.charsCount>1300},on:{click:t.updateRealization}},[t._v("\n        "+t._s(t.$t("realization.label.save"))+"\n      ")])],1)])],2)};C._withStripped=!0;var w=n({data(){return{rules:{length:t=>t&&t.length<1301||this.$t("realization.label.lengthExceed"),value:t=>t>=0&&t<=9999||this.$t("realization.label.pointsValidation")},labels:{searchPlaceholder:this.$t("challenges.programSuggester.searchPlaceholder"),placeholder:this.$t("challenges.programSuggester.placeholder"),noDataLabel:this.$t("challenges.programSuggester.noDataLabel")},domains:[],searchTerm:null,program:null,loadingSuggestions:!1,realizationId:null,actionLabel:null,points:null,maxLength:1300,status:null}},computed:{charsCount(){return this.actionLabel&&this.actionLabel.length}},created(){this.$root.$on("realization-open-edit-drawer",this.open),this.getAllDomains()},methods:{open(t,e){this.points=t.score,this.actionLabel=e||this.realization.actionLabel,this.program=t.domain,this.realizationId=t.id,this.status=t.status,this.$refs.editRealizationDrawer.open()},close(){this.$refs.editRealizationDrawer.close()},getAllDomains(){this.$realizationsServices.getAllDomains().then((t=>this.domains=t.domains))},updateRealization(){this.$realizationsServices.updateRealization(this.realizationId,this.status,this.actionLabel,this.program.title,this.points).then((t=>{this.$emit("updated",t),this.close()}))}}},C,[],!1,null,null,null);w.options.__file="src/main/webapp/vue-app/realizations/components/EditRealizationDrawer.vue";const D=w.exports;var S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("exo-drawer",{ref:"RealizationsFilterDrawer",staticClass:"RealizationsFilterDrawer",attrs:{right:!t.$vuetify.rtl,eager:""},on:{closed:t.close}},[t.loading?a("v-progress-circular",{attrs:{indeterminate:"",size:"32"}}):t._e(),t._v(" "),a("template",{slot:"title"},[a("span",{staticClass:"pb-2"},[t._v(" "+t._s(t.$t("realization.label.search.filtersAchievements"))+" ")])]),t._v(" "),a("template",{slot:"content"},[a("form",{ref:"realizationFilter",attrs:{id:"realizationFilter"}},[t.isAdministrator?a("v-card-text",[a("span",{staticClass:"subtitle-1"},[t._v(t._s(t.$t("realization.label.filter.grantee")))]),t._v(" "),a("v-flex",{staticClass:"user-suggester text-truncate"},[a("exo-identity-suggester",{ref:"granteeAttendeeAutoComplete",attrs:{name:"granteeAttendee","search-options":t.searchOptions,labels:t.granteeSuggesterLabels,"include-users":""},model:{value:t.granteeAttendee,callback:function(e){t.granteeAttendee=e},expression:"granteeAttendee"}}),t._v(" "),t.grantees?a("div",{staticClass:"identitySuggester no-border mt-0"},t._l(t.grantees,(function(e){return a("grantee-attendee-item",{key:e.identity.id,attrs:{attendee:e},on:{"remove-attendee":t.removeGranteeAttendee}})})),1):t._e()],1)],1):t._e(),t._v(" "),a("v-card-text",[a("span",{staticClass:"subtitle-1"},[t._v(t._s(t.$t("realization.label.filter.program")))]),t._v(" "),a("program-suggester",{ref:"programAttendeeAutoComplete",attrs:{labels:t.programSuggesterLabels,"include-deleted":t.IncludeDisabledPrograms,"include-disabled":t.IncludeDisabledPrograms},model:{value:t.programAttendee,callback:function(e){t.programAttendee=e},expression:"programAttendee"}}),t._v(" "),t.programs?a("div",{staticClass:"identitySuggester no-border mt-0"},t._l(t.programs,(function(e){return a("program-attendee-item",{key:e.id,attrs:{program:e},on:{"remove-attendee":t.removeProgramAttendee}})})),1):t._e(),t._v(" "),a("v-checkbox",{attrs:{"hide-details":""},on:{click:t.changeSelection},scopedSlots:t._u([{key:"label",fn:function(){return[a("span",{staticClass:"text--color subtitle-2 font-weight-normal"},[t._v("\n              "+t._s(t.$t("realization.label.filter.program.includeDisabledOrRemoved"))+"\n            ")])]},proxy:!0}]),model:{value:t.IncludeDisabledPrograms,callback:function(e){t.IncludeDisabledPrograms=e},expression:"IncludeDisabledPrograms"}})],1)],1)]),t._v(" "),a("template",{slot:"footer"},[a("div",{staticClass:"VuetifyApp flex d-flex"},[a("v-btn",{staticClass:"btn",on:{click:t.reset}},[a("v-icon",{staticClass:"pr-1",attrs:{"x-small":""}},[t._v("fas fa-redo")]),t._v(" "),[t._v("\n          "+t._s(t.$t("exoplatform.gamification.gamificationinformation.domain.reset"))+"\n        ")]],2),t._v(" "),a("v-spacer"),t._v(" "),a("div",{staticClass:"d-btn"},[a("v-btn",{staticClass:"btn me-2",on:{click:t.cancel}},[[t._v("\n            "+t._s(t.$t("exoplatform.gamification.gamificationinformation.domain.cancel"))+"\n          ")]],2),t._v(" "),a("v-btn",{staticClass:"btn btn-primary",attrs:{disabled:t.disabled},on:{click:t.confirm}},[[t._v("\n            "+t._s(t.$t("exoplatform.gamification.gamificationinformation.domain.confirm"))+"\n          ")]],2)],1)],1)])],2)};S._withStripped=!0;var T=n({props:{isAdministrator:{type:Boolean,default:!1}},data:()=>({tab:null,disabled:!1,granteeAttendee:null,grantees:[],granteesIds:[],programAttendee:null,programs:[],searchOptions:{currentUser:""},IncludeDisabledPrograms:!1}),computed:{granteeSuggesterLabels(){return{searchPlaceholder:this.$t("realization.label.filter.grantee.searchPlaceholder"),placeholder:this.$t("realization.label.filter.grantee.placeholder"),noDataLabel:this.$t("realization.label.filter.grantee.noDataLabel")}},programSuggesterLabels(){return{searchPlaceholder:this.$t("realization.label.filter.program.searchPlaceholder"),placeholder:this.$t("realization.label.filter.program.placeholder"),noDataLabel:this.$t("realization.label.filter.program.noDataLabel")}}},created(){this.$root.$on("realization-open-filter-drawer",this.open),this.$root.$on("program-load-more",this.loadMore)},watch:{loading(){this.loading?document.dispatchEvent(new CustomEvent("displayTopBarLoading")):document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},granteeAttendee(){if(!this.granteeAttendee)return void this.$nextTick(this.$refs.granteeAttendeeAutoComplete.$refs.selectAutoComplete.deleteCurrentItem);this.grantees||(this.grantees=[]);const t=this.grantees?.find((t=>t.identity.remoteId===this.granteeAttendee.remoteId&&t.identity.providerId===this.granteeAttendee.providerId));t||this.grantees.push({identity:this.granteeAttendee}),this.granteeAttendee=null},programAttendee(){if(!this.programAttendee)return void this.$nextTick(this.$refs.programAttendeeAutoComplete.$refs.selectAutoComplete.deleteCurrentItem);this.programs||(this.programs=[]);const t=this.programs?.find((t=>t.id===this.programAttendee.id));t||this.programs.push(this.programAttendee),this.programAttendee=null}},methods:{open(){this.$refs.RealizationsFilterDrawer.open()},cancel(){this.$refs.RealizationsFilterDrawer.close(),this.reset()},confirm(){this.$emit("selectionConfirmed",this.programs,this.grantees),this.$refs.RealizationsFilterDrawer.close()},reset(){this.programs=[],this.grantees=[],this.IncludeDisabledPrograms=!1},removeGranteeAttendee(t){const e=this.grantees.findIndex((e=>t.identity.remoteId===e.identity.remoteId&&t.identity.providerId===e.identity.providerId));e>=0&&(this.grantees.splice(e,1),this.granteesIds.splice(e,1))},removeProgramAttendee(t){const e=this.programs.findIndex((e=>t.id===e.id));e>=0&&this.programs.splice(e,1)},changeSelection(){this.programs=[]}}},S,[],!1,null,null,null);T.options.__file="src/main/webapp/vue-app/realizations/components/FilterRealizationsDrawer.vue";const L=T.exports;var A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list",[a("v-list-item",{staticClass:"d-flex align-start"},[a("v-list-item-content",{staticClass:"align-content-center"},[a("v-checkbox",{staticClass:"pt-2",attrs:{indeterminate:t.partiallySelected,color:"primary"},model:{value:t.selectAll,callback:function(e){t.selectAll=e},expression:"selectAll"}}),t._v(" "),a("v-text-field",{staticClass:"pa-0 mx-3 ",attrs:{id:"EngagementCenterApplicationSearchFilter",placeholder:t.$t("realization.label.filterByProgram"),"prepend-inner-icon":"fa-filter","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),t._v(" "),a("v-list-item",[a("v-list-item-content",{staticClass:"flex-column d-flex align-start"},t._l(t.programs,(function(e){return a("v-checkbox",t._b({key:Object.keys(e),staticClass:"pt-2 pb-2 justify-content-start",attrs:{label:Object.values(e),value:Object.keys(e)},on:{click:t.filterByProgram},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},"v-checkbox",t.$attrs,!1))})),1)],1)],1)};A._withStripped=!0;var k=n({data:()=>({selectionType:"all",selectAll:!0,loading:!1,limit:20,pageSize:20,totalSize:0,selected:[],numberOfPrograms:7,search:"",startSearchAfterInMilliseconds:600,endTypingKeywordTimeout:50,startTypingKeywordTimeout:0,typing:!1,programsList:[],loadedMoreProgramsList:[],type:"ALL",status:"ALL",searchingKey:"",size:0,noProgramsFound:!1}),created(){this.retrievePrograms(!1,""),this.$root.$on("reset-selection",this.reset)},watch:{selected(t,e){(0===e.length||0===t.length&&0!==e.length)&&this.$emit("empty-list",0===e.length),this.$emit("selected-programs",this.selectedPrograms)},selectAll(t){this.selected=t?this.programsList.map(Object.keys):[]},search(){this.startTypingKeywordTimeout=Date.now()+this.startSearchAfterInMilliseconds,this.typing||(this.typing=!0,this.waitForEndTyping())}},computed:{programs(){return this.programsList},hasMore(){return this.size>this.programsList?.length},selectedPrograms(){return this.selectAll&&!this.partiallySelected&&""===this.search?[]:this.selected},partiallySelected(){return this.programsList&&this.programsList.length&&(this.hasMore||this.selected.length!==this.programsList.length)}},methods:{reset(){this.search="",this.selectAll=!0,this.selected=this.programsList.map(Object.keys)},waitForEndTyping(){window.setTimeout((()=>{Date.now()>this.startTypingKeywordTimeout?(this.typing=!1,this.retrievePrograms(!1,this.search),this.noProgramsFound=!0,this.selected=[]):this.waitForEndTyping()}),this.endTypingKeywordTimeout)},retrievePrograms(t,e){this.loading=!0,this.$programsServices.retrievePrograms(null,null,this.type,this.status,e,!0).then((e=>{this.size=e.domainsSize,t?(this.loadedMoreProgramsList=e?.domains.map((t=>({[t.id]:t.title}))),this.programsList=this.programsList?.concat(this.loadedMoreProgramsList)):(this.programsList=e?.domains.map((t=>({[t.id]:t.title}))),this.loadedMoreProgramsList=this.programsList),this.selectAll&&(this.selected=this.selected.concat(this.loadedMoreProgramsList.map(Object.keys)))})).finally((()=>this.loading=!1))}}},A,[],!1,null,null,null);k.options.__file="src/main/webapp/vue-app/realizations/components/FilterRealizationsProgramList.vue";const I=k.exports;var E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-chip",{staticClass:"identitySuggesterItem me-4 mt-4",attrs:{close:""},on:{"click:close":function(e){return t.$emit("remove-attendee",t.attendee)}}},[a("v-avatar",{attrs:{left:""}},[a("v-img",{attrs:{src:t.avatarUrl}})],1),t._v(" "),a("span",{staticClass:"text-truncate"},[t._v("\n    "+t._s(t.displayName)+"\n  ")])],1)};E._withStripped=!0;var P=n({props:{attendee:{type:Object,default:()=>({})}},computed:{avatarUrl(){const t=this.attendee.identity&&(this.attendee.identity.profile||this.attendee.identity.space);return t&&(t.avatarUrl||t.avatar||"/portal/rest/v1/social/users/default-image/avatar")},displayName(){const t=this.attendee.identity&&(this.attendee.identity.profile||this.attendee.identity.space),e=t&&(t.displayName||t.fullname||t.fullName);return this.isExternal?`${e} (${this.$t("profile.External")})`:e},isExternal(){const t=this.attendee.identity&&this.attendee.identity.profile;return t&&(t.dataEntity&&"true"===t.dataEntity.external||t.external)}}},E,[],!1,null,null,null);P.options.__file="src/main/webapp/vue-app/realizations/components/GranteeAttendeeItem.vue";const R=P.exports;var M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-chip",{staticClass:"identitySuggesterItem me-4 mt-4",attrs:{close:""},on:{"click:close":function(e){return t.$emit("remove-attendee",t.program)}}},[a("v-avatar",{attrs:{left:""}},[a("v-img",{attrs:{src:t.avatarUrl}})],1),t._v(" "),a("span",{staticClass:"text-truncate"},[t._v("\n    "+t._s(t.displayName)+"\n  ")])],1)};M._withStripped=!0;var O=n({props:{program:{type:Object,default:()=>({})}},computed:{avatarUrl(){return this.program?.coverUrl||""},displayName(){return this.program?.title}}},M,[],!1,null,null,null);function F(t,e,a,i,s,n,r,o){const l=new FormData;if(t&&l.append("fromDate",t),e&&l.append("toDate",e),a?.length>0)for(const t of a)l.append("earnerIds",t);if(i&&l.append("sortBy",i),null!=s&&l.append("sortDescending",s),n&&l.append("offset",n),r&&l.append("limit",r),o?.length>0)for(const t of o)l.append("domainIds",t);const c=new URLSearchParams(l).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/realizations/api/allRealizations?returnSize=true&${c}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error when getting realizations")}))}function j(t,e,a){window.open(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/realizations/api/allRealizations?fromDate=${t}&toDate=${e}&earnerIds=${a}&returnType=xlsx`,"_blank")}function N(t,e,a,i,s){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/realizations/api/updateRealizations?realizationId=${t}&status=${e}&actionLabel=${a||""}&domain=${i||""}&points=${s||0}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"}}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error updating realization status")}))}function B(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains?type=ALL`,{headers:{"Content-Type":"application/json"},method:"GET"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Server indicates an error while sending request")}))}function V(t,e,a,i,s,n,r){const o=new FormData;t&&o.append("offset",t),e&&o.append("limit",e),a&&o.append("type",a),i&&o.append("status",i),s&&o.append("query",s),null!=n&&o.append("includeDeleted",n),null!=r&&o.append("sortByBudget",r);const l=new URLSearchParams(o).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains?returnSize=true&${l}`,{method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Server indicates an error while sending request")}))}function U(t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error saving program")}))}function X(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/canAddProgram`,{headers:{"Content-Type":"text/plain"},method:"GET",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Server indicates an error while sending request")}))}function H(t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/${t.id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Error updating program")}))}function K(t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/${t}`,{method:"GET",credentials:"include"}).then((t=>t&&t.ok?t.json():null))}function G(t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/${t}`,{method:"DELETE",credentials:"include"}).then((t=>{if(t&&t.ok)return t.json();throw new Error("Response code indicates a server error",t)}))}O.options.__file="src/main/webapp/vue-app/realizations/components/ProgramAttendeeItem.vue";const q={realizations:o,"realization-item":d,"realization-item-mobile":p,"select-period":v,"edit-realization-drawer":D,"filter-realizations-drawer":L,"realizations-filter-program-list":I,"engagement-center-no-results":_,"grantee-attendee-item":R,"program-attendee-item":O.exports,"program-suggester":z};for(const t in q)Vue.component(t,q[t]);return Vue.prototype.$programsServices||window.Object.defineProperty(Vue.prototype,"$programsServices",{value:i}),Vue.prototype.$realizationsServices||window.Object.defineProperty(Vue.prototype,"$realizationsServices",{value:a}),e})()));