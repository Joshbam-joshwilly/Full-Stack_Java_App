define((()=>(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>L});var n={};e.r(n),e.d(n,{canAddChallenge:()=>f,deleteChallenge:()=>E,getAllAnnouncementsByChallenge:()=>x,getAllChallengesByUser:()=>C,getAllDomains:()=>D,getChallengeById:()=>b,saveAnnouncement:()=>_,saveChallenge:()=>y,updateChallenge:()=>w});var i={};e.r(i),e.d(i,{displayAlert:()=>k,getFromDate:()=>R,getIsoDate:()=>P,getUserTimezone:()=>A,pad:()=>T,toRFC3339:()=>S});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[e.displayChallenges?n("gamification-overview-widget",{attrs:{"see-all-url":e.challengesURL,"extra-class":"px-0 mt-1"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("\n      "+e._s(e.$t("gamification.overview.challengesOverviewTitle"))+"\n    ")]},proxy:!0},{key:"content",fn:function(){return e._l(e.listChallenges,(function(t,i){return n("gamification-overview-widget-row",{key:i,staticClass:"py-auto",attrs:{"click-event-param":""+t.challengeId,"is-challenge-id-provided":!0},scopedSlots:e._u([{key:"icon",fn:function(){return[n("v-icon",{staticClass:"ps-4",attrs:{color:"yellow darken-2",size:"30px"}},[e._v("\n            fas fa-trophy\n          ")])]},proxy:!0},{key:"content",fn:function(){return[n("span",[n("v-list",{attrs:{subheader:"","two-line":""}},[n("v-list-item",{attrs:{"two-line":""}},[n("v-list-item-content",[n("v-list-item-title",{},[e._v("\n                    "+e._s(t.challengeTitle)+"\n                  ")]),e._v(" "),0===t.challengesAnnouncementsCount?n("v-list-item-subtitle",[e._v(" \n                    "+e._s(e.$t("gamification.overview.label.firstAnnounecement"))+"\n                  ")]):1===t.challengesAnnouncementsCount?n("v-list-item-subtitle",[e._v(" \n                    "+e._s(t.challengesAnnouncementsCount)+"  "+e._s(e.$t("gamification.overview.label.participant"))+"\n                  ")]):n("v-list-item-subtitle",[e._v(" \n                    "+e._s(t.challengesAnnouncementsCount)+"  "+e._s(e.$t("gamification.overview.label.participants"))+"\n                  ")])],1),e._v(" "),n("v-list-item-action",[n("v-list-item-action-text",{staticClass:"mt-5",domProps:{textContent:e._s(t.challengePoints+" "+e.$t("challenges.label.points"))}})],1)],1)],1)],1)]},proxy:!0}],null,!0)})}))},proxy:!0}])}):n("gamification-overview-widget",{attrs:{loading:e.loading},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("\n      "+e._s(e.$t("gamification.overview.emptyChallengesOverviewTitle"))+"\n    ")]},proxy:!0},{key:"content",fn:function(){return[n("gamification-overview-widget-row",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"my-auto",scopedSlots:e._u([{key:"icon",fn:function(){return[n("v-icon",{attrs:{color:"secondary",size:"55px"}},[e._v("fas fa-rocket")])]},proxy:!0},{key:"content",fn:function(){return[n("span",{domProps:{innerHTML:e._s(e.emptySummaryText)}})]},proxy:!0}],null,!1,2348600465)})]},proxy:!0}],null,!1,3743995229)}),e._v(" "),n("rule-details-drawer",{ref:"challengeDetailsDrawer",attrs:{"is-overview-displayed":!0}})],1)};function s(e,t,n,i,a,s,r,o){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),s&&(c._scopeId="data-v-"+s),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},c._ssrRegister=l):a&&(l=o?function(){a.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(e,t){return l.call(t),u(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}a._withStripped=!0;var r=s({data:()=>({search:"",challengePerPage:3,announcementsPerChallenge:-1,filter:"STARTED",period:"WEEK",loading:!0,displayChallenges:!1,listChallenges:[],listRealizations:[],orderByRealizations:!0}),computed:{emptySummaryText(){return this.$t("gamification.overview.challengesOverviewSummary",{0:`<a class="primary--text font-weight-bold" href="${this.challengesURL}">`,1:"</a>"})},challengesURL:()=>`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges`},created(){document.addEventListener("widget-row-click-event",(e=>{e&&this.$challengesServices.getChallengeById(e.detail).then((e=>{document.dispatchEvent(new CustomEvent("rule-detail-drawer",{detail:e}))}))})),this.getChallenges()},methods:{getChallenges(){return this.loading=!0,this.$challengesServices.getAllChallengesByUser(this.search,0,this.challengePerPage,this.announcementsPerChallenge,null,null,this.filter,this.orderByRealizations,this.listRealizations,this.period).then((e=>{if(e){if(e.forEach((e=>{const t={};t.challengeId=e.id,t.challengeTitle=e.title,t.challengePoints=e.points,t.challengesAnnouncementsCount=e.announcements.length,this.listChallenges.push(t),this.listRealizations.push(e.id)})),this.listChallenges.length<this.challengePerPage&&this.orderByRealizations)return this.orderByRealizations=!1,this.challengePerPage-=this.listChallenges.length,this.getChallenges();this.listChallenges=this.listChallenges.sort(((e,t)=>t.challengePoints-e.challengePoints)),this.displayChallenges=this.listChallenges.length>0}})).finally((()=>this.loading=!1))}}},a,[],!1,null,null,null);r.options.__file="src/main/webapp/vue-app/challengesOverview/components/ChallengesOverview.vue";const o=r.exports;var l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("exo-drawer",{ref:"ruleDetailDrawer",attrs:{id:"ruleDetailDrawer",right:!e.$vuetify.rtl},on:{closed:e.close},scopedSlots:e._u([{key:"title",fn:function(){return[n("span",{staticClass:"pb-2"},[e._v(" "+e._s(e.$t("rule.detail.letsSeeWhatToDo"))+" ")])]},proxy:!0},{key:"content",fn:function(){return[n("v-card-text",[n("div",{staticClass:"d-flex"},[n("v-icon",{staticClass:"align-start primary--text",attrs:{size:"60"}},[e._v(e._s(e.actionIcon))]),e._v(" "),n("div",{staticClass:"mb-4 ms-4"},[n("div",{staticClass:"font-weight-bold mx-0 mt-0 mb-2"},[e._v(e._s(e.ruleTitle))]),e._v(" "),n("div",{staticClass:"font-weight-bold text--secondary"},[e._v(e._s(e.ruleScore)+" "+e._s(e.$t("challenges.label.points")))])])],1),e._v(" "),n("div",{staticClass:"d-flex flex-row pt-3 rich-editor-content text-break overflow-hidden"},[n("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.rule.description,expression:"rule.description"}]})]),e._v(" "),n("div",{staticClass:"d-flex flex-row py-3"},[n("v-img",{attrs:{src:e.program.coverUrl,height:e.programCoverSize,width:e.programCoverSize,"max-height":e.programCoverSize,"max-width":e.programCoverSize}}),n("span",{staticClass:"font-weight-bold my-auto ms-3"},[e._v(e._s(e.program.title))])],1),e._v(" "),e.automaticRule?e._e():n("div",{staticClass:"d-flex flex-row py-3"},[n("v-icon",{staticClass:"primary--text ps-1",attrs:{size:"30"}},[e._v("fas fa-calendar-day")]),n("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.DateInfo,expression:"DateInfo"}],staticClass:"my-auto ms-4"})],1),e._v(" "),!e.automaticRule&&e.isActiveRule?n("div",{staticClass:"d-flex flex-row py-3 clickable",on:{click:e.showEditor}},[n("v-icon",{staticClass:"primary--text",attrs:{size:"30"}},[e._v("fas fa-bullhorn")]),n("span",{staticClass:"font-weight-bold my-auto ms-3"},[e._v(e._s(e.$t("rule.detail.AnnounceYourAchievement"))+" ")])],1):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.editor,expression:"editor"}]},[!e.automaticRule&&e.isActiveRule?n("div",{staticClass:"d-flex flex-row pt-3"},[n("v-list-item",{staticClass:"text-truncate px-0"},[n("exo-space-avatar",{attrs:{"space-id":e.spaceId,"extra-class":"text-truncate",size:30,avatar:""}}),e._v(" "),n("exo-user-avatar",{attrs:{"profile-id":e.username,size:25,"extra-class":"ms-n4 mt-6",avatar:""}}),e._v(" "),n("v-list-item-content",{staticClass:"py-0 accountTitleLabel text-truncate"},[n("v-list-item-title",{staticClass:"font-weight-bold d-flex body-2 mb-0"},[n("exo-space-avatar",{attrs:{"space-id":e.spaceId,"extra-class":"text-truncate",fullname:"","bold-title":"","link-style":"","username-class":""}})],1),e._v(" "),n("v-list-item-subtitle",{staticClass:"d-flex flex-row flex-nowrap"},[n("exo-user-avatar",{attrs:{"profile-id":e.username,"extra-class":"text-truncate ms-2 me-1",fullname:"","link-style":"","small-font-size":"","username-class":""}})],1)],1)],1)],1):e._e(),e._v(" "),!e.automaticRule&&e.isActiveRule?n("div",{staticClass:"py-3"},[n("exo-activity-rich-editor",{ref:"announcementRichEditor",staticClass:"flex",attrs:{"max-length":e.MAX_LENGTH,"template-params":e.templateParams,placeholder:e.$t("rule.detail.announceEditor.placeholder"),"tag-enabled":!1,"ck-editor-type":"announcementContent"},on:{"validity-updated":function(t){e.validInput=t}},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}})],1):e._e()])])]},proxy:!0}])},[e._v(" "),e._v(" "),!e.automaticRule&&e.isActiveRule&&e.editor?n("template",{slot:"footer"},[n("div",{staticClass:"d-flex mr-2"},[n("v-spacer"),e._v(" "),n("v-btn",{staticClass:"btn me-2",on:{click:e.close}},[e._v("\n        "+e._s(e.$t("rule.detail.label.cancel"))+"\n      ")]),e._v(" "),n("v-btn",{staticClass:"btn btn-primary",attrs:{loading:e.sending,disabled:e.btnDisabled},on:{click:e.createAnnouncement}},[e._v("\n        "+e._s(e.$t("rule.detail.label.announce"))+"\n      ")])],1)]):e._e()],2)};l._withStripped=!0;var c=s({props:{actionValueExtensions:{type:Object,default:function(){return null}},isOverviewDisplayed:{type:Boolean,default:!1},tabName:{type:String,default:null},tab:{type:Number,default:()=>0}},data:()=>({rule:{},program:{},drawer:!1,username:eXo.env.portal.userName,userId:eXo.env.portal.userIdentityId,validInput:!0,comment:null,templateParams:{},programCoverSize:35,MAX_LENGTH:1300,editorFocus:!1,editor:!1,sending:!1}),computed:{ruleTitle(){const e=`exoplatform.gamification.gamificationinformation.rule.title.${this.rule.title}`;return this.$te(e)?this.$t(e):this.rule.title},extendedActionValueComponent(){return this.actionValueExtension&&{componentName:"action-value",componentOptions:{vueComponent:this.actionValueExtension.vueComponent}}||null},actionValueExtension(){return this.actionValueExtensions&&Object.values(this.actionValueExtensions).sort(((e,t)=>(e.rank||0)-(t.rank||0))).find((e=>e.match&&e.match(this.rule.event)))||null},automaticRule(){return"AUTOMATIC"===this.rule?.type},actionIcon(){return this.automaticRule?this.actionValueExtension?.icon:"fas fa-trophy"},ruleScore(){return this.rule?.score||this.rule?.points},startDate(){return new Date(this.rule?.startDate).getTime()||0},endDate(){return new Date(this.rule?.endDate).getTime()||0},isActiveRule(){return this.automaticRule||this.startDate<=Date.now()&&this.endDate>=Date.now()},DateInfo(){if(this.isActiveRule){const e=Math.round((this.endDate-Date.now())/864e5)+1;return this.$t("rule.detail.challengeEndIn",{0:e})}if(this.endDate<Date.now())return this.$t("rule.detail.challengeEnded");{const e=Math.round((this.startDate-Date.now())/864e5)+1;return this.$t("rule.detail.challengeOpenIn",{0:e})}},spaceId(){return this.program?.audienceId},btnDisabled(){return!this.validInput||!this.comment||!this.comment.length}},watch:{rule(){this.isOverviewDisplayed||1!==this.tab||(this.rule?.id?window.history.replaceState("challenges",this.$t("challenges.challenges"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges/${this.rule.id}`):window.history.replaceState("challenges",this.$t("challenges.challenges"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges`))},watch:{sending(){this.sending?this.$refs.ruleDetailDrawer.startLoading():this.$refs.ruleDetailDrawer.endLoading()}}},created(){this.$root.$on("rule-detail-drawer",((e,t)=>{this.rule=e,this.editorFocus=t,this.program=e?.domainDTO||e?.program,this.$refs.ruleDetailDrawer&&(this.$refs.ruleDetailDrawer.open(),this.$nextTick().then((()=>{!this.automaticRule&&this.isActiveRule&&(this.$refs.announcementRichEditor.initCKEditor(),this.editorFocus&&(this.editor=!0,this.setFocus()))})))})),document.addEventListener("rule-detail-drawer",(e=>{e&&e.detail&&(this.rule=e.detail,this.program=this.rule?.domainDTO||this.rule?.program,this.$refs.ruleDetailDrawer&&this.$refs.ruleDetailDrawer.open())}))},methods:{close(){this.$refs.ruleDetailDrawer.close(),this.rule={},this.comment=null,this.editor=!1,this.editorFocus=!1},open(){this.$refs.ruleDetailDrawer&&this.$refs.ruleDetailDrawer.open()},createAnnouncement(){const e={assignee:this.userId,comment:this.comment,challengeId:this.rule.id,challengeTitle:this.rule.title,templateParams:this.templateParams};this.sending=!0,this.$challengesServices.saveAnnouncement(e).then((e=>{this.$engagementCenterUtils.displayAlert(this.$t("challenges.announcementCreateSuccess")),this.$root.$emit("announcement-added",{detail:{announcement:e,challengeId:this.rule.id}}),this.close()})).catch((e=>{let t="";t="401"===e.message||"403"===e.message?this.$t("challenges.permissionDenied"):"406"===e.message?this.$t("challenges.challengeNotStartedOrEnded"):this.$t("challenges.announcementErrorSave"),this.$engagementCenterUtils.displayAlert(t,"error")})).finally((()=>{this.sending=!1}))},showEditor(){this.editor=!0,this.editorFocus=!0,this.setFocus()},setFocus(){window.setTimeout((()=>{const e=document.querySelector("#ruleDetailDrawer .drawerContent");e.scrollTo({top:e.scrollHeight,behavior:"smooth",block:"start"}),this.$refs.announcementRichEditor.setFocus()}),100)}}},l,[],!1,null,null,null);c.options.__file="src/main/webapp/vue-app/engagement-center/components/rules/RuleDetailDrawer.vue";const u=c.exports;var d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-flex align-center"},[n("div",{staticClass:"d-flex"},e._l(e.avatarsTodisplay,(function(t){return n("exo-user-avatar",{key:t.userName,attrs:{"profile-id":t.userName,size:e.size,popover:"",avatar:"","extra-class":"me-1"}})})),1),e._v(" "),n("a",[e.seeMoreAvatarsToDisplay?n("v-avatar",{staticClass:"light-black-background icon-mini-size white--text font-weight-bold",attrs:{size:e.size},on:{click:function(t){return e.$emit("open-avatars-drawer")}}},[e._v("\n      +"+e._s(e.showMoreAvatarsNumber)+"\n    ")]):e._e()],1)])};d._withStripped=!0;var h=s({props:{avatars:{type:Array,default:()=>[]},maxAvatarsToShow:{type:Number,default:null},avatarsCount:{type:Number,default:null},size:{type:Number,default:null}},computed:{avatarsTodisplay(){return this.avatars.slice(0,this.maxAvatarsToShow-1)},seeMoreAvatarsToDisplay(){return this.avatarsCount>=this.maxAvatarsToShow||null},remainingAvatarsCount(){return this.avatarsCount-this.maxAvatarsToShow+1},showMoreAvatarsNumber(){return this.remainingAvatarsCount>99?99:this.remainingAvatarsCount}},methods:{openDrawer(){this.$root.$emit("open-avatars-drawer",this.avatars)}}},d,[],!1,null,null,null);h.options.__file="src/main/webapp/vue-app/engagement-center/components/common/AvatarsList.vue";const p=h.exports;var m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"activityRichEditor newEditorToolbar",attrs:{id:"descriptionId"}},[e.label?n("div",{staticClass:"py-1 subtitle-1"},[e._v("\n    "+e._s(e.label)+"\n  ")]):e._e(),e._v(" "),e.displayPlaceholder?n("div",{staticClass:"caption text-sub-title position-absolute pa-5 ma-1px full-width",on:{click:function(t){return e.hidePlaceholder()}}},[e._v("\n    "+e._s(e.placeholder)+"\n  ")]):e._e(),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.inputVal,expression:"inputVal"}],ref:"editor",staticClass:"d-none",attrs:{id:"descriptionContent",cols:"30",rows:"10"},domProps:{value:e.inputVal},on:{input:function(t){t.target.composing||(e.inputVal=t.target.value)}}}),e._v(" "),n("div",{staticClass:"activityCharsCount",class:e.tooManyChars?"tooManyChars":""},[e._v("\n    "+e._s(e.charsCount)+e._s(e.maxLength>-1?" / "+e.maxLength:"")+"\n    "),n("i",{staticClass:"uiIconMessageLength"})])])};m._withStripped=!0;var v=s({props:{value:{type:String,default:null},label:{type:String,default:""},placeholder:{type:String,default:""},maxLength:{type:Number,default:()=>1300},autofocus:{type:Boolean,default:!1}},data:()=>({inputVal:"",minLength:1,disabled:!1,displayPlaceholder:!0,editor:null}),computed:{charsCount(){return this.inputVal&&this.$utils.htmlToText(this.inputVal).length||0},validLength(){return this.minLength<=this.charsCount&&this.charsCount<=this.maxLength},editorReady(){return this.editor&&"ready"===this.editor.status},isMobile(){return"sm"===this.$vuetify.breakpoint.name||"xs"===this.$vuetify.breakpoint.name},tooManyChars(){return this.charsCount>this.maxLength}},watch:{inputVal:{immediate:!0,handler(e){""!==e?this.displayPlaceholder&&(this.displayPlaceholder=!1):this.displayPlaceholder=!0,this.$emit("input",e)}},validLength(){this.$emit("validity-updated",this.validLength)},editorReady(){this.editorReady?this.$emit("ready"):this.$emit("unloaded")},value(e){this.editor||this.initCKEditor();let t=null;try{t=this.editor.getData()}catch(e){}e!==t&&(this.initCKEditorData(e||""),this.setEditorReady())}},created(){CKEDITOR.basePath="/commons-extension/ckeditor/",this.initCKEditor()},beforeDestroy(){this.destroyCKEditor()},methods:{initCKEditor(){let e="simpleLink,widget";const t=[["Bold","Italic","BulletedList","NumberedList","Blockquote"]];e=`${e},emoji,formatOption`,this.isMobile||t[0].push("emoji"),t[0].unshift("formatOption"),this.inputVal=this.value||"",this.editor=CKEDITOR.instances.descriptionContent;const n=this;$(this.$refs.editor).ckeditor({customConfig:"/commons-extension/ckeditorCustom/config.js",extraPlugins:e,removePlugins:"image,maximize,resize",toolbar:t,toolbarLocation:"bottom",autoGrow_onStartup:!0,pasteFilter:"p; a[!href]; strong; i",on:{instanceReady:function(){n.editor=CKEDITOR.instances.descriptionContent,n.setEditorReady(),n.autofocus&&(setTimeout((function(){n.editor.getSelection().scrollIntoView()}),0),window.setTimeout((()=>n.setFocus()),50))},change:e=>this.inputVal=e.editor?.getData()||"",destroy:()=>this.inputVal=""}})},destroyCKEditor:function(){this.editor&&this.editor.destroy(!0)},hidePlaceholder(){this.displayPlaceholder=!1,this.setFocus()},initCKEditorData:function(e){this.inputVal=e||"",this.editor&&this.editor.setData(this.inputVal)},setEditorReady:function(){window.setTimeout((()=>{this.$set(this.editor,"status","ready")}),200)},setFocus:function(){this.editorReady&&window.setTimeout((()=>{this.$nextTick().then((()=>this.editor.focus()))}),200)}}},m,[],!1,null,null,null);v.options.__file="src/main/webapp/vue-app/engagement-center/components/common/DescriptionEditor.vue";const g=v.exports;function f(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/canAddChallenge`,{headers:{"Content-Type":"text/plain"},credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Server indicates an error while sending request")}))}function y(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error saving challenge")}))}function w(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error updating challenge")}))}function C(e,t,n,i,a,s,r,o,l,c){const u=new FormData;if(e&&u.append("term",e),t&&u.append("offset",t),n&&u.append("limit",n),i&&u.append("announcements",i),a&&u.append("domainId",a),s&&u.append("groupByDomain",s),r&&u.append("filter",r),null!=o&&u.append("orderByRealizations",o),l?.length>0)for(const e of l)u.append("excludedChallengesIds",e);c&&u.append("period",c);const d=new URLSearchParams(u).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges?${d}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting challenges")}))}function x(e,t,n,i){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/announcement/api/ByChallengeId/${e}?type=${t||""}&offset=${n||0}&limit=${i||10}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting challenges")}))}function _(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/announcement/api/addAnnouncement`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error(e.status)}))}function b(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/${e}`,{method:"GET",credentials:"include"}).then((e=>e&&e.ok?e.json():null))}function D(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains?type=ALL`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Server indicates an error while sending request")}))}function E(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/${e}`,{method:"DELETE",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error(e.status)}))}function T(e){return e<10&&`0${e}`||e}function S(e,t,n){if(!e)return null;let i;return"number"==typeof e?e=new Date(e):"string"==typeof e&&(10===e.indexOf("T")&&e.length>19&&(e=e.substring(0,19)),e=new Date(e)),i=t?`${e.getFullYear()}-${T(e.getMonth()+1)}-${T(e.getDate())}T00:00:00`:`${e.getFullYear()}-${T(e.getMonth()+1)}-${T(e.getDate())}T${T(e.getHours())}:${T(e.getMinutes())}:${T(e.getSeconds())}`,n?`${i}${A()}`:i}function A(){const e=-(new Date).getTimezoneOffset();let t=e/60,n=e%60;return t=t<10?`0${t}`:t,n=n<10?`0${n}`:n,`${e>=0?"+":"-"}${t}:${n}`}function R(e){const t=eXo.env.portal.language,n=String(e.getDate()),i=String(e.getFullYear());return`${e.toLocaleDateString(t||"en",{month:"long"})} ${n}, ${i}`}function k(e,t){document.dispatchEvent(new CustomEvent("notification-alert",{detail:{message:e,type:t||"success"}}))}const P=e=>`${e.getFullYear()}-${T(e.getMonth()+1)}-${T(e.getDate())}T00:00:00`,O={"gamification-overview-challenges":o,"rule-details-drawer":u,"engagement-center-avatars-list":p,"engagement-center-description-editor":g};Vue.prototype.$challengesServices||window.Object.defineProperty(Vue.prototype,"$challengesServices",{value:n}),Vue.prototype.$engagementCenterUtils||window.Object.defineProperty(Vue.prototype,"$engagementCenterUtils",{value:i});for(const e in O)Vue.component(e,O[e]);const X=eXo&&eXo.env&&eXo.env.portal&&eXo.env.portal.language||"en",I=[`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.addon.Gamification-${X}.json`,`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.Challenges-${X}.json`],z="challengesOverview";function L(){exoi18n.loadLanguageAsync(X,I).then((e=>{Vue.createApp({template:`<gamification-overview-challenges id="${z}" />`,i18n:e,vuetify:Vue.prototype.vuetifyOptions},`#${z}`,"Challenges Overview")}))}return t})()));