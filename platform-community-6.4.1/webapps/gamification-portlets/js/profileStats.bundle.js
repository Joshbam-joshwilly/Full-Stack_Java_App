define((()=>(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>ae});var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{staticClass:"ms-md-2",attrs:{flat:"",dark:""}},[s("v-container",{attrs:{"pa-0":""}},[s("v-layout",{staticClass:"white profileCard",attrs:{row:"",wrap:"","mx-0":""}},[e.isFlipped?e._e():s("user-dashbord",{key:e.userDashBordKey,staticClass:"profileFlippedCard profileStats",attrs:{"commons-space-default-size":e.commonsSpaceDefaultSize,"is-current-user-profile":e.isCurrentUserProfile,"common-connections-size":e.commonConnections.length},on:{"specific-card":e.setFlippedCard,openConnectionsDrawer:e.openConnectionsDrawer,openSpaceDrawer:e.openSpaceDrawer,shouldShowRequests:e.shouldShowRequests,showRequestsSpace:e.showRequestsSpace}}),e._v(" "),e.isFlipped?s(e.currentComponent,{tag:"v-flex",staticClass:"profileFlippedCard ConnexionsRequests",attrs:{"d-flex":"",xs12:"",sm12:""},on:{isProfileStats:e.setFlippedCard}}):e._e()],1)],1),e._v(" "),s("achievements-drawer",{ref:"achievementsDrawer",attrs:{"user-points":e.userPoints}}),e._v(" "),s("connections-drawer",{ref:"connectionsDrawer",attrs:{"connection-requests":e.connectionRequests,"is-current-user-profile":e.isCurrentUserProfile,"common-connections":e.commonConnections},on:{closed:e.refreshUserDashBord}}),e._v(" "),s("space-drawer",{ref:"spaceDrawer",attrs:{"space-requests":e.spaceRequests,"is-current-user-profile":e.isCurrentUserProfile,"commons-space-default-size":e.commonsSpaceDefaultSize},on:{closed:e.refreshUserDashBord}})],1)};function i(e,t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/users/${eXo.env.portal.profileOwner}/spaces?offset=${e||0}&limit=${t||10}&returnSize=true`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting spaces of current user")}))}function a(e,t){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/users/${eXo.env.portal.userName}/spaces/${eXo.env.portal.profileOwner}?offset=${e||0}&limit=${t||10}&returnSize=true`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting commons spaces")}))}function o(){return fetch("/portal/rest/v1/social/spacesMemberships?status=invited&returnSize=true&limit=3",{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting spaces requests")}))}function n(){return fetch("/portal/rest/v1/social/relationships?status=incoming&returnSize=true&limit=3",{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting connections requests")}))}function r(e){return fetch(`/portal/rest/gamification/api/v1/points?userId=${eXo.env.portal.profileOwner}&period=${e||""}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting gamification points")}))}function l(e){return fetch(`/portal/rest/v1/social/identities/${e}/commonConnections?returnSize=true`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting common connections")}))}s._withStripped=!0;const c={data:function(){return{currentComponent:null,isFlipped:!1,connectionRequests:null,spaceRequests:null,userDashBordKey:0,commonsSpaceDefaultSize:0,isCurrentUserProfile:!1,commonConnections:[],PROFILE_URI:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/`}},created(){this.$root.$on("open-achievement",(e=>{this.$refs.achievementsDrawer.open(e)})),this.isCurrentUserProfile=eXo.env.portal.userName===eXo.env.portal.profileOwner,this.isCurrentUserProfile||(this.commonsSpaces(),this.retrieveCommonConnections(parseInt(eXo.env.portal.profileOwnerIdentityId)))},methods:{setFlippedCard(e){document.querySelector(".profileCard").classList.toggle("is-flipped"),this.currentComponent=e,this.isFlipped=!this.isFlipped},commonsSpaces(){a(this.offset,this.limitToFetch).then((e=>{this.commonsSpaceDefaultSize=e.size}))},retrieveCommonConnections(e){l(e).then((e=>{const t=[];return t.push(...e.identities),this.commonConnections=t.map((e=>e.profile)),this.commonConnections.forEach((e=>{e.profileLink=this.PROFILE_URI+e.username})),this.$nextTick()}))},openConnectionsDrawer(){this.$refs.connectionsDrawer.open()},shouldShowRequests(e){this.connectionRequests=e},showRequestsSpace(e){this.spaceRequests=e},refreshUserDashBord(){this.userDashBordKey+=1},openSpaceDrawer(){this.$refs.spaceDrawer.open()}}};function p(e,t,s,i,a,o,n,r){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=s,c._compiled=!0),i&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),n?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=l):a&&(l=r?function(){a.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(c.functional){c._injectStyles=l;var p=c.render;c.render=function(e,t){return l.call(t),p(e,t)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,l):[l]}return{exports:e,options:c}}var h=p(c,s,[],!1,null,null,null);h.options.__file="src/main/webapp/vue-app/profileStats/components/ProfileStats.vue";const u=h.exports;var d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-layout",{attrs:{row:"",wrap:"","mx-0":""}},[s("v-flex",{attrs:{"d-flex":"",xs12:"","my-3":""}},[s("v-layout",{attrs:{row:"",wrap:"","mx-2":"","align-start":""}},[s("v-flex",{attrs:{"d-flex":"",xs12:"","mt-n2":"","justify-center":""}},[s("span",{staticClass:"pe-2 text-uppercase subtitle-2 profile-card-header"},[e._v(e._s(e.$t("homepage.profileStatus.connectionsRequests")))]),e._v(" "),s("v-btn",{staticClass:"mb-1 header-badge-color",attrs:{fab:"",depressed:"",dark:"",height:"20",width:"20",href:e.receivedInvitationsUrl}},[s("span",{staticClass:"white--text caption"},[e._v(e._s(e.connectionsRequestsSize))])])],1)],1)],1),e._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-list",[e._l(e.sort(e.connectionsRequests),(function(t){return[s("v-list-item",{key:t.id,staticClass:"py-0 px-2"},[s("v-list-item-avatar",{staticClass:"my-1 me-2",attrs:{size:"30"}},[s("v-img",{attrs:{src:t.senderAvatar}})],1),e._v(" "),s("v-list-item-content",{staticClass:"py-0"},[s("v-list-item-title",{staticClass:"font-weight-bold subtitle-2 request-user-name darken-2",domProps:{innerHTML:e._s(t.senderFullName)}}),e._v(" "),s("v-list-item-subtitle",{staticClass:"caption grey-color",domProps:{textContent:e._s(t.commonConnections+" "+e.$t("homepage.profileStatus.commonConnections"))}})],1),e._v(" "),s("v-list-item-action",[s("v-btn-toggle",{staticClass:"transparent",attrs:{dark:""}},[s("v-btn",{staticClass:"px-0 connexion-accept-btn",attrs:{text:"",icon:"",small:"","min-width":"auto"},on:{click:function(s){return e.replyInvitationToConnect(t.id,"confirmed")}}},[s("v-icon",{attrs:{size:"20"}},[e._v("mdi-checkbox-marked-circle")])],1),e._v(" "),s("v-btn",{staticClass:"px-0 connexion-refuse-btn",attrs:{text:"",icon:"",small:"","min-width":"auto"},on:{click:function(s){return e.replyInvitationToConnect(t.id,"ignored")}}},[s("v-icon",{attrs:{size:"20"}},[e._v("mdi-close-circle")])],1)],1)],1)],1)]}))],2)],1)],1)};d._withStripped=!0;var m=p({data:()=>({connectionsRequests:[],connectionsRequestsSize:"",items:[],receivedInvitationsUrl:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/connexions/receivedInvitations`}),created(){this.getConnectionsRequests()},methods:{getConnectionsRequests(){this.connectionsRequests=[],n().then((e=>{if(this.connectionsRequestsSize=e.size,this.$emit("shouldShowRequests",this.connectionsRequestsSize),this.connectionsRequestsSize>0)for(let t=0;t<e.relationships.length;t++){const s={};s.id=e.relationships[t].id,fetch(`${e.relationships[t].sender}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting connection request sender")})).then((e=>{s.senderAvatar=e.avatar||e.avatarUrl||`/rest/v1/social/users/${e.username}/avatar`,s.senderFullName=e.fullname,l(e.id).then((e=>{s.commonConnections=e.size,this.connectionsRequests.splice(t,0,s)}))}))}}))},sort:e=>e.slice().sort((function(e,t){return e.senderFullName.localeCompare(t.senderFullName)})),replyInvitationToConnect(e,t){(function(e,t){const s={status:`${t}`};return fetch(`/portal/rest/v1/social/relationships/${e}`,{method:"PUT",credentials:"include",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when replying invitation to connect")}))})(e,t).then((()=>{if("confirmed"===t){const t=this.connectionsRequests.filter((t=>t.id===e))[0],s={id:t.id,fullname:t.senderFullName,avatar:t.senderAvatar};this.$emit("invitationReplied",s)}this.getConnectionsRequests()}))}}},d,[],!1,null,null,null);m.options.__file="src/main/webapp/vue-app/profileStats/components/ConnectionsRequests.vue";const v=m.exports;var f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-layout",{class:e.isOverviewDisplay?"mt-n10 mb-5":"",attrs:{row:"",wrap:"","mx-0":""}},[s("v-flex",{attrs:{"d-flex":"",xs12:"","my-5":""}},[s("v-layout",{attrs:{row:"",wrap:"","mx-2":"","align-start":"",px12:""}},[e.isOverviewDisplay?e._e():s("v-flex",{attrs:{"d-flex":"",xs12:"","mt-n2":"","justify-center":""}},[s("div",[s("span",{staticClass:"pe-2 text-uppercase subtitle-2 profile-card-header"},[e._v(e._s(this.$t("homepage.profileStatus.weeklyRank")))])])]),e._v(" "),e.isOverviewDisplay?e._e():s("v-flex",{attrs:{"d-flex":"",xs12:"","mt-n6":""}},[s("v-icon",{attrs:{color:"grey darken-2",size:"20"},on:{click:function(t){return e.toProfileStats()}}},[e._v("\n          "+e._s(e.$vuetify.rtl?"mdi-arrow-right":"mdi-arrow-left")+"\n        ")])],1)],1)],1),e._v(" "),s("v-flex",{attrs:{xs12:"","mb-1":""}},[s("v-layout",{staticClass:"podium-layout",attrs:{row:"",wrap:"","mx-0":""}},[s("v-flex",{class:e.isOverviewDisplay?"mb-7":"",attrs:{"d-flex":"","justify-center":"","align-end":""}},[e.leaderBoardArray[1]?s("div",{staticClass:"transparent mx-1 align-center"},[s("exo-user-avatar",{attrs:{"profile-id":e.leaderBoardArray[1].remoteId,size:40,"extra-class":"me-2 ml-2 pa-0 mt-0 mb-1 rounded-circle elevation-1 d-inline-block",avatar:"",popover:"","popover-left-position":""}}),e._v(" "),s("v-card-text",{staticClass:"top2 grey lighten-1 px-3 py-2 flex d-flex white--text justify-center font-weight-bold",staticStyle:{height:"40px"}},[e._v("\n            "+e._s(e.leaderBoardArray[1].score)+"\n          ")])],1):e._e(),e._v(" "),e.leaderBoardArray[0]?s("div",{staticClass:"transparent mx-1 align-center"},[s("exo-user-avatar",{attrs:{"profile-id":e.leaderBoardArray[0].remoteId,size:40,"extra-class":"ml-2 me-2 pa-0 mt-0 mb-1 rounded-circle elevation-1 d-inline-block",avatar:"",popover:"","popover-left-position":""}}),e._v(" "),s("v-card-text",{staticClass:"top1 yellow darken-1 px-3 py-2 flex d-flex white--text justify-center font-weight-bold",staticStyle:{height:"55px"}},[e._v("\n            "+e._s(e.leaderBoardArray[0].score)+"\n          ")])],1):e._e(),e._v(" "),e.leaderBoardArray[2]?s("div",{staticClass:"transparent mx-1 align-center"},[s("exo-user-avatar",{attrs:{"profile-id":e.leaderBoardArray[2].remoteId,size:40,"extra-class":"me-2 ml-2 pa-0 mt-0 mb-1 rounded-circle elevation-1 d-inline-block",avatar:"",popover:"","popover-left-position":""}}),e._v(" "),s("v-card-text",{staticClass:"top3 amber darken-1 px-3 pb-1 flex d-flex white--text justify-center font-weight-bold pt-2px",staticStyle:{height:"25px"}},[e._v("\n            "+e._s(e.leaderBoardArray[2].score)+"\n          ")])],1):e._e()])],1)],1),e._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-list",{attrs:{height:"110"}},[e._l(e.listBelowPoduim,(function(t){return[t?[s("v-list-item",{key:t.remoteId,staticClass:"py-0 px-4 mt-n3"},[s("v-card",{staticClass:"me-2",attrs:{"min-width":"16",flat:""}},[e._v("\n              "+e._s(t.rank)+"\n            ")]),e._v(" "),s("exo-user-avatar",{attrs:{"profile-id":t.remoteId,size:25,"bold-title":t.socialId===e.identityId,"extra-class":"me-0 pa-0 my-0 text-truncate-2","popover-left-position":"","offset-x":"",popover:""}}),e._v(" "),s("v-list-item-action",{staticClass:"ml-auto"},[s("span",[e._v(e._s(t.score))])])],1)]:e._e()]}))],2)],1)],1)};f._withStripped=!0;var g=p({props:{isOverviewDisplay:{type:Boolean,default:()=>!1}},data:()=>({leaderBoardArray:[],listBelowPoduim:[],identityId:eXo.env.portal.profileOwnerIdentityId}),created(){this.getUsersByGamificationRank()},methods:{getUsersByGamificationRank(){("WEEK",fetch("/portal/rest/gamification/leaderboard/rank/all?loadCapacity=false&period=WEEK",{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting users by gamification rank")}))).then((e=>{document.dispatchEvent(new CustomEvent("listOfRankedConnections",{detail:e.length}));const t=eXo.env.portal.profileOwner,s=e.findIndex((e=>e.remoteId===t))+1;for(const t of e)this.leaderBoardArray.push(t);if(6===e.length||e.length>6&&s<7)for(let t=3;t<6;t++)this.listBelowPoduim.push(e[t]);else if(e.length<=3)for(const t of e)this.listBelowPoduim.push(t);else if(e.length>3&&e.length<6||s===e.length)for(let t=e.length-3;t<e.length;t++)this.listBelowPoduim.push(e[t]);else for(let t=s-2;t<s+1;t++)this.listBelowPoduim.push(e[t])}))},toProfileStats(){this.$emit("isProfileStats")}}},f,[],!1,null,null,null);g.options.__file="src/main/webapp/vue-app/profileStats/components/GamificationRank.vue";const w=g.exports;var S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-layout",{attrs:{row:"",wrap:"","mx-0":""}},[s("v-flex",{attrs:{"d-flex":"",xs12:"","my-5":""}},[s("v-layout",{attrs:{row:"",wrap:"","mx-2":"","align-start":""}},[s("v-flex",{attrs:{"d-flex":"",xs12:"","mt-n2":"","justify-center":""}},[s("div",[s("span",{staticClass:"pe-2 text-uppercase spaceRequestedTitle subtitle-2 profile-card-header",on:{click:function(t){return e.openSpaceRequests()}}},[e._v(e._s(this.$t("homepage.profileStatus.spaceRequests")))]),e._v(" "),s("v-btn",{staticClass:"mb-1 header-badge-color",attrs:{fab:"",depressed:"",dark:"",height:"20",width:"20"}},[s("span",{staticClass:"white--text caption"},[e._v(e._s(e.spacesRequestsSize))])])],1)])],1)],1),e._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-list",[e._l(e.sort(e.spacesRequests),(function(t){return[s("v-list-item",{key:t.id,staticClass:"py-0 px-2"},[s("v-list-item-avatar",{staticClass:"my-1 me-2",attrs:{size:"30"}},[s("v-img",{attrs:{src:t.avatar}})],1),e._v(" "),s("v-list-item-content",{staticClass:"py-0"},[s("v-list-item-title",{staticClass:"font-weight-bold subtitle-2 request-user-name darken-2",domProps:{textContent:e._s(t.displayName)}}),e._v(" "),s("v-list-item-subtitle",{staticClass:"caption grey-color",domProps:{textContent:e._s(t.description)}})],1),e._v(" "),s("v-list-item-action",[s("v-btn-toggle",{staticClass:"transparent",attrs:{dark:""}},[s("v-btn",{staticClass:"px-0 connexion-accept-btn",attrs:{text:"",icon:"",small:"","min-width":"auto"},on:{click:function(s){return e.replyInvitationToJoinSpace(t.id,"approved")}}},[s("v-icon",{attrs:{color:"primary-color",size:"20"}},[e._v("mdi-checkbox-marked-circle")])],1),e._v(" "),s("v-btn",{staticClass:"px-0 connexion-refuse-btn",attrs:{text:"",icon:"",small:"","min-width":"auto"},on:{click:function(s){return e.replyInvitationToJoinSpace(t.id,"ignored")}}},[s("v-icon",{attrs:{color:"grey lighten-1",size:"20"}},[e._v("mdi-close-circle")])],1)],1)],1)],1)]}))],2)],1),e._v(" "),s("v-flex",{attrs:{"d-flex":"",xs12:"","px-4":"","pb-2":"","justify-center":""}},[e.spacesRequestsSize>3?s("v-btn",{staticClass:"caption text-uppercase grey--text",attrs:{depressed:"",small:"",href:e.invitationSpaceUrl}},[e._v("\n      "+e._s(this.$t("homepage.seeAll"))+"\n    ")]):e._e()],1)],1)};S._withStripped=!0;var x=p({data:()=>({spacesRequests:[],spacesRequestsSize:"",invitationSpaceUrl:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/invitationSpace`}),created(){this.getSpacesRequests()},methods:{getSpacesRequests(){this.spacesRequests=[],o().then((e=>{if(this.spacesRequestsSize=e.size,this.$emit("showRequestsSpace",this.spacesRequestsSize),this.spacesRequestsSize>0)for(let t=0;t<e.spacesMemberships.length;t++){const s={};s.id=e.spacesMemberships[t].id,fetch(`${e.spacesMemberships[t].space}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting space")})).then((e=>{s.avatar=e.avatarUrl||e.avatarUrl||`/portal/rest/v1/social/spaces/${s.id.split(":")[0]}/avatar`,s.displayName=e.displayName,this.spacesRequests.splice(t,0,s)}))}}))},sort:e=>e.slice().sort((function(e,t){return e.displayName.localeCompare(t.displayName)})),openSpaceRequests(){window.location.href=`${this.invitationSpaceUrl}`},replyInvitationToJoinSpace(e,t){(function(e,t){const s={status:`${t}`};return fetch(`/portal/rest/v1/social/spacesMemberships/${e}`,{method:"PUT",credentials:"include",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when replying invitation to join space")}))})(e,t).then((()=>{if("approved"===t){const t=this.spacesRequests.filter((t=>t.id===e))[0],s={id:t.id,displayName:t.displayName,avatarUrl:t.avatar};this.$emit("invitationReplied",s)}this.getSpacesRequests()}))}}},S,[],!1,null,null,null);x.options.__file="src/main/webapp/vue-app/profileStats/components/SpacesRequests.vue";const _=x.exports;var C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"d-flex flex-column full-height full-width"},[s("div",{staticClass:"flex d-flex flex-grow-0 flex-shrink-1"},[e.overviewDisplay&&!e.hasZeroPoints?s("v-layout",{attrs:{row:"",wrap:"","align-start":"","mx-0":""}},[s("v-flex",{attrs:{"d-flex":""}},[s("div",[s("span",{staticClass:"subtitle-2 profile-card-header text-color"},[e._v(e._s(e.$t("overview.myContributions.points")))])])])],1):e.overviewDisplay?e._e():s("v-layout",{attrs:{row:"",wrap:"","align-start":"","mx-4":"","mt-4":""}},[s("v-flex",{attrs:{"d-flex":"",xs1:""}},[s("v-icon",{attrs:{color:"grey darken-2",size:"20"},on:{click:function(t){return e.$emit("isProfileStats")}}},[e._v("\n          "+e._s(e.$vuetify.rtl?"mdi-arrow-right":"mdi-arrow-left")+"\n        ")])],1),e._v(" "),s("v-flex",{attrs:{"d-flex":"",xs10:"","justify-center":""}},[s("div",[s("span",{staticClass:"pe-6 text-uppercase subtitle-2 profile-card-header text-color"},[e._v(e._s(e.$t("homepage.profileStatus.weeklyPoints")))])])]),e._v(" "),e.hasZeroPoints?e._e():s("v-flex",{staticClass:"text-right",attrs:{"d-flex":"",xs1:""}},[s("i",{staticClass:"uiIconInformation clickable primary--text my-auto ms-3 pb-2",on:{click:e.openHistoryDrawer}})])],1)],1),e._v(" "),e.hasZeroPoints?s("v-list",{staticClass:"d-flex flex-shrink-0 flex-grow-1",attrs:{height:"180"}},[s("v-list-item",[s("v-list-item-icon",{staticClass:"my-auto"},[s("v-icon",{staticClass:"secondary--text me-1",attrs:{size:"65"}},[e._v("fas fa-chart-pie")])],1),e._v(" "),s("v-list-item-content",[s("div",{staticClass:"d-flex flex-grow-0 flex-shrink-1"},[s("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.$t("overview.myContributions.zeroPoints.description",{0:"<a href='"+e.challengesURL+"' class='primary--text font-weight-bold' rel='nofollow noreferrer noopener'>"+e.$t("overview.myContributions.zeroPoints.description.this")+"</a>"}),expression:"$t('overview.myContributions.zeroPoints.description', {0: `<a href='${challengesURL}' class='primary--text font-weight-bold' rel='nofollow noreferrer noopener'>${$t('overview.myContributions.zeroPoints.description.this')}</a>`})"}],staticClass:"align-self-center text-wrap text-left text-break"})])])],1)],1):s("v-card",{staticClass:"flex full-width flex-grow-1",attrs:{loading:e.displayLoadingChart,flat:""}},[s("div",{staticClass:"d-flex flex-row full-height full-width subtitle-2 text-color"},[e.overviewDisplay?s("div",{staticClass:"col-5 ps-0 pe-1"},e._l(e.programLabels,(function(t){return s("v-tooltip",{key:t.name,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(i){var a=i.on;return[s("h6",e._g({staticClass:"text-truncate-2 font-weight-light my-1"},a),[s("div",{staticClass:"d-inline-block"},[s("v-card",{staticClass:"me-1 mb-n1",attrs:{color:t.color,"min-width":"30px",width:"30px",height:"17px",flat:""}})],1),e._v("\n              "+e._s(t.name)+"\n            ")])]}}],null,!0)},[e._v(" "),s("span",[e._v(e._s(t.name))])])})),1):e._e(),e._v(" "),s("div",{staticClass:"flex my-auto",style:e.pieChartDimensions,attrs:{id:"echartUserPoints"}})])])],1)};C._withStripped=!0;var y=p({props:{overviewDisplay:{type:Boolean,default:!1}},data:()=>({userPoints:0,period:"WEEK",programLabels:[],loading:!0,colors:["#4ad66d","#ffe169","#ff8fa3","#20a8ea","#C155F4","#F7A35B","#A0C7FF","#FD6A6A","#059d98","#b7efc5","#dbb42c","#c9184a","#1273d4","#E65ABC","#00FF56","#B1F6FF","#FFFF46","#26a855","#f10000","#208b3a","#c9a227","#ffccd5","#134d9b","#E66CDC","#58D68B","#5CE6D3","#f16a27","#ac1c1e","#eda3ff","#1a7431","#a47e1b","#ff4d6d","#62b0de","#FF97D0","#92e03a","#f44336","#3d6d8a","#E0A5FF","#FF9DB8","#808080"]}),computed:{option(){return{title:[{text:this.$t("overview.myContributions.Total"),textStyle:{fontStyle:"normal",color:"#4d5466",fontWeight:"normal",fontSize:"16"},subtext:"",subtextStyle:{fontStyle:"normal",color:"#4d5466",fontWeight:"bold",fontSize:"18",lineHeight:22},left:"center",top:"43%"}],tooltip:{trigger:"item",formatter:"{b} : {c} ({d}%)",position:["center","center"]},series:[{type:"pie",radius:["50%","90%"],center:["50%","50%"],label:{show:!1},color:this.colors}]}},pieChartDimensions(){return this.overviewDisplay?"width:100%; height:100%;":"width:100%; height:220px;"},challengesURL:()=>`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges`,displayLoadingChart(){return!this.overviewDisplay&&this.loading},hasZeroPoints(){return 0===this.userPoints&&!this.loading}},created(){this.loading=!0,Promise.all([this.getGamificationPointsStats(),this.getGamificationPoints()]).finally((()=>this.loading=!1))},methods:{getGamificationPoints(){return this.$nextTick().then((()=>r(this.period).then((e=>{this.userPoints=e.points,0!==e.points&&this.$emit("seeAll",!0),this.option.title[0].subtext=e.points}))))},getGamificationPointsStats(){return(e=this.period,fetch(`/portal/rest/gamification/leaderboard/stats?username=${eXo.env.portal.profileOwner}&period=${e||""}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting gamification points stats")}))).then((e=>{this.option.series[0].data=[];const t=[];for(let s=0;s<e.length;s++){const i=e[s].label;let a,o;a=this.$t(`exoplatform.gamification.gamificationinformation.domain.${i.charAt(0).toUpperCase()}${i.slice(1)}`).includes("exoplatform.gamification.gamificationinformation.domain")?i.charAt(0).toUpperCase()+i.slice(1):this.$t(`exoplatform.gamification.gamificationinformation.domain.${i.charAt(0).toUpperCase()}${i.slice(1)}`),s>4?(o={name:this.$t("exoplatform.gamification.gamificationinformation.domain.others"),value:this.option.series[0].data[4].value+e[s].value},this.option.series[0].data[4]=o):(o={name:a,value:e[s].value},this.option.series[0].data.push(o)),s<=4?t.push({name:o.name,color:this.colors[s]}):t[4].name=o.name}return this.programLabels=t,this.$nextTick()})).finally((()=>this.initChart(this.option)));var e},initChart(e){return new Promise((t=>{window.require(["SHARED/eCharts"],(s=>{t(s),this.$emit("loaded",!1),this.$nextTick().then((()=>{const t=document.getElementById("echartUserPoints");t?s.init(t).setOption(e,!0):window.setTimeout((()=>{this.initChart(e)}),50)}))}))}))},openHistoryDrawer(){this.$root.$emit("open-achievement",this.userPoints)}}},C,[],!1,null,null,null);y.options.__file="src/main/webapp/vue-app/profileStats/components/UserPointsWidget.vue";const b=y.exports;var $=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-flex",{attrs:{"d-flex":"","flex-column":"",xs12:"",sm12:""}},[s("v-toolbar",{staticClass:"border-box-sizing profile-card-header flex-column flex-shrink-1 flex-grow-0",attrs:{height:"64",color:"white",flat:""}},[s("div",{staticClass:"text-header-title text-sub-title"},[e._v("\n      "+e._s(e.title)+"\n    ")])]),e._v(" "),s("v-layout",{attrs:{row:"",wrap:"","mx-0":""}},[s("v-flex",{attrs:{"d-flex":"",xs12:""}},[s("v-layout",{attrs:{row:"","mx-0":""}},[s("v-flex",{attrs:{id:"profile-stats-spacesCount",xs6:"","d-flex":"","justify-center":"","align-center":""}},[s("v-card",{attrs:{flat:""}},[s("a",{staticClass:"white--text"},[s("v-badge",{staticClass:"badge-color",attrs:{value:e.isCurrentUserProfile&&e.spacesRequestsSize>0}},[s("v-btn",{attrs:{slot:"badge",icon:"",dark:"",height:"22",width:"22"},on:{click:e.openSpaceDrawer},slot:"badge"},[e._v(e._s(e.spacesRequestsSize)+"\n                ")]),e._v(" "),s("div",{staticClass:"headline text-color font-weight-bold pa-1",on:{click:e.openSpaceDrawer}},[s("span",[e._v(e._s(e.isCurrentUserProfile?e.spacesSize:e.commonsSpaceDefaultSize))])])],1)],1),e._v(" "),s("v-card-text",{staticClass:"pa-1 subtitle-1 text-color"},[s("span",[e._v(e._s(e.isCurrentUserProfile?e.$t("homepage.profileStatus.spaces"):e.$t("homepage.profileStatus.Commonspaces")))])])],1)],1),e._v(" "),s("v-flex",{attrs:{id:"profile-stats-connectionsCount","d-flex":"",xs6:"","justify-center":"","align-center":""}},[s("v-card",{attrs:{tile:"",flat:""}},[s("a",{staticClass:"white--text"},[s("v-badge",{staticClass:"badge-color",attrs:{value:e.isCurrentUserProfile&&e.connectionsRequestsSize>0,"pa-0":""}},[s("v-btn",{attrs:{slot:"badge",icon:"",dark:"",height:"20",width:"20"},on:{click:e.openConnectionsDrawer},slot:"badge"},[e._v(e._s(e.connectionsRequestsSize))]),e._v(" "),s("div",{staticClass:"headline text-color font-weight-bold pa-1",on:{click:e.openConnectionsDrawer}},[s("span",[e._v(e._s(e.isCurrentUserProfile?e.connectionsSize:e.commonConnectionsSize))])])],1)],1),e._v(" "),s("v-card-text",{staticClass:"pa-1 subtitle-1 text-color"},[s("span",[e._v(e._s(e.isCurrentUserProfile?e.$t("homepage.profileStatus.connections"):e.$t("homepage.commonConnections.label")))])])],1)],1)],1)],1),e._v(" "),s("v-flex",{attrs:{"d-flex":"",xs12:"","align-center":""}},[s("v-layout",{attrs:{row:"","mx-0":""}},[s("v-flex",{attrs:{id:"profile-stats-weeklyPoints",xs6:"","d-flex":"","justify-center":"","align-center":""}},[s("v-card",{attrs:{flat:""}},[s("a",{on:{click:function(t){return e.getSpecificCard("user-points-widget")}}},[s("v-card-text",{staticClass:"headline text-color font-weight-bold pa-1"},[s("span",[e._v(e._s(e.userPoints))])]),e._v(" "),s("v-card-text",{staticClass:"pa-1 subtitle-1 text-color"},[s("span",[e._v(e._s(e.$t("homepage.profileStatus.weeklyPoints")))])])],1)])],1),e._v(" "),s("v-flex",{attrs:{id:"profile-stats-weeklyRank","d-flex":"",xs6:"","justify-center":"","align-center":""}},[s("v-card",{attrs:{flat:"","align-center":""}},[s("a",{on:{click:function(t){return e.getSpecificCard("gamification-rank")}}},[s("v-card-text",{staticClass:"headline text-color font-weight-bold pa-1"},[s("span",[e._v(e._s(e.gamificationRank))])]),e._v(" "),s("v-card-text",{staticClass:"pa-1 subtitle-1 text-color"},[s("span",[e._v(e._s(e.$t("homepage.profileStatus.weeklyRank")))])])],1)])],1)],1)],1)],1)],1)};$._withStripped=!0;const k={props:{commonsSpaceDefaultSize:{type:Number,default:0},isCurrentUserProfile:{type:Boolean,default:!1},commonConnectionsSize:{type:Number,default:0}},data:()=>({period:"WEEK",firstName:"",avatar:"",spacesSize:"",spacesRequestsSize:"",connectionsSize:"",connectionsRequestsSize:"",gamificationRank:"",userPoints:"",loadingWidgets:!1,profileUrl:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile`,spacesUrl:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/spaces`,connexionsUrl:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/connexions/network`,firstLoadingName:!0,firstLoadingSpaces:!0,firstLoadingConnexion:!0,firstLoadingUserPoints:!0,firstLoadingRank:!0}),computed:{title(){return this.isCurrentUserProfile&&this.$t("homepage.profileStatus.yourActivity")||this.$t("homepage.profileStatus.myActivity")}},watch:{loadingWidgets(e,t){e||e===t||this.$nextTick().then((()=>this.$root.$applicationLoaded()))}},created(){document.addEventListener("userModified",(e=>{e&&e.detail&&(this.avatar=e.detail.avatar||e.detail.avatarUrl,this.firstName=e.detail.firstname)})),this.profileUrl=this.profileUrl+(this.isCurrentUserProfile?"":`/${eXo.env.portal.profileOwner}`),this.loadingWidgets=!0,Promise.all([this.retrieveUserData(),this.getSpacesRequestsSize(),this.getConnectionsRequestsSize(),this.getGamificationRank(),this.getGamificationPoints()]).finally((()=>this.loadingWidgets=!1))},methods:{retrieveUserData(){return fetch(`/portal/rest/v1/social/users/${eXo.env.portal.profileOwner}?expand=spacesCount,connectionsCount`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting user informations")})).then((e=>{this.avatar=e.avatar||e.avatarUrl,this.firstName=e.firstname,this.firstLoadingName&&(this.firstLoadingName=!1),this.spacesSize=e.spacesCount,this.firstLoadingSpaces&&(this.firstLoadingSpaces=!1),this.connectionsSize=e.connectionsCount,this.firstLoadingConnexion&&(this.firstLoadingConnexion=!1)}))},getSpacesRequestsSize(){return o().then((e=>{this.spacesRequestsSize=e.size,this.$emit("showRequestsSpace",this.spacesRequestsSize)}))},getConnectionsRequestsSize(){return n().then((e=>{this.connectionsRequestsSize=e.size,this.$emit("shouldShowRequests",this.connectionsRequestsSize)}))},getGamificationRank(){return fetch(`/portal/rest/gamification/reputation/status?username=${eXo.env.portal.profileOwner}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting the user reputation status")})).then((e=>{this.gamificationRank=e.rank,this.firstLoadingRank&&(this.firstLoadingRank=!1)}))},getGamificationPoints(){return r(this.period).then((e=>{this.userPoints=e.points,this.firstLoadingUserPoints&&(this.firstLoadingUserPoints=!1)}))},getSpecificCard(e){this.$emit("specific-card",e)},openConnectionsDrawer(){this.$emit("openConnectionsDrawer")},openSpaceDrawer(){this.$emit("openSpaceDrawer")},toProfileStats(){this.$emit("isProfileStats")}}};var R=p(k,$,[],!1,null,null,null);R.options.__file="src/main/webapp/vue-app/profileStats/components/UserDashbord.vue";const z=R.exports;var L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-list-item",{staticClass:"ma-4 px-0",attrs:{href:e.achievementUrl,"two-line":""}},[e.isSpace?s("exo-space-avatar",{attrs:{"space-pretty-name":e.remoteId,"extra-class":"me-2",avatar:"",popover:""}}):s("exo-user-avatar",{attrs:{"profile-id":e.remoteId,"extra-class":"me-2",avatar:"",popover:""}}),e._v(" "),s("v-list-item-content",{staticClass:"py-0"},[s("v-list-item-title",{attrs:{title:e.actionTitle}},[e._v("\n      "+e._s(e.actionTitle)+"\n    ")]),e._v(" "),s("v-list-item-subtitle",{attrs:{title:e.actionDetail}},[e._v("\n      "+e._s(e.actionDetail)+"\n    ")])],1),e._v(" "),s("v-list-item-icon",{staticClass:"my-auto"},[s("v-avatar",{attrs:{color:"primary",size:"32"}},[e._v("\n      "+e._s(e.achievement.actionScore)+"\n    ")])],1)],1)};L._withStripped=!0;var P=p({props:{achievement:{type:Object,default:()=>({})}},data:()=>({id:`avatar${parseInt(1e4*Math.random()).toString().toString()}`,lang:eXo.env.portal.language,dateFormat:{dateStyle:"long",timeStyle:"short"}}),computed:{isSender(){return Number(this.identityId)===Number(eXo.env.portal.profileOwnerIdentityId)},isSpace(){return this.achievement.space},avatar(){return this.achievement.avatarUrl||this.achievement.avatar},fullName(){return this.achievement.fullname},remoteId(){return this.achievement.remoteId},identityId(){return this.achievement.socialId},achievementUrl(){return this.achievement.objectId&&this.achievement.objectId.replace("/portal/intranet/",`${eXo.env.portal.context}/${eXo.env.portal.portalName}/`)},domain(){return this.getLabel("exoplatform.gamification.leaderboard.domain",this.achievement.domain)},actionDetail(){return`${this.dateTime} - ${this.$t("exoplatform.gamification.gamificationinformation.Domain")}: ${this.domain}`},actionTitle(){return this.getLabel("exoplatform.gamification.gamificationinformation.rule.title",this.achievement.actionTitle)},dateTime(){const e=new Date(this.achievement.createdDate);return new window.Intl.DateTimeFormat(this.lang,this.dateFormat).format(e)}},methods:{getLabel(e,t){const s=`${e}.${t}`,i=this.$t(s);return i===s&&t||i}}},L,[],!1,null,null,null);P.options.__file="src/main/webapp/vue-app/profileStats/components/AchievementItem.vue";const D=P.exports;var q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("exo-drawer",{ref:"achievementsDrawer",staticClass:"achievementsDrawer",attrs:{"body-classes":"hide-scroll decrease-z-index-more",right:""}},[s("template",{slot:"titleIcons"},[s("a",{staticClass:"d-inline-block mb-1",attrs:{href:e.infoUrl,title:e.$t("exoplatform.gamification.leaderboard.Howearnpoints")}},[s("i",{staticClass:"uiIconInformation text-sub-title"})])]),e._v(" "),s("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("exoplatform.gamification.gamificationinformation.achievements"))+"\n  ")]),e._v(" "),s("template",{slot:"content"},[s("div",{staticClass:"d-flex"},[s("div",{staticClass:"d-block text-center pa-5 mx-auto my-5 border-radius border-color"},[s("div",{staticClass:"d-block-inline pull-left mt-2"},[s("v-icon",{attrs:{color:"tertiary",size:"36"}},[e._v("fa-trophy")])],1),e._v(" "),s("div",{staticClass:"d-block-inline pull-right px-2"},[s("div",{staticClass:"caption"},[e._v("\n            "+e._s(e.$t("homepage.profileStatus.weeklyPoints"))+"\n          ")]),e._v(" "),s("div",{staticClass:"title"},[e._v("\n            "+e._s(e.userPoints)+"\n          ")])])])]),e._v(" "),e.achievements?s("v-list",e._l(e.achievements,(function(e,t){return s("achievement-item",{key:t,attrs:{achievement:e}})})),1):e._e()],1),e._v(" "),e.hasMore?s("template",{slot:"footer"},[s("v-spacer"),e._v(" "),s("v-btn",{staticClass:"loadMoreButton ma-auto btn",attrs:{loading:e.loading,disabled:e.loading,block:""},on:{click:e.loadMore}},[e._v("\n      "+e._s(e.$t("exoplatform.gamification.leaderboard.showMore"))+"\n    ")]),e._v(" "),s("v-spacer")],1):e._e()],2)};q._withStripped=!0;var U=p({data:()=>({pageSize:20,userPoints:0,loading:!1,limit:20,achievements:[]}),computed:{infoUrl:()=>`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs`,hasMore(){return this.loading||this.achievements.length>=this.limit}},methods:{reset(){this.limit=20,this.achievements=[]},open(e){this.reset(),this.retrieveList(),this.userPoints=e,this.$refs.achievementsDrawer.open()},loadMore(){this.loading=!0,this.limit+=this.pageSize,this.retrieveList()},retrieveList(){return this.$refs.achievementsDrawer.startLoading(),("user",e=eXo.env.portal.profileOwner,t=this.limit,fetch(`/portal/rest/gamification/gameficationinformationsboard/history/all?capacity=${t}&providerId=user&remoteId=${e}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting achievements")}))).then((e=>this.achievements=e||[])).finally((()=>{this.loading=!1,this.$refs.achievementsDrawer.endLoading()}));var e,t}}},q,[],!1,null,null,null);U.options.__file="src/main/webapp/vue-app/profileStats/components/AchievementsDrawer.vue";const E=U.exports;var I=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("exo-drawer",{ref:"connectionsDrawer",staticClass:"connectionsDrawer",attrs:{"body-classes":"hide-scroll decrease-z-index-more",right:""},on:{closed:function(t){return e.$emit("closed")}},scopedSlots:e._u([{key:"title",fn:function(){return[e.showSearch?s("v-row",[s("v-text-field",{staticClass:"connectionsSearch pa-0 my-n2",attrs:{placeholder:e.$t("profile.label.search.connections"),"single-line":"",solo:"",flat:"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1):s("span",{staticClass:"connectionsDrawerTitle"},[e._v(e._s(e.$t("homepage.profileStatus.connections")))])]},proxy:!0},{key:"titleIcons",fn:function(){return[e.showSearch?s("v-btn",{attrs:{icon:""},on:{click:e.closeConnectionSearch}},[s("v-icon",{attrs:{size:"20"}},[e._v("mdi-filter-remove")])],1):s("v-btn",{attrs:{icon:""},on:{click:e.openConnectionSearch}},[s("v-icon",{attrs:{size:"20"}},[e._v("mdi-filter")])],1)]},proxy:!0},{key:"content",fn:function(){return[s("div",{staticClass:"overflow-hidden"},[e.isCurrentUserProfile?s("div",[e.showConnectionRequests&&!e.showSearch?s("div",[s("v-row",{staticClass:"connectionsRequests px-2"},[s("v-col",{staticClass:"pb-0"},[s("connections-requests",{on:{invitationReplied:e.refreshConnections,shouldShowRequests:e.updateRequestsSize}})],1)],1),e._v(" "),s("v-row",{staticClass:"seeAllRequests"},[s("v-col",{staticClass:"align-center py-0"},[s("v-btn",{staticClass:"caption text-uppercase grey--text ma-0",attrs:{depressed:"",small:"",href:e.receivedInvitationsUrl}},[e._v("\n                "+e._s(e.$t("homepage.seeAll"))+"\n              ")])],1)],1)],1):e._e()]):s("div",[e.showSuggestions&&!e.showSearch?s("div",[s("v-row",{staticClass:"peopleSuggestions px-2"},[s("v-col",[s("v-row",{staticClass:"align-center"},[s("v-col",[s("span",{staticClass:"pe-2 text-uppercase subtitle-2 profile-card-header"},[e._v(e._s(e.$t("homepage.suggestions.label")))])])],1),e._v(" "),s("v-list",e._l(e.peoplesToDisplay,(function(t){return s("exo-suggestions-people-list-item",{key:t.suggestionId,attrs:{people:t,"people-suggestions-list":e.peopleSuggestionsList}})})),1)],1)],1)],1):e._e()]),e._v(" "),e.isCurrentUserProfile&&e.showConnectionRequests&&!e.showSearch||!e.isCurrentUserProfile&&e.showSuggestions&&!e.showSearch?s("v-row",{staticClass:"px-2"},[s("v-col",{staticClass:"pb-0"},[s("v-divider",{staticClass:"my-0"})],1)],1):e._e(),e._v(" "),s("v-row",{staticClass:"ma-0 px-2"},[s("v-col",{staticClass:"py-1 px-0"},[e.showConnections?s("div",[s("v-row",{attrs:{align:"center"}},[s("v-col",[s("span",{staticClass:"pe-2 text-uppercase subtitle-2 profile-card-header"},[e._v(e._s(e.isCurrentUserProfile?e.$t("homepage.profileStatus.connectionsList"):e.$t("homepage.commonConnections.label")))]),e._v(" "),s("v-btn",{staticClass:"mb-1 header-badge-color",attrs:{fab:"",depressed:"",dark:"",height:"20",width:"20"}},[s("span",{staticClass:"white--text caption"},[e._v(e._s(e.isCurrentUserProfile?e.connections.length:e.commonConnections.length))])])],1)],1)],1):e._e(),e._v(" "),e.isCurrentUserProfile?s("div",[e.showConnections?s("div",{class:(e.showMore?"showMore ":"").concat(e.showConnectionRequests&&!e.showSearch?"requestsNotEmpty":"")},e._l(e.filteredConnections,(function(t){return s("people-list-item",{key:t.id,attrs:{person:t,people:e.filteredConnections}})})),1):s("div",[s("v-row",{staticClass:"d-flex text-center noPeopleYetBlock my-12"},[s("div",{staticClass:"ma-auto noPeopleYet"},[s("p",{staticClass:"noPeopleYetIcons"},[s("v-icon",[e._v("fa-users")])],1),e._v(" "),s("p",{staticClass:"title font-weight-bold"},[e._v("\n                    "+e._s(e.$t("peopleList.label.noConnection"))+"\n                  ")])])])],1)]):s("div",{staticClass:"connectionsItems",class:e.showSuggestions&&!e.showSearch?"suggestionsNotEmpty":""},e._l(e.filteredCommonConnections,(function(t){return s("people-list-item",{key:t.id,attrs:{person:t,people:e.filteredCommonConnections}})})),1)])],1)],1)]},proxy:!0},e.isCurrentUserProfile&&e.connections&&e.showMore?{key:"footer",fn:function(){return[s("v-btn",{staticClass:"text-uppercase caption ma-auto btn",attrs:{block:""},on:{click:e.loadNextPage}},[e._v("\n      "+e._s(e.$t("homepage.loadMore"))+"\n    ")])]},proxy:!0}:null],null,!0),model:{value:e.connectionsDrawer,callback:function(t){e.connectionsDrawer=t},expression:"connectionsDrawer"}})};I._withStripped=!0;var T=p({props:{connectionRequests:{type:Number,default:0},isCurrentUserProfile:{type:Boolean,default:!1},commonConnections:{type:Array,default:function(){return[]}}},data:()=>({connections:[],showSearch:!1,connectionsDrawer:!1,search:null,PROFILE_URI:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/`,receivedInvitationsUrl:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/connexions/receivedInvitations`,connexionsSize:0,limit:10,peopleSuggestionsList:[]}),computed:{filteredConnections(){return this.search?this.connections.filter((e=>e.fullname.toLowerCase().match(this.search.toLowerCase()))):this.connections},filteredCommonConnections(){return this.search?this.commonConnections.filter((e=>e.fullname.toLowerCase().match(this.search.toLowerCase()))):this.commonConnections},showConnections(){return this.connections&&this.connections.length>0},showConnectionRequests(){return this.connectionRequests>0},showSuggestions(){return this.peopleSuggestionsList.length>0},showMore(){return this.connexionsSize>this.connections.length},peoplesToDisplay(){return this.peopleSuggestionsList.slice(0,2)}},methods:{open(){this.$refs.connectionsDrawer.startLoading(),this.$refs.connectionsDrawer.open(),this.init().finally((()=>this.$refs.connectionsDrawer.endLoading()))},close(){this.showSearch=!1,this.$refs.connectionsDrawer.close()},loadNextPage(){this.limit+=10,this.$refs.connectionsDrawer.startLoading(),this.init().finally((()=>this.$refs.connectionsDrawer.endLoading()))},init(){return this.isCurrentUserProfile?(this.connections=[],this.getConnections(0)):this.getConnections(0,0).then((()=>this.initPeopleSuggestionsList()))},getConnections(e,t){return function(e,t,s,i){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/users/${eXo.env.portal.profileOwner}/connections?q=&offset=${t||0}&limit=${s||0}&expand=&returnSize=true`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}(0,e,t>=0?t:this.limit).then((e=>{this.connexionsSize=e.size,this.connections.push(...e.users),this.connections.forEach((e=>{e.profileLink=this.PROFILE_URI+e.username}))}))},refreshConnections(e){this.connections.unshift(e)},updateRequestsSize(e){this.connectionRequests=e},closeConnectionSearch(){this.search=null,this.showSearch=!1},openConnectionSearch(){this.showSearch=!0},initPeopleSuggestionsList(){this.$userService.getUserSuggestions().then((e=>{this.peopleSuggestionsList=e.items;const t=this.connections.map((e=>e.username));this.peopleSuggestionsList.filter((e=>{t.some((t=>e.username===t))}))}))}}},I,[],!1,null,null,null);T.options.__file="src/main/webapp/vue-app/profileStats/components/ConnectionsDrawer.vue";const X=T.exports;var N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-list-item",{staticClass:"suggestions-list-item pa-0"},[s("v-list-item-avatar",{attrs:{size:e.avatarSize}},[s("v-img",{attrs:{src:e.avatarUrl}})],1),e._v(" "),s("v-list-item-content",{staticClass:"pb-3"},[s("v-list-item-title",{staticClass:"body-2 font-weight-bold text-color suggestions-list-item-title"},[s("a",{staticClass:"text-color",attrs:{href:e.url}},[e._v("\n        "+e._s(e.people.suggestionName)+"\n      ")])]),e._v(" "),s("v-list-item-subtitle",{staticClass:"caption text-sub-title suggestions-list-item-subtitle"},[s("span",[e._v(e._s(e.people.number)+" "+e._s(e.$t("homepage.profileStatus.commonConnections")))])])],1),e._v(" "),s("v-list-item-action",{staticClass:"suggestions-list-item-actions"},[s("v-btn-toggle",{staticClass:"transparent"},[s("a",{staticClass:"px-0 suggestions-btn-action connexion-accept-btn",attrs:{text:"",icon:"",small:"","min-width":"auto"},on:{click:function(t){return e.connectionRequest(e.people)}}},[s("i",{staticClass:"uiIconInviteUser"})]),e._v(" "),s("a",{staticClass:"px-0 suggestions-btn-action connexion-refuse-btn",attrs:{text:"",small:"","min-width":"auto"},on:{click:function(t){return e.ignoredConnectionUser(e.people)}}},[s("i",{staticClass:"uiIconCloseCircled"})])])],1)],1)};N._withStripped=!0;var F=p({props:{people:{type:Object,default:()=>null},avatarSize:{type:Number,default:()=>37},peopleSuggestionsList:{type:Array,default:()=>[]}},computed:{avatarUrl(){return this.people&&this.people.avatar||`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/users/${this.people.username}/avatar`},url(){return this.people&&this.people.suggestionId?`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.people.username}`:"#"}},methods:{connectionRequest(e){this.$userService.connect(e.suggestionId).then((()=>{this.peopleSuggestionsList.splice(this.peopleSuggestionsList.indexOf(e),1)}))},ignoredConnectionUser(e){this.$userService.ignore(e.username).then((()=>{this.peopleSuggestionsList.splice(this.peopleSuggestionsList.indexOf(e),1)}))}}},N,[],!1,null,null,null);F.options.__file="src/main/webapp/vue-app/profileStats/components/ExoSuggestionsPeopleListItem.vue";const j=F.exports;var O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-list-item",{staticClass:"py-0 px-2"},[s("v-list-item-avatar",{staticClass:"my-1 me-2",attrs:{size:"30"}},[s("v-img",{attrs:{src:e.person.avatar}})],1),e._v(" "),s("v-list-item-content",{staticClass:"py-0"},[s("a",{staticClass:"connectionProfileLink",attrs:{id:e.cmpId,href:e.person.profileLink,rel:"nofollow"}},[s("v-list-item-title",{staticClass:"font-weight-bold subtitle-2 request-user-name darken-2",domProps:{innerHTML:e._s(e.person.fullname)}})],1)])],1)};O._withStripped=!0;var A=p({props:{person:{type:Object,default:()=>({})},people:{type:Array,default:function(){return[]}}},data:()=>({cmpId:`react${parseInt(1e4*Math.random()).toString()}`})},O,[],!1,null,null,null);A.options.__file="src/main/webapp/vue-app/profileStats/components/PeopleListItem.vue";const B=A.exports;var M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("exo-drawer",{ref:"spaceDrawer",staticClass:"spaceDrawer",attrs:{"body-classes":"hide-scroll decrease-z-index-more",right:""},on:{closed:function(t){return e.$emit("closed")}},scopedSlots:e._u([{key:"title",fn:function(){return[e.showSearch?s("v-row",[s("v-text-field",{staticClass:"spacesSearch pa-0 my-n2",attrs:{placeholder:e.$t("profile.label.search.connections"),"single-line":"",solo:"",flat:"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1):s("span",{staticClass:"spaceDrawerTitle"},[e._v(e._s(e.$t("homepage.profileStatus.spaces")))])]},proxy:!0},{key:"titleIcons",fn:function(){return[e.showSearch?s("v-btn",{attrs:{title:e.$t("profile.label.search.closeSearch"),icon:""},on:{click:e.closeSpacesSearch}},[s("v-icon",{attrs:{size:"20"}},[e._v("mdi-filter-remove")])],1):s("v-btn",{attrs:{title:e.$t("profile.label.search.openSearch"),icon:""},on:{click:e.openSpacesSearch}},[s("v-icon",{attrs:{size:"20"}},[e._v("mdi-filter")])],1)]},proxy:!0},{key:"content",fn:function(){return[s("div",{staticClass:"overflow-hidden"},[e.isCurrentUserProfile?[e.showSpacesRequests?s("v-row",{staticClass:"px-4 ma-0"},[s("v-col",[s("spaces-requests",{on:{invitationReplied:e.refreshSpaces,showRequestsSpace:e.updateRequestsSize}})],1)],1):e._e(),e._v(" "),e.showSpacesRequests?s("v-row",{staticClass:"px-4 ma-0"},[s("v-col",[s("v-divider",{staticClass:"my-0"})],1)],1):e._e(),e._v(" "),e.showSpaces?s("v-row",{staticClass:"px-4 ma-0"},[s("v-col",[s("v-flex",{attrs:{"d-flex":"",xs12:"","justify-center":""}},[s("span",{staticClass:"pe-2 text-uppercase spaceListTitle subtitle-2 profile-card-header",on:{click:function(t){return e.openSpace()}}},[e._v(e._s(e.$t("homepage.profileStatus.spaceList")))]),e._v(" "),s("v-btn",{staticClass:"mb-1 header-badge-color",attrs:{fab:"",depressed:"",dark:"",height:"20",width:"20"},on:{click:function(t){return e.openSpace()}}},[s("span",{staticClass:"white--text caption"},[e._v(e._s(e.spacesSize))])])],1),e._v(" "),e._l(e.filteredSpaces,(function(t){return s("space-drawer-items",{key:t.id,attrs:{space:t},on:{removeLeavedSpace:e.removeLeftSpace,closeDrawer:e.close}})}))],2)],1):e._e()]:e._e(),e._v(" "),e.isCurrentUserProfile?e._e():s("v-row",{staticClass:"px-4 ma-0"},[s("v-col",[e.showSpaces?[e.spacesSuggestionsList.length>0&&"people"!==e.suggestionsType&&!e.showSearch?s("v-list",{staticClass:"py-4",attrs:{dense:""}},[s("v-flex",{attrs:{"d-flex":"",xs12:"","my-5":""}},[s("v-layout",{attrs:{row:"",wrap:"","mx-2":"","align-start":""}},[s("v-flex",{attrs:{"d-flex":"",xs12:"","mt-n2":"","justify-center":""}},[s("div",[s("span",{staticClass:"pe-2 text-uppercase spaceRequestedTitle subtitle-2 profile-card-header"},[e._v(e._s(e.$t("homepage.profileStatus.SuggestionsSpaces")))]),e._v(" "),s("v-btn",{staticClass:"mb-1 header-badge-color",attrs:{fab:"",depressed:"",dark:"",height:"20",width:"20"}},[s("span",{staticClass:"white--text caption"},[e._v(e._s(e.spacesSuggestionsList.length>3?3:e.spacesSuggestionsList.length))])])],1)])],1)],1),e._v(" "),e._l(e.suggestionSpacesToDisplay,(function(t){return s("suggestions-space-list-item",{key:t.spaceId,attrs:{"space-suggestion":t,"spaces-suggestions-list":e.spacesSuggestionsList}})}))],2):e._e(),e._v(" "),e.spacesSuggestionsList.length>0&&!e.showSearch?s("v-row",{staticClass:"px-4 ma-0"},[s("v-col",[s("v-divider",{staticClass:"my-0"})],1)],1):e._e(),e._v(" "),s("v-flex",{attrs:{"d-flex":"",xs12:"","justify-center":""}},[s("span",{staticClass:"pe-2 text-uppercase spaceListTitle subtitle-2 profile-card-header",on:{click:function(t){return e.openSpace()}}},[e._v(e._s(e.$t("homepage.profileStatus.commonSpaceList")))]),e._v(" "),s("v-btn",{staticClass:"mb-1 header-badge-color",attrs:{fab:"",depressed:"",dark:"",height:"20",width:"20"}},[s("span",{staticClass:"white--text caption"},[e._v(e._s(e.commonSpacesSize))])])],1),e._v(" "),e._l(e.filteredCommonsSpaces,(function(e){return s("space-drawer-items",{key:e.id,attrs:{space:e}})}))]:e._e()],2)],1),e._v(" "),e.showSpaces?e._e():[s("v-row",{staticClass:"d-flex text-center noSpaceYetBlock my-12"},[s("div",{staticClass:"ma-auto noSpaceYet"},[s("p",{staticClass:"noSpaceYetIcons"},[s("v-icon",[e._v("fa-users")])],1),e._v(" "),s("p",{staticClass:"title font-weight-bold"},[e._v("\n              "+e._s(e.isCurrentUserProfile?e.$t("homepage.profileStatus.noSpaces"):e.$t("homepage.profileStatus.noCommonSpaces"))+"\n            ")])])])]],2)]},proxy:!0},e.showSpaces&&e.showLoadMoreSpaces?{key:"footer",fn:function(){return[s("v-btn",{staticClass:"text-uppercase caption ma-auto btn",attrs:{block:""},on:{click:e.loadNextPage}},[e._v("\n      "+e._s(e.$t("spacesList.button.showMore"))+"\n    ")])]},proxy:!0}:null],null,!0),model:{value:e.spaceDrawer,callback:function(t){e.spaceDrawer=t},expression:"spaceDrawer"}})};M._withStripped=!0;var G=p({props:{suggestionsType:{type:String,default:"all"},spaceRequests:{type:Number,default:0},isCurrentUserProfile:{type:Boolean,default:!1},commonsSpaceDefaultSize:{type:Number,default:0}},data:()=>({spaces:[],spacesSuggestionsList:[],commonsSpaces:[],spaceDrawer:!1,offset:0,spaceSize:0,commonsSpaceSize:0,limit:10,limitToFetch:0,showSearch:!1,firstLoadingSpaces:!0,search:null}),computed:{filteredSpaces(){return this.search?this.spaces.filter((e=>e.displayName.toLowerCase().match(this.search.toLowerCase()))):this.spaces},displaySpacesSuggestions(){return!this.suggestionsType||"all"===this.suggestionsType||"space"===this.suggestionsType},suggestionSpacesToDisplay(){return this.spacesSuggestionsList.slice(0,3)},filteredCommonsSpaces(){return this.search?this.commonsSpaces.filter((e=>e.displayName.toLowerCase().match(this.search.toLowerCase()))):this.commonsSpaces},showSpaces(){return this.spaces&&this.spaces.length>0||this.commonsSpaces&&this.commonsSpaces.length||this.spacesSuggestionsList&&this.spacesSuggestionsList.length},showLoadMoreSpaces(){return this.spaceSize>this.limitToFetch||this.commonsSpaceDefaultSize>this.limitToFetch},spacesSize(){return this.search?this.spaces.filter((e=>e.displayName.toLowerCase().match(this.search.toLowerCase()))).length:this.spaces.length},commonSpacesSize(){return this.search?this.commonsSpaces.filter((e=>e.displayName.toLowerCase().match(this.search.toLowerCase()))).length:this.commonsSpaces.length},showSpacesRequests(){return this.spaceRequests>0&&!this.showSearch}},methods:{open(){this.$refs.spaceDrawer.startLoading(),this.$refs.spaceDrawer.open(),this.init().finally((()=>this.$refs.spaceDrawer.endLoading()))},close(){this.showSearch=!1,this.$refs.spaceDrawer.close()},init(){return this.limitToFetch=this.limit,this.isCurrentUserProfile?this.getMySpaces():this.getCommonsSpaces().then((()=>{this.displaySpacesSuggestions&&this.initSpaceSuggestionsList()}))},getMySpaces(){return this.firstLoadingSpaces=!1,i(this.offset,this.limitToFetch).then((e=>{this.spaces=e.spaces,this.spaceSize=e.size}))},getCommonsSpaces(){return this.firstLoadingSpaces=!1,a(this.offset,this.limitToFetch).then((e=>{this.commonsSpaces=e.spaces.slice(0,this.limitToFetch),this.commonsSpaceSize=e.size}))},openSpace(){window.location.href=`${eXo.env.portal.context}/${eXo.env.portal.portalName}/spaces`},updateRequestsSize(e){this.spaceRequests=e},refreshSpaces(e){this.spaces.unshift(e)},openSpacesSearch(){this.showSearch=!0},closeSpacesSearch(){this.showSearch=!1,this.search=""},loadNextPage(){if(this.isCurrentUserProfile){if(this.limitToFetch<=this.spaceSize)return this.limitToFetch=this.limitToFetch+=this.limit,this.$refs.spaceDrawer.startLoading(),i(this.offset,this.limitToFetch).then((e=>this.spaces=e.spaces)).finally((()=>this.$refs.spaceDrawer.endLoading()))}else if(this.limitToFetch<=this.commonsSpaceDefaultSize)return this.limitToFetch=this.limitToFetch+=this.limit,this.$refs.spaceDrawer.startLoading(),a(this.offset,this.limitToFetch).then((e=>{this.commonsSpaces=e.spaces.slice(0,this.limitToFetch),this.commonsSpaceSize=e.size})).finally((()=>this.$refs.spaceDrawer.endLoading()))},initSpaceSuggestionsList(){this.firstLoadingSpaces=!1,fetch("/portal/rest/homepage/intranet/spaces/suggestions",{credentials:"include"}).then((e=>e&&e.ok?e.json():e.text().then((e=>{throw new Error(e)})))).then((e=>{this.spacesSuggestionsList=e.items}))},removeLeftSpace(e){const t=this.spaces.filter((t=>t.prettyName!==e));this.spaces=[],this.spaces.push(...t)}}},M,[],!1,null,null,null);G.options.__file="src/main/webapp/vue-app/profileStats/components/SpaceDrawer.vue";const W=G.exports;var H=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-row",{attrs:{"user-item":""}},[[s("v-list-item",{key:e.space.id,staticClass:"py-0 px-2",class:e.spaceItemClass,attrs:{href:e.url}},[s("v-list-item-avatar",{staticClass:"my-1 me-2",attrs:{size:"30"}},[s("v-img",{attrs:{src:e.avatarUrl}})],1),e._v(" "),s("v-list-item-content",{staticClass:"py-0",attrs:{href:e.url}},[s("v-list-item-title",[s("a",{staticClass:"font-weight-bold subtitle-2 request-user-name darken-2",attrs:{href:e.url}},[e._v("\n            "+e._s(e.space.displayName)+"\n          ")])])],1)],1)]],2)};H._withStripped=!0;var K=p({props:{space:{type:Object,default:()=>null}},data:()=>({spaceItemClass:`spaceItem${parseInt(1e4*Math.random()).toString().toString()}`}),computed:{url(){if(!this.space||!this.space.groupId)return"#";const e=this.space.groupId.replace(/\//g,":");return`${eXo.env.portal.context}/g/${e}/${this.space.prettyName}`},avatarUrl(){return this.space&&this.space.avatarUrl||`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/spaces/${this.space.avatarUrl}/avatar`}},mounted(){this.space.id&&this.space.groupId&&(document.addEventListener("space_membership_updated",(e=>{this.$emit("removeLeavedSpace",e.detail)})),document.addEventListener("exo-chat-room-open-requested",(()=>{this.$emit("closeDrawer")})))}},H,[],!1,null,null,null);K.options.__file="src/main/webapp/vue-app/profileStats/components/SpaceDrawerItems.vue";const V=K.exports;var J=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-layout",{attrs:{row:"",wrap:"","mx-0":""}},[s("v-flex",{attrs:{xs12:""}},[s("v-list",[[s("v-list-item",{staticClass:"suggestions-list-item pa-0"},[s("v-list-item-avatar",{attrs:{size:e.avatarSize}},[s("v-img",{attrs:{src:e.avatarUrl}})],1),e._v(" "),s("v-list-item-content",{staticClass:"py-0"},[s("v-list-item-title",{staticClass:"body-2 font-weight-bold suggestions-list-item-title"},[s("a",{staticClass:"font-weight-bold subtitle-2 request-user-name darken-2",attrs:{href:e.url}},[e._v("\n                "+e._s(e.spaceSuggestion.displayName)+"\n              ")])]),e._v(" "),s("v-list-item-subtitle",{staticClass:"caption text-sub-title suggestions-list-item-subtitle"},[s("span",[e._v("\n                "+e._s(e.spaceSuggestion.members)+" "+e._s(e.$t("spacemember.Label"))+"\n              ")])])],1),e._v(" "),s("v-list-item-action",{staticClass:"suggestions-list-item-actions"},[s("v-btn-toggle",{staticClass:"transparent"},[s("a",{staticClass:"px-1 suggestions-btn-action connexion-accept-btn",attrs:{text:"",icon:"",small:"","min-width":"auto"},on:{click:function(t){return e.joinSpace(e.spaceSuggestion)}}},[s("v-icon",{attrs:{color:"primary-color",size:"20"}},[e._v("mdi-plus-circle")])],1),e._v(" "),s("a",{staticClass:"px-1 suggestions-btn-action connexion-refuse-btn",attrs:{text:"",small:"","min-width":"auto"},on:{click:function(t){return e.ignoredSuggestionSpace(e.spaceSuggestion)}}},[s("v-icon",{attrs:{color:"grey lighten-1",size:"20"}},[e._v("mdi-close-circle")])],1)])],1)],1)]],2)],1)],1)};J._withStripped=!0;var Y=p({props:{spaceSuggestion:{type:Object,default:()=>null},avatarSize:{type:Number,default:()=>30},spacesSuggestionsList:{type:Array,default:()=>[]}},computed:{avatarUrl(){return this.spaceSuggestion&&this.spaceSuggestion.spaceAvatarUrl||`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/spaces/${this.spaceSuggestion.spaceUrl}/avatar`},url(){return this.spaceSuggestion&&this.spaceSuggestion.spaceId?`${eXo.env.portal.context}/g/:spaces:${this.spaceSuggestion.spaceUrl}/`:"#"}},methods:{joinSpace(e){this.$spaceService.requestJoin(e.spaceId).then((()=>{this.spacesSuggestionsList.splice(this.spacesSuggestionsList.indexOf(e),1)}))},ignoredSuggestionSpace(e){this.$spaceService.ignoreSuggestion(e).then((()=>{this.spacesSuggestionsList.splice(this.spacesSuggestionsList.indexOf(e),1)}))}}},J,[],!1,null,null,null);Y.options.__file="src/main/webapp/vue-app/profileStats/components/SuggestionsSpaceListItem.vue";const Z={"profile-stats":u,"connections-requests":v,"gamification-rank":w,"spaces-requests":_,"user-points-widget":b,"user-dashbord":z,"achievements-drawer":E,"achievement-item":D,"connections-drawer":X,"space-drawer":W,"space-drawer-items":V,"suggestions-space-list-item":Y.exports,"exo-suggestions-people-list-item":j,"people-list-item":B};for(const e in Z)Vue.component(e,Z[e]);Vue.use(Vuetify);const Q=new Vuetify(eXo.env.portal.vuetifyPreset),ee=eXo&&eXo.env&&eXo.env.portal&&eXo.env.portal.language||"en",te=[`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.addon.Gamification-${ee}.json`,`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.social.PeopleListApplication-${ee}.json`],se="profile-stats-portlet",ie=`${se}_${eXo.env.portal.profileOwnerIdentityId}`;function ae(){const e=document.createElement("div");e.id=se,exoi18n.loadLanguageAsync(ee,te).then((t=>{Vue.createApp({template:`<profile-stats id="${se}" v-cacheable="{cacheId: '${ie}'}" />`,i18n:t,vuetify:Q},e,"Profile Stats")}))}return t})()));