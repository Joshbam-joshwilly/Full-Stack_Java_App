define((()=>(()=>{"use strict";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>h});var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-card",{attrs:{flat:""}},[n("v-card-title",{staticClass:"text-sub-title subtitle-1 text-uppercase pb-2"},[e._v("\n      "+e._s(e.$t("popularSpaces.title"))+"\n    ")]),e._v(" "),n("v-layout",[n("v-col",[e.spaces&&e.spaces.length?n("v-list",{staticClass:"pt-0 px-3",attrs:{"two-line":""}},e._l(e.spaces,(function(t){return n("popular-spaces-item",{key:t.technicalId,attrs:{space:t},on:{refresh:e.refresh}})})),1):n("div",{staticClass:"d-flex justify-center"},[n("span",{staticClass:"emptySpacesLeaderboardIcon mb-2"},[e._v("\n            Ã˜\n          ")])])],1)],1)],1)],1)};function s(e,t,n,s,o,a,i,r){var c,p="function"==typeof e?e.options:e;if(t&&(p.render=t,p.staticRenderFns=n,p._compiled=!0),s&&(p.functional=!0),a&&(p._scopeId="data-v-"+a),i?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},p._ssrRegister=c):o&&(c=r?function(){o.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:o),c)if(p.functional){p._injectStyles=c;var l=p.render;p.render=function(e,t){return c.call(t),l(e,t)}}else{var d=p.beforeCreate;p.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:p}}n._withStripped=!0;var o=s({props:{limit:{type:Number,default:()=>10},period:{type:String,default:()=>"WEEK"}},data:()=>({spaces:[]}),created(){this.refresh()},methods:{refresh(){return(e=this.period,t=this.limit,fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/leaderboard/rank/all?earnerType=space&limit=${t}&period=${e}`,{credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting users by gamification leaderboard")}))).then((e=>{const t=[];return e.filter((e=>e.technicalId)).forEach((e=>{var n;t.push((n=e.technicalId,fetch(`/portal/rest/v1/social/spaces/${n}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))).then((t=>{if(t&&t.id)return Object.assign(e,t),e})))})),Promise.all(t)})).then((e=>(this.spaces=e.sort(((e,t)=>e.rank-t.rank)),this.$nextTick()))).finally((()=>this.$root.$applicationLoaded()));var e,t}}},n,[],!1,null,null,null);o.options.__file="src/main/webapp/vue-app/popularSpaces/components/PopularSpaces.vue";const a=o.exports;var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-list-item",{staticClass:"pa-0 spaceItem"},[n("exo-space-avatar",{staticClass:"text-truncate",attrs:{space:e.space,"subtitle-new-line":"",popover:""}},[n("template",{slot:"subTitle"},[n("span",{staticClass:"caption"},[e._v("\n        "+e._s(e.$t("popularSpaces.label.points",{0:e.space.score}))+"\n      ")])])],2),e._v(" "),n("v-list-item-action",{staticClass:"ma-0 pe-4 flex-row align-self-center ml-auto flex-shrink-0",class:e.displaySecondButton?"secondButtonDisplayed":""},[e.space.isInvited||e.skeleton?n("div",{staticClass:"invitationButtons"},[n("div",{staticClass:"acceptToJoinSpaceButtonParent"},[n("v-btn",{staticClass:"btn mx-auto spaceMembershipButton acceptToJoinSpaceButton",attrs:{loading:e.sendingAction,disabled:e.sendingAction,depressed:"",small:""},on:{click:e.acceptToJoin}},[n("v-icon",[e._v("mdi-check")]),e._v(" "),n("span",{staticClass:"d-flex"},[e._v("\n            "+e._s(e.$t("popularSpaces.button.acceptToJoin"))+"\n          ")])],1),e._v(" "),n("v-btn",{staticClass:"btn spaceButtonMenu d-inline",attrs:{depressed:"","x-small":""},on:{click:function(t){e.displaySecondButton=!e.displaySecondButton}}},[n("v-icon",[e._v("mdi-menu-down")])],1)],1),e._v(" "),n("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.displaySecondButton,expression:"displaySecondButton"}],staticClass:"btn mx-auto px-0 spaceMembershipButton refuseToJoinSpaceButton",attrs:{loading:e.sendingSecondAction,disabled:e.sendingSecondAction,depressed:"",block:"",small:""},on:{click:e.refuseToJoin}},[n("v-icon",[e._v("mdi-close")]),e._v(" "),n("span",{staticClass:"d-flex"},[e._v("\n          "+e._s(e.$t("popularSpaces.button.refuseToJoin"))+"\n        ")])],1)],1):e.space.isPending?n("v-btn",{staticClass:"btn mx-auto spaceMembershipButton",attrs:{loading:e.sendingAction,depressed:"",block:"",small:""},on:{click:e.cancelRequest}},[n("v-icon",[e._v("mdi-close")]),e._v(" "),n("span",{staticClass:"spaceMembershipButtonText d-inline"},[e._v("\n        "+e._s(e.$t("popularSpaces.button.cancelRequest"))+"\n      ")])],1):!e.space.isMember||e.skeleton?["open"===e.space.subscription?n("v-btn",{staticClass:"btn mx-auto spaceMembershipButton joinSpaceButton",attrs:{disabled:e.skeleton,loading:e.sendingAction,depressed:"",block:"",small:""},on:{click:e.join}},[n("v-icon",[e._v("mdi-plus")]),e._v(" "),n("span",{staticClass:"spaceMembershipButtonText d-inline"},[e._v("\n          "+e._s(e.$t("popularSpaces.button.join"))+"\n        ")])],1):"validation"===e.space.subscription?n("v-btn",{staticClass:"btn mx-auto spaceMembershipButton joinSpaceButton",attrs:{disabled:e.skeleton,title:e.$t("popularSpaces.button.requestJoin"),loading:e.sendingAction,depressed:"",block:"",small:""},on:{click:e.requestJoin}},[n("v-icon",[e._v("mdi-plus")]),e._v(" "),n("span",{staticClass:"spaceMembershipButtonText d-inline"},[e._v("\n          "+e._s(e.$t("popularSpaces.button.requestJoin"))+"\n        ")])],1):e._e()]:e._e()],2)],1)};i._withStripped=!0;var r=s({props:{space:{type:Object,default:()=>null},skeleton:{type:Boolean,default:!1}},data:()=>({sendingAction:!1,displaySecondButton:!1,sendingSecondAction:!1,spaceItemClass:`popularSpace${parseInt(1e4*Math.random()).toString().toString()}`}),methods:{acceptToJoin(){var e;this.sendingAction=!0,(e=this.space.id,fetch(`/portal/rest/homepage/intranet/spaces/accept/${e}`,{method:"GET",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))).then((()=>this.$emit("refresh"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))},refuseToJoin(){var e;this.sendingSecondAction=!0,(e=this.space.id,fetch(`/portal/rest/homepage/intranet/spaces/deny/${e}`,{method:"GET",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))).then((()=>this.$emit("refresh"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingSecondAction=!1}))},join(){var e;this.sendingAction=!0,(e=this.space.id,fetch(`/portal/rest/homepage/intranet/spaces/join/${e}`,{method:"GET",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))).then((()=>this.$emit("refresh"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))},requestJoin(){var e;this.sendingAction=!0,(e=this.space.id,fetch(`/portal/rest/homepage/intranet/spaces/request/${e}`,{method:"GET",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))).then((()=>this.$emit("refresh"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))},cancelRequest(){var e;this.sendingAction=!0,(e=this.space.id,fetch(`/portal/rest/homepage/intranet/spaces/cancel/${e}`,{method:"DELETE",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error("Response code indicates a server error",e)}))).then((()=>this.$emit("refresh"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))}}},i,[],!1,null,null,null);r.options.__file="src/main/webapp/vue-app/popularSpaces/components/PopularSpacesItem.vue";const c={"popular-spaces":a,"popular-spaces-item":r.exports};for(const e in c)Vue.component(e,c[e]);if(extensionRegistry){const e=extensionRegistry.loadComponents("PopularSpaces");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}Vue.use(Vuetify);const p=new Vuetify(eXo.env.portal.vuetifyPreset),l=eXo&&eXo.env&&eXo.env.portal&&eXo.env.portal.language||"en",d=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.addon.Gamification-${l}.json`,u="popularSpacesApplication";function h(){exoi18n.loadLanguageAsync(l,d).then((e=>{Vue.createApp({template:`<popular-spaces id="${u}" />`,i18n:e,vuetify:p},`#${u}`,"Popular Spaces")}))}return t})()));