define((()=>(()=>{var e={9185:()=>{},6614:()=>{const e=["addActivityOnMyStream","addActivityOnNetworkStream","addActivityOnSpaceStream","addActivityOnSpaceStreamTarget","addActivityTargetUserStream","addCommentOnNetworkStream","addCommentOnSpaceStream","receiveCommentOnNetworkStream","receiveCommentOnSpaceStream","likeActivityOnNetworkStream","likeActivityOnSpaceStream","likeActivityOnSpaceStreamTarget","likeActivityTargetUserStream","likeComment","likeCommentOnNetworkStream","likeCommentOnNetworkStreamTarget","likeCommentOnSpaceStream","likeCommentOnSpaceStreamTarget","uploaddocumentOnNetworkStream"],t=["addUserProfileAboutMe","addUserProfileAvatar","addUserProfileBanner","userLogin","receiveRelationshipRequest","sendRelationshipRequest"],a=["addSpace","becomeSpaceManager","joinSpace"];extensionRegistry.registerExtension("engagementCenterActions","user-actions",{type:"Stream",options:{rank:10,icon:"fas fa-stream",match:t=>e.includes(t),getLabel:()=>""}}),extensionRegistry.registerExtension("engagementCenterActions","user-actions",{type:"Profile",options:{rank:20,icon:"fas fa-user",match:e=>t.includes(e),getLabel:()=>""}}),extensionRegistry.registerExtension("engagementCenterActions","user-actions",{type:"Space",options:{rank:30,icon:"fas fa-layer-group",match:e=>a.includes(e),getLabel:()=>""}})}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{"use strict";a.r(s),a.d(s,{init:()=>Tt});var e={};a.r(e),a.d(e,{canAddChallenge:()=>Ge,deleteChallenge:()=>nt,getAllAnnouncementsByChallenge:()=>et,getAllChallengesByUser:()=>Ze,getAllDomains:()=>st,getChallengeById:()=>at,saveAnnouncement:()=>tt,saveChallenge:()=>Ye,updateChallenge:()=>Qe});var t={};a.r(t),a.d(t,{displayAlert:()=>ct,getFromDate:()=>ot,getIsoDate:()=>dt,getUserTimezone:()=>lt,pad:()=>it,toRFC3339:()=>rt});var n={};a.r(n),a.d(n,{canAddProgram:()=>pt,deleteProgram:()=>vt,getProgramById:()=>ht,retrievePrograms:()=>ut,saveProgram:()=>mt,updateProgram:()=>gt});var i={};a.r(i),a.d(i,{createRule:()=>wt,deleteRule:()=>Ct,getDomains:()=>_t,getEvents:()=>bt,getRules:()=>ft,updateRule:()=>$t});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"challenges-application border-box-sizing",class:e.classWelcomeMessage,attrs:{id:"ChallengesApplication",role:"main"}},[a("v-toolbar",{attrs:{flat:""}},[e.displayAddChallengeButton?a("div",{staticClass:"border-box-sizing clickable"},[a("v-btn",{staticClass:"btn btn-primary",attrs:{id:"engagementCenterAddChallengeBtn"},on:{click:e.openChallengeDrawer}},[a("v-icon",{attrs:{small:""}},[e._v("fas fa-plus")]),e._v(" "),a("span",{staticClass:"mx-2 d-none d-lg-inline text-capitalize-first-letter subtitle-1"},[e._v("\n          "+e._s(e.$t("challenges.button.addChallenge"))+"\n        ")])],1)],1):e._e(),e._v(" "),a("v-spacer"),e._v(" "),a("div",{staticClass:"challengeFilter text-center d-flex align-center justify-space-around"},[a("v-text-field",{staticClass:"pa-0 mx-3",attrs:{id:"EngagementCenterApplicationSearchFilter",placeholder:e.$t("challenges.filter.search"),"prepend-inner-icon":"fa-filter","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),a("v-tooltip",{attrs:{id:"EngagementCenterApplicationSearchFilterTooltip",value:e.displayMinimumCharactersToolTip,attach:""}},[a("span",[e._v(" "+e._s(e.$t("challenges.filter.searchTooltip"))+" ")])])],1),e._v(" "),a("div",{staticClass:"pt-1"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],staticClass:"my-auto ignore-vuetify-classes text-truncate challengeQuickFilter mb-3",attrs:{id:"EngagementCenterApplicationChallengesQuickFilter"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.filter=t.target.multiple?a:a[0]},e.refreshChallenges]}},e._l(e.challengesFilter,(function(t){return a("option",{key:t.value,domProps:{value:t.value}},[a("span",{staticClass:"d-none d-lg-inline"},[e._v("\n            "+e._s(t.text)+"\n          ")])])})),0)])],1),e._v(" "),a("v-card",{attrs:{flat:""}},[e.loading?a("v-progress-linear",{attrs:{indeterminate:"",height:"2",color:"primary"}}):e.displayWelcomeMessage?a("engagement-center-welcome-message",{scopedSlots:e._u([{key:"content",fn:function(){return[a("div",{staticClass:"mx-4 my-6 dark-grey-color"},[a("p",{staticClass:"align-center font-weight-bold mb-5"},[e._v(" "+e._s(e.$t("challenges.welcomeMessage"))+" ")]),e._v(" "),e.canAddChallenge?a("p",{staticClass:"align-center"},[e._v(" "+e._s(e.$t("challenges.welcomeMessageForManager"))+" ")]):a("p",{staticClass:"align-center"},[e._v(" "+e._s(e.$t("challenges.welcomeMessageForUser"))+" ")])])]},proxy:!0}])}):e.displayNoSearchResult?a("engagement-center-no-results",{attrs:{info:e.$t("challenges.search.noResults"),"info-message":e.notFoundInfoMessage}}):e.displayChallengesList?a("challenges-list",{staticClass:"pl-2 pt-8",attrs:{domains:e.domainsHavingChallenges,"challenges-by-domain-id":e.challengesByDomainId,"can-edit-challenge":e.canAddChallenge}}):e._e()],1),e._v(" "),a("exo-confirm-dialog",{ref:"deleteChallengeConfirmDialog",attrs:{title:e.$t("challenges.delete"),message:e.$t("challenges.deleteConfirmMessage"),"ok-label":e.$t("challenges.ok"),"cancel-label":e.$t("engagementCenter.button.cancel")},on:{ok:e.deleteChallenge}})],1)};function l(e,t,a,s,n,i,r,l){var o,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),s&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),r?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},c._ssrRegister=o):n&&(o=l?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),o)if(c.functional){c._injectStyles=o;var d=c.render;c.render=function(e,t){return o.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,o):[o]}return{exports:e,options:c}}r._withStripped=!0;var o=l({props:{challengeId:{type:Number,default:null},canAddChallenge:{type:Boolean,default:!1}},data:()=>({selectedChallenge:null,loading:!0,domains:[],domainsWithChallenges:[],announcementsPerChallenge:2,search:"",startSearchAfterInMilliseconds:600,endTypingKeywordTimeout:50,startTypingKeywordTimeout:0,typing:!1,displayMinimumCharactersToolTip:!1,filter:"STARTED",challengeIdFromUrl:null}),computed:{displayAddChallengeButton(){return this.canAddChallenge||this.domains?.filter((e=>e.owners?.filter((e=>Number(e)===Number(eXo.env.portal.userIdentityId))).length))?.length},classWelcomeMessage(){return this.displayWelcomeMessage?"emptyChallenges":""},domainsHavingChallenges(){return this.domainsWithChallenges.filter((e=>e.challenges.length>0))},displayWelcomeMessage(){return!(this.typing||this.loading||this.domainsHavingChallenges.length||this.search?.length||"ALL"!==this.filter&&"STARTED"!==this.filter)},notFoundInfoMessage(){return"NOT_STARTED"!==this.filter||this.search?.length?"ENDED"!==this.filter||this.search?.length?this.$t("challenges.search.noResultsMessage"):this.$t("challenges.filter.endedNoResultsMessage"):this.$t("challenges.filter.upcomingNoResultsMessage")},displayNoSearchResult(){return!this.typing&&!this.loading&&!this.domainsHavingChallenges.length&&(this.search?.length||"NOT_STARTED"===this.filter||"ENDED"===this.filter)},displayChallengesList(){return this.domainsHavingChallenges.length},challengesByDomainId(){const e={};return this.domainsHavingChallenges.forEach((t=>{e[t.id]=t.challenges})),e},domainsById(){const e={};return this.domainsWithChallenges.forEach((t=>{e[t.id]=t})),e},challengePerPage(){return this.$vuetify.breakpoint.width<=768?5:6},challengesFilter(){return[{text:this.$t("challenges.filter.allChallenges"),value:"ALL"},{text:this.$t("challenges.filter.activeChallenges"),value:"STARTED"},{text:this.$t("challenges.filter.UpcomingChallenges"),value:"NOT_STARTED"},{text:this.$t("challenges.filter.endedChallenges"),value:"ENDED"}]},providedId(){return this.challengeIdFromUrl?this.challengeIdFromUrl:this.challengeId}},watch:{search(){this.displayMinimumCharactersToolTip=!1,this.search?.length?this.search.length<3?this.displayMinimumCharactersToolTip=!0:(this.startTypingKeywordTimeout=Date.now()+this.startSearchAfterInMilliseconds,this.typing||(this.typing=!0,this.waitForEndTyping())):this.getChallenges(!1)},loading(){this.loading?document.dispatchEvent(new CustomEvent("displayTopBarLoading")):document.dispatchEvent(new CustomEvent("hideTopBarLoading"))}},created(){const e=[];e.push(this.getChallenges(!1)),this.$root.$on("challenge-added",this.pushChallenge),this.$root.$on("challenge-updated",this.refreshChallenges),this.$root.$on("challenge-deleted",this.refreshChallenges),this.$root.$on("challenge-load-more",this.loadMore),this.$root.$on("challenge-delete-confirm",this.confirmDelete);const t=document.location.pathname;t.indexOf(`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges`)>-1&&(this.challengeIdFromUrl=t.match(/\d+/)&&t.match(/\d+/).join(""),this.providedId&&setTimeout((()=>{const t=this.$challengesServices.getChallengeById(this.providedId).then((e=>{e?.id?(this.$root.$emit("rule-detail-drawer",e),window.history.replaceState("challenges",this.$t("challenges.challenges"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges/${this.providedId}`)):(window.history.replaceState("challenges",this.$t("challenges.challenges"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges`),this.showAlert("error",this.$t("challenges.viewChallengeError")))}));e.push(t)}),10)),Promise.all(e).finally((()=>this.$root.$applicationLoaded()))},methods:{pushChallenge(e){e?.program?.id&&this.getChallenges(!1,e.program.id)},refreshChallenges(){return this.getChallenges(!1)},loadMore(e){return this.getChallenges(!0,e)},openChallengeDrawer(){this.$root.$emit("edit-challenge-details")},getChallenges(e,t){this.loading=!0;const a=e&&t&&this.challengesByDomainId[t]?.length||0;return this.$challengesServices.getAllChallengesByUser(this.search,a,this.challengePerPage,this.announcementsPerChallenge,t,!t,this.filter).then((a=>{if(a)if(this.domains=a,t){const s=this.domainsById[t]||{};s.challenges||(s.challenges=[]),a.forEach((e=>e.program=s)),e?s.challenges=this.challengesByDomainId[t].concat(a):(s.challenges=a||[],(!s.challengesSize||s.challengesSize<6)&&(s.challengesSize=a.length))}else a.forEach((e=>{if(e.challenges){const t=Object.assign({},e);delete t.challenges,e.challenges.forEach((e=>e.program=t))}else e.challenges=[]})),this.domainsWithChallenges=a})).finally((()=>this.loading=!1))},deleteChallenge(){this.loading=!0,this.$challengesServices.deleteChallenge(this.selectedChallenge.id).then((()=>{this.showAlert("success",this.$t("challenges.deleteSuccess")),this.$root.$emit("challenge-deleted")})).catch((e=>{let t="";t="401"===e.message||"403"===e.message?this.$t("challenges.deletePermissionDenied"):"404"===e.message?this.$t("challenges.notFound"):this.$t("challenges.deleteErrorSave"),this.showAlert("error",t)})).finally((()=>this.loading=!1))},confirmDelete(e){this.selectedChallenge=e,this.$refs.deleteChallengeConfirmDialog.open()},showAlert(e,t){this.$engagementCenterUtils.displayAlert(t,e)},waitForEndTyping(){window.setTimeout((()=>{Date.now()>this.startTypingKeywordTimeout?(this.typing=!1,this.getChallenges(!1,!1)):this.waitForEndTyping()}),this.endTypingKeywordTimeout)}}},r,[],!1,null,null,null);o.options.__file="src/main/webapp/vue-app/engagement-center/components/challenges/Challenges.vue";const c=o.exports;var d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"engagement-center-card"},[a("v-card",{staticClass:"mx-auto",attrs:{id:"engagementCenterChallengeCard",width:e.challengeCardWidth,height:"230","max-height":"230",outlined:"",hover:""}},[a("div",{staticClass:"d-flex flex-column full-height pa-2",on:{click:function(t){return e.$root.$emit("rule-detail-drawer",e.challenge)}}},[a("div",{staticClass:"d-flex flex-row pb-1"},[a("div",{staticClass:"d-flex flex-row flex-grow-0 flex-shrink-0"},[a("div",{staticClass:"d-flex flex-row my-auto"},[a("v-icon",{staticClass:"mt-n2px primary--text ms-1",attrs:{size:"18"}},[e._v("fas fa-trophy")]),e._v(" "),a("div",{staticClass:"font-weight-bold text--secondary text-subtitle-2 mt-1 ms-2"},[e._v("\n              "+e._s(e.challenge&&e.challenge.points)+" "+e._s(e.$t("challenges.label.points"))+"\n            ")])],1)]),e._v(" "),a("v-spacer"),e._v(" "),a("div",{staticClass:"d-flex flex-column flex-grow-0 flex-shrink-1"},[a("div",{staticClass:"edit"},[e.enableEdit?a("v-menu",{attrs:{left:!e.$vuetify.rtl,right:e.$vuetify.rtl,bottom:"","offset-y":"",attach:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:"",small:""}},"v-btn",n,!1),s),[a("v-icon",{staticClass:"icon-default-color",attrs:{size:"16"}},[e._v("fas fa-ellipsis-v")])],1)]}}],null,!1,2622159970),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[e._v(" "),a("v-list",{staticClass:"pa-0",attrs:{dense:""}},[a("v-list-item",{attrs:{dense:""},on:{mousedown:function(e){return e.preventDefault()},click:e.editChallenge}},[a("v-list-item-title",{staticClass:"editLabel"},[e._v(e._s(e.$t("challenges.edit")))])],1),e._v(" "),e.enableDelete?a("v-list-item",{staticClass:"editList",on:{mousedown:function(e){return e.preventDefault()},click:e.deleteChallenge}},[a("v-list-item-title",{staticClass:"editLabel"},[e._v(e._s(e.$t("challenges.delete")))])],1):e._e()],1)],1):e._e()],1)])],1),e._v(" "),a("div",{staticClass:"ma-auto"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("span",e._g(e._b({staticClass:"d-flex-inline text-center position-relative text-truncate-2 font-weight-bold text-subtitle-1 text--secondary text-break overflow-hidden"},"span",n,!1),s),[e._v("\n              "+e._s(e.challengeTitle)+"\n            ")])]}}])},[e._v("\n          "+e._s(e.challengeTitle)+"\n        ")])],1),e._v(" "),a("div",{staticClass:"d-flex flex-row ms-1 ms-sm-0",on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[a("engagement-center-avatars-list",{attrs:{avatars:e.winnerAvatars,"max-avatars-to-show":e.maxAvatarsToShow,"avatars-count":e.announcementCount,size:27},on:{"open-avatars-drawer":e.openWinnersDrawer}}),e._v(" "),a("v-spacer"),e._v(" "),e.noParticipationYet?e._e():a("div",{staticClass:"winners winnersAvatarsList d-flex flex-nowrap pe-3",on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[a("v-spacer")],1),e._v(" "),a("div",{staticClass:"d-flex flex-row my-auto my-sm-0"},[a("v-icon",{staticClass:"primary--text",attrs:{size:"18"}},[e._v("fas fa-calendar-day")]),e._v(" "),a("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.remainingPeriodLabel,expression:"remainingPeriodLabel"}],staticClass:"mt-1 ms-2 text-subtitle-2"})],1)],1)])])],1)};d._withStripped=!0;var u=l({props:{challenge:{type:Object,default:null},domain:{type:Array,default:function(){return[]}}},data:()=>({showMenu:!1,label:"",status:""}),computed:{winnerAvatars(){return this.challenge?.announcements?.filter((e=>e.assignee)).map((e=>({userName:e.assignee})))||[]},enableDelete(){return this.enableEdit&&!this.announcementCount&&"Ended"===this.status},enableEdit(){return this.challenge?.userInfo?.canEdit},announcementCount(){return this.challenge?.announcementsCount||0},challengeTitle(){return this.challenge?.title},startDate(){return new Date(this.challenge?.startDate)},endDate(){return new Date(this.challenge?.endDate)},remainingPeriodLabel(){if(this.endDate.getTime()<Date.now())return this.$t("challenges.label.over");if(this.startDate.getTime()>Date.now()){const e=Math.round((this.startDate.getTime()-Date.now())/864e5)+1;return this.$t("challenges.label.openIn",{0:e})}{const e=Math.round((this.endDate.getTime()-Date.now())/864e5)+1;return this.$t("challenges.label.daysLeft",{0:e})}},noParticipationYet(){return 0===this.challenge?.announcementsCount},isMobile(){return this.$vuetify.breakpoint.xsOnly},maxAvatarsToShow(){return this.isMobile?2:3},challengeCardWidth(){return this.isMobile?"100%":"95%"}},created(){this.$root.$on("announcement-added",this.announcementAdded),$(document).mousedown((()=>{this.showMenu&&window.setTimeout((()=>{this.showMenu=!1}),200)}))},methods:{editChallenge(e){e&&(e.preventDefault(),e.stopPropagation()),this.$challengesServices.getChallengeById(this.challenge?.id).then((e=>this.$root.$emit("edit-challenge-details",e)))},deleteChallenge(e){e&&(e.preventDefault(),e.stopPropagation()),this.$root.$emit("challenge-delete-confirm",this.challenge)},openWinnersDrawer(e){e&&(e.preventDefault(),e.stopPropagation()),this.$root.$emit("open-winners-drawer",this.challenge)},announcementAdded(e){const t=e?.detail?.announcement,a=e?.detail?.challengeId;t&&this.challenge.id===a&&(this.winnerAvatars.unshift({userName:t.assignee}),this.challenge.announcementsCount++)}}},d,[],!1,null,null,null);u.options.__file="src/main/webapp/vue-app/engagement-center/components/challenges/ChallengeCard.vue";const m=u.exports;var p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-expansion-panels",{attrs:{value:e.domainIndexes,multiple:"",flat:""}},e._l(e.domains,(function(t){return a("domain-challenges-list",{key:t.id,attrs:{domain:t,challenges:e.challengesByDomainId[t.id],"can-edit-challenge":e.canEditChallenge}})})),1)};p._withStripped=!0;var g=l({props:{domains:{type:Array,default:function(){return[]}},challengesByDomainId:{type:Object,default:function(){return{}}},canEditChallenge:{type:Boolean,default:!1}},computed:{domainIndexes(){return this.domains.map(((e,t)=>t))}},methods:{announcementAdded(e){this.listWinners.unshift({userName:e.assignee}),this.challenge.announcementsCount=this.challenge.announcementsCount+1}}},p,[],!1,null,null,null);g.options.__file="src/main/webapp/vue-app/engagement-center/components/challenges/ChallengesList.vue";const h=g.exports;var v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.size?a("v-expansion-panel",[a("v-expansion-panel-header",{staticClass:"pa-3",attrs:{"hide-actions":""},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.open;return[a("v-list-item",{attrs:{flat:"",dense:""}},[a("v-list-item-icon",{staticClass:"me-2"},[a("v-icon",{attrs:{size:"16"},domProps:{textContent:e._s(s?"fa-chevron-up":"fa-chevron-down")}})],1),e._v(" "),a("v-list-item-content",{staticClass:"flex flex-grow-0 flex-shrink-0 me-2"},[e._v("\n          "+e._s(e.title)+"\n        ")]),e._v(" "),a("v-list-item-content",{staticClass:"flex flex-grow-0 flex-shrink-0 me-2"},[e._v("\n          ( "+e._s(e.size)+" )\n        ")]),e._v(" "),a("v-list-item-content",{staticClass:"mr-7"},[a("v-divider")],1)],1)]}}],null,!1,3289153623)}),e._v(" "),a("v-expansion-panel-content",[a("v-container",{staticClass:"pa-0"},[a("v-row",{attrs:{"no-gutters":""}},e._l(e.challenges,(function(t){return a("v-col",{key:t.id,staticClass:"mb-4 challenge-column",attrs:{cols:"12",sm:"6",lg:"4"}},[a("challenge-card",{attrs:{domain:e.domain,challenge:t,"can-edit-challenge":e.canEditChallenge}})],1)})),1),e._v(" "),e.hasMore?a("v-row",{staticClass:"ml-6 mr-6 mb-6 mt-n4"},[a("v-btn",{staticClass:"loadMoreButton ma-auto mt-4 btn",attrs:{block:""},on:{click:function(t){return e.$root.$emit("challenge-load-more",e.domain.id)}}},[e._v("\n          "+e._s(e.$t("engagementCenter.button.ShowMore"))+"\n        ")])],1):e._e()],1)],1)],1):e._e()};v._withStripped=!0;var f=l({props:{domain:{type:Array,default:function(){return[]}},challenges:{type:Object,default:function(){return{}}},canEditChallenge:{type:Boolean,default:!1}},computed:{title(){const e=`exoplatform.gamification.gamificationinformation.domain.${this.domain.title}`;return this.$te(e)&&this.$t(e)||this.domain.title},size(){return this.domain.challengesSize},hasMore(){return this.domain.challengesSize>this.domain.challenges.length}}},v,[],!1,null,null,null);f.options.__file="src/main/webapp/vue-app/engagement-center/components/challenges/DomainChallengesList.vue";const _=f.exports;var b=function(){var e=this,t=e.$createElement;return(e._self._c||t)("challenge-program-drawer",{attrs:{"is-administrator":e.isAdministrator}})};b._withStripped=!0;var C=l({props:{isAdministrator:{type:Boolean,default:!1}}},b,[],!1,null,null,null);C.options.__file="src/main/webapp/vue-app/engagement-center/components/challenges/ChallengeDrawer.vue";const w=C.exports;var x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("exo-drawer",{ref:"challengeDrawer",staticClass:"EngagementCenterDrawer",attrs:{id:"EngagementCenterChallengeDrawer",right:!e.$vuetify.rtl,eager:""},on:{closed:e.close},scopedSlots:e._u([{key:"title",fn:function(){return[a("span",{staticClass:"pb-2"},[e._v(" "+e._s(e.drawerTitle)+" ")])]},proxy:!0},e.drawer?{key:"content",fn:function(){return[e.challenge?a("v-card-text",[a("v-form",{ref:"form",attrs:{id:"EngagementCenterChallengeDrawerForm"},on:{submit:function(e){e.preventDefault(),e.stopPropagation()}},model:{value:e.isValidForm,callback:function(t){e.isValidForm=t},expression:"isValidForm"}},[a("v-textarea",{staticClass:"pl-0 pt-0 EngagementCenter-title",attrs:{id:"EngagementCenterChallengeDrawerTitleTextArea",placeholder:e.$t("challenges.label.enterChallengeTitle"),rules:[e.rules.length],name:"challengeTitle","auto-grow":"",rows:"1","row-height":"13",required:"",autofocus:""},model:{value:e.challenge.title,callback:function(t){e.$set(e.challenge,"title",t)},expression:"challenge.title"}}),e._v(" "),a("v-divider",{staticClass:"my-2"}),e._v(" "),a("span",{staticClass:"subtitle-1"},[e._v(" "+e._s(e.$t("challenges.label.program"))+" *")]),e._v(" "),a("program-suggester",{ref:"challengeProgram",attrs:{id:"EngagementCenterChallengeDrawerProgramSuggester",labels:e.programSuggesterLabels,"only-owned":!e.isAdministrator},model:{value:e.challenge.program,callback:function(t){e.$set(e.challenge,"program",t)},expression:"challenge.program"}}),e._v(" "),a("div",{staticClass:"mt-4"},[a("span",{staticClass:"subtitle-1"},[e._v(" "+e._s(e.$t("challenges.label.ChallengeDates"))+" *")]),e._v(" "),a("challenge-date-picker",{ref:"challengeDatePicker",staticClass:"challengeDates my-2",attrs:{id:"EngagementCenterChallengeDrawerDatePicker",challenge:e.challenge},on:{startDateChanged:function(t){return e.updateChallengeStartDate(t)},endDateChanged:function(t){return e.updateChallengeEndDate(t)}}})],1),e._v(" "),a("div",{staticClass:"mt-4"},[a("span",{staticClass:"subtitle-1"},[e._v(" "+e._s(e.$t("challenges.label.reward")))]),e._v(" "),a("v-text-field",{staticClass:"pt-2 points",attrs:{id:"EngagementCenterChallengeDrawerPoints",label:e.$t("challenges.label.points"),rules:[e.rules.value],placeholder:e.$t("challenges.label.points"),type:"number",outlined:"",required:""},model:{value:e.challenge.points,callback:function(t){e.$set(e.challenge,"points",t)},expression:"challenge.points"}})],1),e._v(" "),a("div",{staticClass:"challengeDescription py-4 my-2"},[e.drawer?a("engagement-center-description-editor",{ref:"challengeDescription",attrs:{id:"EngagementCenterChallengeDrawerDescriptionEditor",label:e.$t("challenges.label.describeYourChallenge")},on:{"validity-updated":function(t){e.isValidDescription=t},addDescription:function(t){return e.addDescription(t)}},model:{value:e.challenge.description,callback:function(t){e.$set(e.challenge,"description",t)},expression:"challenge.description"}}):e._e()],1),e._v(" "),a("div",{staticClass:"mt-4"},[a("span",{staticClass:"subtitle-1"},[e._v(" "+e._s(e.$t("challenges.label.status")))]),e._v(" "),a("div",{staticClass:"d-flex flex-row px-4"},[a("label",{staticClass:"subtitle-1 text-light-color"},[e._v(e._s(e.$t("challenges.label.enabled")))]),e._v(" "),e.drawer?a("v-switch",{staticClass:"mt-0 ms-4",attrs:{id:"engagementCenterChallengeDrawerSwitch"},model:{value:e.challenge.enabled,callback:function(t){e.$set(e.challenge,"enabled",t)},expression:"challenge.enabled"}}):e._e()],1)])],1)],1):e._e()]},proxy:!0}:null],null,!0),model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[e._v(" "),e._v(" "),a("template",{slot:"footer"},[a("div",{staticClass:"d-flex mr-2"},[a("v-spacer"),e._v(" "),a("v-btn",{staticClass:"btn mx-1",attrs:{id:"EngagementCenterChallengeDrawerCancelButton"},on:{click:e.close}},[e._v("\n        "+e._s(e.$t("engagementCenter.button.cancel"))+"\n      ")]),e._v(" "),a("v-btn",{staticClass:"btn btn-primary",attrs:{id:"EngagementCenterChallengeDrawerSaveButton",disabled:e.disabledSave},on:{click:e.saveChallenge}},[e._v("\n        "+e._s(e.buttonName)+"\n      ")])],1)])],2)};x._withStripped=!0;var y=l({props:{isAdministrator:{type:Boolean,default:!1}},data(){return{rules:{length:e=>e&&e.length<50||this.$t("challenges.label.challengeTitleLengthExceed"),value:e=>e>=0&&e<=9999||this.$t("challenges.label.pointsValidation")},drawer:!1,challenge:null,isValidForm:!0,isValidDescription:!0}},computed:{drawerTitle(){return this.challenge&&this.challenge.id?this.$t("challenges.button.editChallenge"):this.$t("challenges.button.addChallenge")},spaceSuggesterLabels(){return{searchPlaceholder:this.$t("challenges.spaces.noDataLabel"),placeholder:this.$t("challenges.spaces.placeholder")}},disabledSave(){return!(this.challenge&&this.isValidForm&&this.isValidDescription&&this.challenge.startDate&&this.challenge.endDate&&this.challenge.program?.id)},buttonName(){return this.challenge&&this.challenge.id&&this.$t("engagementCenter.button.save")||this.$t("engagementCenter.button.create")},programSuggesterLabels(){return{searchPlaceholder:this.$t("challenges.programSuggester.searchPlaceholder"),placeholder:this.$t("challenges.programSuggester.placeholder"),noDataLabel:this.$t("challenges.programSuggester.noDataLabel")}}},created(){this.$root.$on("edit-challenge-details",this.open),this.$root.$on("edit-manuel-rule",this.editManuelRule)},methods:{reset(){this.challenge={points:20},this.$refs.challengeDatePicker.startDate=null,this.$refs.challengeDatePicker.endDate=null},open(e){this.challenge=e&&JSON.parse(JSON.stringify(e))||{points:20,enabled:!0,description:""};const t=this.getChallengeStatus();this.$refs.challengeDrawer.open(),this.$nextTick().then((()=>{this.$refs.challengeDescription.initCKEditor(),"STARTED"===t||"ENDED"===t?(this.$refs.challengeDatePicker.startDate=new Date(this.challenge.startDate),this.$refs.challengeDatePicker.endDate=this.challenge.endDate,this.$refs.challengeDatePicker.disabledStartDate=!0,this.disabledSuggester=!0):(this.$refs.challengeDatePicker.startDate=this.challenge.startDate,this.$refs.challengeDatePicker.endDate=this.challenge.endDate)}))},editManuelRule(e){this.$challengesServices.getChallengeById(e.id).then((e=>this.open(e)))},close(){this.reset(),this.$refs.challengeDrawer.close()},updateChallengeStartDate(e){e&&this.$set(this.challenge,"startDate",e)},updateChallengeEndDate(e){e&&this.$set(this.challenge,"endDate",e)},addDescription(e){e&&this.$set(this.challenge,"description",e)},getChallengeStatus(){const e=new Date,t=new Date(this.challenge&&this.challenge.startDate),a=new Date(this.challenge&&this.challenge.endDate);return t.getTime()>e.getTime()&&a.getTime()>e.getTime()?"NOTSTARTED":t.getTime()<e.getTime()&&a.getTime()>e.getTime()||this.getFromDate(a)===this.getFromDate(e)?"STARTED":a.getTime()<e.getTime()&&t.getTime()<e.getTime()?"ENDED":void 0},getFromDate(e){return this.$engagementCenterUtils.getFromDate(e)},saveChallenge(){if(this.challenge.startDate>this.challenge.endDate)this.$engagementCenterUtils.displayAlert(this.$t("challenges.challengeDateError"),"error");else if(this.challenge.id){const e=JSON.parse(JSON.stringify(this.challenge));e.programId=this.challenge.program.id,e.program=this.challenge.program.title,this.$refs.challengeDrawer.startLoading(),this.$challengesServices.updateChallenge(e).then((e=>{this.$engagementCenterUtils.displayAlert(this.$t("challenges.challengeUpdateSuccess")),this.$root.$emit("challenge-updated",e),this.$root.$emit("program-rules-refresh"),this.close(),this.challenge={}})).catch((e=>{console.error(e),this.$engagementCenterUtils.displayAlert(this.$t("challenges.challengeCreateError"),"error")})).finally((()=>this.$refs.challengeDrawer.endLoading()))}else{const e=JSON.parse(JSON.stringify(this.challenge));e.programId=this.challenge.program.id,e.program=this.challenge.program.title,this.$refs.challengeDrawer.startLoading(),this.$challengesServices.saveChallenge(e).then((e=>{this.$root.$emit("challenge-added",e),this.$engagementCenterUtils.displayAlert(this.$t("challenges.challengeCreateSuccess")),this.close(),this.challenge={}})).catch((e=>{console.error(e),this.$engagementCenterUtils.displayAlert(this.$t("challenges.challengeCreateError"),"error")})).finally((()=>this.$refs.challengeDrawer.endLoading()))}}}},x,[],!1,null,null,null);y.options.__file="src/main/webapp/vue-app/engagement-center/components/challenges/ChallengeProgramDrawer.vue";const D=y.exports;var S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"challengeDates"},[a("div",{staticClass:"challengePlanDateCalender d-flex align-center"},[a("i",{staticClass:"uiIconStartDate uiIconBlue"}),e._v(" "),e.disabledStartDate?a("div",{staticClass:"subtitle-1 mx-4 mt-1"},[a("date-format",{attrs:{id:"engagementCenterChallengeStartDate",value:e.startDate}})],1):a("div",{attrs:{id:"engagementCenterChallengeStartDatePicker"}},[a("date-picker",{ref:"challengeStartDate",staticClass:"flex-grow-1 my-auto",attrs:{"default-value":!1,placeholder:e.$t("challenges.label.startDate"),"max-value":e.maximumStartDate,"min-value":e.minimumStartDate,disabled:e.disabledStartDate},on:{input:function(t){return e.emitStartDate(e.startDate)}},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1)]),e._v(" "),e.startDate?e._e():a("div",{staticClass:"mx-3 mt-n2 justify-center"},[a("span",{staticClass:"error--text"},[e._v("\n      * "+e._s(e.$t("challenges.label.requiredStartDate"))+"\n    ")])]),e._v(" "),a("div",{staticClass:"challengeEndDateCalender d-flex align-center mt-1"},[a("i",{staticClass:"uiIconEndDate uiIconBlue"}),e._v(" "),e.disabledEndDate?a("div",{staticClass:"subtitle-1 mx-4 mt-1"},[a("date-format",{attrs:{id:"engagementCenterChallengeEndDatePicker",value:e.endDate}})],1):a("div",{attrs:{id:"engagementCenterChallengeEndDatePicker"}},[a("date-picker",{ref:"challengeEndDate",staticClass:"flex-grow-1 my-auto",attrs:{"default-value":!1,placeholder:e.$t("challenges.label.endDate"),"min-value":e.minimumEndDate,disabled:e.disabledEndDate},on:{input:function(t){return e.emitEndDate(e.endDate)}},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)]),e._v(" "),e.endDate?e._e():a("div",{staticClass:"mx-3 mt-n2 justify-center"},[a("span",{staticClass:"error--text"},[e._v("\n      * "+e._s(e.$t("challenges.label.requiredEndDate"))+"\n    ")])])])};S._withStripped=!0;var E=l({name:"ChallengeDatePicker",data:()=>({startDate:null,endDate:null,disabledStartDate:!1,disabledEndDate:!1}),computed:{minimumStartDate:()=>new Date,maximumStartDate(){if(this.endDate){const e=new Date(this.endDate);return e.setDate(e.getDate()-1),e}return null},minimumEndDate(){let e=new Date;return this.startDate&&(e=new Date(this.startDate)),e.setDate(e.getDate()+1),e}},mounted(){$(".challengeDate").off("click").on("click",(()=>{this.$refs.challengeStartDate.menu=!1,this.$refs.challengeEndDate.menu=!1}))},methods:{emitStartDate(e){if(e){const t=new Date(e);this.$emit("startDateChanged",this.$engagementCenterUtils.getIsoDate(t))}},emitEndDate(e){if(e){const t=new Date(e);this.$emit("endDateChanged",this.$engagementCenterUtils.getIsoDate(t))}}}},S,[],!1,null,null,null);E.options.__file="src/main/webapp/vue-app/engagement-center/components/challenges/ChallengeDatePicker.vue";const T=E.exports;var A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("exo-drawer",{ref:"winnersDetails",attrs:{id:"EngagementCenterWinnersDetails",right:""},on:{closed:e.close}},[a("template",{slot:"title"},[a("div",[e.back?a("i",{staticClass:"uiIcon uiArrowBAckIcon",on:{click:e.close}}):e._e(),e._v(" "),a("span",{staticClass:"pb-2"},[e._v(" "+e._s(e.$t("challenges.winners.details"))+" ")])])]),e._v(" "),a("template",{slot:"content"},e._l(e.listWinners,(function(t){return a("v-list-item",{key:t.user},[a("v-list-item-content",{staticClass:"d-inline"},[a("exo-user-avatar",{attrs:{"profile-id":t.user,size:44,"bold-title":"","link-style":"",popover:""}},[a("template",{slot:"subTitle"},[a("a",{attrs:{href:e.getLinkActivity(t.activityId)}},[a("relative-date-format",{staticClass:"text-capitalize-first-letter text-light-color text-truncate",attrs:{value:t.createDate}})],1)])],2)],1),e._v(" "),a("v-list-item-action",[t.noActivityId?a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("a",e._g({},s),[a("span",[a("v-icon",{staticClass:"not-clickable ",attrs:{size:"16",color:"grey"}},[e._v("fas fa-eye")])],1)])]}}],null,!0)},[e._v(" "),a("span",[e._v(e._s(e.$t("program.winner.label.noActivity")))]),e._v("\n          "+e._s(e.$t("challenges.winners.details"))+"\n        ")]):a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on;return[a("a",e._g({},n),[a("span",[a("v-icon",{attrs:{size:"16",color:"dark-grey"},on:{click:function(a){return e.redirectToLinkActivity(t.activityId)}}},[e._v("fas fa-eye")])],1)])]}}],null,!0)},[e._v(" "),a("span",[e._v(e._s(e.$t("program.winner.label.checkActivity")))])])],1)],1)})),1),e._v(" "),e.showPagination?a("template",{slot:"footer"},[a("div",{staticClass:"text-center"},[a("v-pagination",{attrs:{length:e.paginationPageCount,circle:"",light:"",flat:""},on:{input:e.loadMore},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)]):e._e()],2)};A._withStripped=!0;var k=l({data:()=>({challengeId:!1,showLoadMoreButton:!1,announcementTotalCount:0,page:1,loading:!0,announcement:[],listWinners:[],earnerType:"USER"}),watch:{loading(){this.loading?this.$refs.winnersDetails.startLoading():this.$refs.winnersDetails.endLoading()},announcementPerPage(){this.retrieveAnnouncements()}},created(){this.$root.$on("open-winners-drawer",this.open)},computed:{paginationPageCount(){return Math.ceil(this.announcementTotalCount/this.announcementPerPage)},showPagination(){return this.announcementTotalCount>=this.announcementPerPage},announcementPerPage(){return Math.round((this.$vuetify.breakpoint.height-122)/70)}},methods:{getLinkActivity:e=>`${eXo.env.portal.context}/${eXo.env.portal.portalName}/activity?id=${e}`,redirectToLinkActivity(e){window.location.href=`${eXo.env.portal.context}/${eXo.env.portal.portalName}/activity?id=${e}`},close(){this.$refs.winnersDetails.close(),this.page=1},open(e){this.announcementTotalCount=e?.announcementsCount,this.listWinners=[],this.challengeId=e?.id,this.$refs.winnersDetails.open(),this.retrieveAnnouncements(this.earnerType)},loadMore(){this.retrieveAnnouncements()},retrieveAnnouncements(e){this.loading=!0;const t=(this.page-1)*this.announcementPerPage;this.listWinners=[],this.$challengesServices.getAllAnnouncementsByChallenge(this.challengeId,e,t,this.announcementPerPage).then((e=>{e.length>0&&e.filter((e=>e.assignee)).map((e=>{const t={user:e.assignee,activityId:e.activityId,createDate:e.createdDate,noActivityId:null===e.activityId};this.listWinners.push(t)}))})).finally((()=>this.loading=!1))}}},A,[],!1,null,null,null);k.options.__file="src/main/webapp/vue-app/engagement-center/components/challenges/WinnersDrawer.vue";const P=k.exports;var I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-flex",{attrs:{id:e.id}},[a("v-autocomplete",{ref:"selectAutoComplete",staticClass:"identitySuggester identitySuggesterInputStyle",attrs:{label:e.labels.label,placeholder:e.labels.placeholder,items:e.domains,loading:e.loadingSuggestions,multiple:e.multiple,"hide-no-data":"","append-icon":"","menu-props":"closeOnClick, closeOnContentClick, maxHeight = 100","content-class":"identitySuggesterContent",width:"100%","max-width":"100%","item-text":"title","item-value":"id","return-object":"","persistent-hint":"","hide-selected":"",chips:"","cache-items":"",dense:"",flat:"",required:"",attach:""},on:{"update:search-input":function(t){e.searchTerm=t}},scopedSlots:e._u([{key:"selection",fn:function(t){var s=t.item,n=t.selected;return[a("v-chip",{staticClass:"identitySuggesterItem",attrs:{"input-value":n,close:!0},on:{"click:close":function(t){e.program=null}}},[a("span",{staticClass:"text-truncate"},[e._v("\n          "+e._s(s.title)+"\n        ")])])]}},{key:"item",fn:function(t){return[a("v-list-item-title",{staticClass:"text-truncate identitySuggestionMenuItemText",domProps:{textContent:e._s(t.item.title)}})]}}]),model:{value:e.program,callback:function(t){e.program=t},expression:"program"}},[a("template",{slot:"no-data"},[a("v-list-item",{staticClass:"pa-0"},[a("v-list-item-title",{staticClass:"px-2"},[e._v("\n          "+e._s(e.labels.searchPlaceholder)+"\n        ")])],1)],1)],2)],1)};I._withStripped=!0;var O=l({props:{multiple:{type:Boolean,default:function(){return!1}},onlyOwned:{type:Boolean,default:!1},value:{type:Object,default:null},labels:{type:Object,default:()=>({label:"",placeholder:"",searchPlaceholder:"",noDataLabel:""})},includeDeleted:{type:Boolean,default:function(){return!1}},includeDisabled:{type:Boolean,default:function(){return!1}}},data:()=>({id:`AutoComplete${parseInt(1e4*Math.random())}`,domains:[],program:null,searchTerm:null,loadingSuggestions:!1,broadcast:!0,startSearchAfterInMilliseconds:300,endTypingKeywordTimeout:50,startTypingKeywordTimeout:0,typing:!1}),watch:{searchTerm(){this.startTypingKeywordTimeout=Date.now()+this.startSearchAfterInMilliseconds,this.typing||(this.typing=!0,this.waitForEndTyping())},program(){this.program!==this.value&&this.$emit("input",this.program)},value(){!this.domains.length&&this.value&&this.domains.push(this.value)},includeDeleted(){this.$refs.selectAutoComplete.cachedItems=[]}},created(){this.program=this.value,this.program&&(this.domains=[this.program])},mounted(){$(`#${this.id} input`).on("blur",(()=>{this.$refs.selectAutoComplete.isFocused=!1}))},methods:{remove(e){this.value=null,this.$emit("removeProgram",e.title)},waitForEndTyping(){window.setTimeout((()=>{Date.now()>this.startTypingKeywordTimeout?(this.typing=!1,this.searchPrograms()):this.waitForEndTyping()}),this.endTypingKeywordTimeout)},focus(){this.$refs.selectAutoComplete.focus()},searchPrograms(){this.searchTerm&&this.searchTerm.length?(this.focus(),this.previousSearchTerm&&this.previousSearchTerm===this.searchTerm||(this.loadingSuggestions=0,this.domains=[],this.$programsServices.retrievePrograms(0,10,"ALL",this.includeDisabled?"ALL":"ENABLED",this.searchTerm,this.includeDeleted).then((e=>{this.onlyOwned?this.domains=e?.domains.filter((e=>e?.owners.find((e=>e.id===eXo.env.portal.userIdentityId)))):this.domains=e.domains}))),this.previousSearchTerm=this.searchTerm):this.domains=[]}}},I,[],!1,null,null,null);O.options.__file="src/main/webapp/vue-app/engagement-center/components/common/ProgramSuggester.vue";const M=O.exports;var L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[e.initialized?e._e():a("main",[a("v-toolbar",{attrs:{color:"transparent",flat:""}},[a("v-spacer"),e._v(" "),a("v-progress-circular",{staticClass:"mb-2",attrs:{color:"primary",indeterminate:""}}),e._v(" "),a("v-spacer")],1)],1),e._v(" "),a("main",[a("v-tabs",{staticClass:"mb-4",attrs:{id:"engagementCenterTabs","slider-size":"4"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab",{staticClass:"px-5"},[e._v(e._s(e.$t("engagementCenter.label.programs")))]),e._v(" "),a("v-tab",{staticClass:"px-5"},[e._v(e._s(e.$t("engagementCenter.label.challenges")))]),e._v(" "),a("v-tab",{staticClass:"px-5"},[e._v(e._s(e.$t("engagementCenter.label.achievements")))])],1),e._v(" "),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",[a("engagement-center-programs",{directives:[{name:"show",rawName:"v-show",value:!e.displayProgramDetail,expression:"!displayProgramDetail"}],attrs:{id:"engagementCenterProgramsTab","is-administrator":e.isAdministrator}}),e._v(" "),e.displayProgramDetail?a("engagement-center-program-detail",{attrs:{program:e.program,events:e.events,"is-administrator":e.isAdministrator,"action-value-extensions":e.actionValueExtensions}}):e._e()],1),e._v(" "),a("v-tab-item",[a("challenges",{attrs:{"challenge-id":e.challengeId,"can-add-challenge":e.canAddChallenge}})],1),e._v(" "),a("v-tab-item",[a("realizations",{directives:[{name:"show",rawName:"v-show",value:!e.displayProgramDetail,expression:"!displayProgramDetail"}],attrs:{id:"Realizations","earner-id":e.earnerId,"is-administrator":e.isAdministrator,"action-value-extensions":e.actionValueExtensions}}),e._v(" "),e.displayProgramDetail?a("engagement-center-program-detail",{attrs:{program:e.program,events:e.events,"is-administrator":e.isAdministrator,"action-value-extensions":e.actionValueExtensions,tab:2}}):e._e()],1)],1)],1),e._v(" "),a("challenge-drawer",{ref:"challengeDrawer",attrs:{"is-administrator":e.isAdministrator}}),e._v(" "),a("engagement-center-rule-detail-drawer",{ref:"ruleDetails",attrs:{tab:e.tab,"action-value-extensions":e.actionValueExtensions}}),e._v(" "),a("engagement-center-winners-details",{ref:"winnersDetails"}),e._v(" "),a("engagement-center-program-drawer",{ref:"programDrawer",attrs:{"is-administrator":e.isAdministrator}}),e._v(" "),a("engagement-center-program-owners-drawer",{ref:"ownersDetails"})],1)};L._withStripped=!0;const R={props:{isAdministrator:{type:Boolean,default:!1}},data:()=>({initialized:!1,tab:null,earnerId:eXo.env.portal.userIdentityId,challengeId:null,program:null,canAddChallenge:!1,displayProgramDetail:!1,events:[],avoidAddToHistory:!1,extensionApp:"engagementCenterActions",actionValueExtensionType:"user-actions",actionValueExtensions:{}}),watch:{tab(){this.avoidAddToHistory||(0===this.tab?window.history.pushState("Engagement Center",this.$t("engagementCenter.label.programs"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs`):1===this.tab?window.history.pushState("Engagement Center",this.$t("engagementCenter.label.challenges"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges`):2===this.tab&&window.history.pushState("Engagement Center",this.$t("engagementCenter.label.achievements"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/achievements`),this.displayProgramDetail=!1),this.avoidAddToHistory=!1}},created(){this.$root.$on("open-program-detail",(e=>{this.program=e,this.displayProgramDetail=!0})),this.$root.$on("close-program-detail",(()=>this.displayProgramDetail=!1)),this.initTabs(),this.$ruleServices.getEvents().then((e=>{this.events=e||[]})),this.$challengesServices.canAddChallenge().then((e=>this.canAddChallenge=e)),this.initialized=!0,window.addEventListener("popstate",(e=>this.initTabs(e))),document.addEventListener(`extension-${this.extensionApp}-${this.actionValueExtensionType}-updated`,this.refreshActionValueExtensions),this.refreshActionValueExtensions()},methods:{initTabs(e){e&&(this.avoidAddToHistory=!0),this.switchTabs()},switchTabs(){const e=document.location.search||document.location.pathname,t=e.match(/\d+/)&&e.match(/\d+/).join("");e.indexOf(`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs`)>-1?(t&&this.$programsServices.getProgramById(t).then((e=>{e&&e.id&&(this.$root.$emit("open-program-detail",e),window.history.replaceState("programs",this.$t("engagementCenter.label.programs"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs/${e.id}`))})),this.tab=0):e.indexOf(`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges`)>-1||e.indexOf(`${eXo.env.portal.context}/${eXo.env.portal.portalName}/challenges`)>-1?(this.id=t,this.tab=1):e.indexOf(`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/achievements`)>-1&&(this.tab=2)},refreshActionValueExtensions(){const e=extensionRegistry.loadExtensions(this.extensionApp,this.actionValueExtensionType);let t=!1;e.forEach((e=>{!e.type||!e.options||this.actionValueExtensions[e.type]&&this.actionValueExtensions[e.type]===e.options||(this.actionValueExtensions[e.type]=e.options,t=!0)})),t&&(this.actionValueExtensions=Object.assign({},this.actionValueExtensions))}}};var N=l(R,L,[],!1,null,null,null);N.options.__file="src/main/webapp/vue-app/engagement-center/components/EngagementCenter.vue";const z=N.exports;var j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-flex",{staticClass:"searchNoResults justify-center d-flex border-box-sizing emptyChallenges"},[a("div",{staticClass:"d-flex flex-column"},[a("img",{staticClass:"mx-auto mb-2",attrs:{src:"/gamification-portlets/skin/images/challenge_not_found_filter_image.png",alt:e.$t("challenges.search.noResults"),width:"230px",loading:"lazy"}}),e._v(" "),a("div",{staticClass:"d-flex flex-column text-center text-sub-title"},[e.info?a("span",{staticClass:"text-header-title text-light-color"},[e._v(e._s(e.info))]):e._e(),e._v(" "),e.infoMessage?a("span",{staticClass:"text-sub-title subtitle-1 text-light-color"},[e._v(e._s(e.infoMessage))]):e._e()])])])};j._withStripped=!0;var B=l({props:{info:{type:String,default:""},infoMessage:{type:String,default:""}}},j,[],!1,null,null,null);B.options.__file="src/main/webapp/vue-app/engagement-center/components/common/NoResultFound.vue";const U=B.exports;var F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"border-box-sizing",attrs:{id:"EngagementCenterPrograms",role:"main",flat:""}},[e.isAdministrator?a("v-toolbar",{staticClass:"px-4 mt-4",attrs:{color:"transparent","max-height":"64",flat:""}},[a("div",{staticClass:"border-box-sizing clickable"},[e.canAddProgram?a("v-btn",{staticClass:"btn btn-primary",attrs:{id:"engagementCenterAddProgramBtn"},on:{click:function(t){return e.$root.$emit("open-program-drawer")}}},[a("v-icon",{attrs:{small:""}},[e._v("fas fa-plus")]),e._v(" "),a("span",{staticClass:"mx-2 d-none d-lg-inline text-capitalize-first-letter subtitle-1"},[e._v("\n          "+e._s(e.$t("programs.button.addProgram"))+"\n        ")])],1):e._e()],1),e._v(" "),a("v-spacer"),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.status,expression:"status"}],staticClass:"my-auto ignore-vuetify-classes text-truncate challengeQuickFilter width-auto",attrs:{id:"EngagementCenterApplicationCProgramsQuickFilter"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.status=t.target.multiple?a:a[0]},e.filter]}},e._l(e.programStatus,(function(t){return a("option",{key:t.value,domProps:{value:t.value}},[a("span",{staticClass:"d-none d-lg-inline"},[e._v("\n          "+e._s(t.text)+"\n        ")])])})),0)],1):e._e(),e._v(" "),a("v-layout",{staticClass:"pa-3"},[a("v-row",{attrs:{"no-gutters":""}},e._l(e.programs,(function(t){return a("v-col",{key:t.id,staticClass:"mb-4",attrs:{cols:"12",sm:"6",lg:"4"}},[a("engagement-center-program-card",{staticClass:"mx-2",attrs:{program:t,"is-administrator":e.isAdministrator}})],1)})),1)],1),e._v(" "),e.hasMore?a("v-row",{staticClass:"ml-6 mr-6 mb-6 mt-n4"},[a("v-btn",{staticClass:"loadMoreButton my-4 btn",attrs:{loading:e.loading,disabled:e.loading,block:""},on:{click:function(t){return e.$root.$emit("program-load-more")}}},[e._v("\n      "+e._s(e.$t("engagementCenter.button.ShowMore"))+"\n    ")])],1):e._e(),e._v(" "),e.confirmDelete?a("exo-confirm-dialog",{ref:"deleteProgramConfirmDialog",attrs:{message:e.deleteConfirmMessage,title:e.$t("programs.label.title.confirmDeleteRule"),"ok-label":e.$t("programs.label.ok.button"),"cancel-label":e.$t("programs.label.cancel.button")},on:{ok:e.deleteProgram}}):e._e(),e._v(" "),e.displayNoSearchResult&&!e.isStatusDisabled?a("engagement-center-welcome-message",{staticClass:"mx-16 mb-5",scopedSlots:e._u([{key:"content",fn:function(){return[a("div",{staticClass:"mx-4 my-6 dark-grey-color"},[a("p",{staticClass:"align-center font-weight-bold mb-5"},[e._v(" "+e._s(e.$t("programs.label.welcome"))+" ")]),e._v(" "),a("p",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.welcomeMessage,expression:"welcomeMessage"}],staticClass:"align-center mb-5"}),e._v(" "),a("p",{staticClass:"align-center"},[e._v(" "+e._s(e.$t("programs.label.seeYouSoon"))+" ")])])]},proxy:!0}],null,!1,437614053)}):e.displayNoSearchResult&&e.isStatusDisabled?a("engagement-center-no-results",{staticClass:"mt-11",attrs:{info:e.$t("program.filter.noResults")}}):e._e()],1)};F._withStripped=!0;const X={props:{isAdministrator:{type:Boolean,default:!1}},data:()=>({programs:[],totalSize:0,pageSize:9,loading:!1,canAddProgram:!1,type:"ALL",status:"ENABLED",deleteConfirmMessage:"",selectedProgram:{},initialized:!1,offset:0,limit:9,users:[],limitToFetch:0,originalLimitToFetch:0}),computed:{programStatus(){return[{text:this.$t("programs.status.allPrograms"),value:"ALL"},{text:this.$t("programs.status.enabledPrograms"),value:"ENABLED"},{text:this.$t("programs.status.disabledPrograms"),value:"DISABLED"}]},displayNoSearchResult(){return!this.loading&&0===this.totalSize},welcomeMessage(){return this.$t("programs.label.welcomeMessage",{0:`<a class="primary--text font-weight-bold" href="${eXo.env.portal.context}/${eXo.env.portal.portalName}/spaces/">`,1:"</a>"})},hasMore(){return this.loading||this.limitToFetch<this.totalSize},isStatusDisabled(){return"DISABLED"===this.status}},watch:{loading(){this.loading?document.dispatchEvent(new CustomEvent("displayTopBarLoading")):document.dispatchEvent(new CustomEvent("hideTopBarLoading"))}},created(){this.limitToFetch=this.originalLimitToFetch=this.limit;const e=[];e.push(this.computeCanAddProgram()),e.push(this.retrievePrograms()),this.$root.$on("program-load-more",this.loadMore),this.$root.$on("program-added",this.refreshPrograms),this.$root.$on("program-updated",this.refreshPrograms),this.$root.$on("delete-program",this.confirmDelete),Promise.all(e).finally((()=>this.$root.$applicationLoaded()))},methods:{computeCanAddProgram(){return this.$programsServices.canAddProgram().then((e=>this.canAddProgram=e))},retrievePrograms(){return this.loading=!0,this.$programsServices.retrievePrograms(this.offset,this.limitToFetch,this.type,this.status).then((e=>{this.programs=e.domains,this.totalSize=e.domainsSize||0})).finally((()=>{this.initialized||this.$root.$applicationLoaded(),this.loading=!1,this.initialized=!0}))},loadMore(){return this.hasMore&&(this.limitToFetch+=this.pageSize),this.retrievePrograms()},refreshPrograms(){return this.retrievePrograms()},filter(){return this.resetSearch(),this.retrievePrograms()},resetSearch(){this.limitToFetch!==this.originalLimitToFetch&&(this.limitToFetch=this.originalLimitToFetch)},deleteProgram(){this.loading=!0,this.$programsServices.deleteProgram(this.selectedProgram.id).then((e=>{this.$root.$emit("program-deleted",e),this.$engagementCenterUtils.displayAlert(this.$t("programs.programDeleteSuccess")),this.retrievePrograms()})).finally((()=>this.loading=!1))},confirmDelete(e){this.selectedProgram=e,this.deleteConfirmMessage=this.$t("programs.label.message.confirmDeleteRule",{0:e.title}),this.$refs.deleteProgramConfirmDialog.open()}}};var V=l(X,F,[],!1,null,null,null);V.options.__file="src/main/webapp/vue-app/engagement-center/components/programs/Programs.vue";const W=V.exports;var K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"card engagement-center-card",attrs:{id:"engagementCenterProgramCard",height:"240","max-height":"240",outlined:"",hover:""}},[a("div",{on:{click:e.openProgramDetail}},[a("v-img",{staticClass:"primary--text",attrs:{src:e.programCover,alt:e.$t("programs.cover.default"),width:"100%","aspect-ratio":"1","min-height":"70","min-width":"70","max-height":"100"}},[a("engagement-center-program-menu",{attrs:{"is-administrator":e.isAdministrator,program:e.program}})],1),e._v(" "),a("v-list",{staticClass:"d-flex py-1",attrs:{"min-height":"70",dense:""}},[a("v-list-item",{staticClass:"px-3"},[a("v-list-item-content",{staticClass:"align-center text-wrap text-break py-0"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("span",e._g(e._b({staticClass:"d-flex-inline position-relative text-truncate-2 font-weight-bold text-subtitle-1 text--secondary"},"span",n,!1),s),[e._v("\n                "+e._s(e.program.title)+"\n              ")])]}}])},[e._v("\n            "+e._s(e.program.title)+"\n          ")])],1)],1)],1),e._v(" "),a("div",{staticClass:"d-flex justify-center pb-4 mt-n2"},[a("v-icon",{staticClass:"pe-2 primary--text",attrs:{size:"18"}},[e._v("fas fa-trophy")]),e._v(" "),a("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.$t("programs.budget",e.$t(e.programBudgetLabel)),expression:"$t('programs.budget', $t(programBudgetLabel))"}],staticClass:"text-light-color text-caption"})],1)],1),e._v(" "),a("div",{staticClass:"d-flex mb-0 mx-2"},[a("div",{staticClass:"pa-1"},[a("span",{staticClass:"my-auto caption text-light-color"},[e._v(" "+e._s(this.$t("programs.details.label.hosts"))+" ")])]),e._v(" "),a("v-spacer"),e._v(" "),a("engagement-center-avatars-list",{attrs:{avatars:e.owners,"max-avatars-to-show":4,"avatars-count":e.ownersCount,size:25},on:{"open-avatars-drawer":function(t){return e.$root.$emit("open-owners-drawer",e.owners)}}})],1)])};K._withStripped=!0;var J=l({props:{program:{type:Object,default:null},isAdministrator:{type:Boolean,default:!1}},data:()=>({showMenu:!1}),computed:{programCover(){return this.program?.coverUrl||""},programBudgetLabel(){return{0:`<span>${this.programBudget} ${this.$t("programs.details.label.points")}</span>`}},programBudget(){return this.program?.rulesTotalScore||0},addedOwnersList(){return(this.program?.owners||[]).filter((e=>e.domainOwner&&!this.program?.space?.managers.includes(e.remoteId))).map((e=>({userName:e.remoteId})))},spaceManagers(){return this.program?.space?.managers},spaceManagersList(){return(this.spaceManagers||[]).map((e=>({userName:e})))},owners(){return this.addedOwnersList.concat(this.spaceManagersList)},ownersCount(){return this.owners?.length}},methods:{openProgramDetail(){this.$root.$emit("open-program-detail",this.program),window.history.replaceState("programs",this.$t("engagementCenter.label.programs"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs/${this.program.id}`)}}},K,[],!1,null,null,null);J.options.__file="src/main/webapp/vue-app/engagement-center/components/programs/ProgramCard.vue";const q=J.exports;var H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.showActionsMenu?a("v-menu",{attrs:{left:!e.$vuetify.rtl,right:e.$vuetify.rtl,bottom:"","offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"pull-right primary ma-2",attrs:{icon:"",width:"26",height:"26"},on:{blur:e.closeMenu}},"v-btn",n,!1),s),[a("v-icon",{attrs:{size:"15",color:"white"}},[e._v("fas fa-ellipsis-v")])],1)]}}],null,!1,2628859312),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[e._v(" "),a("v-list",{staticClass:"pa-0",attrs:{dense:""}},[a("v-list-item",{attrs:{dense:""},on:{mousedown:function(e){return e.preventDefault()},click:e.editProgram}},[a("v-layout",{staticClass:"me-3"},[a("v-icon",{staticClass:"dark-grey-color pb-2px",attrs:{size:"13"}},[e._v("fas fa-edit")])],1),e._v(" "),a("v-list-item-title",{staticClass:"d-flex"},[e._v(e._s(e.$t("programs.button.editProgram")))])],1),e._v(" "),a("v-list-item",{attrs:{dense:""},on:{mousedown:function(e){return e.preventDefault()},click:e.deleteProgram}},[a("v-layout",{staticClass:"me-3"},[a("v-icon",{staticClass:"dark-grey-color pb-2px",attrs:{size:"13"}},[e._v("fas fa-trash-alt")])],1),e._v(" "),a("v-list-item-title",{staticClass:"d-flex"},[e._v("\n        "+e._s(e.$t("programs.button.deleteProgram"))+"\n      ")])],1)],1)],1):e._e()};H._withStripped=!0;var G=l({props:{program:{type:Object,default:null},isAdministrator:{type:Boolean,default:!1}},data:()=>({showMenu:!1}),computed:{programCover(){return this.program?.coverUrl||""},programBudgetLabel(){return{0:`<span>${this.programBudget} ${this.$t("programs.details.label.points")}</span>`}},programBudget(){return this.program?.rulesTotalScore||0},showActionsMenu(){return this.isAdministrator||this.program?.userInfo?.canEdit},addedOwnersList(){return(this.program?.owners||[]).filter((e=>e.domainOwner&&!this.program?.space?.managers.includes(e.remoteId))).map((e=>({userName:e.remoteId})))},spaceManagers(){return this.program?.space?.managers},spaceManagersList(){return(this.spaceManagers||[]).map((e=>({userName:e})))},owners(){return this.addedOwnersList.concat(this.spaceManagersList)},ownersCount(){return this.owners?.length}},created(){$(document).mousedown((()=>{this.showMenu&&window.setTimeout((()=>{this.showMenu=!1}),200)}))},methods:{editProgram(e){e&&(e.preventDefault(),e.stopPropagation()),this.$root.$emit("edit-program-details",this.program)},deleteProgram(e){e&&(e.preventDefault(),e.stopPropagation()),this.$root.$emit("delete-program",this.program)},closeMenu(){this.showMenu=!1}}},H,[],!1,null,null,null);G.options.__file="src/main/webapp/vue-app/engagement-center/components/programs/ProgramMenu.vue";const Y=G.exports;var Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("exo-drawer",{ref:"programDrawer",staticClass:"EngagementCenterDrawer",attrs:{right:!e.$vuetify.rtl,eager:""},scopedSlots:e._u([e.drawer?{key:"content",fn:function(){return[e.program?a("v-card-text",[e.warning?a("div",{staticClass:"alert alert-error v-content mb-4"},[a("i",{staticClass:"uiIconError"}),e._v("\n        "+e._s(e.warning)+"\n      ")]):e._e(),e._v(" "),a("v-form",{ref:"form",attrs:{id:"EngagementCenterProgramDrawerForm"},on:{submit:function(e){e.preventDefault(),e.stopPropagation()}},model:{value:e.isValidForm,callback:function(t){e.isValidForm=t},expression:"isValidForm"}},[a("v-textarea",{staticClass:"pl-0 pt-0 EngagementCenter-title",attrs:{id:"EngagementCenterProgramDrawerTitleTextArea",rules:[e.rules.length],placeholder:e.$t("programs.label.enterProgramTitle"),name:"programTitle","auto-grow":"",rows:"1","row-height":"13",required:"",autofocus:""},model:{value:e.program.title,callback:function(t){e.$set(e.program,"title",t)},expression:"program.title"}}),e._v(" "),a("v-divider",{staticClass:"my-2"}),e._v(" "),a("div",{staticClass:"py-2"},[a("span",{staticClass:"subtitle-1"},[e._v(" "+e._s(e.$t("programs.label.programCover")))]),e._v(" "),a("engagement-center-image-selector",{ref:"programCover",staticClass:"mb-2",attrs:{id:"engagementCenterProgramDrawerImageSelector"},on:{updated:e.addCover},model:{value:e.program.coverUrl,callback:function(t){e.$set(e.program,"coverUrl",t)},expression:"program.coverUrl"}}),e._v(" "),a("span",{staticClass:"caption mt-2 text-light-color"},[a("v-icon",{staticClass:"mb-1",attrs:{small:""}},[e._v("fas fa-info-circle")]),e._v("\n            "+e._s(e.$t("programs.label.coverWarning"))+"\n          ")],1)],1),e._v(" "),a("div",{staticClass:"py-2"},[a("engagement-center-description-editor",{ref:"programDescription",attrs:{id:"engagementCenterProgramDrawerDescriptionEditor",label:e.$t("programs.label.describeProgram")},on:{"validity-updated":function(t){e.validDescription=t}},model:{value:e.program.description,callback:function(t){e.$set(e.program,"description",t)},expression:"program.description"}})],1),e._v(" "),e.showBudget?a("div",{staticClass:"mt-4"},[a("span",{staticClass:"subtitle-1"},[e._v(e._s(e.$t("programs.label.budget")))]),e._v(" "),[a("v-list-item",{staticClass:"px-0",attrs:{flat:"",dense:""}},[a("v-list-item-content",{staticClass:"f me-2 points"},[a("v-text-field",{staticClass:"pt-2 points mt-n3",attrs:{id:"EngagementCenterProgramDrawerBudget",rules:[e.rules.value],type:"number",outlined:"",required:""},model:{value:e.program.budget,callback:function(t){e.$set(e.program,"budget",t)},expression:"program.budget"}})],1),e._v(" "),a("v-list-item-content",{staticClass:"flex flex-grow-0 flex-shrink-0 me-2"},[a("span",{staticClass:"caption mx-2 text-light-color"},[e._v(" "+e._s(e.$t("programs.label.budgetPerWeek"))+" ")])])],1)]],2):e._e(),e._v(" "),a("span",{staticClass:"subtitle-1"},[e._v(e._s(e.$t("programs.label.audienceSpace")))]),e._v(" "),a("exo-identity-suggester",{ref:"programSpaceSuggester",attrs:{id:"EngagementCenterProgramDrawerSpaceSuggester",name:"programSpaceAutocomplete",items:e.audience&&[e.audience]||[],"search-options":e.audienceSearchOptions,labels:e.spaceSuggesterLabels,width:220,"include-spaces":""},model:{value:e.audience,callback:function(t){e.audience=t},expression:"audience"}}),e._v(" "),a("div",{staticClass:"mt-4"},[a("span",{staticClass:"subtitle-1"},[e._v(" "+e._s(e.$t("programs.label.programOwners")))]),e._v(" "),a("div",{staticClass:"d-flex"},[a("v-icon",{staticClass:"me-1",attrs:{small:""}},[e._v("fas fa-info-circle")]),e._v(" "),a("span",{staticClass:"caption text-light-color"},[e._v(" "+e._s(e.$t("programs.label.accessPermission")))])],1)]),e._v(" "),e.audience?a("v-row",{staticClass:"pa-0 mx-0 mt-4 mb-2"},[a("v-col",{staticClass:"pa-0 d-flex align-center"},[a("span",[e._v(" "+e._s(e.$t("programs.label.spaceHostsOf")))])]),e._v(" "),a("v-col",{staticClass:"pa-0 d-flex align-center"},[e.spaceId?a("exo-space-avatar",{attrs:{"space-id":e.spaceId,"extra-class":" ms-auto d-flex align-center primary--text"}}):e._e()],1)],1):e._e(),e._v(" "),e.audience?a("engagement-center-program-owner-assignment",{ref:"programAssignment",staticClass:"mt-4",attrs:{id:"engagementCenterProgramOwnerAssignee",audience:e.audience,multiple:""},model:{value:e.programOwners,callback:function(t){e.programOwners=t},expression:"programOwners"}}):e._e(),e._v(" "),e.isExternalOwner?a("div",{staticClass:"error--text mt-1"},[e._v("\n          "+e._s(e.$t("programs.label.externalOwner.warning"))+"\n        ")]):e._e(),e._v(" "),a("div",{staticClass:"mt-4"},[a("div",{staticClass:"d-flex"},[a("span",{staticClass:"subtitle-1 me-auto"},[e._v(e._s(e.$t("programs.label.status")))]),e._v(" "),a("v-switch",{staticClass:"my-0 ms-0 me-n1",attrs:{id:"engagementCenterProgramDrawerSwitch"},model:{value:e.program.enabled,callback:function(t){e.$set(e.program,"enabled",t)},expression:"program.enabled"}})],1),e._v(" "),a("div",{staticClass:"caption text-light-color"},[a("v-icon",{staticClass:"me-1",attrs:{small:""}},[e._v("fas fa-info-circle")]),e._v("\n            "+e._s(e.$t("programs.label.programStatusSubtitle"))+"\n          ")],1)])],1)],1):e._e()]},proxy:!0}:null],null,!0),model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("template",{slot:"title"},[a("span",{staticClass:"pb-2"},[e._v(" "+e._s(e.drawerTitle)+" ")])]),e._v(" "),e._v(" "),a("template",{slot:"footer"},[a("div",{staticClass:"d-flex mr-2"},[a("v-spacer"),e._v(" "),a("v-btn",{staticClass:"btn mx-1",attrs:{disabled:e.loading},on:{click:e.close}},[e._v("\n        "+e._s(e.$t("engagementCenter.button.cancel"))+"\n      ")]),e._v(" "),a("v-btn",{staticClass:"btn btn-primary",attrs:{disabled:e.disabledSave,loading:e.loading},on:{click:e.save}},[e._v("\n        "+e._s(e.buttonName)+"\n      ")])],1)])],2)};Q._withStripped=!0;var Z=l({props:{isAdministrator:{type:Boolean,default:!1}},data:()=>({program:null,programOwners:[],audience:null,warning:null,isValidForm:!0,drawer:!1,showMenu:!1,loading:!1,showBudget:!1,validDescription:!1,programSpace:null}),computed:{audienceSearchOptions(){return this.isAdministrator&&{filterType:"all"}||{filterType:"manager"}},drawerTitle(){return this.program?.id?this.$t("programs.button.editProgram"):this.$t("programs.button.addProgram")},disabledSave(){return!this.isValidForm||!this.audienceId||!this.validDescription||this.isExternalOwner},buttonName(){return this.program&&this.program.id&&this.$t("engagementCenter.button.save")||this.$t("engagementCenter.button.create")},spaceId(){return this.audience?.spaceId},audienceId(){return Number(this.audience?.spaceId)||0},spaceSuggesterLabels(){return{searchPlaceholder:this.$t("programs.label.spaces.noDataLabel"),placeholder:this.$t("programs.label.spaces.placeholder")}},rules(){return{length:e=>e&&e.length<50||this.$t("programs.label.TitleLengthExceed"),value:e=>e>=0&&e<=9999||this.$t("challenges.label.pointsValidation")}},isExternalOwner(){return this.programOwners.some((e=>e.external))}},watch:{loading(){this.loading?this.$refs.programDrawer.startLoading():this.$refs.programDrawer.endLoading()},audience(){this.drawer&&!this.audience?.spaceId&&(this.program.space=null,this.programOwners=[],document.dispatchEvent(new CustomEvent("audienceChanged")))}},created(){this.$root.$on("edit-program-details",this.open),this.$root.$on("open-program-drawer",this.open),$(document).mousedown((()=>{this.showMenu&&window.setTimeout((()=>{this.showMenu=!1}),200)}))},methods:{open(e){if(this.program=e&&JSON.parse(JSON.stringify(e))||{budget:0,enabled:!0,owners:[]},this.programOwners=this.program?.owners?.filter((e=>e.domainOwner)).slice()||[],this.program?.id&&this.program?.space){const e=this.program?.space;this.audience={id:`space:${e.prettyName}`,profile:{avatarUrl:e.avatarUrl,fullName:e.displayName},providerId:"space",remoteId:e.prettyName,spaceId:this.program.space.id,displayName:this.program.space.displayName,notToChange:!0}}else this.audience=null;this.$refs.programDrawer.open(),this.$nextTick().then((()=>this.$refs.programDescription.initCKEditor()))},close(){this.$refs.programDrawer.close(),this.program={}},addDescription(e){e&&this.$set(this.program,"description",e)},addCover(e){e&&this.$set(this.program,"coverUploadId",e)},save(){if(!this.disabledSave)if(this.program.type="MANUAL",this.loading=!0,this.program?.id){const e=JSON.parse(JSON.stringify(this.program));e.owners=this.programOwners?.map((e=>e.id)).filter((e=>!!e)),e.audienceId=this.audienceId,this.$programsServices.updateProgram(e).then((e=>{this.close(),this.$root.$emit("program-updated",e),this.$engagementCenterUtils.displayAlert(this.$t("programs.programUpdateSuccess"))})).catch((()=>{this.$engagementCenterUtils.displayAlert(this.$t("programs.programUpdateError"),"error")})).finally((()=>this.loading=!1))}else{const e=JSON.parse(JSON.stringify(this.program));e.owners=this.programOwners?.map((e=>e.id)).filter((e=>!!e)),e.audienceId=this.audienceId,this.$programsServices.saveProgram(e).then((e=>{this.$root.$emit("program-added",e),this.close(),this.$engagementCenterUtils.displayAlert(this.$t("programs.programCreateSuccess"))})).catch((()=>{this.$engagementCenterUtils.displayAlert(this.$t("programs.programCreateError"),"error")})).finally((()=>this.loading=!1))}}}},Q,[],!1,null,null,null);Z.options.__file="src/main/webapp/vue-app/engagement-center/components/programs/ProgramDrawer.vue";const ee=Z.exports;var te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{id:"ownersDetails"}},[a("exo-drawer",{ref:"ownersDetails",attrs:{right:""},on:{closed:e.close}},[a("template",{slot:"title"},[a("div",[e.back?a("v-icon",{on:{click:e.close}},[e._v("\n          fas fa-arrow-left\n        ")]):e._e(),e._v(" "),a("span",{staticClass:"pb-2"},[e._v(" "+e._s(e.$t("programs.label.programOwners")))])],1)]),e._v(" "),a("template",{slot:"content"},e._l(e.listOwners,(function(e){return a("exo-user-avatar",{key:e.id,attrs:{"profile-id":e.userName,size:44,"extra-class":"px-4 py-3","bold-title":"","link-style":"",popover:""}})})),1)],2)],1)};te._withStripped=!0;var ae=l({data:()=>({listOwners:[],program:null}),created(){this.$root.$on("open-owners-drawer",this.open)},methods:{close(){this.$refs.ownersDetails.close()},open(e){this.listOwners=e,this.$refs.ownersDetails.open()}}},te,[],!1,null,null,null);ae.options.__file="src/main/webapp/vue-app/engagement-center/components/programs/ProgramOwnersDrawer.vue";const se=ae.exports;var ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pa-2 pa-sm-5",attrs:{id:"engagementCenterProgramDetail"}},[e.isDeleted?a("engagement-center-program-deleted",{on:{"back-to-list":e.backToProgramList}}):a("div",[a("div",{staticClass:"py-2 py-sm-5 d-flex"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("div",e._g({staticClass:"d-flex my-auto clickable",on:{click:function(t){return e.backToProgramList()}}},s),[a("v-icon",{staticClass:"px-3",attrs:{size:"18"}},[e._v("\n              fas fa-arrow-left\n            ")]),e._v(" "),a("div",{staticClass:"text-header-title"},[e._v(" "+e._s(e.programTitle)+" ")])],1)]}}],null,!1,267354636)},[e._v(" "),a("span",[e._v(e._s(e.$t("programs.details.label.BackToList")))])]),e._v(" "),a("v-spacer"),e._v(" "),a("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.$t("programs.budget",e.$t(e.programBudgetLabel)),expression:"$t('programs.budget', $t(programBudgetLabel))"}],staticClass:"text-header-title d-none d-sm-block"})],1),e._v(" "),a("div",{staticClass:"d-flex flex-grow-1"},[a("v-img",{staticClass:"d-flex primary--text border-color",attrs:{src:e.programCover,alt:e.$t("programs.cover.default"),"min-height":36,"max-height":e.height,height:"auto","min-width":"100%",width:"100%"}},[a("engagement-center-program-menu",{attrs:{"is-administrator":e.isAdministrator,program:e.program}})],1)],1),e._v(" "),a("div",{staticClass:"d-sm-flex"},[a("div",{staticClass:"me-auto pe-sm-6 pt-5"},[a("v-list-item",{staticClass:"px-0",attrs:{"two-line":""}},[a("v-list-item-content",{staticClass:"pa-0"},[a("div",{staticClass:"text-subtitle-1 text-color font-weight-bold mb-0"},[e._v("\n              "+e._s(e.$t("programs.details.label.description"))+"\n            ")]),e._v(" "),a("v-list-item-subtitle",{staticClass:"text-color pt-2"},[a("div",{staticClass:"d-flex flex-grow-0 flex-shrink-1 pb-sm-5 rich-editor-content"},[a("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.programDescription,expression:"programDescription"}],staticClass:"mt-1 align-self-center text-wrap text-left text-break"})])])],1)],1)],1),e._v(" "),a("div",{staticClass:"pt-sm-5 px-0 col-sm-3"},[a("div",{staticClass:"text-color text-subtitle-1 font-weight-bold width-fit-content ms-sm-auto"},[e._v("\n          "+e._s(e.$t("programs.details.label.programOwners"))+"\n        ")]),e._v(" "),a("engagement-center-avatars-list",{staticClass:"justify-sm-end pt-2",attrs:{avatars:e.owners,"max-avatars-to-show":3,"avatars-count":e.ownersCount,size:25},on:{"open-avatars-drawer":function(t){return e.$root.$emit("open-owners-drawer",e.owners)}}}),e._v(" "),a("div",{staticClass:"text-color text-subtitle-1 font-weight-bold pt-3 width-fit-content ms-sm-auto"},[e._v("\n          "+e._s(e.$t("programs.details.label.audienceSpace"))+"\n        ")]),e._v(" "),a("exo-space-avatar",{staticClass:"d-flex justify-sm-end pt-2",attrs:{space:e.space,size:32,popover:""}})],1)]),e._v(" "),a("div",{staticClass:"pt-5"},[a("v-list-item",{staticClass:"px-0",attrs:{"two-line":""}},[a("v-list-item-content",[a("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.$t("programs.budget",e.$t(e.programBudgetLabel)),expression:"$t('programs.budget', $t(programBudgetLabel))"}],staticClass:"text-header-title subtitle-1 d-sm-none mb-5"}),e._v(" "),a("v-list-item-title",{staticClass:"text-color font-weight-bold"},[e._v("\n            "+e._s(e.$t("programs.details.label.rulesOfProgram"))+"\n          ")]),e._v(" "),e.canManageRule?a("v-flex",{staticClass:"d-flex  mt-5"},[a("div",{staticClass:"text-no-wrap mt-sm-3"},[a("div",{staticClass:"d-inline-block"},[a("v-btn",{staticClass:"btn btn-primary",attrs:{small:""},on:{click:e.openNewRuleForm}},[a("v-icon",{attrs:{dark:""}},[e._v("\n                    mdi-plus\n                  ")]),e._v(" "),a("span",{staticClass:"ms-2 d-none d-lg-inline subtitle-1"},[e._v("\n                    "+e._s(e.$t("programs.details.rule.button.addRule"))+"\n                  ")])],1)],1)]),e._v(" "),a("div",{staticClass:"d-flex ms-auto"},[a("engagement-center-rule-filter",{on:{"filter-applied":e.applyFilter}})],1)]):e._e(),e._v(" "),a("v-list-item-subtitle",{staticClass:"text-color pt-4"},[a("v-data-table",{attrs:{headers:e.rulesHeaders,items:e.programRulesToDisplay,options:e.options,"server-items-length":e.totalSize,"no-data-text":e.$t("programs.details.rules.noRules"),loading:e.loadingRules,"show-rows-border":!1,"mobile-breakpoint":"0","hide-default-footer":"","disable-sort":""},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"item",fn:function(t){return[a("engagement-center-rule-item",{attrs:{rule:t.item,"can-manage-rule":e.canManageRule,"action-value-extensions":e.actionValueExtensions},on:{"delete-rule":e.confirmDelete}})]}},e.displayFooter?{key:"footer",fn:function(t){var s=t.props;return[a("v-divider"),e._v(" "),a("div",{staticClass:"text-center"},[a("v-pagination",{attrs:{length:s.pagination.pageCount,circle:"",light:"",flat:""},on:{input:e.retrieveProgramRules},model:{value:e.options.page,callback:function(t){e.$set(e.options,"page",t)},expression:"options.page"}})],1)]}}:null],null,!0)})],1)],1)],1),e._v(" "),a("engagement-center-rule-form-drawer",{attrs:{events:e.events,program:e.program}}),e._v(" "),e.confirmDelete?a("exo-confirm-dialog",{ref:"deleteRuleConfirmDialog",attrs:{message:e.deleteConfirmMessage,title:e.$t("programs.details.title.confirmDeleteRule"),"ok-label":e.$t("programs.details.ok.button"),"cancel-label":e.$t("programs.details.cancel.button")},on:{ok:e.deleteRule}}):e._e()],1)])],1)};ne._withStripped=!0;var ie=l({props:{program:{type:Object,default:null},events:{type:Array,default:()=>[]},tab:{type:Number,default:()=>0},isAdministrator:{type:Boolean,default:!1},actionValueExtensions:{type:Object,default:function(){return null}}},data:()=>({displayProgramDetail:!1,programRules:[],options:{page:1,itemsPerPage:25},totalSize:0,loadingRules:!1,deleteConfirmMessage:"",filter:"ENABLED",expand:"userAnnouncements"}),computed:{programRulesToDisplay(){return this.programRules.filter((e=>!e.deleted))},programTitle(){return this.program?.title},programBudget(){return this.program?.rulesTotalScore||0},programBudgetLabel(){return{0:`<span class="font-weight-bold success-color">${this.programBudget} ${this.$t("programs.details.label.points")}</span>`}},programCover(){return this.program?.coverUrl||""},programDescription(){return this.program?.description||""},programId(){return this.program?.id},spaceId(){return this.program?.space?.id},isDeleted(){return this.program?.deleted},rulesHeaders(){return[{text:this.$t("programs.details.rules.action"),align:"start",width:"70%"},{text:"",align:"center",width:"15%"},{text:this.$t("programs.details.rules.points"),align:"center",width:"15%",enabled:!this.isMobile},{text:this.$t("gamification.overview.label.participants"),align:"center",width:"25%",enabled:!this.isMobile}].filter((e=>null==e.enabled||!0===e.enabled))},displayFooter(){return this.totalSize>this.options.itemsPerPage},canManageRule(){return this.isAdministrator||this.program?.userInfo?.canEdit},height(){return this.isMobile?70:173},isMobile(){return this.$vuetify.breakpoint.xsOnly},space(){return this.program?.space},spaceManagers(){return this.space?.managers},spaceManagersList(){return(this.spaceManagers||[]).map((e=>({userName:e})))},addedOwners(){return(this.program?.owners||[]).filter((e=>e.domainOwner&&!this.program?.space?.managers.includes(e.remoteId))).map((e=>({userName:e.remoteId})))},owners(){return this.addedOwners.concat(this.spaceManagersList)},ownersCount(){return this.owners?.length}},watch:{program(){this.retrieveProgramRules()},options(){this.retrieveProgramRules()}},created(){this.$root.$on("challenge-delete-confirm",this.confirmDelete),this.$root.$on("program-rules-refresh",this.retrieveProgramRules),this.$root.$on("program-deleted",this.backToProgramList),this.$root.$on("program-updated",this.programUpdated),window.addEventListener("popstate",(()=>{this.backToProgramList()}))},methods:{programUpdated(e){e.id===this.program.id&&(this.program=e)},applyFilter(e){this.filter=e,this.retrieveProgramRules()},retrieveProgramRules(){const e=this.options&&this.options.page;let t=this.options&&this.options.itemsPerPage;t<=0&&(t=this.totalSize||10);const a=(e-1)*t;return this.loadingRules=!0,this.$ruleServices.getRules(null,this.programId,this.filter,"ALL",a,t,this.expand).then((e=>(this.programRules=e.rules,this.totalSize=e.size||0,this.$nextTick()))).finally((()=>{this.loadingRules=!1}))},backToProgramList(){this.options.page=1,this.options.itemsPerPage=10,this.$root.$emit("close-program-detail"),0===this.tab?window.history.replaceState("Engagement Center",this.$t("engagementCenter.label.programs"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs`):2===this.tab&&window.history.replaceState("Engagement Center",this.$t("engagementCenter.label.achievements"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/achievements`)},openNewRuleForm(){this.$root.$emit("rule-form-drawer",null)},confirmDelete(e){this.selectedRule=e,this.deleteConfirmMessage=this.$t("programs.details.message.confirmDeleteRule",{0:this.ruleTitle(this.selectedRule)}),this.$refs.deleteRuleConfirmDialog.open()},deleteRule(){this.loading=!0,this.$ruleServices.deleteRule(this.selectedRule.id).then((e=>{this.$root.$emit("program-rule-deleted",e),this.$engagementCenterUtils.displayAlert(this.$t("programs.details.ruleDeleteSuccess")),this.retrieveProgramRules()})).finally((()=>this.loading=!1))},ruleTitle(e){let t=`exoplatform.gamification.gamificationinformation.rule.title.${e?.title}`,a=this.$t(t);return a===t&&(t=`exoplatform.gamification.gamificationinformation.rule.title.def_${e?.title}`,a=this.$t(t)),a===t?e?.title:a}}},ne,[],!1,null,null,null);ie.options.__file="src/main/webapp/vue-app/engagement-center/components/programs/ProgramDetail.vue";const re=ie.exports;var le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"EngagementCenterAssignItem"},[a("v-menu",{attrs:{id:"assigneeMenu","content-class":e.menuId,"close-on-content-click":!1,"nudge-left":0,"max-width":300,attach:"",transition:"scale-transition","offset-y":"","allow-overflow":"",eager:"",top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("div",{staticClass:"d-flex align-center"},[a("span",[e._v(e._s(e.$t("programs.label.and")))]),e._v(" "),a("v-btn",e._g({staticClass:"ms-auto pa-0",attrs:{id:"EngagementCenterAssignmentBtn",color:"primary",text:""}},s),[a("v-icon",{staticClass:"me-2",attrs:{size:"18"}},[e._v("fas fa-user-plus")]),e._v(" "),a("span",{staticClass:"text-capitalize"},[e._v(e._s(e.$t("programs.label.addOwners")))])],1)],1)]}}]),model:{value:e.globalMenu,callback:function(t){e.globalMenu=t},expression:"globalMenu"}},[e._v(" "),a("v-card",{staticClass:"pb-4 assignChallengeMenu pa-4"},[a("v-card-text",{staticClass:"pb-0 d-flex justify-space-between"},[a("span",[e._v(e._s(e.$t("challenges.label.assignTo"))+" :")]),e._v(" "),a("a",{staticClass:"ml-4",on:{click:function(t){return e.assignToMe()}}},[a("i",{staticClass:"uiIcon uiAssignToMeIcon"}),e._v(" "),a("span",[e._v(e._s(e.$t("challenges.label.addMe")))])])]),e._v(" "),a("exo-identity-suggester",{ref:"challengeSpaceSuggester",attrs:{"search-options":e.searchOptions,"ignore-items":e.ignoredMembers,"type-of-relations":e.relationsType,width:220,name:"challengeSpaceAutocomplete","include-users":""},model:{value:e.invitedChallengeAssignee,callback:function(t){e.invitedChallengeAssignee=t},expression:"invitedChallengeAssignee"}})],1)],1),e._v(" "),a("div",{staticClass:"assigneeName d-flex align-start flex-column"},e._l(e.assigneeObj,(function(t){return a("v-chip",{key:t,staticClass:"identitySuggesterItem mt-2",attrs:{close:""},on:{"click:close":function(a){return e.removeUser(t)}}},[a("v-avatar",{attrs:{left:""}},[a("v-img",{attrs:{src:t.avatarUrl}})],1),e._v(" "),a("span",{staticClass:"text-truncate"},[e._v("\n        "+e._s(t.fullName)+"\n      ")])],1)})),1)],1)};le._withStripped=!0;var oe=l({props:{value:{type:Array,default:()=>[]},globalMenu:{type:Boolean,default:!1},audience:{type:Object,default:()=>null},multiple:{type:Boolean,default:!1},onlyManager:{type:Boolean,default:!1},allowedUsers:{type:Array,default:null}},data:()=>({assigneeObj:[],invitedChallengeAssignee:[],currentUser:eXo.env.portal.userName,menu:!1,space:{},menuId:`AssigneeMenu${parseInt(1e4*Math.random())}`}),computed:{relationsType(){return this.audience?"member_of_space":""},searchOptions(){const e={currentUser:""},t=this.audience?.remoteId||this.audience?.prettyName;return t&&(e.spaceURL=t),e},ignoredMembers(){return this.assigneeObj?this.assigneeObj.map((e=>`organization:${e.remoteId}`)):""}},watch:{assigneeObj(){this.$emit("input",this.assigneeObj)},invitedChallengeAssignee(){if(!this.assigneeObj.find((e=>e.remoteId===(this.invitedChallengeAssignee&&this.invitedChallengeAssignee.remoteId)))&&this.invitedChallengeAssignee&&this.invitedChallengeAssignee.remoteId){let e={};this.$identityService.getIdentityByProviderIdAndRemoteId("organization",this.invitedChallengeAssignee.remoteId).then((t=>{e={id:t.profile.id,remoteId:t.profile.username,fullName:t.profile.fullname,avatarUrl:t.profile.avatar,external:t.profile.external||"true"===t.profile.dataEntity.external},this.multiple||(this.assigneeObj=[]),this.assigneeObj.push(e),this.$emit("add-manager",e.id),this.$emit("input",this.assigneeObj),this.invitedChallengeAssignee=null,this.globalMenu=!1})).finally((()=>{e&&this.$emit("add-item",e.id)}))}}},mounted(){$(document).on("click",(e=>{!e.target||$(e.target).parents(`.${this.menuId}`).length||$(e.target).parents(".v-autocomplete__content").length||(this.globalMenu=!1)}))},created(){this.assigneeObj=[],this.invitedChallengeAssignee=[],this.assigneeObj=this.value||[],this.space=this.audience,document.addEventListener("audienceChanged",(e=>{e&&e.detail?this.space=e.detail.space:this.space={}}))},methods:{assignToMe(){this.isAssigned(this.currentUser)||this.$identityService.getIdentityByProviderIdAndRemoteId("organization",this.currentUser).then((e=>{const t={id:e.profile.id,remoteId:e.profile.username,fullName:e.profile.fullname,avatarUrl:e.profile.avatar};this.multiple||(this.assigneeObj=[]),this.assigneeObj.push(t),this.$emit("add-item",t.id),this.$emit("input",this.assigneeObj)})),this.globalMenu=!1},isAssigned(e){return!!(this.assigneeObj&&this.assigneeObj.findIndex((t=>t.remoteId===e))>=0)},removeUser(e){if(this.multiple){const t=this.assigneeObj.findIndex((t=>t.remoteId===e.remoteId));this.assigneeObj.splice(t,1)}else this.assigneeObj=[];this.$emit("remove-user",e.id),this.$emit("input",this.assigneeObj)},reset(){this.assigneeObj=[]},setUp(e){this.assigneeObj=e}}},le,[],!1,null,null,null);oe.options.__file="src/main/webapp/vue-app/engagement-center/components/programs/ProgramOwnerAssignment.vue";const ce=oe.exports;var de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"d-flex"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("div",e._g({staticClass:"d-flex my-auto clickable",on:{click:function(t){return e.$emit("back-to-list")}}},s),[a("v-icon",{staticClass:"px-3",attrs:{size:"16"}},[e._v("\n            fas fa-arrow-left\n          ")]),e._v(" "),a("div",{staticClass:"text-subtitle-1 font-weight-bold dark-grey-color"},[e._v(" "+e._s(e.$t("programs.details.label.BackToList"))+" ")])],1)]}}])},[e._v(" "),a("span",[e._v(e._s(e.$t("programs.details.label.BackToList")))])])],1),e._v(" "),a("div",{staticClass:"pt-12 d-flex align-center justify-center"},[a("v-icon",{staticClass:"px-8 primary--text",attrs:{size:"40"}},[e._v("\n      fas fa-award\n    ")]),e._v(" "),a("v-icon",{staticClass:"px-4 px-sm-12 secondary--text",attrs:{size:"40"}},[e._v("\n      fas fa-stream\n    ")]),e._v(" "),a("v-icon",{staticClass:"px-8 primary--text",attrs:{size:"40"}},[e._v("\n      fas fa-trophy\n    ")])],1),e._v(" "),a("div",{staticClass:"d-flex flex-column justify-center align-center py-12"},[a("span",{staticClass:"text-header-title font-weight-regular"},[e._v("\n      "+e._s(e.$t("programs.details.programDeleted"))+"\n    ")]),e._v(" "),a("v-btn",{staticClass:"btn btn-primary mt-8",attrs:{href:e.programListLink}},[a("span",{staticClass:"mx-2 text-capitalize-first-letter subtitle-1"},[e._v("\n        "+e._s(e.$t("programs.details.programDeleted.explore"))+"\n      ")])])],1)])};de._withStripped=!0;var ue=l({data:()=>({programListLink:`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/programs`})},de,[],!1,null,null,null);ue.options.__file="src/main/webapp/vue-app/engagement-center/components/programs/ProgramDeleted.vue";const me=ue.exports;var pe=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"text-truncate",attrs:{title:e.ruleTitle}},[e._v("\n  "+e._s(e.ruleTitle)+"\n")])};pe._withStripped=!0;var ge=l({props:{rule:{type:Object,default:function(){return null}}},computed:{ruleTitle(){return this.$t(`exoplatform.gamification.gamificationinformation.rule.title.${this.rule?.title}`).includes("exoplatform.gamification.gamificationinformation.rule.title")?this.rule?.title:this.$t(`exoplatform.gamification.gamificationinformation.rule.title.${this.rule?.title}`)}}},pe,[],!1,null,null,null);ge.options.__file="src/main/webapp/vue-app/engagement-center/components/rules/RuleTitle.vue";const he=ge.exports;var ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var s=t.hover;return[a("tr",[a("td",{staticClass:"no-border-bottom ps-0"},[a("div",{staticClass:"clickable d-flex flex-row ma-auto",on:{click:e.openRule}},[a("div",{staticClass:"d-flex flex-column col-2 col-sm-1 pa-0"},[a("v-icon",{staticClass:"primary--text my-auto",attrs:{size:"22"}},[e._v("\n            "+e._s(e.actionIcon)+"\n          ")])],1),e._v(" "),a("div",{staticClass:"d-flex flex-column col-10 col-sm-11 pa-0 text-truncate"},[a("engagement-center-rule-title",{attrs:{rule:e.rule}}),e._v(" "),a("span",{staticClass:"d-sm-none text-caption text-sub-title"},[e._v(e._s(e.rule.score)+" "+e._s(e.$t("challenges.label.points")))])],1)])]),e._v(" "),a("td",{staticClass:"align-center no-border-bottom",attrs:{cols:"2"}},[s||e.isMobile?a("div",{staticClass:"d-flex"},[e.automaticRule?e._e():a("div",{staticClass:"align-center d-none d-sm-block"},[a("v-btn",{staticClass:"me-2",attrs:{icon:""},on:{click:function(t){return e.$root.$emit("rule-detail-drawer",e.rule,!0)}}},[a("v-icon",{attrs:{size:e.iconSize}},[e._v("fas fa-bullhorn")])],1)],1),e._v(" "),e.canManageRule?a("v-menu",{attrs:{left:!e.$vuetify.rtl,right:e.$vuetify.rtl,bottom:"","offset-y":"",attach:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"me-2",attrs:{icon:""},on:{blur:e.closeMenu}},"v-btn",n,!1),s),[a("v-icon",{staticClass:"icon-default-color",attrs:{size:e.iconSize}},[e._v("fas fa-ellipsis-v")])],1)]}}],null,!0),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),a("v-list",{staticClass:"pa-0",attrs:{dense:""}},[a("v-list-item",{attrs:{dense:""},on:{mousedown:function(e){return e.preventDefault()},click:e.editRule}},[a("v-layout",{staticClass:"me-3"},[a("v-icon",{staticClass:"dark-grey-color pb-2px",attrs:{size:"13"}},[e._v("fas fa-edit")])],1),e._v(" "),a("v-list-item-title",{staticClass:"d-flex"},[e._v(e._s(e.$t("programs.details.rule.button.edit")))])],1),e._v(" "),e.automaticRule?a("v-list-item",{attrs:{dense:""},on:{mousedown:function(e){return e.preventDefault()},click:e.deleteRule}},[a("v-layout",{staticClass:"me-3"},[a("v-icon",{staticClass:"dark-grey-color pb-2px",attrs:{size:"13"}},[e._v("fas fa-trash-alt")])],1),e._v(" "),a("v-list-item-title",{staticClass:"d-flex"},[e._v("\n                "+e._s(e.$t("programs.details.rule.button.delete"))+"\n              ")])],1):e._e()],1)],1):e._e()],1):e._e()]),e._v(" "),a("td",{staticClass:"no-border-bottom d-none d-sm-inline"},[a("div",{staticClass:"align-center"},[e._v("\n        "+e._s(e.rule.score)+"\n      ")])]),e._v(" "),a("td",{staticClass:"no-border-bottom  d-none d-sm-table-cell"},[a("div",{staticClass:"winners winnersAvatarsList d-flex flex-nowrap my-2 justify-center",class:e.showAllAvatarList&&"AllUsersAvatar"},[e.haveParticipants?a("engagement-center-avatars-list",{attrs:{avatars:e.ruleWinnerAvatars,"max-avatars-to-show":e.maxAvatarsToShow,"avatars-count":e.ruleWinnersCount,size:27},on:{"open-avatars-drawer":function(t){return e.$root.$emit("open-winners-drawer",e.rule)}}}):a("div",[a("span",[e._v("\n            -\n          ")])])],1)])])]}}])})};ve._withStripped=!0;var fe=l({props:{rule:{type:Object,default:null},canManageRule:{type:Boolean,default:!1},actionValueExtensions:{type:Object,default:function(){return null}}},data:()=>({menu:!1,maxAvatarsToShow:4}),computed:{automaticRule(){return"AUTOMATIC"===this.rule?.type},actionValueExtension(){return this.actionValueExtensions&&Object.values(this.actionValueExtensions).sort(((e,t)=>(e.rank||0)-(t.rank||0))).find((e=>e.match&&e.match(this.rule.event)))||null},actionIcon(){return this.automaticRule?this.actionValueExtension?.icon:"fas fa-trophy"},isMobile(){return this.$vuetify.breakpoint.xsOnly},iconSize(){return this.isMobile?13:16},ruleWinnerAvatars(){return this.rule?.announcements?.filter((e=>e.assignee)).map((e=>({userName:e.assignee})))||[]},ruleWinnersCount(){return this.rule?.announcementsCount||this.rule?.announcements.length||0},haveParticipants(){return 0!==this.ruleWinnersCount}},methods:{closeMenu(){this.menu=!1},editRule(){this.automaticRule?this.$root.$emit("rule-form-drawer",this.rule):this.$root.$emit("edit-manuel-rule",this.rule)},openRule(){this.$root.$emit("rule-detail-drawer",this.rule)},deleteRule(){this.$emit("delete-rule",this.rule)}}},ve,[],!1,null,null,null);fe.options.__file="src/main/webapp/vue-app/engagement-center/components/rules/RuleItem.vue";const _e=fe.exports;var be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("exo-drawer",{ref:"ruleFormDrawer",attrs:{right:"","body-classes":"hide-scroll decrease-z-index-more"},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("template",{slot:"title"},[e._v("\n    "+e._s(e.drawerTitle)+"\n  ")]),e._v(" "),a("template",{slot:"content"},[a("v-form",{ref:"RuleForm",staticClass:"form-horizontal pt-0 pb-4",attrs:{flat:""},on:{submit:e.updateRule}},[a("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left text-subtitle-1 pb-2"},[e._v("\n        "+e._s(e.$t("rule.form.label.rules"))+"\n      ")]),e._v(" "),a("v-card-text",{staticClass:"d-flex py-0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.rule.title,expression:"rule.title"}],ref:"ruleTitle",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{id:"ruleTitle",placeholder:e.$t("rule.form.label.title.placeholder"),type:"text",required:""},domProps:{value:e.rule.title},on:{input:function(t){t.target.composing||e.$set(e.rule,"title",t.target.value)}}})]),e._v(" "),a("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left text-subtitle-1 pb-2"},[e._v("\n        "+e._s(e.$t("rule.form.label.event"))+"\n      ")]),e._v(" "),a("v-card-text",{staticClass:"py-0"},[a("v-autocomplete",{ref:"EventSelectAutoComplete",staticClass:"pa-0",attrs:{id:"EventSelectAutoComplete",items:e.eventNames,"item-text":"label",filled:"","persistent-hint":"",dense:""},scopedSlots:e._u([{key:"selection",fn:function(t){return[a("v-chip",e._b({attrs:{"input-value":t.selected,title:t.item&&t.item.label||t.item},on:{click:t.select}},"v-chip",t.attrs,!1),[e._v("\n              "+e._s(t.item&&t.item.label||t.item)+"\n            ")])]}},{key:"item",fn:function(t){return[a("v-list-item-content",{domProps:{textContent:e._s(t.item.label)}})]}}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),e.eventExist?a("v-card-text",{staticClass:"error--text py-0"},[e._v("\n        "+e._s(e.$t("rule.form.error.sameEventExist"))+"\n      ")]):e._e(),e._v(" "),a("v-card-text",[a("div",{staticClass:"py-2"},[a("engagement-center-description-editor",{ref:"ruleDescription",attrs:{id:"ruleDescription",label:e.$t("rule.form.label.description"),placeholder:e.$t("rule.form.label.description.placeholder")},on:{addDescription:function(t){return e.addDescription(t)},"validity-updated":function(t){e.validDescription=t}},model:{value:e.rule.description,callback:function(t){e.$set(e.rule,"description",t)},expression:"rule.description"}})],1)]),e._v(" "),a("div",{staticClass:"d-flex flex-row pa-4"},[a("label",{staticClass:"text-subtitle-1 mt-1 pe-3"},[e._v(e._s(e.$t("rule.form.label.program")))]),e._v(" "),a("v-chip",{attrs:{color:"primary"}},[a("v-avatar",{attrs:{left:""}},[a("v-img",{attrs:{src:e.programCover}})],1),e._v(" "),a("span",{staticClass:"text-truncate"},[e._v("\n            "+e._s(e.programTitle)+"\n          ")])],1)],1),e._v(" "),a("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left text-subtitle-1 pb-2"},[e._v("\n        "+e._s(e.$t("rule.form.label.rewards"))+"\n      ")]),e._v(" "),a("div",{staticClass:"d-flex flex-row px-4"},[a("v-text-field",{staticClass:"mt-0 pt-0 me-2",staticStyle:{"max-width":"185px"},attrs:{"hide-details":"",outlined:"",dense:""},model:{value:e.rule.score,callback:function(t){e.$set(e.rule,"score",t)},expression:"rule.score"}}),e._v(" "),a("label",{staticClass:"my-auto"},[e._v(e._s(e.$t("rule.form.label.points")))])],1),e._v(" "),a("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left text-subtitle-1 pb-2"},[e._v("\n        "+e._s(e.$t("rule.form.label.status"))+"\n      ")]),e._v(" "),a("div",{staticClass:"d-flex flex-row px-4"},[a("label",{staticClass:"subtitle-1 text-light-color mt-1 pe-3"},[e._v(e._s(e.$t("rule.form.label.enabled")))]),e._v(" "),a("v-switch",{ref:"allowAttendeeToUpdateRef",staticClass:"mt-0 ms-4",attrs:{id:"allowAttendeeToUpdateRef"},model:{value:e.rule.enabled,callback:function(t){e.$set(e.rule,"enabled",t)},expression:"rule.enabled"}})],1)],1)],1),e._v(" "),a("template",{slot:"footer"},[a("div",{staticClass:"d-flex"},[a("v-spacer"),e._v(" "),a("v-btn",{staticClass:"btn me-2",on:{click:e.close}},[e._v("\n        "+e._s(e.$t("rule.form.label.button.cancel"))+"\n      ")]),e._v(" "),a("v-btn",{staticClass:"btn btn-primary",attrs:{disabled:e.disableSaveButton},on:{click:e.updateRule}},[e._v("\n        "+e._s(e.saveButtonLabel)+"\n      ")])],1)])],2)};be._withStripped=!0;var Ce=l({props:{program:{type:Object,default:()=>null},events:{type:Array,default:function(){return[]}}},data:()=>({rule:{},ruleToUpdate:{},saving:!1,eventMapping:[],drawer:!1,value:"",eventExist:!1,validDescription:!1,validEvent:!1}),computed:{eventNames(){return this.events.filter((e=>null!=e)).forEach((e=>{const t={};t.name=e;let a=`exoplatform.gamification.gamificationinformation.rule.title.${e}`,s=this.$t(a);s===a&&(a=`exoplatform.gamification.gamificationinformation.rule.title.def_${e}`,s=this.$t(a)),t.label=s===a?e:s,this.eventMapping.push(t)})),this.eventMapping},programCover(){return this.program?.coverUrl||""},programTitle(){return this.program?.title},ruleTitle(){return this.rule?.title},ruleId(){return this.rule?.id},ruleTitleValid(){return this.ruleTitle?.length>0},disableSaveButton(){return this.saving||!this.ruleTitleValid||!this.validDescription||!this.validEvent},drawerTitle(){return this.ruleId?this.$t("rule.form.label.edit"):this.$t("rule.form.label.add")},saveButtonLabel(){return this.ruleId?this.$t("rule.form.label.button.update"):this.$t("rule.form.label.button.add")}},watch:{value:{immediate:!0,handler(){this.emitSelectedValue(this.value),this.validEvent=this.value&&""!==this.value}}},created(){this.$root.$on("rule-form-drawer",(e=>{this.rule=e&&JSON.parse(JSON.stringify(e))||{score:20,enabled:!0,area:this.programTitle},this.eventExist=!1,this.$refs.ruleFormDrawer&&this.$refs.ruleFormDrawer.open(),window.setTimeout((()=>{this.$refs.ruleTitle&&this.$refs.ruleTitle.focus()}),200),this.$nextTick().then((()=>{this.$refs.ruleDescription.initCKEditor(),this.$root.$emit("rule-form-drawer-opened",this.rule),this.value=this.eventMapping.find((t=>t.name===e?.event))||""}))}))},methods:{close(){this.$refs.ruleDescription.destroyCKEditor(),this.$refs.ruleFormDrawer.close(),this.rule.enabled=!0,this.rule.event=null,this.$set(this.rule,"title",""),this.rule.description="",this.value={}},emitSelectedValue(e){const t=this.eventMapping.find((t=>t.label===e));t&&(this.$set(this.rule,"event",t.name),this.eventExist&&(this.eventExist=!1))},addDescription(e){e&&this.$set(this.rule,"description",e)},updateRule(){this.saving=!0,this.$refs.ruleFormDrawer.startLoading(),this.rule.id?this.$ruleServices.updateRule(this.rule).then((e=>{this.displayAlert(this.$t("programs.details.ruleUpdateSuccess")),this.$root.$emit("program-rules-refresh",e),this.close()})).catch((e=>{"409"===e.message&&(this.eventExist=!0)})).finally((()=>{this.saving=!1,this.$refs.ruleFormDrawer.endLoading()})):this.$ruleServices.createRule(this.rule,this.program).then((e=>{this.displayAlert(this.$t("programs.details.ruleCreationSuccess")),this.$root.$emit("program-rules-refresh",e),this.close()})).catch((e=>{"409"===e.message&&(this.eventExist=!0)})).finally((()=>{this.saving=!1,this.$refs.ruleFormDrawer.endLoading()}))},displayAlert(e,t){document.dispatchEvent(new CustomEvent("notification-alert",{detail:{message:e,type:t||"success"}}))}}},be,[],!1,null,null,null);Ce.options.__file="src/main/webapp/vue-app/engagement-center/components/rules/RuleFormDrawer.vue";const $e=Ce.exports;var we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("exo-drawer",{ref:"ruleDetailDrawer",attrs:{id:"ruleDetailDrawer",right:!e.$vuetify.rtl},on:{closed:e.close},scopedSlots:e._u([{key:"title",fn:function(){return[a("span",{staticClass:"pb-2"},[e._v(" "+e._s(e.$t("rule.detail.letsSeeWhatToDo"))+" ")])]},proxy:!0},{key:"content",fn:function(){return[a("v-card-text",[a("div",{staticClass:"d-flex"},[a("v-icon",{staticClass:"align-start primary--text",attrs:{size:"60"}},[e._v(e._s(e.actionIcon))]),e._v(" "),a("div",{staticClass:"mb-4 ms-4"},[a("div",{staticClass:"font-weight-bold mx-0 mt-0 mb-2"},[e._v(e._s(e.ruleTitle))]),e._v(" "),a("div",{staticClass:"font-weight-bold text--secondary"},[e._v(e._s(e.ruleScore)+" "+e._s(e.$t("challenges.label.points")))])])],1),e._v(" "),a("div",{staticClass:"d-flex flex-row pt-3 rich-editor-content text-break overflow-hidden"},[a("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.rule.description,expression:"rule.description"}]})]),e._v(" "),a("div",{staticClass:"d-flex flex-row py-3"},[a("v-img",{attrs:{src:e.program.coverUrl,height:e.programCoverSize,width:e.programCoverSize,"max-height":e.programCoverSize,"max-width":e.programCoverSize}}),a("span",{staticClass:"font-weight-bold my-auto ms-3"},[e._v(e._s(e.program.title))])],1),e._v(" "),e.automaticRule?e._e():a("div",{staticClass:"d-flex flex-row py-3"},[a("v-icon",{staticClass:"primary--text ps-1",attrs:{size:"30"}},[e._v("fas fa-calendar-day")]),a("span",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.DateInfo,expression:"DateInfo"}],staticClass:"my-auto ms-4"})],1),e._v(" "),!e.automaticRule&&e.isActiveRule?a("div",{staticClass:"d-flex flex-row py-3 clickable",on:{click:e.showEditor}},[a("v-icon",{staticClass:"primary--text",attrs:{size:"30"}},[e._v("fas fa-bullhorn")]),a("span",{staticClass:"font-weight-bold my-auto ms-3"},[e._v(e._s(e.$t("rule.detail.AnnounceYourAchievement"))+" ")])],1):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.editor,expression:"editor"}]},[!e.automaticRule&&e.isActiveRule?a("div",{staticClass:"d-flex flex-row pt-3"},[a("v-list-item",{staticClass:"text-truncate px-0"},[a("exo-space-avatar",{attrs:{"space-id":e.spaceId,"extra-class":"text-truncate",size:30,avatar:""}}),e._v(" "),a("exo-user-avatar",{attrs:{"profile-id":e.username,size:25,"extra-class":"ms-n4 mt-6",avatar:""}}),e._v(" "),a("v-list-item-content",{staticClass:"py-0 accountTitleLabel text-truncate"},[a("v-list-item-title",{staticClass:"font-weight-bold d-flex body-2 mb-0"},[a("exo-space-avatar",{attrs:{"space-id":e.spaceId,"extra-class":"text-truncate",fullname:"","bold-title":"","link-style":"","username-class":""}})],1),e._v(" "),a("v-list-item-subtitle",{staticClass:"d-flex flex-row flex-nowrap"},[a("exo-user-avatar",{attrs:{"profile-id":e.username,"extra-class":"text-truncate ms-2 me-1",fullname:"","link-style":"","small-font-size":"","username-class":""}})],1)],1)],1)],1):e._e(),e._v(" "),!e.automaticRule&&e.isActiveRule?a("div",{staticClass:"py-3"},[a("exo-activity-rich-editor",{ref:"announcementRichEditor",staticClass:"flex",attrs:{"max-length":e.MAX_LENGTH,"template-params":e.templateParams,placeholder:e.$t("rule.detail.announceEditor.placeholder"),"tag-enabled":!1,"ck-editor-type":"announcementContent"},on:{"validity-updated":function(t){e.validInput=t}},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}})],1):e._e()])])]},proxy:!0}])},[e._v(" "),e._v(" "),!e.automaticRule&&e.isActiveRule&&e.editor?a("template",{slot:"footer"},[a("div",{staticClass:"d-flex mr-2"},[a("v-spacer"),e._v(" "),a("v-btn",{staticClass:"btn me-2",on:{click:e.close}},[e._v("\n        "+e._s(e.$t("rule.detail.label.cancel"))+"\n      ")]),e._v(" "),a("v-btn",{staticClass:"btn btn-primary",attrs:{loading:e.sending,disabled:e.btnDisabled},on:{click:e.createAnnouncement}},[e._v("\n        "+e._s(e.$t("rule.detail.label.announce"))+"\n      ")])],1)]):e._e()],2)};we._withStripped=!0;var xe=l({props:{actionValueExtensions:{type:Object,default:function(){return null}},isOverviewDisplayed:{type:Boolean,default:!1},tabName:{type:String,default:null},tab:{type:Number,default:()=>0}},data:()=>({rule:{},program:{},drawer:!1,username:eXo.env.portal.userName,userId:eXo.env.portal.userIdentityId,validInput:!0,comment:null,templateParams:{},programCoverSize:35,MAX_LENGTH:1300,editorFocus:!1,editor:!1,sending:!1}),computed:{ruleTitle(){const e=`exoplatform.gamification.gamificationinformation.rule.title.${this.rule.title}`;return this.$te(e)?this.$t(e):this.rule.title},extendedActionValueComponent(){return this.actionValueExtension&&{componentName:"action-value",componentOptions:{vueComponent:this.actionValueExtension.vueComponent}}||null},actionValueExtension(){return this.actionValueExtensions&&Object.values(this.actionValueExtensions).sort(((e,t)=>(e.rank||0)-(t.rank||0))).find((e=>e.match&&e.match(this.rule.event)))||null},automaticRule(){return"AUTOMATIC"===this.rule?.type},actionIcon(){return this.automaticRule?this.actionValueExtension?.icon:"fas fa-trophy"},ruleScore(){return this.rule?.score||this.rule?.points},startDate(){return new Date(this.rule?.startDate).getTime()||0},endDate(){return new Date(this.rule?.endDate).getTime()||0},isActiveRule(){return this.automaticRule||this.startDate<=Date.now()&&this.endDate>=Date.now()},DateInfo(){if(this.isActiveRule){const e=Math.round((this.endDate-Date.now())/864e5)+1;return this.$t("rule.detail.challengeEndIn",{0:e})}if(this.endDate<Date.now())return this.$t("rule.detail.challengeEnded");{const e=Math.round((this.startDate-Date.now())/864e5)+1;return this.$t("rule.detail.challengeOpenIn",{0:e})}},spaceId(){return this.program?.audienceId},btnDisabled(){return!this.validInput||!this.comment||!this.comment.length}},watch:{rule(){this.isOverviewDisplayed||1!==this.tab||(this.rule?.id?window.history.replaceState("challenges",this.$t("challenges.challenges"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges/${this.rule.id}`):window.history.replaceState("challenges",this.$t("challenges.challenges"),`${eXo.env.portal.context}/${eXo.env.portal.portalName}/contributions/challenges`))},watch:{sending(){this.sending?this.$refs.ruleDetailDrawer.startLoading():this.$refs.ruleDetailDrawer.endLoading()}}},created(){this.$root.$on("rule-detail-drawer",((e,t)=>{this.rule=e,this.editorFocus=t,this.program=e?.domainDTO||e?.program,this.$refs.ruleDetailDrawer&&(this.$refs.ruleDetailDrawer.open(),this.$nextTick().then((()=>{!this.automaticRule&&this.isActiveRule&&(this.$refs.announcementRichEditor.initCKEditor(),this.editorFocus&&(this.editor=!0,this.setFocus()))})))})),document.addEventListener("rule-detail-drawer",(e=>{e&&e.detail&&(this.rule=e.detail,this.program=this.rule?.domainDTO||this.rule?.program,this.$refs.ruleDetailDrawer&&this.$refs.ruleDetailDrawer.open())}))},methods:{close(){this.$refs.ruleDetailDrawer.close(),this.rule={},this.comment=null,this.editor=!1,this.editorFocus=!1},open(){this.$refs.ruleDetailDrawer&&this.$refs.ruleDetailDrawer.open()},createAnnouncement(){const e={assignee:this.userId,comment:this.comment,challengeId:this.rule.id,challengeTitle:this.rule.title,templateParams:this.templateParams};this.sending=!0,this.$challengesServices.saveAnnouncement(e).then((e=>{this.$engagementCenterUtils.displayAlert(this.$t("challenges.announcementCreateSuccess")),this.$root.$emit("announcement-added",{detail:{announcement:e,challengeId:this.rule.id}}),this.close()})).catch((e=>{let t="";t="401"===e.message||"403"===e.message?this.$t("challenges.permissionDenied"):"406"===e.message?this.$t("challenges.challengeNotStartedOrEnded"):this.$t("challenges.announcementErrorSave"),this.$engagementCenterUtils.displayAlert(t,"error")})).finally((()=>{this.sending=!1}))},showEditor(){this.editor=!0,this.editorFocus=!0,this.setFocus()},setFocus(){window.setTimeout((()=>{const e=document.querySelector("#ruleDetailDrawer .drawerContent");e.scrollTo({top:e.scrollHeight,behavior:"smooth",block:"start"}),this.$refs.announcementRichEditor.setFocus()}),100)}}},we,[],!1,null,null,null);xe.options.__file="src/main/webapp/vue-app/engagement-center/components/rules/RuleDetailDrawer.vue";const ye=xe.exports;var De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-flex",{staticClass:"d-flex content-box-sizing justify-end"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],staticClass:"width-auto my-auto ignore-vuetify-classes d-none d-sm-inline",on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.filter=t.target.multiple?a:a[0]},e.applyFilter]}},e._l(e.ruleFilters,(function(t){return a("option",{key:t.value,domProps:{value:t.value}},[e._v("\n      "+e._s(t.text)+"\n    ")])})),0),e._v(" "),a("v-icon",{staticClass:"d-sm-none",attrs:{size:"18"},on:{click:e.openBottomMenuFilter}},[e._v("\n    fa-filter\n  ")]),e._v(" "),a("v-bottom-sheet",{staticClass:"pa-0",model:{value:e.bottomMenu,callback:function(t){e.bottomMenu=t},expression:"bottomMenu"}},[a("v-sheet",{staticClass:"text-center"},[a("v-toolbar",{staticClass:"border-box-sizing",attrs:{color:"primary",dark:""}},[a("v-btn",{attrs:{text:""},on:{click:function(t){e.bottomMenu=!1}}},[e._v("\n          "+e._s(e.$t("programs.details.filter.cancel"))+"\n        ")]),e._v(" "),a("v-spacer"),e._v(" "),a("v-toolbar-title",[a("v-icon",[e._v("fa-filter")]),e._v("\n          "+e._s(e.$t("programs.details.filter.cancel"))+"\n        ")],1),e._v(" "),a("v-spacer"),e._v(" "),a("v-btn",{attrs:{text:""},on:{click:e.changeFilterSelection}},[e._v("\n          "+e._s(e.$t("programs.details.filter"))+"\n        ")])],1),e._v(" "),a("v-list",e._l(e.ruleFilters,(function(t){return a("v-list-item",{key:t,on:{click:function(a){e.filterToChange=t.value}}},[a("v-list-item-title",{staticClass:"align-center d-flex"},[e.filterToChange===t.value?a("v-icon",[e._v("fa-check")]):a("span",{staticClass:"me-6"}),e._v(" "),a("v-spacer"),e._v(" "),a("div",[e._v("\n              "+e._s(t.text)+"\n            ")]),e._v(" "),a("v-spacer"),e._v(" "),a("span",{staticClass:"me-6"})],1)],1)})),1)],1)],1)],1)};De._withStripped=!0;var Se=l({data:()=>({filterToChange:null,bottomMenu:!1,filter:"ENABLED"}),computed:{ruleFilters(){return[{text:this.$t("programs.details.filter.all"),value:"ALL"},{text:this.$t("programs.details.filter.enabled"),value:"ENABLED"},{text:this.$t("programs.details.filter.disabled"),value:"DISABLED"}]}},methods:{applyFilter(){this.$emit("filter-applied",this.filter)},openBottomMenuFilter(){this.filterToChange=this.filter,this.bottomMenu=!0},changeFilterSelection(){this.bottomMenu=!1,this.filter=this.filterToChange,this.applyFilter()}}},De,[],!1,null,null,null);Se.options.__file="src/main/webapp/vue-app/engagement-center/components/rules/RuleFilter.vue";const Ee=Se.exports;var Te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"EngagementCenterAssignItem"},[a("v-menu",{attrs:{id:"assigneeMenu","content-class":e.menuId,"close-on-content-click":!1,"nudge-left":0,"max-width":300,attach:"",transition:"scale-transition","offset-y":"","allow-overflow":"",eager:"",bottom:"",disabled:e.disabledUnAssign},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("div",e._g({staticClass:"d-flex align-"},s),[a("a",{staticClass:"challengeAssignBtn align-end mt-n8",class:e.assignButtonClass,attrs:{id:"EngagementCenterAssignmentBtn",disabled:e.disabledUnAssign}},[a("i",{staticClass:"uiIcon uiAddAssignIcon"}),e._v(" "),a("span",{staticClass:"text-decoration-underline"},[e._v(e._s(e.$t("challenges.label.assign")))])])])]}}]),model:{value:e.globalMenu,callback:function(t){e.globalMenu=t},expression:"globalMenu"}},[e._v(" "),a("v-card",{staticClass:"pb-4 assignChallengeMenu pa-4"},[a("v-card-text",{staticClass:"pb-0 d-flex justify-space-between"},[a("span",[e._v(e._s(e.$t("challenges.label.assignTo"))+" :")]),e._v(" "),a("a",{staticClass:"ml-4",on:{click:function(t){return e.assignToMe()}}},[a("i",{staticClass:"uiIcon uiAssignToMeIcon"}),e._v(" "),a("span",[e._v(e._s(e.$t("challenges.label.addMe")))])])]),e._v(" "),a("exo-identity-suggester",{ref:"challengeSpaceSuggester",attrs:{"search-options":e.searchOptions,"ignore-items":e.ignoredMembers,"type-of-relations":e.relationsType,width:220,name:"challengeSpaceAutocomplete","include-users":""},model:{value:e.invitedChallengeAssignee,callback:function(t){e.invitedChallengeAssignee=t},expression:"invitedChallengeAssignee"}})],1)],1),e._v(" "),a("div",{staticClass:"assigneeName"},e._l(e.assigneeObj,(function(t){return a("v-chip",{key:t,staticClass:"identitySuggesterItem mx-1 mb-2",attrs:{close:!e.disabledUnAssign},on:{"click:close":function(a){return e.removeUser(t)}}},[a("v-avatar",{attrs:{left:""}},[a("v-img",{attrs:{src:t.avatarUrl}})],1),e._v(" "),a("span",{staticClass:"text-truncate"},[e._v("\n        "+e._s(t.fullName)+"\n      ")])],1)})),1)],1)};Te._withStripped=!0;var Ae=l({props:{value:{type:Array,default:()=>[]},globalMenu:{type:Boolean,default:!1},audience:{type:Object,default:()=>null},multiple:{type:Boolean,default:!1},onlyManager:{type:Boolean,default:!1},allowedUsers:{type:Array,default:null}},data:()=>({assigneeObj:[],invitedChallengeAssignee:[],currentUser:eXo.env.portal.userName,menu:!1,space:{},menuId:`AssigneeMenu${parseInt(1e4*Math.random())}`,disabledUnAssign:!1}),computed:{relationsType(){return this.audience?"member_of_space":""},searchOptions(){const e={currentUser:""},t=this.audience?.remoteId||this.audience?.prettyName;return t&&(e.spaceURL=t),e},assignButtonClass(){return this.assigneeObj&&this.assigneeObj.length&&"mt-2"},ignoredMembers(){return this.assigneeObj?this.assigneeObj.map((e=>`organization:${e.remoteId}`)):""}},watch:{assigneeObj(){this.$emit("input",this.assigneeObj)},invitedChallengeAssignee(){if(!this.assigneeObj.find((e=>e.remoteId===(this.invitedChallengeAssignee&&this.invitedChallengeAssignee.remoteId)))&&this.invitedChallengeAssignee&&this.invitedChallengeAssignee.remoteId){let e={};this.$identityService.getIdentityByProviderIdAndRemoteId("organization",this.invitedChallengeAssignee.remoteId).then((t=>{e={id:t.profile.id,remoteId:t.profile.username,fullName:t.profile.fullname,avatarUrl:t.profile.avatar},this.multiple||(this.assigneeObj=[]),this.assigneeObj.push(e),this.$emit("add-manager",e.id),this.$emit("input",this.assigneeObj),this.invitedChallengeAssignee=null,this.globalMenu=!1})).finally((()=>{e&&this.$emit("add-item",e.id)}))}}},mounted(){$(document).on("click",(e=>{!e.target||$(e.target).parents(`.${this.menuId}`).length||$(e.target).parents(".v-autocomplete__content").length||(this.globalMenu=!1)}))},created(){this.assigneeObj=[],this.invitedChallengeAssignee=[],this.assigneeObj=this.value||[],this.space=this.audience,document.addEventListener("audienceChanged",(e=>{e&&e.detail?this.space=e.detail.space:this.space={}}))},methods:{assignToMe(){this.isAssigned(this.currentUser)||this.$identityService.getIdentityByProviderIdAndRemoteId("organization",this.currentUser).then((e=>{const t={id:e.profile.id,remoteId:e.profile.username,fullName:e.profile.fullname,avatarUrl:e.profile.avatar};this.multiple||(this.assigneeObj=[]),this.assigneeObj.push(t),this.$emit("add-item",t.id),this.$emit("input",this.assigneeObj)})),this.globalMenu=!1},isAssigned(e){return!!(this.assigneeObj&&this.assigneeObj.findIndex((t=>t.remoteId===e))>=0)},removeUser(e){if(this.multiple){const t=this.assigneeObj.findIndex((t=>t.remoteId===e.remoteId));this.assigneeObj.splice(t,1)}else this.assigneeObj=[];this.$emit("remove-user",e.id),this.$emit("input",this.assigneeObj)},reset(){this.assigneeObj=[]},setUp(e){this.assigneeObj=e}}},Te,[],!1,null,null,null);Ae.options.__file="src/main/webapp/vue-app/engagement-center/components/common/Assignment.vue";const ke=Ae.exports;var Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"d-flex align-center"},[a("div",{staticClass:"d-flex"},e._l(e.avatarsTodisplay,(function(t){return a("exo-user-avatar",{key:t.userName,attrs:{"profile-id":t.userName,size:e.size,popover:"",avatar:"","extra-class":"me-1"}})})),1),e._v(" "),a("a",[e.seeMoreAvatarsToDisplay?a("v-avatar",{staticClass:"light-black-background icon-mini-size white--text font-weight-bold",attrs:{size:e.size},on:{click:function(t){return e.$emit("open-avatars-drawer")}}},[e._v("\n      +"+e._s(e.showMoreAvatarsNumber)+"\n    ")]):e._e()],1)])};Pe._withStripped=!0;var Ie=l({props:{avatars:{type:Array,default:()=>[]},maxAvatarsToShow:{type:Number,default:null},avatarsCount:{type:Number,default:null},size:{type:Number,default:null}},computed:{avatarsTodisplay(){return this.avatars.slice(0,this.maxAvatarsToShow-1)},seeMoreAvatarsToDisplay(){return this.avatarsCount>=this.maxAvatarsToShow||null},remainingAvatarsCount(){return this.avatarsCount-this.maxAvatarsToShow+1},showMoreAvatarsNumber(){return this.remainingAvatarsCount>99?99:this.remainingAvatarsCount}},methods:{openDrawer(){this.$root.$emit("open-avatars-drawer",this.avatars)}}},Pe,[],!1,null,null,null);Ie.options.__file="src/main/webapp/vue-app/engagement-center/components/common/AvatarsList.vue";const Oe=Ie.exports;var Me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"activityRichEditor newEditorToolbar",attrs:{id:"descriptionId"}},[e.label?a("div",{staticClass:"py-1 subtitle-1"},[e._v("\n    "+e._s(e.label)+"\n  ")]):e._e(),e._v(" "),e.displayPlaceholder?a("div",{staticClass:"caption text-sub-title position-absolute pa-5 ma-1px full-width",on:{click:function(t){return e.hidePlaceholder()}}},[e._v("\n    "+e._s(e.placeholder)+"\n  ")]):e._e(),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.inputVal,expression:"inputVal"}],ref:"editor",staticClass:"d-none",attrs:{id:"descriptionContent",cols:"30",rows:"10"},domProps:{value:e.inputVal},on:{input:function(t){t.target.composing||(e.inputVal=t.target.value)}}}),e._v(" "),a("div",{staticClass:"activityCharsCount",class:e.tooManyChars?"tooManyChars":""},[e._v("\n    "+e._s(e.charsCount)+e._s(e.maxLength>-1?" / "+e.maxLength:"")+"\n    "),a("i",{staticClass:"uiIconMessageLength"})])])};Me._withStripped=!0;var Le=l({props:{value:{type:String,default:null},label:{type:String,default:""},placeholder:{type:String,default:""},maxLength:{type:Number,default:()=>1300},autofocus:{type:Boolean,default:!1}},data:()=>({inputVal:"",minLength:1,disabled:!1,displayPlaceholder:!0,editor:null}),computed:{charsCount(){return this.inputVal&&this.$utils.htmlToText(this.inputVal).length||0},validLength(){return this.minLength<=this.charsCount&&this.charsCount<=this.maxLength},editorReady(){return this.editor&&"ready"===this.editor.status},isMobile(){return"sm"===this.$vuetify.breakpoint.name||"xs"===this.$vuetify.breakpoint.name},tooManyChars(){return this.charsCount>this.maxLength}},watch:{inputVal:{immediate:!0,handler(e){""!==e?this.displayPlaceholder&&(this.displayPlaceholder=!1):this.displayPlaceholder=!0,this.$emit("input",e)}},validLength(){this.$emit("validity-updated",this.validLength)},editorReady(){this.editorReady?this.$emit("ready"):this.$emit("unloaded")},value(e){this.editor||this.initCKEditor();let t=null;try{t=this.editor.getData()}catch(e){}e!==t&&(this.initCKEditorData(e||""),this.setEditorReady())}},created(){CKEDITOR.basePath="/commons-extension/ckeditor/",this.initCKEditor()},beforeDestroy(){this.destroyCKEditor()},methods:{initCKEditor(){let e="simpleLink,widget";const t=[["Bold","Italic","BulletedList","NumberedList","Blockquote"]];e=`${e},emoji,formatOption`,this.isMobile||t[0].push("emoji"),t[0].unshift("formatOption"),this.inputVal=this.value||"",this.editor=CKEDITOR.instances.descriptionContent;const a=this;$(this.$refs.editor).ckeditor({customConfig:"/commons-extension/ckeditorCustom/config.js",extraPlugins:e,removePlugins:"image,maximize,resize",toolbar:t,toolbarLocation:"bottom",autoGrow_onStartup:!0,pasteFilter:"p; a[!href]; strong; i",on:{instanceReady:function(){a.editor=CKEDITOR.instances.descriptionContent,a.setEditorReady(),a.autofocus&&(setTimeout((function(){a.editor.getSelection().scrollIntoView()}),0),window.setTimeout((()=>a.setFocus()),50))},change:e=>this.inputVal=e.editor?.getData()||"",destroy:()=>this.inputVal=""}})},destroyCKEditor:function(){this.editor&&this.editor.destroy(!0)},hidePlaceholder(){this.displayPlaceholder=!1,this.setFocus()},initCKEditorData:function(e){this.inputVal=e||"",this.editor&&this.editor.setData(this.inputVal)},setEditorReady:function(){window.setTimeout((()=>{this.$set(this.editor,"status","ready")}),200)},setFocus:function(){this.editorReady&&window.setTimeout((()=>{this.$nextTick().then((()=>this.editor.focus()))}),200)}}},Me,[],!1,null,null,null);Le.options.__file="src/main/webapp/vue-app/engagement-center/components/common/DescriptionEditor.vue";const Re=Le.exports;var Ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"EngagementCenterImageSelector",attrs:{id:"engagementCenterImgSelectorcard",elevation:"0",height:"140px"}},[a("v-avatar",{staticClass:"align-start flex-grow-0",attrs:{id:"engagementCenterImgSelectorAvatar",width:"100%",height:"140px",tile:""}},[a("v-img",{attrs:{id:"engagementCenterImgSelectorImg","lazy-src":e.cover,src:e.cover,transition:"none",eager:"",role:"presentation"}}),e._v(" "),a("v-file-input",{ref:"avatarInput",staticClass:"changeImgButton",attrs:{id:"engagementCenterImgSelectorFileInput","prepend-icon":"mdi-image",accept:"image/*",clearable:""},on:{change:e.uploadCover}})],1)],1)};Ne._withStripped=!0;var ze=l({props:{value:{type:String,default:"/gamification-portlets/skin/images/program_default_cover_back.png"},maxUploadsSize:{type:Number,default:1e5}},data(){return{error:"",coverData:null,MAX_RANDOM_NUMBER:1e5,random:Math.round(Math.random()*this.MAX_RANDOM_NUMBER),now:Date.now(),uploadId:`${this.random}-${this.now}`}},computed:{cover(){return this.coverData||this.value}},methods:{uploadCover(e){if(e&&e.size){if(e.type&&0!==e.type.indexOf("image/"))return void this.$engagementCenterUtils.displayAlert(this.$t("engagementCenter.error.uploadUnsupportedFileType"),"error");if(e.size>this.maxUploadsSize)return void this.$engagementCenterUtils.displayAlert(this.$t("programs.imageSize.errorMessage"),"error");const t=this;return this.$uploadService.upload(e).then((a=>{const s=new FileReader;s.onload=e=>{t.coverData=e.target.result,t.$forceUpdate()},s.readAsDataURL(e),this.$emit("updated",a)})).catch((()=>this.$engagementCenterUtils.displayAlert(this.$t("programs.cover.uploadErrorMessage"),"error")))}},reset(){this.coverData=null}}},Ne,[],!1,null,null,null);ze.options.__file="src/main/webapp/vue-app/engagement-center/components/common/ImageSelector.vue";const je=ze.exports;var Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("img",{staticClass:"justify-center ma-auto d-flex flex-no-wrap",attrs:{src:"/gamification-portlets/skin/images/Challenge_app_backg_image.png",alt:e.$t("challenges.welcomeMessageImgAlt"),width:"800px",loading:"lazy"}}),e._v(" "),a("v-list-item",{staticClass:"px-0"},[a("v-list-item-content",[a("div",{staticClass:"justify-center ma-auto d-flex flex-no-wrap"},[e._t("content")],2)])],1)],1)};Be._withStripped=!0;var Ue=a(9185),Fe=l(a.n(Ue)(),Be,[],!1,null,null,null);Fe.options.__file="src/main/webapp/vue-app/engagement-center/components/common/WelcomeMessage.vue";const Xe=Fe.exports;var Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("div",e._g({},s),[a("a",{staticClass:"flex-nowrap flex-grow-1 d-flex text-truncate container--fluid text-truncate",attrs:{href:e.actionURL}},[a("v-icon",{staticClass:"primary--text",attrs:{size:"15"}},[e._v(e._s(e.actionIcon))]),e._v(" "),a("div",{staticClass:"ps-2 text-truncate"},[e._v(e._s(e.actionLabel)+"\n        ")])],1)])]}}])},[e._v(" "),a("span",[e._v(e._s(e.actionLabel))])])};Ve._withStripped=!0;var We=l({props:{actionLabel:{type:String,default:null},actionURL:{type:String,default:null},actionIcon:{type:String,default:null}}},Ve,[],!1,null,null,null);We.options.__file="src/main/webapp/vue-app/engagement-center/components/actionValues/RuleActionValue.vue";const Ke=We.exports;var Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("div",e._g({},s),[a("a",{staticClass:"flex-nowrap flex-grow-1 d-flex text-truncate container--fluid text-truncate",attrs:{href:e.actionURL}},[a("v-icon",{staticClass:"primary--text",attrs:{size:"15"}},[e._v("fas fa-trophy")]),e._v(" "),a("div",{staticClass:"ps-2 text-truncate"},[e._v(e._s(e.actionLabel)+"\n        ")])],1)])]}}])},[e._v(" "),a("span",[e._v(e._s(e.actionLabel))])])};Je._withStripped=!0;var qe=l({props:{actionLabel:{type:String,default:null},actionURL:{type:String,default:null}}},Je,[],!1,null,null,null);qe.options.__file="src/main/webapp/vue-app/engagement-center/components/actionValues/ChallengeActionValue.vue";const He=qe.exports;function Ge(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/canAddChallenge`,{headers:{"Content-Type":"text/plain"},credentials:"include",method:"GET"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Server indicates an error while sending request")}))}function Ye(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error saving challenge")}))}function Qe(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error updating challenge")}))}function Ze(e,t,a,s,n,i,r,l,o,c){const d=new FormData;if(e&&d.append("term",e),t&&d.append("offset",t),a&&d.append("limit",a),s&&d.append("announcements",s),n&&d.append("domainId",n),i&&d.append("groupByDomain",i),r&&d.append("filter",r),null!=l&&d.append("orderByRealizations",l),o?.length>0)for(const e of o)d.append("excludedChallengesIds",e);c&&d.append("period",c);const u=new URLSearchParams(d).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges?${u}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting challenges")}))}function et(e,t,a,s){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/announcement/api/ByChallengeId/${e}?type=${t||""}&offset=${a||0}&limit=${s||10}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting challenges")}))}function tt(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/announcement/api/addAnnouncement`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error(e.status)}))}function at(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/${e}`,{method:"GET",credentials:"include"}).then((e=>e&&e.ok?e.json():null))}function st(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains?type=ALL`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Server indicates an error while sending request")}))}function nt(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/challenges/${e}`,{method:"DELETE",credentials:"include"}).then((e=>{if(!e||!e.ok)throw new Error(e.status)}))}function it(e){return e<10&&`0${e}`||e}function rt(e,t,a){if(!e)return null;let s;return"number"==typeof e?e=new Date(e):"string"==typeof e&&(10===e.indexOf("T")&&e.length>19&&(e=e.substring(0,19)),e=new Date(e)),s=t?`${e.getFullYear()}-${it(e.getMonth()+1)}-${it(e.getDate())}T00:00:00`:`${e.getFullYear()}-${it(e.getMonth()+1)}-${it(e.getDate())}T${it(e.getHours())}:${it(e.getMinutes())}:${it(e.getSeconds())}`,a?`${s}${lt()}`:s}function lt(){const e=-(new Date).getTimezoneOffset();let t=e/60,a=e%60;return t=t<10?`0${t}`:t,a=a<10?`0${a}`:a,`${e>=0?"+":"-"}${t}:${a}`}function ot(e){const t=eXo.env.portal.language,a=String(e.getDate()),s=String(e.getFullYear());return`${e.toLocaleDateString(t||"en",{month:"long"})} ${a}, ${s}`}function ct(e,t){document.dispatchEvent(new CustomEvent("notification-alert",{detail:{message:e,type:t||"success"}}))}const dt=e=>`${e.getFullYear()}-${it(e.getMonth()+1)}-${it(e.getDate())}T00:00:00`;function ut(e,t,a,s,n,i,r){const l=new FormData;e&&l.append("offset",e),t&&l.append("limit",t),a&&l.append("type",a),s&&l.append("status",s),n&&l.append("query",n),null!=i&&l.append("includeDeleted",i),null!=r&&l.append("sortByBudget",r);const o=new URLSearchParams(l).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains?returnSize=true&${o}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Server indicates an error while sending request")}))}function mt(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error saving program")}))}function pt(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/canAddProgram`,{headers:{"Content-Type":"text/plain"},method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Server indicates an error while sending request")}))}function gt(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/${e.id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error updating program")}))}function ht(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/${e}`,{method:"GET",credentials:"include"}).then((e=>e&&e.ok?e.json():null))}function vt(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains/${e}`,{method:"DELETE",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function ft(e,t,a,s,n,i,r){const l=new FormData;e&&l.append("term",e),t&&l.append("domainId",t),a&&l.append("status",a),s&&l.append("type",s),n&&l.append("offset",n),i&&l.append("limit",i),r&&l.append("expand",r);const o=new URLSearchParams(l).toString();return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/rules?returnSize=true&${o}`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting rules")}))}function _t(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/domains`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting domains")}))}function bt(){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/api/v1/events`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error when getting events")}))}function Ct(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/rules/${e}`,{method:"DELETE",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Response code indicates a server error",e)}))}function $t(e){return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/rules`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error(e.status)}))}function wt(e,t){return(e=Object.assign({},e)).domainDTO=JSON.parse(JSON.stringify(t)),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/gamification/rules`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(e&&e.ok)return e.json();throw new Error(e.status)}))}const xt={challenges:c,"challenge-card":m,"challenges-list":h,"domain-challenges-list":_,"challenge-drawer":w,"challenge-program-drawer":D,"challenge-date-picker":T,"program-suggester":M,"engagement-center-no-results":U,"engagement-center":z,"engagement-center-programs":W,"engagement-center-program-card":q,"engagement-center-program-menu":Y,"engagement-center-program-drawer":ee,"engagement-center-program-owners-drawer":se,"engagement-center-program-detail":re,"engagement-center-program-owner-assignment":ce,"engagement-center-program-deleted":me,"engagement-center-rule-title":he,"engagement-center-rule-item":_e,"engagement-center-rule-form-drawer":$e,"engagement-center-rule-detail-drawer":ye,"engagement-center-rule-filter":Ee,"engagement-center-winners-details":P,"engagement-center-assignment":ke,"engagement-center-avatars-list":Oe,"engagement-center-description-editor":Re,"engagement-center-image-selector":je,"engagement-center-welcome-message":Xe,"rule-action-value":Ke,"challenge-action-value":He};for(const e in xt)Vue.component(e,xt[e]);if(Vue.prototype.$challengesServices||window.Object.defineProperty(Vue.prototype,"$challengesServices",{value:e}),Vue.prototype.$engagementCenterUtils||window.Object.defineProperty(Vue.prototype,"$engagementCenterUtils",{value:t}),Vue.prototype.$programsServices||window.Object.defineProperty(Vue.prototype,"$programsServices",{value:n}),Vue.prototype.$ruleServices||window.Object.defineProperty(Vue.prototype,"$ruleServices",{value:i}),a(6614),extensionRegistry){const e=extensionRegistry.loadComponents("Challenges");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}Vue.use(Vuetify);const yt=new Vuetify(eXo.env.portal.vuetifyPreset),Dt="EngagementCenterApplication",St=eXo&&eXo.env.portal.language||"en",Et=[`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.Challenges-${St}.json`,`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.addon.Gamification-${St}.json`];function Tt(e){exoi18n.loadLanguageAsync(St,Et).then((t=>{Vue.createApp({template:`<engagement-center id="${Dt}" :is-administrator="${e}"/>`,vuetify:yt,i18n:t},`#${Dt}`,"EngagementCenter")})),Object.keys(window.requirejs.s.contexts._.registry).filter((e=>e.includes("engagementCenterActions"))).forEach((e=>{window.require([e],(e=>e.init()))}))}})(),s})()));