define((()=>(()=>{"use strict";var t={d:(e,s)=>{for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{init:()=>c});var s=function(){var t=this,e=t._self._c;return e("v-app",[t.displayed?[t.displayDetails?e("user-setting-security-window",{on:{back:t.closeSecurityDetail}}):e("v-card",{staticClass:"my-3 border-radius",attrs:{flat:""}},[e("v-list",[e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",{staticClass:"title text-color"},[t._v("\n              "+t._s(t.$t("UserSettings.security"))+"\n            ")])],1),t._v(" "),e("v-list-item-action",[e("span",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom",value:t.allowedToChangePassword?t.$t("UserSettings.button.tooltip.enabled"):t.$t("UserSettings.button.tooltip.disabled"),expression:"allowedToChangePassword ? $t('UserSettings.button.tooltip.enabled') : $t('UserSettings.button.tooltip.disabled')",modifiers:{bottom:!0}}]},[e("v-btn",{attrs:{disabled:!t.allowedToChangePassword,small:"",icon:""},on:{click:t.openSecurityDetail}},[e("v-icon",{staticClass:"text-sub-title",attrs:{size:"24"}},[t._v("\n                  "+t._s(t.$vuetify.rtl?"fa-caret-left":"fa-caret-right")+"\n                ")])],1)],1)])],1)],1)],1)]:t._e()],2)};function r(t,e,s,r,i,n,o,a){var l,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=s,d._compiled=!0),r&&(d.functional=!0),n&&(d._scopeId="data-v-"+n),o?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=l):i&&(l=a?function(){i.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(d.functional){d._injectStyles=l;var c=d.render;d.render=function(t,e){return l.call(e),c(t,e)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:d}}s._withStripped=!0;const i=r({data:()=>({id:`Security${parseInt(1e4*Math.random()).toString().toString()}`,displayed:!0,allowedToChangePassword:!1,displayDetails:!1}),watch:{displayed(){this.$nextTick().then((()=>this.$root.$emit("application-cache")))}},created(){document.addEventListener("hideSettingsApps",(t=>{t&&t.detail&&this.id!==t.detail&&(this.displayed=!1)})),this.$userService.isSynchronizedUserAllowedToChangePassword().then((t=>{this.allowedToChangePassword="true"===t.isSynchronizedUserAllowedToChangePassword})),document.addEventListener("showSettingsApps",(()=>this.displayed=!0))},mounted(){this.$nextTick().then((()=>this.$root.$applicationLoaded()))},methods:{openSecurityDetail(){document.dispatchEvent(new CustomEvent("hideSettingsApps",{detail:this.id})),this.displayDetails=!0},closeSecurityDetail(){document.dispatchEvent(new CustomEvent("showSettingsApps")),this.displayDetails=!1}}},s,[],!1,null,null,null).exports;var n=function(){var t=this,e=t._self._c;return e("v-card",{attrs:{flat:""}},[e("v-toolbar",{staticClass:"border-box-sizing",attrs:{flat:""}},[e("v-btn",{staticClass:"mx-1",attrs:{icon:"",height:"36",width:"36"},on:{click:function(e){return t.$emit("back")}}},[e("v-icon",{attrs:{size:"20"}},[t._v("\n        "+t._s(t.$vuetify.rtl?"mdi-arrow-right":"mdi-arrow-left")+"\n      ")])],1),t._v(" "),e("v-toolbar-title",{staticClass:"ps-0"},[t._v("\n      "+t._s(t.$t("UserSettings.security"))+"\n    ")]),t._v(" "),e("v-spacer")],1),t._v(" "),e("v-form",{ref:"form",staticClass:"mt-6 mx-10 px-5"},[e("input",{staticClass:"hidden",attrs:{id:"username",name:"username",autocomplete:"username"}}),t._v(" "),e("v-card",{attrs:{flat:""}},[e("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left font-weight-bold pt-0 pb-2"},[t._v("\n        "+t._s(t.$t("UserSettings.label.currentPassword"))+"*\n      ")]),t._v(" "),e("v-card-text",{staticClass:"d-flex py-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentPassword,expression:"currentPassword"}],ref:"currentPassword",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{type:"password",autocomplete:"current-password",required:""},domProps:{value:t.currentPassword},on:{input:function(e){e.target.composing||(t.currentPassword=e.target.value)}}})]),t._v(" "),e("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[t._v("\n        "+t._s(t.$t("UserSettings.label.newPassword"))+"*\n      ")]),t._v(" "),e("v-card-text",{staticClass:"d-flex py-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newPassword,expression:"newPassword"}],ref:"newPassword",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{type:"password",autocomplete:"new-password",required:""},domProps:{value:t.newPassword},on:{input:function(e){e.target.composing||(t.newPassword=e.target.value)}}})]),t._v(" "),e("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[t._v("\n        "+t._s(t.$t("UserSettings.label.confirmNewPassword"))+"*\n      ")]),t._v(" "),e("v-card-text",{staticClass:"d-flex py-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.confirmNewPassword,expression:"confirmNewPassword"}],ref:"confirmNewPassword",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{type:"password",autocomplete:"new-password",required:""},domProps:{value:t.confirmNewPassword},on:{input:function(e){e.target.composing||(t.confirmNewPassword=e.target.value)}}})]),t._v(" "),t.error?e("v-card-text",[e("v-alert",{attrs:{type:"error"}},[t._v("\n          "+t._s(t.error)+"\n        ")])],1):t._e(),t._v(" "),t.success?e("v-card-text",[e("v-alert",{attrs:{type:"success"}},[t._v("\n          "+t._s(t.success)+"\n        ")])],1):t._e(),t._v(" "),e("v-card-actions",{staticClass:"my-6"},[e("v-spacer"),t._v(" "),e("v-btn",{staticClass:"btn me-2",attrs:{disabled:t.saving},on:{click:function(e){return t.$emit("back")}}},[t._v("\n          "+t._s(t.$t("UserSettings.button.cancel"))+"\n        ")]),t._v(" "),e("v-btn",{staticClass:"btn btn-primary",attrs:{loading:t.saving,disabled:t.saving},on:{click:t.savePassword}},[t._v("\n          "+t._s(t.$t("UserSettings.button.confirm"))+"\n        ")])],1)],1)],1)],1)};n._withStripped=!0;const o={"user-setting-security":i,"user-setting-security-window":r({data:()=>({username:eXo.env.portal.userName,currentPassword:null,newPassword:null,confirmNewPassword:null,success:null,error:null,saving:!1,displayed:!0}),watch:{confirmNewPassword(){this.resetCustomValidity()}},created(){document.addEventListener("hideSettingsApps",(t=>{this.id!==t&&(this.displayed=!1)})),document.addEventListener("showSettingsApps",(()=>{this.displayed=!0}))},methods:{resetCustomValidity(){this.$refs.confirmNewPassword.setCustomValidity("")},savePassword(){this.resetCustomValidity(),this.$refs.form.$el.reportValidity()&&(this.confirmNewPassword===this.newPassword||(this.$refs.confirmNewPassword.setCustomValidity(this.$t("UserSettings.label.newPasswordsDoesNotMatch")),this.$refs.form.$el.reportValidity()))&&this.$refs.form.validate()&&this.$refs.form.$el.reportValidity()&&(this.success=null,this.error=null,this.saving=!0,this.$userService.changePassword(eXo.env.portal.userName,this.currentPassword,this.newPassword).then((()=>{this.success=this.$t("UserSettings.label.changePasswordSuccess"),this.$refs.form.$el.reset()})).catch((t=>{const e=String(t);e.indexOf("WRONG_USER_PASSWORD")>-1?this.error=this.$t("UserSettings.label.wrongCurrentPassword"):e.indexOf("USER_NOT_FOUND")>-1?this.error=this.$t("UserSettings.label.accountNotExist"):e.indexOf("PASSWORD_UNKNOWN_ERROR_CODE")>-1?this.error=this.$t("UserSettings.label.changePasswordFail"):e.indexOf("UNCHANGED_NEW_PASSWORD")>-1?this.error=this.$t("UserSettings.label.changePasswordIdentical"):this.error=e})).finally((()=>{this.saving=!1})))}}},n,[],!1,null,null,null).exports};for(const t in o)Vue.component(t,o[t]);if(extensionRegistry){const t=extensionRegistry.loadComponents("UserSettingSecurity");t&&t.length>0&&t.forEach((t=>{Vue.component(t.componentName,t.componentOptions)}))}const a=eXo&&eXo.env.portal.language||"en",l=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.social.UserSettings-${a}.json`,d="UserSettingSecurity";function c(){exoi18n.loadLanguageAsync(a,l).then((t=>{const e=document.createElement("div");e.id=d,Vue.createApp({mounted(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:`<user-setting-security id="${d}" v-cacheable />`,i18n:t,vuetify:Vue.prototype.vuetifyOptions},e,"User Settings Security")}))}return document.dispatchEvent(new CustomEvent("displayTopBarLoading")),e})()));