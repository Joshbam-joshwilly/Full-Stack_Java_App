define((()=>(()=>{"use strict";var e={d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>m});var i=function(){var e=this,t=e._self._c;return t("v-app",[t("v-card",{staticClass:"pa-4 text-center",attrs:{flat:""}},[t("v-card",{staticClass:"border-box-sizing d-flex flex-row justify-center ma-0",attrs:{flat:""}},[t("people-overview-card",{class:"-"===e.invitations&&"text-sub-title",attrs:{id:"peopleInvitationsOverview",title:e.$t("peopleOverview.label.invitations"),count:e.invitations},on:{click:function(t){e.$refs.peopleDrawer.open("invitations",e.$t("peopleOverview.label.invitations"))}}}),e._v(" "),t("v-divider",{staticClass:"peopleOverviewVertivalSeparator ma-auto",attrs:{vertical:""}}),e._v(" "),t("people-overview-card",{class:"-"===e.pending&&"text-sub-title",attrs:{id:"peoplePendingOverview",title:e.$t("peopleOverview.label.pending"),count:e.pending},on:{click:function(t){e.$refs.peopleDrawer.open("pending",e.$t("peopleOverview.label.pending"))}}})],1)],1),e._v(" "),t("people-overview-drawer",{ref:"peopleDrawer",on:{refresh:function(t){return e.refresh()}}})],1)};function s(e,t,i,s,n,r,o,a){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),s&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=l):n&&(l=a?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(c.functional){c._injectStyles=l;var p=c.render;c.render=function(e,t){return l.call(t),p(e,t)}}else{var v=c.beforeCreate;c.beforeCreate=v?[].concat(v,l):[l]}return{exports:e,options:c}}i._withStripped=!0;const n=s({data:()=>({invitations:"-",pending:"-",initialized:!1}),watch:{initialized(e,t){e!==t&&e&&this.$root.$applicationLoaded()}},created(){this.refresh()},methods:{refresh(){let e=2;this.$userService.getInvitations().then((e=>{this.invitations=e&&e.size||0})).finally((()=>{e--,0===e&&(this.initialized=!0),window.location.pathname.includes("receivedInvitations")&&this.$refs.peopleDrawer.open("invitations",this.$t("peopleOverview.label.invitations"))})),this.$userService.getPending().then((e=>{this.pending=e&&e.size||0})).finally((()=>{e--,0===e&&(this.initialized=!0)}))}}},i,[],!1,null,null,null).exports;var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"peopleOverviewCard d-flex flex-column",class:e.clickable,on:{click:function(t){e.count&&e.$emit("click")}}},[t("div",{staticClass:"ma-auto"},[t("div",{staticClass:"peopleOverviewCount text-center pb-1"},[e._v("\n      "+e._s(e.count)+"\n    ")]),e._v(" "),t("div",{staticClass:"peopleOverviewTitle text-center text-truncate pt-1"},[e._v("\n      "+e._s(e.title)+"\n    ")])])])};r._withStripped=!0;const o=s({props:{id:{type:String,default:()=>null},title:{type:String,default:()=>null},count:{type:Number,default:()=>0}},computed:{clickable(){return this.count&&"-"!==this.count&&"clickable"}}},r,[],!1,null,null,null).exports;var a=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"overviewDrawer",attrs:{"body-classes":"hide-scroll decrease-z-index-more",right:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("v-layout",{staticClass:"ma-3",attrs:{column:""}},[e.users&&e.users.length?t("people-overview-people-list",{staticClass:"ma-0 border-box-sizing",attrs:{users:e.users,filter:e.filter},on:{refresh:function(t){return e.refresh()}}}):e.loadingUsers?e._e():[t("span",{staticClass:"ma-auto"},[e._v(e._s(e.$t("peopleOverview.label.noResults")))])],e._v(" "),t("v-card-actions",{staticClass:"flex-grow-1 justify-center my-2"},[t("v-spacer"),e._v(" "),e.canShowMore?t("v-btn",{staticClass:"loadMoreButton ma-auto btn",attrs:{loading:e.loadingUsers,disabled:e.loadingUsers},on:{click:e.loadNextPage}},[e._v("\n          "+e._s(e.$t("peopleOverview.label.showMore"))+"\n        ")]):e._e(),e._v(" "),t("v-spacer")],1)],2)],1)],2)};a._withStripped=!0;const l=s({data:()=>({title:null,filter:null,fieldsToRetrieve:"all,connectionsInCommonCount",loadingUsers:!1,offset:0,pageSize:20,users:[]}),computed:{canShowMore(){return this.loadingUsers||this.users.length>=this.limit},searchUsersMethod(){return"invitations"===this.filter?this.$userService.getInvitations:this.$userService.getPending}},methods:{refresh(){this.$emit("refresh"),this.searchUsers()},searchUsers(){return this.users=[],this.loadingUsers=!0,this.searchUsersMethod(this.offset,this.limit,this.fieldsToRetrieve).then((e=>(this.users=e&&e.users||[],this.$nextTick()))).finally((()=>this.loadingUsers=!1))},loadNextPage(){this.limit+=this.pageSize,this.searchUsers()},open(e,t){this.title=t,this.limit=this.pageSize,this.filter=e,this.$nextTick().then((()=>{this.searchUsers(),this.$refs.overviewDrawer.open()}))}}},a,[],!1,null,null,null).exports;var c=function(){var e=this,t=e._self._c;return e.users&&e.users.length?t("v-list",{attrs:{"two-line":"",subheader:""}},e._l(e.users,(function(i){return t("people-overview-people-list-item",{key:i.id,attrs:{user:i,filter:e.filter},on:{refresh:function(t){return e.$emit("refresh")}}})})),1):e._e()};c._withStripped=!0;const p=s({props:{users:{type:Array,default:()=>null},filter:{type:String,default:()=>null}}},c,[],!1,null,null,null).exports;var v=function(){var e=this,t=e._self._c;return t("v-list-item",{staticClass:"pa-0 userItem"},[t("v-list-item-avatar",{staticClass:"my-0",class:e.userItemClass,attrs:{href:e.url,tile:""}},[t("v-avatar",{attrs:{size:e.avatarSize,tile:""}},[t("v-img",{staticClass:"mx-auto userAvatar",attrs:{src:e.avatarUrl,height:e.avatarSize,width:e.avatarSize,"max-height":e.avatarSize,"max-width":e.avatarSize,role:"presentation"}})],1)],1),e._v(" "),t("v-list-item-content",{staticClass:"pa-0",class:e.userItemClass,attrs:{href:e.url}},[t("v-list-item-title",[t("a",{staticClass:"text-color",attrs:{href:e.url}},[e._v("\n        "+e._s(e.user.fullname)+"\n        "),"true"===e.user.external?t("span",{staticClass:"externalTagClass"},[e._v("\n          ("+e._s(e.$t("UserProfilePopup.label.profile.external"))+")\n        ")]):e._e()])]),e._v(" "),t("v-list-item-subtitle",[e._v("\n      "+e._s(e.$t("peopleOverview.connectionsInCommon",{0:e.user.connectionsInCommonCount}))+"\n    ")])],1),e._v(" "),t("v-list-item-action",{staticClass:"ma-0 flex-row align-self-center"},["invitations"===e.filter?[t("v-btn",{staticClass:"me-2 peopleOverviewCheck",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,fab:"",dark:"",depressed:""},on:{click:e.acceptToConnect}},[t("v-icon",{attrs:{dark:""}},[e._v("\n          mdi-check\n        ")])],1),e._v(" "),t("v-btn",{staticClass:"peopleOverviewClose",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,fab:"",dark:"",depressed:""},on:{click:e.refuseToConnect}},[t("v-icon",{attrs:{dark:""}},[e._v("\n          mdi-close\n        ")])],1)]:e._e(),e._v(" "),"pending"===e.filter?[t("v-btn",{staticClass:"peopleOverviewClose",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,fab:"",dark:"",depressed:""},on:{click:e.cancelRequest}},[t("v-icon",{attrs:{dark:""}},[e._v("\n          mdi-close\n        ")])],1)]:e._e()],2)],1)};v._withStripped=!0;const u={"people-overview":n,"people-overview-card":o,"people-overview-drawer":l,"people-overview-people-list":p,"people-overview-people-list-item":s({props:{user:{type:Object,default:()=>null},filter:{type:String,default:()=>null},avatarSize:{type:Number,default:()=>37}},data:()=>({actionIconSize:27,sendingAction:!1,userItemClass:`userItem${parseInt(1e4*Math.random()).toString().toString()}`}),computed:{avatarUrl(){return this.user&&this.user.avatar||`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/users/${this.user.username}/avatar`},url(){return this.user&&this.user.profile||`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.user.username}/`}},methods:{acceptToConnect(){this.sendingAction=!0,this.$userService.confirm(this.user.username).then((()=>this.$emit("refresh"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))},refuseToConnect(){this.sendingSecondAction=!0,this.$userService.deleteRelationship(this.user.username).then((()=>this.$emit("refresh"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingSecondAction=!1}))},cancelRequest(){this.sendingAction=!0,this.$userService.deleteRelationship(this.user.username).then((()=>this.$emit("refresh"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))}}},v,[],!1,null,null,null).exports};for(const e in u)Vue.component(e,u[e]);if(extensionRegistry){const e=extensionRegistry.loadComponents("PeopleOverview");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}const d=eXo&&eXo.env.portal.language||"en",h=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.social.PeopleOverview-${d}.json`,f="PeopleOverview";function m(){exoi18n.loadLanguageAsync(d,h).then((e=>{Vue.createApp({template:`<people-overview id="${f}" />`,i18n:e,vuetify:Vue.prototype.vuetifyOptions},`#${f}`,"People Overview")}))}return t})()));