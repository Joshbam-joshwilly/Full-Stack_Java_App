define((()=>(()=>{"use strict";var e={d:(t,i)=>{for(var r in i)e.o(i,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>v});var i=function(){var e=this,t=e._self._c;return e.displayApp?t("v-app",{staticClass:"white",class:e.owner?"profileWorkExperience":"profileWorkExperienceOther"},[t("v-toolbar",{staticClass:"border-box-sizing",attrs:{color:"white",flat:""}},[t("div",{staticClass:"text-header-title text-sub-title"},[e._v("\n      "+e._s(e.title)+"\n    ")]),e._v(" "),e.owner?[t("v-spacer"),e._v(" "),t("v-btn",{attrs:{icon:"",outlined:"",small:""},on:{click:e.addWorkExperience}},[t("v-icon",{attrs:{size:"18"}},[e._v("fas fa-plus")])],1),e._v(" "),e.hasExperiences?t("v-btn",{staticClass:"ms-2",attrs:{icon:"",outlined:"",small:""},on:{click:e.editWorkExperiences}},[t("v-icon",{attrs:{size:"18"}},[e._v("fas fa-edit")])],1):e._e()]:e._e()],2),e._v(" "),t("div",{staticClass:"px-4 pb-6 white"},[e.hasExperiences?t("v-timeline",{staticClass:"workExperienceTimeLine",attrs:{"align-top":"",dense:""}},e._l(e.experiences,(function(e){return t("profile-work-experience-item",{key:e.id,attrs:{experience:e}})})),1):e.displayEmptyBlock?t("div",{domProps:{innerHTML:e._s(e.emptyExperiencesOwnerTitle)}}):e._e()],1),e._v(" "),t("profile-work-experience-drawer",{key:e.workExperiencesDrawerKey,ref:"profileWorkExperiencesDrawer",attrs:{experiences:e.experiences},on:{refreshWorkExperiencesDrawer:e.initWorkExperiencesDrawer,refresh:function(t){return e.setExperiences(t)}}})],1):e._e()};function r(e,t,i,r,s,n,o,a){var l,p="function"==typeof e?e.options:e;if(t&&(p.render=t,p.staticRenderFns=i,p._compiled=!0),r&&(p.functional=!0),n&&(p._scopeId="data-v-"+n),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},p._ssrRegister=l):s&&(l=a?function(){s.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(p.functional){p._injectStyles=l;var c=p.render;p.render=function(e,t){return l.call(t),c(e,t)}}else{var d=p.beforeCreate;p.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:p}}i._withStripped=!0;const s=r({data:()=>({owner:eXo.env.portal.profileOwner===eXo.env.portal.userName,addExperienceEventName:"profile-add-experience",experiences:null,error:null,saving:null,workExperiencesDrawerKey:0,initialized:!1}),computed:{hasExperiences(){return this.experiences?.length},displayApp(){return this.owner||!this.initialized||this.hasExperiences},title(){return this.owner&&this.$t("profileYourWorkExperiences.title")||this.$t("profileWorkExperiences.title")},displayEmptyBlock(){return this.owner&&!this.hasExperiences},emptyExperiencesOwnerTitle(){return this.owner&&this.$t("profileYourWorkExperiences.emptyTitle",{0:'<a id="emptyExperiencesLink" class="primary--text font-weight-bold">',1:"</a>"})}},created(){document.addEventListener("click",this.openDrawerOnLinkClick),this.refresh().finally((()=>this.$root.$applicationLoaded()))},mounted(){this.experiences&&this.$root.$emit("application-loaded")},beforeDestroy(){document.removeEventListener("click",this.openDrawerOnLinkClick)},methods:{refresh(){return this.$userService.getUser(eXo.env.portal.profileOwner,"all").then((e=>this.setExperiences(e&&e.experiences))).catch((e=>console.error("Error while retrieving user details",e))).finally((()=>{this.$nextTick().then((()=>this.$root.$emit("application-loaded"))),this.initialized=!0}))},setExperiences(e){e=e||[];try{e.sort(((e,t)=>e.isCurrent?-1:t.isCurrent?1:e.startDate||t.startDate?e.startDate?t.startDate?new Date(t.startDate).getTime()-new Date(e.startDate).getTime():-1:1:0))}catch(e){console.error("Error sorting experiences",e)}this.experiences=e},openDrawerOnLinkClick(e){this.displayEmptyBlock&&"emptyExperiencesLink"===e?.target?.id&&this.addWorkExperience()},initWorkExperiencesDrawer(){this.workExperiencesDrawerKey+=1},editWorkExperiences(){this.$refs.profileWorkExperiencesDrawer.open()},addWorkExperience(){this.$refs.profileWorkExperiencesDrawer.open(!0)}}},i,[],!1,null,null,null).exports;var n=function(){var e=this,t=e._self._c;return t("v-timeline-item",{staticClass:"workExperienceTimeLineItem",attrs:{color:"tertiary"}},[t("v-row",{staticClass:"ma-0"},[t("v-col",{staticClass:"px-0",attrs:{cols:"12",sm:"3"}},[t("div",{staticClass:"text-color font-weight-bold"},[e._v("\n        "+e._s(e.experience.position)+"\n      ")]),e._v(" "),t("div",[e._v("\n        "+e._s(e.experience.company)+"\n      ")]),e._v(" "),e.displayedFromDate?t("div",{staticClass:"workExperienceTimeLineItemTime text-sub-title"},[e._v("\n        "+e._s(e.displayedFromDate)+"\n      ")]):e._e(),e._v(" "),e.displayedToDate?t("div",{staticClass:"workExperienceTimeLineItemTime text-sub-title"},[e._v("\n        "+e._s(e.displayedToDate)+"\n      ")]):e._e()]),e._v(" "),t("v-col",{staticClass:"px-0 px-sm-3"},[t("v-card",{attrs:{flat:"",tile:""}},[t("v-card-text",{staticClass:"pa-0"},[t("div",{directives:[{name:"autolinker",rawName:"v-autolinker",value:e.experience.description,expression:"experience.description"}],staticClass:"text-color mb-4"}),e._v(" "),e.experience.skills?[t("div",{staticClass:"text-color font-weight-bold"},[e._v("\n              "+e._s(e.$t("profileWorkExperiences.appliedSkills"))+" :\n            ")]),e._v(" "),t("div",{staticClass:"text-color"},[e._v("\n              "+e._s(e.experience.skills)+"\n            ")])]:e._e()],2)],1)],1)],1)],1)};n._withStripped=!0;const o=r({props:{experience:{type:Object,default:()=>null}},data:()=>({dateFormat:{year:"numeric",month:"long",day:"numeric"}}),computed:{displayedFromDate(){if(!this.experience.startDate)return null;if(this.experience.isCurrent){const e=this.$dateUtil.getDateObjectFromString(this.experience.startDate,!0),t=this.$dateUtil.formatDateObjectToDisplay(e,this.dateFormat);return this.$t("profileWorkExperiences.since",{0:t})}{const e=this.$dateUtil.getDateObjectFromString(this.experience.startDate,!0),t=this.$dateUtil.formatDateObjectToDisplay(e,this.dateFormat);return this.$t("profileWorkExperiences.from",{0:t})}},displayedToDate(){if(!this.experience.endDate||this.experience.isCurrent)return null;const e=this.$dateUtil.getDateObjectFromString(this.experience.endDate,!0),t=this.$dateUtil.formatDateObjectToDisplay(e,this.dateFormat);return this.$t("profileWorkExperiences.to",{0:t})}}},n,[],!1,null,null,null).exports;var a=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"profileWorkExperiencesDrawer",staticClass:"profileWorkExperiencesDrawer",attrs:{"body-classes":"hide-scroll decrease-z-index-more",right:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("profileWorkExperiences.title"))+"\n  ")]),e._v(" "),t("template",{slot:"titleIcons"},[t("v-icon",{staticClass:"my-auto",on:{click:e.addNew}},[e._v("mdi-plus")])],1),e._v(" "),t("template",{slot:"content"},[t("v-form",{ref:"profileContactForm",staticClass:"form-horizontal pa-0",attrs:{flat:""}},[e.experiences&&e.experiencesToEdit.length?t("v-expansion-panels",{staticClass:"d-block border-box-sizing",attrs:{multiple:"",flat:""},model:{value:e.openedExperiences,callback:function(t){e.openedExperiences=t},expression:"openedExperiences"}},e._l(e.experiencesToEdit,(function(i,r){return t("profile-work-experience-edit-item",{key:r,attrs:{experience:i},on:{remove:function(t){return e.remove(i)}}})})),1):e._e()],1)],1),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex"},[t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn me-2",attrs:{disabled:e.saving},on:{click:e.cancel}},[e._v("\n        "+e._s(e.$t("profileWorkExperiences.cancel"))+"\n      ")]),e._v(" "),t("v-btn",{staticClass:"btn btn-primary",attrs:{disabled:e.saving,loading:e.saving},on:{click:e.save}},[e._v("\n        "+e._s(e.$t("profileWorkExperiences.save"))+"\n      ")])],1)])],2)};a._withStripped=!0;const l=r({props:{experiences:{type:Array,default:()=>null}},data:()=>({hasCurrentExperience:!1,experiencesToEdit:[],openedExperiences:[],saving:null,error:null}),watch:{error(){this.error||this.$root.$emit("close-alert-message")}},methods:{save(){this.error=null;const e=this.experiencesToEdit.filter((e=>e&&(e.startDate||e.endDate||e.position||e.company||e.description||e.skills)));for(const t of e){if(!t.endDate&&this.hasCurrentExperience&&!t.id)return void this.handleError(this.$t("profileWorkExperiences.invalidStillInPosition"));if(t.company=t.company&&t.company.trim(),!t.company||t.company.length>100||t.company.length<3)return void this.handleError(this.$t("profileWorkExperiences.invalidFieldLength",{0:this.$t("profileWorkExperiences.company"),1:3,2:250}));if(t.position=t.position&&t.position.trim(),!t.position||t.position.length>100||t.position.length<3)return void this.handleError(this.$t("profileWorkExperiences.invalidFieldLength",{0:this.$t("profileWorkExperiences.jobTitle"),1:3,2:100}));if(t.description&&t.description.length>1500)return void this.handleError(this.$t("profileWorkExperiences.invalidFieldLength",{0:this.$t("profileWorkExperiences.jobDetails"),1:0,2:1500}));if(t.endDate&&new Date(t.endDate)>new Date)return void this.handleError(this.$t("profileWorkExperiences.beforeTodayEndDate"));if(t.startDate&&new Date(t.startDate)>new Date)return void this.handleError(this.$t("profileWorkExperiences.beforeTodayStartDate"));if(t.startDate&&t.endDate&&new Date(t.startDate)>=new Date(t.endDate))return void this.handleError(this.$t("profileWorkExperiences.invalidEndDate"))}this.error||(this.$refs.profileContactForm.validate()&&this.$refs.profileContactForm.$el.reportValidity()?(this.$refs.profileWorkExperiencesDrawer.startLoading(),this.saving=!0,this.$userService.updateProfileFields(eXo.env.portal.userName,{experiences:e},["experiences"]).then(this.refresh).then((()=>{this.$refs.profileWorkExperiencesDrawer.close()})).catch(this.handleError).finally((()=>{this.saving=!1,this.$refs.profileWorkExperiencesDrawer.endLoading(),this.$emit("refreshWorkExperiencesDrawer")}))):this.handleError(this.$t("profileWorkExperiences.formValidationError")))},handleError(e){e&&(this.error=String(e),this.$root.$emit("alert-message",this.error,"error"))},refresh(){return this.$userService.getUser(eXo.env.portal.profileOwner,"all").then((e=>{this.user=e,this.$emit("refresh",e&&e.experiences||[])})).catch((e=>{console.warn("Error while retrieving user details",e)}))},addNew(){this.experiencesToEdit.unshift({}),this.openedExperiences.push(this.openedExperiences.length)},remove(e){const t=this.experiencesToEdit.findIndex((t=>t===e));this.openedExperiences.includes(t)&&this.openedExperiences.splice(this.openedExperiences.indexOf(t),1),this.experiencesToEdit.splice(t,1)},cancel(){this.$refs.profileWorkExperiencesDrawer.close()},open(e){const t=this.experiences&&this.experiences.slice()||[];e&&t.unshift({}),this.experiencesToEdit=t.map((e=>Object.assign({},e))),this.hasCurrentExperience=this.experiencesToEdit.find((e=>e.isCurrent)),this.openedExperiences=[],this.$nextTick().then((()=>{this.$refs.profileWorkExperiencesDrawer.open(),e&&this.$nextTick().then((()=>this.openedExperiences=[0]))}))}}},a,[],!1,null,null,null).exports;var p=function(){var e=this,t=e._self._c;return e.experience?t("v-expansion-panel",{staticClass:"profileWorkExperiencesEditItem border-color border-radius my-3 mx-2"},[t("v-expansion-panel-header",[e.experience.id?t("div",{staticClass:"truncate-text"},[t("div",[e._v(e._s(e.position))]),e._v(" "),t("div",{staticClass:"text-sub-title"},[e._v(e._s(e.company))])]):e._e()]),e._v(" "),t("v-expansion-panel-content",[t("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left font-weight-bold pt-0 pb-2"},[e._v("\n      "+e._s(e.$t("profileWorkExperiences.company"))+" *\n    ")]),e._v(" "),t("v-card-text",{staticClass:"d-flex py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.experience.company,expression:"experience.company"}],staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{name:"company",type:"text",maxlength:"250",autofocus:"autofocus",required:""},domProps:{value:e.experience.company},on:{input:function(t){t.target.composing||e.$set(e.experience,"company",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n      "+e._s(e.$t("profileWorkExperiences.jobTitle"))+" *\n    ")]),e._v(" "),t("v-card-text",{staticClass:"d-flex py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.experience.position,expression:"experience.position"}],staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{name:"position",type:"text",maxlength:"250",required:""},domProps:{value:e.experience.position},on:{input:function(t){t.target.composing||e.$set(e.experience,"position",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n      "+e._s(e.$t("profileWorkExperiences.jobDetails"))+"\n    ")]),e._v(" "),t("v-card-text",{staticClass:"d-flex py-0"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.experience.description,expression:"experience.description"}],staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{name:"description",maxlength:"1500"},domProps:{value:e.experience.description},on:{input:function(t){t.target.composing||e.$set(e.experience,"description",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n      "+e._s(e.$t("profileWorkExperiences.usedSkills"))+"\n    ")]),e._v(" "),t("v-card-text",{staticClass:"d-flex py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.experience.skills,expression:"experience.skills"}],staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{name:"skills",type:"text",maxlength:"2000"},domProps:{value:e.experience.skills},on:{input:function(t){t.target.composing||e.$set(e.experience,"skills",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex text-color pb-2"},[t("div",{staticClass:"align-start flex-grow-1 text-no-wrap text-left font-weight-bold me-3"},[e._v("\n        "+e._s(e.$t("profileWorkExperiences.startDate"))+"\n      ")]),e._v(" "),t("div",{staticClass:"align-start flex-grow-1 text-no-wrap text-left font-weight-bold px-3"},[e._v("\n        "+e._s(e.$t("profileWorkExperiences.endDate"))+"\n      ")])]),e._v(" "),t("v-card-text",{staticClass:"d-flex py-0 profileWorkExperiencesDates"},[t("div",{staticClass:"align-start flex-grow-0 text-no-wrap text-left font-weight-bold half-width me-3"},[t("date-picker",{staticClass:"ignore-vuetify-classes",attrs:{left:e.$vuetify.rtl,top:"","return-iso":"",required:""},model:{value:e.experience.startDate,callback:function(t){e.$set(e.experience,"startDate",t)},expression:"experience.startDate"}})],1),e._v(" "),t("div",{staticClass:"align-end flex-grow-0 text-no-wrap text-left font-weight-bold half-width"},[t("date-picker",{staticClass:"ignore-vuetify-classes",attrs:{disabled:e.isCurrent,"min-value":e.experience.startDate,left:!e.$vuetify.rtl,top:"","return-iso":"",required:""},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)]),e._v(" "),t("v-card-text",{staticClass:"d-flex"},[t("v-switch",{attrs:{label:e.$t("profileWorkExperiences.stillInPosition")},model:{value:e.isCurrent,callback:function(t){e.isCurrent=t},expression:"isCurrent"}})],1),e._v(" "),t("v-card-text",{staticClass:"d-flex py-0"},[t("v-btn",{staticClass:"pa-0",attrs:{color:"error",outlined:""},on:{click:function(t){return e.$emit("remove")}}},[t("i",{staticClass:"uiIconTrash pb-1 pe-2"}),e._v("\n        "+e._s(e.$t("profileWorkExperiences.removeExperience"))+"\n      ")])],1)],1)],1):e._e()};p._withStripped=!0;const c={"profile-work-experiences":s,"profile-work-experience-item":o,"profile-work-experience-drawer":l,"profile-work-experience-edit-item":r({props:{experience:{type:Object,default:()=>null}},data:()=>({isCurrent:null,endDate:null,company:null,position:null}),watch:{experience(){this.copyAtributes()},endDate(){this.experience.endDate=this.endDate},isCurrent(){this.experience.isCurrent=this.isCurrent,this.isCurrent&&(this.endDate="")}},created(){this.copyAtributes()},methods:{copyAtributes(){this.company=this.experience&&this.experience.company||"",this.position=this.experience&&this.experience.position||"",this.isCurrent=this.experience&&this.experience.isCurrent||!1,this.isCurrent?this.endDate="":this.endDate=this.experience&&this.experience.endDate||""}}},p,[],!1,null,null,null).exports};for(const e in c)Vue.component(e,c[e]);if(extensionRegistry){const e=extensionRegistry.loadComponents("ProfileWorkExperience");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}document.dispatchEvent(new CustomEvent("displayTopBarLoading"));const d=eXo&&eXo.env.portal.language||"en",x="ProfileWorkExperience",h=`${x}_${eXo.env.portal.profileOwnerIdentityId}`,f=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.social.ProfileWorkExperience-${d}.json`;function v(){exoi18n.loadLanguageAsync(d,f).then((e=>{const t=document.createElement("div");t.id=x,Vue.createApp({mounted(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:`<profile-work-experiences v-cacheable="{cacheId: '${h}'}" id="${x}" />`,i18n:e,vuetify:Vue.prototype.vuetifyOptions},t,"Profile Work Experience")}))}return t})()));