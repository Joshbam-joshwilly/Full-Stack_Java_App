define((()=>(()=>{"use strict";var t={};(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);var e=function(){var t=this,e=t._self._c;return e("v-app",[e("activity-reactions",{attrs:{"activity-id":t.activityId,likers:t.likers,"likers-number":t.likersNumber,"comment-number":t.commentNumber}})],1)};function i(t,e,i,s,n,r,a,o){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=i,c._compiled=!0),s&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),a?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=l):n&&(l=o?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}e._withStripped=!0;const s=i({props:{activityId:{type:String,default:()=>""},likers:{type:Array,default:()=>[]},likersNumber:{type:Number,default:0},commentNumber:{type:Number,default:0}}},e,[],!1,null,null,null).exports;var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"activityReactionsContainer activityLikersAndKudos text-font-size d-flex flex-nowrap py-2"},[e("div",{staticClass:"reactionsUsersAvatar position-relative d-none d-lg-inline"},[e("div",{staticClass:"d-flex flex-nowrap"},t._l(t.likersToDisplay,(function(t){return e("exo-user-avatar",{key:t.id,attrs:{identity:t,size:30,popover:"",avatar:"","extra-class":"me-1"}})})),1)]),t._v(" "),e("div",{staticClass:"activityLikersAndKudosDrawer d-none d-lg-inline"},[e("div",{staticClass:"seeMoreReactionsContainer"},[t.seeMoreLikerToDisplay?e("div",{staticClass:"seeMoreLikers",on:{click:t.openDrawer}},[e("span",{staticClass:"seeMoreLikersDetails"},[t._v("+"+t._s(t.showMoreLikersNumber))])]):t._e(),t._v(" "),t.likersNumber&&t.likersNumber<=1?e("p",{staticClass:"likersNumber my-auto pl-2 align-self-end caption text-no-wrap",on:{click:t.openDrawer}},[t._v("\n        "+t._s(t.likersNumber)+" "+t._s(t.$t("UIActivity.label.single_Reaction_Number"))+"\n      ")]):t._e(),t._v(" "),t.likersNumber>1?e("p",{staticClass:"likersNumber my-auto pl-2 align-self-end caption text-no-wrap",on:{click:t.openDrawer}},[t._v("\n        "+t._s(t.likersNumber)+" "+t._s(t.$t("UIActivity.label.Reactions_Number"))+"\n      ")]):t._e()])]),t._v(" "),e("activity-reactions-mobile",{staticClass:"d-flex d-lg-none align-center",attrs:{activity:t.activity,"likers-number":t.likersNumber,"comment-number":t.commentNumber},on:{openDrawer:t.openDrawer}})],1)};n._withStripped=!0;const r=i({props:{activityId:{type:String,default:()=>""},activity:{type:Object,default:null},likers:{type:Array,default:()=>[]},likersNumber:{type:Number,default:0},commentNumber:{type:Number,default:0},avatarSize:{type:Number,default:()=>30}},data:()=>({maxLikersToShow:4}),computed:{seeMoreLikerToDisplay(){return this.likersNumber>=this.maxLikersToShow&&this.likers[this.maxLikersToShow-1]||null},likersToDisplay(){return this.likers.slice(0,this.maxLikersToShow-1)},showMoreLikersNumber(){return this.likersNumber-this.maxLikersToShow+1},activityPosterId(){return this.activity&&this.activity.identity&&this.activity.identity.profile&&this.activity.identity.profile.username}},methods:{openDrawer(){const t={activityId:this.activityId,activityPosterId:this.activityPosterId,tab:"like",activityType:"ACTIVITY"};this.$root.$emit("open-reaction-drawer-selected-tab",t)}}},n,[],!1,null,null,null).exports;var a=function(){var t=this,e=t._self._c;return e("v-list-item",{staticClass:"likerItem"},[e("v-list-item-avatar",{attrs:{size:t.avatarSize}},[e("v-img",{staticClass:"likerAvatar",attrs:{src:t.avatar}})],1),t._v(" "),e("v-list-item-content",{staticClass:"pb-3"},[e("v-list-item-title",{staticClass:"body-2 font-weight-bold text-color"},[e("a",{staticClass:"text-color",attrs:{id:t.cmpId,href:t.profileUrl,rel:"nofollow"},domProps:{innerHTML:t._s(t.name)}})]),t._v(" "),t.attributesLoaded&&!t.sameUser?e("v-list-item-subtitle",{staticClass:"caption text-bold"},[t._v("\n      "+t._s(t.inCommonConnections)+" "+t._s(t.$t("UIActivity.label.Reactions_in_Common"))+"\n    ")]):t._e()],1),t._v(" "),t.notConnected?e("v-list-item-action",[e("v-btn-toggle",{staticClass:"transparent"},[e("a",{attrs:{text:"",icon:"","min-width":"auto"},on:{click:function(e){return t.connect()}}},[e("i",{staticClass:"uiIconInviteUser"})])])],1):t._e()],1)};a._withStripped=!0;const o=i({props:{userId:{type:String,default:""},avatarSize:{type:Number,default:()=>34},avatar:{type:String,default:()=>""},name:{type:String,default:()=>""}},data:()=>({cmpId:`react${parseInt(1e4*Math.random()).toString()}`,user:null,attributesLoaded:!1}),computed:{inCommonConnections(){return this.user&&this.user.connectionsInCommonCount||0},sameUser(){return this.user&&this.user.username===eXo.env.portal.userName},notConnected(){return this.user&&!this.user.relationshipStatus&&!this.sameUser},profileUrl(){return this.user&&`${eXo.env.portal.context}/${eXo.env.portal.portalName}/profile/${this.user.username}`}},created(){this.retrieveUserInformations()},methods:{retrieveUserInformations(){return this.$userService.getUser(this.userId,"all,connectionsInCommonCount,relationshipStatus").then((t=>this.user=t)).catch((t=>{console.error("Error while getting user details",t)})).finally((()=>this.attributesLoaded=!0))},connect(){this.$userService.connect(this.userId).then(this.retrieveUserInformations()).catch((t=>{console.error("Error processing action",t)}))}}},a,[],!1,null,null,null).exports;var l=function(){var t=this,e=t._self._c;return e("exo-drawer",{ref:"activityReactionsDrawer",attrs:{"disable-pull-to-refresh":"",right:"",fixed:""},on:{closed:function(e){t.selectedTab=null}}},[e("template",{slot:"title"},[t._v("\n    "+t._s(t.$t("UIActivity.label.reactions"))+"\n  ")]),t._v(" "),t.drawerOpened?e("template",{slot:"content"},[e("div",[e("v-tabs",{attrs:{"slider-size":"4","fixed-tabs":""},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},t._l(t.enabledReactionsTabsExtensions,(function(i,s){return e("v-tab",{key:s,staticClass:"text-capitalize",attrs:{href:`#${i.componentOptions.id}`}},[e("span",[t._v(t._s(t.$t(`${i.componentOptions.reactionLabel}`))+" ("+t._s(i.componentOptions.numberOfReactions)+")")])])})),1),t._v(" "),e("v-divider",{attrs:{dark:""}})],1),t._v(" "),e("v-tabs-items",{staticClass:"pt-3",model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},t._l(t.enabledReactionsTabsExtensions,(function(i,s){return e("v-tab-item",{key:s,attrs:{eager:!0,value:`${i.componentOptions.id}`}},[e("extension-registry-component",{attrs:{component:i,params:t.reactionParams}})],1)})),1)],1):t._e(),t._v(" "),t.hasMoreLikers?e("template",{slot:"footer"},[e("v-btn",{staticClass:"btn pa-0",attrs:{loading:t.loading,disabled:t.loading,block:""},on:{click:t.loadMore}},[t._v("\n      "+t._s(t.$t("Search.button.loadMore"))+"\n    ")])],1):t._e()],2)};l._withStripped=!0;const c=i({data:()=>({activityId:null,activityPosterId:null,parentId:"",activityType:"",limit:10,selectedTab:null,drawerOpened:!1,activityReactionsExtensions:[],user:{}}),computed:{enabledReactionsTabsExtensions(){return this.activityReactionsExtensions?this.activityReactionsExtensions.slice().sort(((t,e)=>t.componentOptions.rank-e.componentOptions.rank)):[]},reactionParams(){return{activityId:this.activityId,parentId:this.parentId,activityType:this.activityType,activityPosterId:this.activityPosterId}}},created(){document.addEventListener("update-reaction-extension",this.updateReaction),document.addEventListener("open-reaction-drawer-selected-tab",(t=>{t&&t.detail&&this.openSelectedTab(t.detail.activityId,t.detail.tab,t.detail.activityType,t.detail.activityPosterId)})),this.$root.$on("open-reaction-drawer-selected-tab",(t=>{this.openSelectedTab(t.activityId,t.tab,t.activityType,t.activityPosterId)}))},methods:{open(){0===this.enabledReactionsTabsExtensions.length?this.refreshReactions():document.dispatchEvent(new CustomEvent("check-reactions",{detail:this.activityId})),this.$refs.activityReactionsDrawer.open(),this.drawerOpened=!0},openSelectedTab(t,e,i,s){t&&e&&(this.activityId=t,this.parentId=t,this.activityPosterId=s,this.activityType=i,this.selectedTab=e,this.open())},loadMore(){this.limit+=10},cancel(){this.$refs.activityReactionsDrawer.close()},refreshReactions(){this.activityReactionsExtensions=[],this.activityReactionsExtensions=extensionRegistry.loadComponents("ActivityReactions")||[]},updateReaction(t){if(t&&t.detail){const e=this.enabledReactionsTabsExtensions.findIndex((e=>e.componentOptions.id===t.detail.type));if(e>=0){const i=this.enabledReactionsTabsExtensions[e];i.componentOptions.numberOfReactions=t.detail.numberOfReactions,this.enabledReactionsTabsExtensions.splice(e,1,i)}}}}},l,[],!1,null,null,null).exports;var d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"actionBarMobile ps-0"},[1===t.likersNumber?e("a",{staticClass:"likesNumber me-2 my-1",on:{click:t.open}},[t._v("\n    "+t._s(t.likersNumber)+" "+t._s(t.$t("UIActivity.label.single_likeLabel")))]):t.likersNumber>1?e("a",{staticClass:"likesNumber me-2 my-1",on:{click:t.open}},[t._v("\n    "+t._s(t.likersNumber)+" "+t._s(t.$t("UIActivity.label.likesLabel")))]):t._e(),t._v(" "),t.commentNumber>0?e("a",{staticClass:"my-1 me-2 CommentsNumber",on:{click:t.openComments}},[t._v("\n    "+t._s(t.commentNumber)+" "+t._s(t.$t("UIActivity.comment.commentsLabel"))+"\n  ")]):t._e(),t._v(" "),e("extension-registry-components",{staticClass:"d-flex flex-column",attrs:{params:t.extensionParams,name:"ActivityReactionsCount",type:"activity-reaction-count","parent-element":"div",element:"div"}})],1)};d._withStripped=!0;const u=i({props:{activity:{type:Object,default:null},likersNumber:{type:Number,default:0},commentNumber:{type:Number,default:0}},computed:{extensionParams(){return{activity:this.activity}}},methods:{open(){this.$emit("openDrawer")},openComments(){document.dispatchEvent(new CustomEvent("activity-comments-display",{detail:{activity:this.activity,offset:0,limit:2*(this.commentNumber||10)}}))}}},d,[],!1,null,null,null).exports;var m=function(){var t=this,e=t._self._c;return t.likers.length?e("div",{staticClass:"likers-list"},t._l(t.likers,(function(t,i){return e("activity-liker-item",{key:i,attrs:{liker:t}})})),1):t._e()};m._withStripped=!0;const p=i({props:{activityId:{type:String,default:()=>""},parentId:{type:String,default:()=>""}},data:()=>({likers:[],limit:10}),created(){this.retrieveLikers(),document.addEventListener("check-reactions",(t=>{t&&t.detail&&t.detail===this.activityId&&this.updateLikers()})),document.addEventListener("activity-liked",(t=>{t&&t.detail&&t.detail===this.activityId&&this.retrieveLikers()}))},watch:{activityId(){this.retrieveLikers()}},methods:{retrieveLikers(){return this.$activityService.getActivityLikers(this.activityId,0).then((t=>{this.likers=t.likes,this.updateLikers()})).catch((t=>{console.error("error retrieving activity likers",t)}))},updateLikers(){document.dispatchEvent(new CustomEvent("update-reaction-extension",{detail:{numberOfReactions:this.likers.length,type:"like"}}))}}},m,[],!1,null,null,null).exports;var v=function(){var t=this,e=t._self._c;return t.liker?e("div",{staticClass:"activityLikerItem"},[e("exo-user-avatar",{attrs:{identity:t.liker,"avatar-class":"me-2",size:"42","extra-class":"pl-3 pt-2 pb-1",popover:"","bold-title":""}},[e("template",{slot:"subTitle"},[t.sameUser?t._e():e("span",{staticClass:"caption text-bold"},[t._v("\n        "+t._s(t.inCommonConnections)+" "+t._s(t.$t("UIActivity.label.Reactions_in_Common"))+"\n      ")])])],2)],1):t._e()};v._withStripped=!0;const h={"activity-reactions-app":s,"activity-reactions":r,"activity-reactions-list-items":o,"activity-likes-list":p,"activity-liker-item":i({props:{liker:{type:Object,default:null}},data:()=>({userInformations:null}),computed:{inCommonConnections(){return this.userInformations&&this.userInformations.connectionsInCommonCount||0},sameUser(){return this.userInformations&&this.userInformations.username===eXo.env.portal.userName},notConnected(){return this.userInformations&&!this.userInformations.relationshipStatus&&!this.sameUser}},created(){this.retrieveUserInformations()},methods:{retrieveUserInformations(){return this.$userService.getUser(this.liker.username,"all,connectionsInCommonCount,relationshipStatus").then((t=>this.userInformations=t)).catch((t=>{console.error("Error while getting user details",t)}))},connect(){this.$userService.connect(this.liker.username).then(this.retrieveUserInformations()).catch((t=>{console.error("Error while connecting to user",t)}))}}},v,[],!1,null,null,null).exports,"activity-reactions-drawer":c,"activity-reactions-mobile":u};for(const t in h)Vue.component(t,h[t]);if(extensionRegistry.registerComponent("ActivityReactions","activity-reaction-action",{id:"like",reactionLabel:"UIActivity.label.likesLabel",numberOfReactions:0,vueComponent:Vue.options.components["activity-likes-list"],rank:1}),extensionRegistry){const t=extensionRegistry.loadComponents("ActivityReactions");t&&t.length>0&&t.forEach((t=>{Vue.component(t.componentName,t.componentOptions)}))}return t})()));