define((()=>(()=>{"use strict";var e={d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>M});var s=function(){var e=this,t=e._self._c;return t("v-app",{staticClass:"white"},[t("v-card",{attrs:{flat:""}},[t("users-management-toolbar"),e._v(" "),t("users-management-list"),e._v(" "),t("users-management-user-form-drawer"),e._v(" "),t("users-management-user-membership-drawer"),e._v(" "),t("users-management-filter-drawer")],1)],1)};function r(e,t,s,r,i,a,n,o){var l,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=s,d._compiled=!0),r&&(d.functional=!0),a&&(d._scopeId="data-v-"+a),n?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},d._ssrRegister=l):i&&(l=o?function(){i.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(d.functional){d._injectStyles=l;var m=d.render;d.render=function(e,t){return l.call(t),m(e,t)}}else{var c=d.beforeCreate;d.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:d}}s._withStripped=!0;const i=r({},s,[],!1,null,null,null).exports;var a=function(){var e=this,t=e._self._c;return t("div",[t("users-management-import-csv-result",{staticClass:"px-4"}),e._v(" "),t("exo-confirm-dialog",{ref:"deleteConfirmDialog",attrs:{message:e.deleteConfirmMessage,title:e.$t("UsersManagement.title.confirmDelete"),"ok-label":e.$t("UsersManagement.button.ok"),"cancel-label":e.$t("UsersManagement.button.cancel")},on:{ok:function(t){return e.deleteUserConfirm()}}}),e._v(" "),t("exo-confirm-dialog",{ref:"currentUserWarningDialog",attrs:{message:e.$t("UsersManagement.message.deleteCurrentUserWarning"),title:e.$t("UsersManagement.title.deleteCurrentUserWarning"),"ok-label":e.$t("UsersManagement.button.ok")}}),e._v(" "),e.error?t("v-card-text",{staticClass:"errorMessage"},[t("v-alert",{attrs:{type:"error"}},[e._v("\n      "+e._s(e.error)+"\n    ")])],1):e._e(),e._v(" "),t("v-data-table",{staticClass:"data-table-light-border",attrs:{headers:e.headers,items:e.filteredUsers,loading:e.loading,options:e.options,"server-items-length":e.totalSize,"footer-props":{itemsPerPageOptions:e.itemsPerPageOptions},"loading-text":e.$t("UsersManagement.loadingResults"),"no-results-text":e.$t("UsersManagement.noResultsFound"),"no-data-text":e.$t("UsersManagement.noData"),"show-select":""},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"item.lastConnexion",fn:function({item:s}){return[s.lastLoginTime?t("div",[t("date-format",{staticClass:"grey--text me-1",attrs:{value:s.lastLoginTime,format:e.fullDateFormat}})],1):t("div",{staticClass:"grey--text"},[e._v("\n        "+e._s(s.connectionStatus)+"\n      ")])]}},{key:"item.enrollmentDate",fn:function({item:s}){return["invitationAccepted"===s.enrollmentStatus?t("div",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.enrollmentDetails,expression:"item.enrollmentDetails",modifiers:{bottom:!0,body:!0}}],staticClass:"d-inline"},[t("v-badge",{staticClass:"mailBadge",attrs:{bottom:"",color:"white",flat:"","offset-x":"8","offset-y":"12"}},[t("span",{attrs:{slot:"badge"},slot:"badge"},[t("v-icon",{staticClass:"successColor mt-n1 me-0",attrs:{size:"14"}},[e._v("mdi-check-circle")])],1),e._v(" "),t("v-icon",{attrs:{size:"22",color:"primary"}},[e._v("mdi-email")])],1)],1):"reInviteToJoin"===s.enrollmentStatus?t("div",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.enrollmentDetails,expression:"item.enrollmentDetails",modifiers:{bottom:!0,body:!0}}],staticClass:"d-inline"},[t("v-badge",{staticClass:"mailBadge",attrs:{bottom:"",color:"white",flat:"","offset-x":"15","offset-y":"19"}},[t("span",{attrs:{slot:"badge"},slot:"badge"},[t("v-icon",{staticClass:"errorColor mt-n1 me-0",attrs:{size:"14"}},[e._v("mdi-help-circle")])],1),e._v(" "),t("v-btn",{attrs:{icon:""},on:{click:function(t){return e.sendOnBoardingEmail(s.username)}}},[t("v-icon",{attrs:{size:"22",color:"primary"}},[e._v("mdi-email")])],1)],1)],1):"inviteToJoin"===s.enrollmentStatus?t("div",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.enrollmentDetails,expression:"item.enrollmentDetails",modifiers:{bottom:!0,body:!0}}],staticClass:"d-inline"},[t("v-btn",{attrs:{icon:""},on:{click:function(t){return e.sendOnBoardingEmail(s.username)}}},[t("v-icon",{attrs:{size:"22",color:"primary"}},[e._v("mdi-email")])],1)],1):t("div",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.enrollmentDetails,expression:"item.enrollmentDetails",modifiers:{bottom:!0,body:!0}}],staticClass:"d-inline mailBadge"},[t("v-icon",{staticClass:"disabled",attrs:{size:"22"}},[e._v("mdi-email")])],1)]}},{key:"item.enabled",fn:function({item:s}){return[t("div",[t("label",{staticClass:"switch"},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.enabled,expression:"item.enabled"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(s.enabled)?e._i(s.enabled,null)>-1:s.enabled},on:{click:function(t){return e.saveUserStatus(s)},change:function(t){var r=s.enabled,i=t.target,a=!!i.checked;if(Array.isArray(r)){var n=e._i(r,null);i.checked?n<0&&e.$set(s,"enabled",r.concat([null])):n>-1&&e.$set(s,"enabled",r.slice(0,n).concat(r.slice(n+1)))}else e.$set(s,"enabled",a)}}}),e._v(" "),t("div",{staticClass:"slider round"},[t("span",{staticClass:"absolute-activate"},[e._v(e._s(e.$t("UsersManagement.button.enabled")))])]),e._v(" "),t("span",{staticClass:"absolute-deactivated"},[e._v(e._s(e.$t("UsersManagement.button.disabled")))])])])]}},{key:"item.isInternal",fn:function({item:s}){return[s.isInternal?t("div",{staticClass:"displayedIconClass"},[t("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:e.createdTitle(s.createdDate),expression:"createdTitle(item.createdDate)",modifiers:{bottom:!0,body:!0}}],attrs:{primary:"",icon:"",text:""}},[t("i",{staticClass:"uiIconSoupCan"},[t("span",{staticClass:"internalIconClass"},[e._v("eXo")])])])],1):t("div",{staticClass:"displayedIconClass"},[t("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:e.synchronizedTitle(s.synchronizedDate),expression:"synchronizedTitle(item.synchronizedDate)",modifiers:{bottom:!0,body:!0}}],attrs:{primary:"",icon:"",text:""}},[t("i",{staticClass:"uiIconManageApplication"},[t("span",{staticClass:"synchronizedIconClass"},[e._v("SYNC")])])])],1)]}},{key:"item.external",fn:function({item:t}){return[e._v("\n      "+e._s(t&&"true"===t.external?e.$t("UsersManagement.type.external"):e.$t("UsersManagement.type.internal"))+"\n    ")]}},{key:"item.role",fn:function({item:s}){return[t("v-btn",{attrs:{title:e.$t("UsersManagement.button.membership"),primary:"",icon:"",text:""},on:{click:function(t){return e.$root.$emit("openUserMemberships",s)}}},[t("i",{staticClass:"uiIconGroup"})])]}},{key:"item.edit",fn:function({item:s}){return[t("span",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.isInternal?e.$t("UsersManagement.button.editUser"):e.$t("UsersManagement.tooltip.editSynchronzedUser"),expression:"item.isInternal ? $t('UsersManagement.button.editUser') : $t('UsersManagement.tooltip.editSynchronzedUser')",modifiers:{bottom:!0,body:!0}}]},[t("v-btn",{attrs:{disabled:!s.isInternal,icon:"",text:""},on:{click:function(t){return e.$root.$emit("editUser",s)}}},[t("i",{staticClass:"uiIconEdit",class:s.isInternal?"uiIconEdit":"uiDiseabledIconEdit"})])],1)]}},{key:"item.delete",fn:function({item:s}){return[t("v-btn",{attrs:{title:e.$t("UsersManagement.button.deleteUser"),primary:"",icon:"",text:""},on:{click:function(t){return e.deleteUser(s)}}},[t("i",{staticClass:"uiIconTrash trashIconColor"})])]}}]),model:{value:e.selectedUsers,callback:function(t){e.selectedUsers=t},expression:"selectedUsers"}}),e._v(" "),e.selectedUsersUpdated?t("v-alert",{staticClass:"userUpdated",attrs:{border:"left",type:"info","close-icon":"mdi-close","colored-border":"",color:"primary",dismissible:""}},[e._v("\n    "+e._s(e.selectedUsersUpdated)+"\n  ")]):e._e()],1)};a._withStripped=!0;const n=r({data:()=>({startSearchAfterInMilliseconds:600,endTypingKeywordTimeout:50,startTypingKeywordTimeout:0,itemsPerPageOptions:[20,50,100],users:[],user:null,currentUser:eXo.env.portal.userName,selectedUser:null,selectedUsers:[],selectedUsersUpdated:"",deleteConfirmMessage:null,keyword:null,filter:"ENABLED",selectedFiler:null,isConnected:null,userType:null,enrollmentStatus:null,lang:eXo.env.portal.language,options:{page:1,itemsPerPage:20},synchronizedDate:0,createdDate:0,totalSize:0,initialized:!1,isSuperUser:!1,loading:!0,error:null,fullDateFormat:{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}}),computed:{filteredUsers(){return this.keyword&&this.loading?this.users.slice().filter((e=>e.userName.toLowerCase().indexOf(this.keyword.toLowerCase())>=0||e.firstName.toLowerCase().indexOf(this.keyword.toLowerCase())>=0||e.lastName.toLowerCase().indexOf(this.keyword.toLowerCase())>=0||e.email.toLowerCase().indexOf(this.keyword.toLowerCase())>=0)):this.users.slice()},headers(){return[{text:this.$t&&this.$t("UsersManagement.userName"),value:"userName",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.firstName"),value:"firstName",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.lastName"),value:"lastName",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.email"),value:"email",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.lastConnection"),value:"lastConnexion",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.enrollment"),value:"enrollmentDate",align:"center",width:"80px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.status"),value:"enabled",align:"center",width:"80px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.source"),value:"isInternal",align:"center",width:"80px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.type"),value:"external",align:"center",width:"80px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.role"),value:"role",align:"center",width:"60px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.edit"),value:"edit",align:"center",width:"60px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.delete"),value:"delete",align:"center",width:"80px",class:"headerPadding",sortable:!1,show:this.isSuperUser}].filter((e=>null==e.show||!0===e.show))}},watch:{options(){this.searchUsers()},filter(){this.options.page=1,this.searchUsers()},selectedUsers(e){document.dispatchEvent(new CustomEvent("multiSelect",{detail:{usersSelected:e.length>0}}))},keyword(){this.options.page=1,this.keyword?(this.startTypingKeywordTimeout=Date.now(),this.loading||(this.loading=!0,this.waitForEndTyping())):this.searchUsers()}},created(){this.$userService.isSuperUser().then((e=>{this.isSuperUser="true"===e.isSuperUser})),this.$root.$on("searchUser",this.updateSearchTerms),this.$root.$on("refreshUsers",this.searchUsers),this.$root.$on("multiSelectAction",this.multiSelectAction),this.$root.$on("applyAdvancedFilter",this.applyAdvancedFilter)},methods:{updateSearchTerms(e,t){this.keyword=e,this.filter=t},multiSelectAction(e){const t=[];let s="";if(this.selectedUsers.length>0){for(let e=0;e<this.selectedUsers.length;e++)t.push(this.selectedUsers[e].userName);this.selectedUsers=[],this.loading=!0,this.$userService.multiSelectAction(e,t).then((t=>{t.length>0&&(s=this.$t(`UsersManagement.selection.success.${e}`))})).finally((()=>{this.initialized||this.$root.$applicationLoaded(),this.searchUsers(),this.loading=!1,this.initialized=!0,this.selectedUsersUpdated=s,setTimeout((()=>this.selectedUsersUpdated=""),3e3)}))}},synchronizedTitle(e){return e?this.$t("UsersManagement.source.synchronized",{0:this.formatDate(e)}):this.$t("UsersManagement.source.synchronized.notProvided")},createdTitle(e){return this.$t("UsersManagement.source.createdUser",{0:this.formatDate(e)})},deleteUser(e){this.currentUser!==e.userName?(this.selectedUser=e,this.deleteConfirmMessage=this.$t("UsersManagement.message.confirmDelete",{0:this.selectedUser.fullName}),this.$refs.deleteConfirmDialog.open()):this.$refs.currentUserWarningDialog.open()},deleteUserConfirm(){this.loading=!0;const e=this,t=this.selectedUser.userName;return fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/users/${t}`,{method:"DELETE",credentials:"include"}).then((s=>{if(!s||!s.ok){if(s&&400===s.status)return s.text().then((e=>{throw new Error(e)}));throw new Error(this.$t("IDMManagement.error.UnknownServerError"))}e.users=e.users.filter((e=>e.userName!==t))})).catch((e=>{const t=`UsersManagement.error.${e=e.message||String(e)}`,s=this.$t(t,{0:this.selectedUser.fullname});s!==t&&(e=s),this.error=e,window.setTimeout((()=>{this.error=null}),5e3)})).finally((()=>this.loading=!1))},searchUsers(){const e=this.options&&this.options.page;let t=this.options&&this.options.itemsPerPage;t<=0&&(t=this.totalSize||20);const s=(e-1)*t;this.loading=!0;const r="ENABLED"===this.filter?"false":"true";return null==this.selectedFiler||"internal"!==this.selectedFiler&&"external"!==this.selectedFiler||(this.userType=this.selectedFiler),null==this.selectedFiler||"connected"!==this.selectedFiler&&"neverConnected"!==this.selectedFiler||(this.isConnected=this.selectedFiler),null==this.selectedFiler||"enrolled"!==this.selectedFiler&&"notEnrolled"!==this.selectedFiler&&"noEnrollmentPossible"!==this.selectedFiler||(this.enrollmentStatus=this.selectedFiler),fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/users?q=${this.keyword||""}&isDisabled=${r}&status=${this.filter||"ENABLED"}&userType=${this.userType||""}${null!=this.isConnected?`&isConnected=${this.isConnected}`:""}${null!=this.enrollmentStatus?`&enrollmentStatus=${this.enrollmentStatus}`:""}&offset=${s||0}&limit=${t}&returnSize=true`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error(this.$t("IDMManagement.error.UnknownServerError"))})).then((e=>{const t=e.entities||e.users;return t.forEach((e=>{e.enabled=e.enabled||!1,e.userName=e.userName||e.username||"",e.firstName=e.firstName||e.firstname||"",e.lastName=e.lastName||e.lastname||"",e.email=e.email||"",e.synchronizedDate&&(e.synchronizedDate=Number(e.synchronizedDate)),e.createdDate&&(e.createdDate=Number(e.createdDate)),e.lastLoginTime?(e.lastLoginTime=Number(e.lastLoginTime),null!=e.enrollmentDate?(e.enrollmentStatus="invitationAccepted",e.enrollmentDetails=this.$t("UsersManagement.enrollment.invitationAccepted",{0:this.formatDate(Number(e.enrollmentDate))})):(e.enrollmentStatus="alreadyConnected",e.enrollmentDetails=this.$t("UsersManagement.enrollment.alreadyConnected"))):(e.connectionStatus=this.$t("UsersManagement.lastConnection.neverConnected"),"true"===e.external?(e.enrollmentStatus="cannotBeEnrolled",e.enrollmentDetails=this.$t("UsersManagement.enrollment.cannotBeEnrolled")):null!=e.enrollmentDate?(e.enrollmentStatus="reInviteToJoin",e.enrollmentDetails=this.$t("UsersManagement.enrollment.reInviteToJoin",{0:this.formatDate(Number(e.enrollmentDate))})):(e.enrollmentStatus="inviteToJoin",e.enrollmentDetails=this.$t("UsersManagement.enrollment.inviteToJoin")))})),this.users=t,this.totalSize=e&&e.size||0,this.$nextTick()})).finally((()=>{this.initialized||this.$root.$applicationLoaded(),this.loading=!1,this.initialized=!0,this.isConnected=null,this.userType=null,this.enrollmentStatus=null}))},waitForEndTyping(){window.setTimeout((()=>{Date.now()-this.startTypingKeywordTimeout>this.startSearchAfterInMilliseconds?this.searchUsers():this.waitForEndTyping()}),this.endTypingKeywordTimeout)},saveUserStatus(e){return this.error=null,this.user={userName:e.userName,firstName:e.firstName,lastName:e.lastName,email:e.email,enabled:!e.enabled},fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/users`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.user)}).then((t=>{if(!t||!t.ok){if(400===t.status)return t.text().then((t=>{const s=`UsersManagement.error.${t=t.message||String(t)}`,r=this.$t(s,{0:e.fullname});r!==s&&(t=r),this.error=t,window.setTimeout((()=>{this.error=null}),5e3)}));throw new Error(this.$t("IDMManagement.error.UnknownServerError"))}})).finally((()=>{this.initialized||this.$root.$applicationLoaded(),this.searchUsers(),this.loading=!1,this.initialized=!0}))},formatDate(e){return this.$dateUtil.formatDateObjectToDisplay(new Date(e),this.fullDateFormat,this.lang)},sendOnBoardingEmail(e){return this.loading=!0,fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/users/onboard/${e}`,{method:"PATCH",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error("Error sending onBoarding email")})).finally((()=>{this.initialized||this.$root.$applicationLoaded(),this.searchUsers(),this.loading=!1,this.initialized=!0}))},applyAdvancedFilter(e){this.selectedFiler=e,this.searchUsers()}}},a,[],!1,null,null,null).exports;var o=function(){var e=this,t=e._self._c;return t("v-toolbar",{attrs:{id:"usersManagementToolbar",flat:""}},[t("v-toolbar-title",{staticClass:"nav-collapse overflow-visible"},[e.isDelegatedAdministrator?e._e():t("div",{staticClass:"btn-group"},[t("v-btn",{staticClass:"btn btn-primary addNewUserButton",on:{click:function(t){return e.$root.$emit("addNewUser")}}},[t("i",{staticClass:"uiIconAddUser uiIconWhite me-md-3"}),e._v(" "),t("span",{staticClass:"d-none d-sm-inline"},[e._v("\n          "+e._s(e.$t("UsersManagement.addUser"))+"\n        ")])]),e._v(" "),t("v-btn",{staticClass:"btn btn-primary dropdown-toggle width-auto pa-0",attrs:{"data-toggle":"dropdown"}},[t("span",{staticClass:"caret my-0 mx-3"})]),e._v(" "),e.initialized?t("div",{staticClass:"dropdown-menu"},[t("users-management-import-csv-button")],1):e._e()],1),e._v(" "),t("v-btn",{staticClass:"mx-1 multiSelect",attrs:{disabled:!e.usersSelected,outlined:"",color:"primary"},on:{click:function(t){return e.multiSelectAction("onboard")}}},[t("i",{staticClass:"uiIconInviteUser me-2 mb-2"}),e._v("\n      "+e._s(e.$t("UsersManagement.selection.onboard"))+"\n    ")]),e._v(" "),t("v-btn",{staticClass:"multiSelect",attrs:{disabled:!e.usersSelected,outlined:"",color:"primary"},on:{click:function(t){return e.multiSelectAction("enable")}}},[t("i",{staticClass:"uiIconValidateUser me-2 mb-2"}),e._v("\n      "+e._s(e.$t("UsersManagement.selection.enable"))+"\n    ")]),e._v(" "),t("v-btn",{staticClass:"multiSelect",attrs:{disabled:!e.usersSelected,outlined:"",color:"primary"},on:{click:function(t){return e.multiSelectAction("disable")}}},[t("i",{staticClass:"uiIconRejectUser me-2 mb-2"}),e._v("\n      "+e._s(e.$t("UsersManagement.selection.disable"))+"\n    ")])],1),e._v(" "),t("v-spacer"),e._v(" "),t("v-scale-transition",[t("v-text-field",{staticClass:"inputUserFilter pa-0 me-3 my-auto",attrs:{placeholder:e.$t("UsersManagement.filterBy"),"prepend-inner-icon":"fa-filter"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),t("v-scale-transition",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],staticClass:"selectUsersFilter width-auto my-auto me-2 pe-2 subtitle-1 ignore-vuetify-classes d-none d-sm-inline",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.filter=t.target.multiple?s:s[0]}}},[t("option",{attrs:{value:"ENABLED"}},[e._v("\n        "+e._s(e.$t("UsersManagement.status.enabled"))+"\n      ")]),e._v(" "),t("option",{attrs:{value:"DISABLED"}},[e._v("\n        "+e._s(e.$t("UsersManagement.status.disabled"))+"\n      ")])])]),e._v(" "),"ENABLED"!==e.filter||e.isDelegatedAdministrator?e._e():t("v-btn",{attrs:{"min-width":"auto",outlined:""},on:{click:function(t){return e.$root.$emit("advancedFilter",e.selectedFiler)}}},[t("i",{staticClass:"uiSettingsIcon"}),e._v(" "),e.numberOfFilters>0?t("div",{staticClass:"pb-1"},[e._v("\n      ("+e._s(e.numberOfFilters)+")\n    ")]):e._e()])],1)};o._withStripped=!0;const l=r({data:()=>({filter:"ENABLED",initialized:!1,keyword:null,usersSelected:!1,numberOfFilters:0,selectedFiler:null,isDelegatedAdministrator:!0}),watch:{keyword(){this.$root.$emit("searchUser",this.keyword,this.filter)},filter(){this.$root.$emit("searchUser",this.keyword,this.filter)}},created(){this.$userService.isDelegatedAdministrator().then((e=>{this.isDelegatedAdministrator="true"===e.result})),document.addEventListener("multiSelect",this.updateSelectedUsers),this.$root.$on("applyAdvancedFilter",this.applyAdvancedFilter)},updated(){window.setTimeout((()=>this.initialized=!0),1e3)},methods:{updateSelectedUsers(e){this.usersSelected=e.detail.usersSelected},multiSelectAction(e){this.$root.$emit("multiSelectAction",e)},applyAdvancedFilter(e){this.selectedFiler=e,this.numberOfFilters=this.countFiltersMethods(e)},countFiltersMethods(e){let t=0;return null!=e&&t++,t}}},o,[],!1,null,null,null).exports;var d=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"userFormDrawer",attrs:{id:"userFormDrawer",right:""},on:{closed:function(t){e.drawer=!1}}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("v-form",{ref:"userForm",staticClass:"form-horizontal pt-0 pb-4",attrs:{flat:""},on:{submit:e.saveUser}},[e.error?t("v-card-text",{staticClass:"errorMessage"},[t("v-alert",{attrs:{type:"error"}},[e._v("\n          "+e._s(e.error)+"\n        ")])],1):e._e(),e._v(" "),t("v-card-text",{staticClass:"d-flex userNameLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.userName"))),e.newUser?[e._v("*")]:e._e()],2),e._v(" "),t("v-card-text",{staticClass:"d-flex userNameField py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.userName,expression:"user.userName"}],ref:"userNameInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving||!e.newUser,autofocus:e.drawer,type:"text",maxlength:"2000",required:""},domProps:{value:e.user.userName},on:{input:function(t){t.target.composing||e.$set(e.user,"userName",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex firstNameLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.firstName"))+"*\n      ")]),e._v(" "),t("v-card-text",{staticClass:"d-flex firstNameField py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.firstName,expression:"user.firstName"}],ref:"firstNameInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving,type:"text",maxlength:"2000",required:""},domProps:{value:e.user.firstName},on:{input:function(t){t.target.composing||e.$set(e.user,"firstName",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex lastNameLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.lastName"))+"*\n      ")]),e._v(" "),t("v-card-text",{staticClass:"d-flex lastNameField py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.lastName,expression:"user.lastName"}],ref:"lastNameInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving,type:"text",maxlength:"2000",required:""},domProps:{value:e.user.lastName},on:{input:function(t){t.target.composing||e.$set(e.user,"lastName",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex emailLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.email"))+"*\n      ")]),e._v(" "),t("v-card-text",{staticClass:"d-flex emailField py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],ref:"emailInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving,type:"email",maxlength:"2000",required:""},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex newPasswordLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.password"))),e.newUser?[e._v("*")]:e._e()],2),e._v(" "),t("v-card-text",{staticClass:"d-flex newPasswordField py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],ref:"newPasswordInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving||!e.user.isInternal&&!e.newUser,required:e.newUser,type:"password",autocomplete:"new-password"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}})]),e._v(" "),t("v-card-text",{staticClass:"d-flex confirmPasswordLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.confirmPassword"))),e.newUser?[e._v("*")]:e._e()],2),e._v(" "),t("v-card-text",{staticClass:"d-flex confirmPasswordField py-0"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.user.confirmNewPassword,expression:"user.confirmNewPassword"}],ref:"confirmNewPassword",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving||!e.user.isInternal&&!e.newUser,required:e.newUser,type:"password",autocomplete:"new-password"},domProps:{value:e.user.confirmNewPassword},on:{input:function(t){t.target.composing||e.$set(e.user,"confirmNewPassword",t.target.value)}}})])],1)],1),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex"},[t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn me-2",attrs:{disabled:e.saving},on:{click:e.cancel}},[e._v("\n        "+e._s(e.$t("UsersManagement.button.cancel"))+"\n      ")]),e._v(" "),t("v-btn",{staticClass:"btn btn-primary",attrs:{disabled:e.saving,loading:e.saving},on:{click:e.saveUser}},[e._v("\n        "+e._s(e.$t("UsersManagement.button.save"))+"\n      ")])],1)])],2)};d._withStripped=!0;const m=r({data:()=>({error:null,fieldError:!1,drawer:!1,newUser:!1,saving:!1,confirmNewPassword:null,user:{enabled:!0}}),computed:{title(){return this.newUser?this.$t("UsersManagement.addUser"):this.$t("UsersManagement.editUser")}},watch:{confirmNewPassword(){this.resetCustomValidity()},saving(){this.saving?this.$refs.userFormDrawer.startLoading():this.$refs.userFormDrawer.endLoading()},drawer(){this.drawer?(this.$refs.userFormDrawer.open(),window.setTimeout((()=>{this.newUser?this.$refs.userNameInput.focus():this.$refs.firstNameInput.focus()}),200)):this.$refs.userFormDrawer.close()}},created(){this.$root.$on("addNewUser",this.addNewUser),this.$root.$on("editUser",this.editUser)},methods:{resetCustomValidity(){this.$refs.userNameInput.setCustomValidity(""),this.$refs.firstNameInput.setCustomValidity(""),this.$refs.lastNameInput.setCustomValidity(""),this.$refs.emailInput.setCustomValidity(""),this.$refs.newPasswordInput.setCustomValidity(""),this.$refs.confirmNewPassword.setCustomValidity("")},addNewUser(){this.user={enabled:!0},this.newUser=!0,this.drawer=!0},editUser(e){this.user=Object.assign({},e),this.newUser=!1,this.drawer=!0},saveUser(e){if(e&&(e.preventDefault(),e.stopPropagation()),this.error=null,this.fieldError=!1,this.resetCustomValidity(),this.$refs.userForm.validate()&&this.$refs.userForm.$el.reportValidity()&&(!this.confirmNewPassword||!this.user.password||this.confirmNewPassword===this.user.password||(this.$refs.confirmNewPassword.setCustomValidity(this.$t("UsersManagement.newPasswordsDoesNotMatch")),this.$refs.userForm.$el.reportValidity())))return this.saving=!0,fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/users`,{method:this.newUser?"POST":"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.user)}).then((e=>{if(!e||!e.ok){if(400===e.status)return e.text().then((e=>{throw this.fieldError=e,new Error(e)}));throw new Error(this.$t("IDMManagement.error.UnknownServerError"))}})).then((()=>this.$root.$emit("refreshUsers"))).then((()=>this.$refs.userFormDrawer.close())).catch(this.handleError).finally((()=>this.saving=!1))},cancel(){this.drawer=!1},handleError(e){if(this.resetCustomValidity(),e){if(this.fieldError&&0===this.fieldError.indexOf("USERNAME:"))if("USERNAME:ALREADY_EXISTS"===this.fieldError)this.$refs.userNameInput.setCustomValidity(this.$t("UsersManagement.message.userWithSameNameAlreadyExists"));else if("USERNAME:ALREADY_EXISTS_AS_DELETED"===this.fieldError)this.$refs.userNameInput.setCustomValidity(this.$t("UsersManagement.message.LoginForDeletedUser"));else{const e=this.fieldError.replace("USERNAME:","");this.$refs.userNameInput.setCustomValidity(e)}else if(this.fieldError&&0===this.fieldError.indexOf("FIRSTNAME:")){const e=this.fieldError.replace("FIRSTNAME:","");this.$refs.firstNameInput.setCustomValidity(e)}else if(this.fieldError&&0===this.fieldError.indexOf("LASTNAME:")){const e=this.fieldError.replace("LASTNAME:","");this.$refs.lastNameInput.setCustomValidity(e)}else if(this.fieldError&&0===this.fieldError.indexOf("EMAIL:"))if("EMAIL:ALREADY_EXISTS"===this.fieldError)this.$refs.emailInput.setCustomValidity(this.$t("UsersManagement.message.userWithSameEmailAlreadyExists"));else{const e=this.fieldError.replace("EMAIL:","");this.$refs.emailInput.setCustomValidity(e)}else if(this.fieldError&&0===this.fieldError.indexOf("PASSWORD:")){const e=this.fieldError.replace("PASSWORD:","");this.$refs.newPasswordInput.setCustomValidity(e)}else{const t=`UsersManagement.error.${e=e.message||String(e)}`,s=this.$t(t,{0:this.user.fullname});s!==t&&(e=s),this.error=e,window.setTimeout((()=>{this.error=null}),5e3)}window.setTimeout((()=>{this.$refs.userForm.validate()&&this.$refs.userForm.$el.reportValidity()}),200)}else this.error=null}}},d,[],!1,null,null,null).exports;var c=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"userMembershipDrawer",attrs:{id:"userMembershipDrawer",right:""},on:{closed:function(t){e.drawer=!1}}},[t("template",{slot:"title"},[t("div",{staticClass:"text-truncate",attrs:{title:e.title}},[e._v("\n      "+e._s(e.title)+"\n    ")])]),e._v(" "),t("template",{slot:"content"},[t("v-data-table",{staticClass:"data-table-light-border",attrs:{headers:e.headers,items:e.membershipsArray,loading:e.loading,"loading-text":e.$t("UsersManagement.loadingResults"),"no-results-text":e.$t("UsersManagement.noResultsFound"),"no-data-text":e.$t("UsersManagement.noData"),"hide-default-header":"","hide-default-footer":""},scopedSlots:e._u([{key:"item.membershipType",fn:function({item:t}){return[e._v("\n        "+e._s(t.membershipType)+"\n      ")]}},{key:"item.groupId",fn:function({item:s}){return[t("v-list-item-content",[t("v-list-item-title",[e._v(e._s(s.groupLabel))]),e._v(" "),t("v-list-item-subtitle",{staticClass:"caption text-sub-title"},[e._v(e._s(s.groupId))])],1)]}}])})],1),e._v(" "),e.hasPagination?t("template",{slot:"footer"},[t("div",{staticClass:"d-flex justify-center"},[t("v-pagination",{attrs:{length:e.pagesCount,circle:"",light:"",flat:""},on:{input:e.changePage},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)]):e._e()],2)};c._withStripped=!0;const u=r({data:()=>({drawer:!1,loading:!1,saving:!1,pageSize:10,page:1,offset:0,limit:5,memberships:{},user:{}}),computed:{title(){return this.$t("UsersManagement.button.membershipsOfUser",{0:this.user.fullname})},userName(){return this.user&&this.user.userName},membershipsArray(){return this.memberships&&this.memberships.entities||[]},hasPagination(){return this.memberships.size>this.pageSize},pagesCount(){return parseInt((this.memberships.size+this.pageSize-1)/this.pageSize)},headers(){return[{text:this.$t&&this.$t("UsersManagement.membershipType"),value:"membershipType",align:"center",sortable:!1},{text:this.$t&&this.$t("UsersManagement.group"),value:"groupId",align:"left",sortable:!1}]}},watch:{loading(){this.loading?this.$refs.userMembershipDrawer.startLoading():this.$refs.userMembershipDrawer.endLoading()},page(){this.refresh()},drawer(){this.drawer?this.$refs.userMembershipDrawer.open():this.$refs.userMembershipDrawer.close()}},created(){this.$root.$on("openUserMemberships",this.open)},methods:{open(e){this.user=e,this.refresh(),this.drawer=!0},refresh(){const e=(this.page-1)*this.pageSize;return this.loading=!0,fetch(`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/users/${this.userName}/memberships?offset=${e}&limit=${this.pageSize}&returnSize=true`,{method:"GET",credentials:"include"}).then((e=>{if(e&&e.ok)return e.json();throw new Error(this.$t("IDMManagement.error.UnknownServerError"))})).then((e=>this.memberships=e)).finally((()=>this.loading=!1))}}},c,[],!1,null,null,null).exports;var h=function(){var e=this,t=e._self._c;return t("v-btn",{staticClass:"btn dropdown-button",attrs:{disabled:e.disabled},on:{click:e.openFileSelection}},[t("i",{staticClass:"uiIconImport me-md-3"}),e._v("\n  "+e._s(e.$t("UsersManagement.importCSV"))+"\n  "),e.disabled?e._e():t("v-file-input",{ref:"usersCSVInput",staticClass:"importCSVUsersButton hidden me-4",attrs:{"prepend-icon":"",accept:".csv",clearable:""},on:{change:e.importUsers}})],1)};h._withStripped=!0;const p=r({data:()=>({disabled:!1}),created(){this.$root.$on("importCSVStarted",(()=>this.disabled=!0)),this.$root.$on("importCSVError",(()=>this.disabled=!1)),this.$root.$on("importCSVFinished",(()=>this.disabled=!1))},methods:{openFileSelection(){this.$refs.usersCSVInput.$el.getElementsByTagName("input")[0].click()},importUsers(e){if(e&&e.size){const t=this.$uploadService.generateRandomId();return this.$root.$emit("importCSVStarted",t),this.$uploadService.upload(e,t).then((()=>this.$userService.importUsers(t))).then((()=>this.$root.$emit("importCSVProgress",t))).catch((e=>this.$root.$emit("importCSVError",e)))}}}},h,[],!1,null,null,null).exports;var g=function(){var e=this,t=e._self._c;return e.error?t("v-flex",{staticClass:"d-flex flex-wrap"},["UPLOAD_ID:MANDATORY"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.uploadIdMandatory"))+"\n  ")]:"UPLOAD_ID:NOT_FOUND"===e.errorMessage||"UPLOAD_ID_FILE:NOT_FOUND"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.uploadedFileNotfound"))+"\n  ")]:"UPLOAD_ID_PROGRESS:NOT_FOUND"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.uploadedFileProgressNotfound"))+"\n  ")]:"UPLOAD_ID_PROCESSING:ALREADY_PROCESSING"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.uploadedFileIsAlreadyProcessing"))+"\n  ")]:"ERROR_READING_FILE"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.errorReadingUploadedFile"))+"\n  ")]:"BAD_FORMAT:FILE_EMPTY"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.fileIsEmpty"))+"\n  ")]:e.createUserErrorMessage?[e._v("\n    "+e._s(e.createUserErrorMessage)+"\n  ")]:"BAD_LINE_FORMAT:MISSING_USERNAME"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.missingUserName"))+"\n  ")]:"BAD_LINE_FORMAT"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.badLineFormat",{0:e.userName}))+"\n  ")]:e.validationErrorMessage?[e._v("\n    "+e._s(e.validationErrorMessage)+"\n  ")]:"USERNAME:ALREADY_EXISTS"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.userAlreadyExists",{0:e.userName}))+"\n  ")]:"EMAIL:ALREADY_EXISTS"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.emailAlreadyExists",{0:e.userName}))+"\n  ")]:e.groupNotExistsErrorMessage?[e._v("\n    "+e._s(e.groupNotExistsErrorMessage)+"\n  ")]:e.membershipNotExistsErrorMessage?[e._v("\n    "+e._s(e.membershipNotExistsErrorMessage)+"\n  ")]:e.membershipImportErrorMessage?[e._v("\n    "+e._s(e.membershipImportErrorMessage)+"\n  ")]:e.createUserProfileErrorMessage?[e._v("\n    "+e._s(e.createUserProfileErrorMessage)+"\n  ")]:[e._v("\n    "+e._s(e.error)+"\n  ")]],2):e._e()};g._withStripped=!0;const v=r({props:{error:{type:String,default:null},userName:{type:String,default:null}},computed:{errorMessage(){return this.error&&String(this.error).replace("Error: ","")},validationErrorMessage(){return this.errorMessage&&this.errorMessage.indexOf("USER_VALIDATION_ERROR:")>-1&&this.errorMessage.split(":")[1]},createUserErrorMessage(){return this.errorMessage&&this.errorMessage.indexOf("CREATE_USER_ERROR")>-1&&this.$t("UsersManagement.error.importCSV.errorCreatingUser")},groupNotExistsErrorMessage(){return this.errorMessage&&this.errorMessage.indexOf("GROUP_NOT_EXISTS:")>-1&&this.$t("UsersManagement.error.importCSV.groupNotExists",{0:this.errorMessage.split(":")[1]})},membershipNotExistsErrorMessage(){return this.errorMessage&&this.errorMessage.indexOf("MEMBERSHIP_TYPE_NOT_EXISTS:")>-1&&this.$t("UsersManagement.error.importCSV.membershipNotExists",{0:this.errorMessage.split(":")[1]})},membershipImportErrorMessage(){return this.errorMessage&&this.errorMessage.indexOf("IMPORT_MEMBERSHIP_ERROR:")>-1&&this.$t("UsersManagement.error.importCSV.createMembershipError")},createUserProfileErrorMessage(){return this.errorMessage&&this.errorMessage.indexOf("CREATE_USER_PROFILE_ERROR:")>-1&&this.$t("UsersManagement.error.importCSV.createSocialProfileError")}}},g,[],!1,null,null,null).exports;var f=function(){var e=this,t=e._self._c;return t("v-flex",[e.displayAlert?t("v-alert",{attrs:{type:e.alertType}},[e.error?t("users-management-import-csv-error-message",{attrs:{error:e.error}}):e.uploading?[e._v("\n      "+e._s(e.$t("UsersManagement.uploadingCSVFile"))+"\n    ")]:e.progress?[t("ul",[t("li",[e.finished?[e._v("\n            "+e._s(e.$t("UsersManagement.finishedImportingCSVFile",{0:e.progress.count}))+"\n          ")]:[e._v("\n            "+e._s(e.$t("UsersManagement.processingCSVFile",{0:e.progress.processedCount,1:e.progress.count}))+"\n          ")]],2),e._v(" "),e.errorsCount?t("li",[e._v("\n          - "+e._s(e.$t("UsersManagement.errorImportingCSVFile"))+": "),t("a",{on:{click:function(t){return e.$refs.errorDrawer.open()}}},[e._v(e._s(e.errorsCount)+" / "+e._s(e.progress.processedCount))])]):e._e(),e._v(" "),e.warnsCount?t("li",[e._v("\n          - "+e._s(e.$t("UsersManagement.warningImportingCSVFile"))+": "),t("a",{on:{click:function(t){return e.$refs.warnDrawer.open()}}},[e._v(e._s(e.warnsCount)+" / "+e._s(e.progress.processedCount))])]):e._e()])]:e._e()],2):e._e(),e._v(" "),t("exo-drawer",{ref:"errorDrawer",attrs:{right:""}},[t("template",{slot:"title"},[e._v(e._s(e.$t("UsersManagement.importCSVErrors")))]),e._v(" "),t("template",{slot:"content"},[t("v-data-table",{attrs:{headers:e.errorHeaders,items:e.errorMessages,"items-per-page":20,"footer-props":{itemsPerPageOptions:e.itemsPerPageOptions},"hide-default-header":""},scopedSlots:e._u([{key:"item.message",fn:function({item:e}){return[t("users-management-import-csv-error-message",{attrs:{error:e.message,"user-name":e.userName}})]}}])})],1)],2),e._v(" "),t("exo-drawer",{ref:"warnDrawer",attrs:{right:""}},[t("template",{slot:"title"},[e._v(e._s(e.$t("UsersManagement.importCSVWarnings")))]),e._v(" "),t("template",{slot:"content"},[t("v-data-table",{attrs:{headers:e.errorHeaders,items:e.warnMessages,"items-per-page":20,"footer-props":{itemsPerPageOptions:e.itemsPerPageOptions},"hide-default-header":""},scopedSlots:e._u([{key:"item.message",fn:function({item:e}){return[t("users-management-import-csv-error-message",{attrs:{error:e.message,"user-name":e.userName}})]}}])})],1)],2)],1)};f._withStripped=!0;const _=r({data:()=>({uploadId:null,progress:null,error:null,errorHeaders:[{value:"userName"},{value:"message"}],itemsPerPageOptions:[20,50,100]}),computed:{warnsCount(){return this.warnMessages.length},warnMessages(){return this.progress&&this.progress.warnMessages?Object.keys(this.progress.warnMessages).flatMap((e=>this.progress.warnMessages[e].map((t=>({userName:e,message:t}))))):[]},errorsCount(){return this.errorMessages.length},errorMessages(){return this.progress&&this.progress.errorMessages?Object.keys(this.progress.errorMessages).map((e=>({userName:e,message:this.progress.errorMessages[e]}))):[]},uploading(){return!this.finished&&!this.progress&&this.uploadId},imported(){return this.progress&&this.progress.processedCount>=this.progress.count},finished(){return this.error||this.imported},alertType(){return this.error?"error":this.finished?"success":"info"},displayAlert(){return this.uploading||this.progress||this.finished}},watch:{uploadId(){this.progress=null,this.error=null},finished(e,t){this.finished&&this.uploadId&&this.$userService.cleanImportUsers(this.uploadId).then((e=>{this.progress=e})),e&&e!==t&&this.$root.$emit("importCSVFinished",this.uploadId,this.progress)}},created(){this.$root.$on("importCSVStarted",(e=>this.uploadId=e)),this.$root.$on("importCSVProgress",this.watchProgress),this.$root.$on("importCSVError",(e=>this.error=e))},methods:{watchProgress(){if(this.uploadId&&!this.finished)return this.$userService.checkImportUsersProgress(this.uploadId).then((e=>{window.setTimeout((()=>this.progress=e),200)})).then((()=>this.$nextTick())).catch((e=>{String(e).indexOf("SyntaxError")<0&&(this.error=e)})).finally((()=>{this.finished||window.setTimeout(this.watchProgress,500)}))}}},f,[],!1,null,null,null).exports;var w=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"usersFilterDrawer",attrs:{id:"usersFilterDrawer",right:""},on:{closed:function(t){e.drawer=!1}}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("UsersManagement.filter"))+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("v-list",[t("v-card",{staticClass:"pa-2",attrs:{flat:""}},[t("v-radio-group",{staticClass:"mt-0",model:{value:e.selectedFiler,callback:function(t){e.selectedFiler=t},expression:"selectedFiler"}},[t("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.lastConnection.connected"),value:"connected"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),t("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.lastConnection.neverConnected"),value:"neverConnected"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),t("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.enrollment.enrolled"),value:"enrolled"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),t("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.enrollment.notEnrolled"),value:"notEnrolled"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),t("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.enrollment.noEnrollmentPossible"),value:"noEnrollmentPossible"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),t("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.type.internal"),value:"internal"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),t("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.type.external"),value:"external"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}})],1)],1)],1)],1),e._v(" "),t("template",{slot:"footer"},[t("div",{staticClass:"d-flex"},[t("v-btn",{staticClass:"ps-0",attrs:{color:"primary",text:""},on:{click:e.resetFilter}},[t("v-icon",{staticClass:"pe-1"},[e._v("mdi-reload")]),e._v("\n        "+e._s(e.$t("UsersManagement.filter.reset"))+"\n      ")],1),e._v(" "),t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"btn me-2",on:{click:e.cancel}},[e._v("\n        "+e._s(e.$t("UsersManagement.button.cancel"))+"\n      ")]),e._v(" "),t("v-btn",{staticClass:"btn btn-primary",on:{click:e.save}},[e._v("\n        "+e._s(e.$t("UsersManagement.button.save"))+"\n      ")])],1)])],2)};w._withStripped=!0;const $={"users-management":i,"users-management-list":n,"users-management-toolbar":l,"users-management-user-form-drawer":m,"users-management-user-membership-drawer":u,"users-management-import-csv-button":p,"users-management-import-csv-result":_,"users-management-import-csv-error-message":v,"users-management-filter-drawer":r({data:()=>({drawer:!1,selectedFiler:null,previouslySelected:null}),watch:{drawer(){this.drawer?this.$refs.usersFilterDrawer.open():this.$refs.usersFilterDrawer.close()}},created(){this.$root.$on("advancedFilter",this.advancedFilter)},methods:{advancedFilter(e){this.selectedFiler=e,this.drawer=!0},cancel(){this.drawer=!1},save(){this.$root.$emit("applyAdvancedFilter",this.selectedFiler),this.$refs.usersFilterDrawer.close()},resetFilter(){this.selectedFiler=null,this.previouslySelected=null},resetOption(e){e===this.previouslySelected&&(this.selectedFiler=null),this.previouslySelected=this.selectedFiler}}},w,[],!1,null,null,null).exports};for(const e in $)Vue.component(e,$[e]);if(extensionRegistry){const e=extensionRegistry.loadComponents("UsersManagement");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}document.dispatchEvent(new CustomEvent("displayTopBarLoading"));const b="UsersManagement",U="undefined"!=typeof eXo?eXo.env.portal.language:"en",y=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.Portlets-${U}.json`;function M(){exoi18n.loadLanguageAsync(U,y).then((e=>{Vue.createApp({mounted(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:`<users-management id="${b}" />`,vuetify:Vue.prototype.vuetifyOptions,i18n:e},`#${b}`,"Users Management")}))}return t})()));