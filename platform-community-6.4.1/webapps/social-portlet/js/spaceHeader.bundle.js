define((()=>(()=>{"use strict";var e={d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>l});var a=function(){var e=this,t=e._self._c;return t("v-app",{class:e._f("''")(e.hasNavigations&&"hasNavigations")},[t("v-card",{staticClass:"mb-6",attrs:{color:"transparent",flat:""}},[t("v-hover",{scopedSlots:e._u([{key:"default",fn:function({hover:a}){return t("v-img",{staticClass:"d-flex",attrs:{"lazy-src":e.bannerUrl||"",src:e.bannerUrl||"","min-height":36,"max-height":e.height,id:"spaceAvatarImg",height:"auto","min-width":"100%",eager:""}},[e.admin?t("div",{directives:[{name:"show",rawName:"v-show",value:a,expression:"hover"}],staticClass:"d-flex flex-grow-1 position-absolute full-height full-width"},[t("v-btn",{directives:[{name:"show",rawName:"v-show",value:a,expression:"hover"}],ref:"bannerInput",staticClass:"changeBannerButton border-color me-2 ms-auto my-auto mt-sm-2 mb-sm-0",attrs:{id:"spaceBannerEditButton",icon:"",outlined:"",dark:""},on:{click:function(t){return e.$refs.imageCropDrawer.open()}}},[t("v-icon",{attrs:{size:"18"}},[e._v("fas fa-file-image")])],1)],1):e._e()])}}])}),e._v(" "),e.admin?t("image-crop-drawer",{ref:"imageCropDrawer",attrs:{"crop-options":e.cropOptions,"max-file-size":e.maxUploadSizeInBytes,src:e.bannerData||e.bannerUrl,"max-image-width":"1280","drawer-title":"UIPopupBannerUploader.title.ChangeBanner"},on:{data:function(t){e.bannerData=t},input:e.uploadBanner}}):e._e(),e._v(" "),e.hasNavigations?t("v-tabs",{staticClass:"mx-auto",attrs:{value:e.selectedNavigationUri,"active-class":"SelectedTab","show-arrows":"","center-active":"","slider-size":"4"},on:{change:function(t){return e.$root.$emit("application-cache")}}},e._l(e.navigations,(function(a){return t("v-tab",{key:a.id,staticClass:"spaceNavigationTab",attrs:{value:a.id,href:a.uri}},[e._v("\n        "+e._s(a.label)+"\n      ")])})),1):e._e()],1)],1)};a._withStripped=!0;var n=function(e,t,a,n,i,r,o,s){var c,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=[],l._compiled=!0),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(e,t){return c.call(t),d(e,t)}}else{var p=l.beforeCreate;l.beforeCreate=p?[].concat(p,c):[c]}return{exports:e,options:l}}({props:{admin:{type:Boolean,default:!1},maxUploadSize:{type:Number,default:()=>2},navigations:{type:Array,default:()=>[]},selectedNavigationUri:{type:String,default:null},bannerUrl:{type:String,default:null}},data:()=>({errorMessage:null,bannerData:null,cropOptions:{aspectRatio:1280/175,viewMode:1}}),computed:{maxUploadSizeInBytes(){return 1024*this.maxUploadSize*1024},height(){let e=this.hasNavigations?143:175;return this.isMobile&&(e-=50),e},hasNavigations(){return this.navigations&&this.navigations.length},isMobile(){return this.$vuetify.breakpoint.xs}},watch:{errorMessage(){this.errorMessage&&this.$root.$emit("alert-message",this.errorMessage,"error")}},created(){document.addEventListener("refreshSpaceNavigations",(()=>{this.$spaceService.getSpaceNavigations(eXo.env.portal.spaceId).then((e=>(e&&e.length&&(e.forEach((e=>{const t=this.navigations.find((t=>t.id===e.id));t?e.uri=t.uri:e.uri&&e.uri.indexOf("/")>=0&&(e.uri=e.uri.split("/")[1])})),this.navigations=e),this.$nextTick()))).then((()=>this.$root.$emit("application-cache")))}))},mounted(){this.$root.$applicationLoaded()},methods:{refresh(){this.bannerUrl=`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/spaces/${eXo.env.portal.spaceName}/banner?updated=${Math.random()}`,this.$nextTick().then((()=>this.$root.$emit("application-cache")))},uploadBanner(e){return this.$spaceService.updateSpace({id:eXo.env.portal.spaceId,bannerId:e}).then((()=>{this.refresh(),this.$root.$emit("alert-message",this.$t("UIPopupBannerUploader.title.BannerUpdated"),"success")})).catch(this.handleError)},handleError(e){e&&(String(e).indexOf(this.$uploadService.bannerExcceedsLimitError)>=0?this.errorMessage=this.$t("spaceHeader.label.bannerExcceededAllowedSize",{0:this.maxUploadSize}):this.errorMessage=String(e))}}},a);const i={"space-header":n.exports};for(const e in i)Vue.component(e,i[e]);if(extensionRegistry){const e=extensionRegistry.loadComponents("SpaceHeader");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}const r="SpaceHeader",o=`${r}_${eXo.env.portal.spaceId}`,s="undefined"!=typeof eXo?eXo.env.portal.language:"en",c=`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.Portlets-${s}.json`;function l(e,t,a,n){document.dispatchEvent(new CustomEvent("displayTopBarLoading")),exoi18n.loadLanguageAsync(s,c).then((i=>{const s=document.createElement("div");s.id=r,Vue.createApp({data:{navigations:e&&e.navigations,selectedNavigationUri:e&&e.selectedNavigationUri,bannerUrl:t},mounted(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:`<space-header v-cacheable="{cacheId: '${o}'}" id="${r}" :navigations="navigations" :selected-navigation-uri="selectedNavigationUri" :banner-url="bannerUrl" :max-upload-size="${a}" :admin="${n}" />`,vuetify:Vue.prototype.vuetifyOptions,i18n:i},s,"Space Header")}))}return t})()));