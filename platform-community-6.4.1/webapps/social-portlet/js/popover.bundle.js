define((()=>(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);var t=function(){var e=this,t=e._self._c;return t("div",[e.isMobile?e._e():t("popover-menu"),e._v(" "),t("notification-alerts"),e._v(" "),t("users-list-drawer")],1)};function i(e,t,i,s,o,n,r,a){var l,p="function"==typeof e?e.options:e;if(t&&(p.render=t,p.staticRenderFns=i,p._compiled=!0),s&&(p.functional=!0),n&&(p._scopeId="data-v-"+n),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},p._ssrRegister=l):o&&(l=a?function(){o.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(p.functional){p._injectStyles=l;var d=p.render;p.render=function(e,t){return l.call(t),d(e,t)}}else{var c=p.beforeCreate;p.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:p}}t._withStripped=!0;const s=i({computed:{isMobile(){return"xs"===this.$vuetify.breakpoint.name||"sm"===this.$vuetify.breakpoint.name}},mounted(){this.$root.$applicationLoaded()}},t,[],!1,null,null,null).exports;var o=function(){var e=this,t=e._self._c;return t("v-menu",{attrs:{rounded:"rounded","close-on-content-click":!1,"position-x":e.offsetX,"position-y":e.offsetY,transition:"slide-x-transition",absolute:"",top:e.top,"content-class":"profile-popover-menu pa-1 transparent",elevation:"0","max-width":"350","min-width":"350"},model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e.isUserIdentity?t("user-popover-content",{attrs:{identity:e.identity}}):e._e(),e._v(" "),e.isSpaceIdentity?t("space-popover-content",{attrs:{space:e.space}}):e._e()],1)};o._withStripped=!0;const n=i({data:()=>({top:!0,menu:!1,element:null,popoverCloseDelay:1e3,popoverOpenDelay:300,menuCloseTimer:null,menuOpenTimer:null,isMenuHovered:!1,isActivatorHovered:!1,offsetX:!1,offsetY:!0,identity:null,space:null,identityType:null}),computed:{isUserIdentity(){return this.identityType&&"User"===this.identityType},isSpaceIdentity(){return this.identityType&&"Space"===this.identityType}},watch:{menu(){this.menu?(this.clearCloseTime(),this.registerActivatorElementEvents(),document.dispatchEvent(new CustomEvent(`${this.identityType}PopoverOpened`))):this.unregisterActivatorElementEvents()}},created(){document.addEventListener("popover-identity-display",(e=>{const t=e?.detail;this.identityType=t.identityType,this.top=t.top,this.isUserIdentity?(this.identity={id:t?.id,enabled:t?.enabled,deleted:t?.deleted,username:t?.username,fullname:t?.fullName,avatar:t?.avatar,position:t?.position,external:t?.external},localStorage.setItem("popover-identity-type","USER_TIPTIP")):this.isSpaceIdentity&&(this.space=t,localStorage.setItem("popover-identity-type","SPACE_TIPTIP")),this.menu&&this.element===t?.element?this.clearCloseTime():(this.unregisterActivatorElementEvents(),this.$nextTick().then((()=>{this.offsetX=t?.offsetX,this.offsetY=t?.offsetY,this.element=t?.element,this.setActivatorHovered(),this.registerActivatorElementEvents(),this.setPopoverNotHovered(),this.openPopover()})))})),document.addEventListener("drawerOpened",(()=>this.closePopover(!0))),document.addEventListener("drawerClosed",(()=>this.closePopover(!0))),document.addEventListener("modalOpened",(()=>this.closePopover(!0))),document.addEventListener("modalClosed",(()=>this.closePopover(!0))),this.$root.$on("popover-hovered",this.setPopoverHovered),this.$root.$on("popover-not-hovered",this.setPopoverNotHovered)},mounted(){$(document).on("click",(e=>{this.menu&&e.target&&!$(e.target).parents("#identity-popover").length&&this.closePopover(!0),this.menu&&$(".profile-popover-menu").css("height","160px")})),document.addEventListener("scroll",this.onScroll,!0)},methods:{onScroll(){this.closePopover(!0)},registerActivatorElementEvents(){this.element&&$(this.element).on("mouseenter",this.setActivatorHovered).on("mouseleave",this.setActivatorNotHovered)},unregisterActivatorElementEvents(){this.element&&($(this.element).off("mouseenter",this.setActivatorHovered).off("mouseleave",this.setActivatorNotHovered),this.setActivatorNotHovered(),this.element=null)},setActivatorHovered(){this.isActivatorHovered=!0},setActivatorNotHovered(){this.isActivatorHovered=!1,this.closePopover()},setPopoverHovered(){this.isMenuHovered=!0},setPopoverNotHovered(){this.isMenuHovered=!1,this.closePopover(!0)},openPopover(e){this.menu||(e?this.menu=!0:this.menuOpenTimer=window.setTimeout((()=>{this.isActivatorHovered&&(this.menu=!0)}),this.popoverOpenDelay))},closePopover(e){this.menu&&(e?(this.menu=!1,localStorage.removeItem("popover-identity-type")):this.menuCloseTimer=window.setTimeout((()=>{this.isMenuHovered||this.isActivatorHovered||(this.menu=!1,localStorage.removeItem("popover-identity-type"))}),this.popoverCloseDelay))},clearCloseTime(){this.menuCloseTimer&&(window.clearTimeout(this.menuCloseTimer),this.menuCloseTimer=null)}}},o,[],!1,null,null,null).exports;var r=function(){var e=this,t=e._self._c;return t("v-card",{staticClass:"pa-2",attrs:{elevation:"2","max-width":"250","min-width":"250",id:"identity-popover"},on:{mouseenter:function(t){return e.$root.$emit("popover-hovered")},mouseleave:function(t){return e.$root.$emit("popover-not-hovered")}}},[t("v-list-item",{staticClass:"px-0"},[t("v-list-item-content",{staticClass:"py-0"},[t("v-list-item-title",[t("exo-user-avatar",{attrs:{identity:e.identity,size:46,popover:!1,"bold-title":"","link-style":""}},[e.position?t("template",{slot:"subTitle"},[t("span",{staticClass:"caption text-bold"},[e._v("\n              "+e._s(e.position)+"\n            ")])]):e._e()],2)],1)],1)],1),e._v(" "),e.isCurrentUser?e._e():t("div",{staticClass:"d-flex justify-end"},[t("extension-registry-components",{staticClass:"d-flex",attrs:{params:e.params,name:"UserPopover",type:"user-popover-action","parent-element":"div",element:"div","element-class":"mx-auto ma-lg-0"}}),e._v(" "),e._l(e.enabledExtensionComponents,(function(e){return t("div",{key:e.key,ref:e.key,refInFor:!0,class:`${e.appClass} ${e.typeClass}`})}))],2)],1)};r._withStripped=!0;const a=i({props:{identity:{type:Object,default:null}},data:()=>({externalExtensions:[]}),computed:{params(){return{identityType:"USER_TIPTIP",identityId:this.identity&&this.identity.username,identityEnabled:this.identity&&this.identity.enabled,identityDeleted:this.identity&&this.identity.deleted}},enabledExtensionComponents(){return this.externalExtensions.filter((e=>e.enabled))},username(){return this.identity?.username},position(){return this.identity?.position},isCurrentUser(){return eXo.env.portal.userName===this.username}},watch:{username:{immediate:!0,handler(e,t){e!==t&&this.refreshExtensions()}}},methods:{refreshExtensions(){this.externalExtensions=[],this.$nextTick((()=>{this.externalExtensions=extensionRegistry.loadExtensions("user-profile-popover","action")||[],this.$nextTick().then((()=>this.externalExtensions.forEach(this.initExtensionAction)))})),$(".profile-popover-menu").css("height","auto")},initExtensionAction(e){if(e.enabled){let t=this.$refs[e.key];if(t?.length){if(t[0]?.childNodes?.length)for(;t[0].firstChild;)t[0].firstChild.remove();t=t[0],e.init(t,this.username)}}}}},r,[],!1,null,null,null).exports;var l=function(){var e=this,t=e._self._c;return t("v-card",{staticClass:"pa-2",attrs:{elevation:"2","max-width":"250","min-width":"250",id:"identity-popover"},on:{mouseenter:function(t){return e.$root.$emit("popover-hovered")},mouseleave:function(t){return e.$root.$emit("popover-not-hovered")}}},[t("v-list-item",{staticClass:"px-2"},[t("v-list-item-content",{staticClass:"py-0"},[t("v-list-item-title",[t("exo-space-avatar",{attrs:{space:e.space,size:45,"bold-title":"","link-style":"","subtitle-new-line":""}},[t("template",{slot:"subTitle"},[e.spaceMembersCount?t("span",{staticClass:"caption text-bold"},[e._v("\n              "+e._s(e.spaceMembersCount)+" "+e._s(e.$t("UIActivity.label.Members"))+"\n            ")]):e._e()])],2)],1),e._v(" "),e.spaceDescription?t("p",{staticClass:"text-truncate-2 text-caption text--primary font-weight-medium"},[e._v("\n        "+e._s(e.spaceDescription)+"\n      ")]):e._e()],1)],1),e._v(" "),t("div",{staticClass:"d-flex justify-end"},[e.favoriteActionEnabled?t("exo-space-favorite-action",{key:e.space.id,attrs:{"is-favorite":e.space.isFavorite,"space-id":e.space.id}}):e._e(),e._v(" "),t("extension-registry-components",{staticClass:"d-flex",attrs:{params:e.params,name:"SpacePopover",type:"space-popover-action","parent-element":"div",element:"div","element-class":"mx-auto ma-lg-0"}}),e._v(" "),e._l(e.enabledExtensionComponents,(function(e){return t("div",{key:e.key,ref:e.key,refInFor:!0,class:`${e.appClass} ${e.typeClass}`})}))],2)],1)};l._withStripped=!0;const p=i({props:{space:{type:Object,default:null}},data:()=>({externalExtensions:[]}),computed:{enabledExtensionComponents(){return this.externalExtensions.filter((e=>e.enabled))},spaceId(){return this.space?.id},spaceMembersCount(){return this.space?.membersCount},spaceDescription(){return this.space?.description},params(){return{identityType:"space",identityId:this.spaceId}},favoriteActionEnabled(){return this.space?.isMember}},watch:{spaceId:{immediate:!0,handler(e,t){e!==t&&this.refreshExtensions()}}},methods:{refreshExtensions(){this.externalExtensions=[],this.$nextTick((()=>{this.externalExtensions=extensionRegistry.loadExtensions("space-popup","space-popup-action")||[],this.$nextTick().then((()=>this.externalExtensions.forEach(this.initExtensionAction)))})),$(".profile-popover-menu").css("height","auto")},initExtensionAction(e){if(e.enabled){let t=this.$refs[e.key];t&&t.length>0?(t=t[0],e.init(t,this.space.prettyName)):console.error(`Error initialization of the ${e.key} action component: empty container`)}}}},l,[],!1,null,null,null).exports;var d=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"managersDrawer",attrs:{right:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("spacesList.title.managers"))+"\n  ")]),e._v(" "),e.displaySpaceHosts?t("template",{slot:"content"},[t("v-layout",{staticClass:"ma-3",attrs:{column:""}},e._l(e.displaySpaceHosts,(function(e){return t("exo-user-avatar",{key:e.id,attrs:{identity:e,"extra-class":"my-2",popover:""}})})),1)],1):e._e()],2)};d._withStripped=!0;const c=i({data:()=>({displaySpaceHosts:null}),mounted(){document.addEventListener("display-users-list-drawer",(e=>{e&&e.detail&&(this.displaySpaceHosts=e.detail,this.$refs.managersDrawer.open())}))}},d,[],!1,null,null,null).exports;var u=function(){var e=this,t=e._self._c;return t("v-snackbar",{staticClass:"z-index-modal",attrs:{left:!e.$vuetify.rtl,right:e.$vuetify.rtl,color:"transparent",elevation:"0",app:""},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[t("exo-notification-alert",{attrs:{alert:e.alert,"no-timeout":""},on:{dismissed:e.clear}})],1)};u._withStripped=!0;const v=i({data:()=>({snackbar:!1,alert:null}),watch:{alert(){this.snackbar=!this.alert,this.$nextTick().then((()=>this.snackbar=!!this.alert))}},created(){document.addEventListener("notification-alert",(e=>this.alert=e?.detail))},methods:{clear(){this.alert=null}}},u,[],!1,null,null,null).exports;var m=function(){var e=this;return(0,e._self._c)("favorite-button",{attrs:{id:e.spaceId,"space-id":e.spaceId,favorite:e.favorite,absolute:e.absolute,top:e.top,right:e.right,small:!1,type:"space","type-label":"space","entity-type":e.entityType,"display-label":e.displayLabel,"extra-class":e.extraClass},on:{removed:e.removed,"remove-error":e.removeError,added:e.added,"add-error":e.addError}})};m._withStripped=!0;const h=i({props:{spaceId:{type:String,default:""},isFavorite:{type:Boolean,default:!1},entityType:{type:String,default:null},absolute:{type:Boolean,default:!1},top:{type:Number,default:()=>0},right:{type:Number,default:()=>0},displayLabel:{type:Boolean,default:!1},extraClass:{type:String,default:()=>""}},data:()=>({favorite:!1}),created(){this.favorite="true"===this.isFavorite},methods:{removed(){this.displayAlert(this.$t("Favorite.tooltip.SuccessfullyDeletedFavorite",{0:this.$t("spaceList.alert.label")})),this.$emit("removed"),document.dispatchEvent(new CustomEvent("space-favorite-removed",{detail:this.spaceId}))},removeError(){this.displayAlert(this.$t("Favorite.tooltip.ErrorDeletingFavorite",{0:this.$t("spaceList.alert.label")}),"error")},added(){this.displayAlert(this.$t("Favorite.tooltip.SuccessfullyAddedAsFavorite",{0:this.$t("spaceList.alert.label")})),this.$emit("added"),document.dispatchEvent(new CustomEvent("space-favorite-added",{detail:this.spaceId}))},addError(){this.displayAlert(this.$t("Favorite.tooltip.ErrorAddingAsFavorite",{0:this.$t("spaceList.alert.label")}),"error")},displayAlert(e,t){document.dispatchEvent(new CustomEvent("notification-alert",{detail:{message:e,type:t||"success"}}))}}},m,[],!1,null,null,null).exports,y={popover:s,"popover-menu":n,"user-popover-content":a,"space-popover-content":p,"notification-alerts":v,"users-list-drawer":c};y["exo-space-favorite-action"]=h;for(const e in y)Vue.component(e,y[e]);const f="undefined"!=typeof eXo?eXo.env.portal.language:"en",x=[`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.Portlets-${f}.json`,`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.commons.Commons-${f}.json`,`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.social.UserPopup-${f}.json`];Vue.directive("identity-popover",((e,t)=>{const i=t?.value,s=i?.username;s||(document.addEventListener("space-favorite-added",(e=>{const t=e?.detail;t===i.id&&(i.isFavorite="true")})),document.addEventListener("space-favorite-removed",(e=>{const t=e?.detail;t===i.id&&(i.isFavorite="false")}))),e.addEventListener("mouseover",(()=>{const t=e.getBoundingClientRect();document.dispatchEvent(new CustomEvent("popover-identity-display",{detail:Object.assign({offsetX:t.left+window.scrollX,offsetY:t.top>150+t.height?t.top:t.bottom+window.scrollY,top:t.top>150+t.height,identityType:s?"User":"Space",element:e},i||{})}))}))}));const E=document.createElement("div");return E.setAttribute("id","Popovers"),document.querySelector("#vuetify-apps").append(E),exoi18n.loadLanguageAsync(f,x).then((e=>{Vue.createApp({template:'<popover id="Popovers" />',i18n:e,vuetify:Vue.prototype.vuetifyOptions},"#Popovers","identity Popover")})),e})()));