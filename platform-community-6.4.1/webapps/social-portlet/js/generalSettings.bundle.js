define((()=>(()=>{"use strict";var t={d:(e,a)=>{for(var i in a)t.o(a,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:a[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{init:()=>C});var a=function(){var t=this,e=t._self._c;return e("v-app",[e("v-main",[e("v-card",{staticClass:"px-4 py-6 mb-12 mb-sm-0",attrs:{color:"white",flat:""}},[e("h3",{staticClass:"font-weight-bold"},[t._v(t._s(t.$t("generalSettings.title")))]),t._v(" "),e("portal-general-settings-branding-site",{ref:"brandingSettings",attrs:{branding:t.branding},on:{"validity-check":function(e){t.validBranding=e},changed:function(e){t.changed=e}}}),t._v(" "),e("portal-general-settings-branding-login",{ref:"loginSettings",attrs:{branding:t.branding},on:{"validity-check":function(e){t.validLogin=e},changed:function(e){t.changed=e}}}),t._v(" "),e("div",{staticClass:"d-flex mt-12 justify-end"},[e("v-btn",{staticClass:"btn btn-primary register-button",attrs:{"aria-label":t.$t("generalSettings.apply"),disabled:!t.validForm,loading:t.loading,color:"primary",elevation:"0"},on:{click:t.save}},[e("span",{staticClass:"text-capitalize"},[t._v("\n            "+t._s(t.$t("generalSettings.apply"))+"\n          ")])])],1)],1)],1)],1)};function i(t,e,a,i,n,o,r,l){var s,g="function"==typeof t?t.options:t;if(e&&(g.render=e,g.staticRenderFns=a,g._compiled=!0),i&&(g.functional=!0),o&&(g._scopeId="data-v-"+o),r?(s=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},g._ssrRegister=s):n&&(s=l?function(){n.call(this,(g.functional?this.parent:this).$root.$options.shadowRoot)}:n),s)if(g.functional){g._injectStyles=s;var c=g.render;g.render=function(t,e){return s.call(e),c(t,e)}}else{var d=g.beforeCreate;g.beforeCreate=d?[].concat(d,s):[s]}return{exports:t,options:g}}a._withStripped=!0;const n=i({data:()=>({branding:null,errorMessage:null,loading:!1,changed:!1,validBranding:!1,validLogin:!1}),computed:{validForm(){return this.changed&&this.validBranding}},watch:{errorMessage(){this.errorMessage?this.$root.$emit("alert-message",this.$t(this.errorMessage),"error"):this.$root.$emit("close-alert-message")},loading(){this.loading?document.dispatchEvent(new CustomEvent("displayTopBarLoading")):document.dispatchEvent(new CustomEvent("hideTopBarLoading"))}},mounted(){this.init().finally((()=>this.$root.$applicationLoaded()))},methods:{init(){return this.loading=!0,this.$brandingService.getBrandingInformation().then((t=>this.branding=t)).then((()=>this.$nextTick())).then((()=>this.$refs.brandingSettings.init())).then((()=>this.$refs.loginSettings.init())).then((()=>this.$nextTick())).finally((()=>this.loading=!1))},save(){this.errorMessage=null;const t=Object.assign({},this.branding);return this.$refs.brandingSettings.preSave(t),this.$refs.loginSettings.preSave(t),this.loading=!0,this.$brandingService.updateBrandingInformation(t).then((()=>this.init())).then((()=>this.$root.$emit("alert-message",this.$t("generalSettings.savedSuccessfully"),"success"))).catch((t=>this.errorMessage=String(t))).finally((()=>this.loading=!1))}}},a,[],!1,null,null,null).exports;var o=function(){var t=this,e=t._self._c;return e("v-row",{staticClass:"ma-0"},[e("v-col",{staticClass:"pa-0",attrs:{cols:"12"}},[e("h4",{staticClass:"font-weight-bold mb-0 mt-8"},[t._v("\n      "+t._s(t.$t("generalSettings.displayCharacteristics"))+"\n    ")])]),t._v(" "),e("v-col",{staticClass:"pa-0",attrs:{cols:"12",lg:"6"}},[e("h4",{staticClass:"mb-0 mt-4"},[t._v("\n      "+t._s(t.$t("generalSettings.companyNameTitle"))+"\n    ")]),t._v(" "),e("h6",{staticClass:"text-subtitle grey--text me-2"},[t._v("\n      "+t._s(t.$t("generalSettings.companyNameSubtitle"))+"\n    ")]),t._v(" "),e("v-card",{staticClass:"me-2",attrs:{"max-width":"350px",flat:""}},[e("v-text-field",{staticClass:"setup-company-name border-box-sizing pt-0",attrs:{id:"companyName",placeholder:t.$t("generalSettings.companyNamePlaceholder"),name:"companyName",type:"text",autofocus:"autofocus","aria-required":"true",required:"required",outlined:"",dense:""},model:{value:t.companyName,callback:function(e){t.companyName=e},expression:"companyName"}})],1)],1),t._v(" "),e("v-col",{staticClass:"pa-0",attrs:{cols:"12",lg:"6"}},[e("h4",{staticClass:"mb-0 mt-4"},[t._v("\n      "+t._s(t.$t("generalSettings.companyLogoTitle"))+"\n    ")]),t._v(" "),e("h6",{staticClass:"text-subtitle grey--text me-2"},[t._v("\n      "+t._s(t.$t("generalSettings.companyLogoSubtitle"))+"\n    ")]),t._v(" "),e("portal-general-settings-company-logo",{ref:"companyLogo",staticClass:"mt-n2",attrs:{branding:t.branding},model:{value:t.logoUploadId,callback:function(e){t.logoUploadId=e},expression:"logoUploadId"}})],1),t._v(" "),e("v-col",{staticClass:"pa-0",attrs:{cols:"12",lg:"6"}},[e("h4",{staticClass:"mb-0 mt-4"},[t._v("\n      "+t._s(t.$t("generalSettings.themeColorsTitle"))+"\n    ")]),t._v(" "),e("h6",{staticClass:"text-subtitle grey--text me-2"},[t._v("\n      "+t._s(t.$t("generalSettings.themeColorsSubtitle"))+"\n    ")]),t._v(" "),e("div",{staticClass:"d-flex flex-wrap mt-n2"},[e("div",[e("portal-general-settings-color-picker",{attrs:{label:t.$t("generalSettings.primaryColor.label")},model:{value:t.primaryColor,callback:function(e){t.primaryColor=e},expression:"primaryColor"}})],1),t._v(" "),e("div",[e("portal-general-settings-color-picker",{attrs:{label:t.$t("generalSettings.secondaryColor.label")},model:{value:t.secondaryColor,callback:function(e){t.secondaryColor=e},expression:"secondaryColor"}})],1),t._v(" "),e("div",[e("portal-general-settings-color-picker",{attrs:{label:t.$t("generalSettings.tertiaryColor.label")},model:{value:t.tertiaryColor,callback:function(e){t.tertiaryColor=e},expression:"tertiaryColor"}})],1)])]),t._v(" "),e("v-col",{staticClass:"pa-0",attrs:{cols:"12",lg:"6"}},[e("h4",{staticClass:"mb-0 mt-4"},[t._v("\n      "+t._s(t.$t("generalSettings.companyFaviconTitle"))+"\n    ")]),t._v(" "),e("h6",{staticClass:"text-subtitle grey--text me-2 mb-3"},[t._v("\n      "+t._s(t.$t("generalSettings.companyFaviconSubtitle"))+"\n    ")]),t._v(" "),e("portal-general-settings-company-favicon",{ref:"companyFavicon",attrs:{branding:t.branding},model:{value:t.faviconUploadId,callback:function(e){t.faviconUploadId=e},expression:"faviconUploadId"}})],1)],1)};o._withStripped=!0;const r=i({props:{branding:{type:Object,default:null}},data:()=>({companyName:null,primaryColor:null,secondaryColor:null,tertiaryColor:null,errorMessage:null,logoUploadId:null,faviconUploadId:null}),computed:{defaultCompanyName(){return this.branding?.companyName},defaultPrimaryColor(){return this.branding?.themeColors?.primaryColor},defaultSecondaryColor(){return this.branding?.themeColors?.secondaryColor},defaultTertiaryColor(){return this.branding?.themeColors?.tertiaryColor},isValidForm(){return this.companyName?.length&&this.primaryColor?.length&&this.secondaryColor?.length&&this.tertiaryColor?.length},changed(){if(!this.branding)return!1;if(this.logoUploadId||this.faviconUploadId)return!0;const t=JSON.parse(JSON.stringify(this.branding)),e=Object.assign(JSON.parse(JSON.stringify(this.branding)),{companyName:this.companyName});return e.themeColors.primaryColor=this.primaryColor,e.themeColors.secondaryColor=this.secondaryColor,e.themeColors.tertiaryColor=this.tertiaryColor,JSON.stringify(t)!==JSON.stringify(e)}},watch:{isValidForm(){this.$emit("validity-check",this.isValidForm)},changed(){this.$emit("changed",this.changed)},errorMessage(){this.errorMessage?this.$root.$emit("alert-message",this.$t(this.errorMessage),"error"):this.$root.$emit("close-alert-message")}},methods:{init(){this.$refs.companyLogo?.resetLogo(),this.$refs.companyFavicon?.resetFavicon(),this.companyName=this.defaultCompanyName,this.primaryColor=this.defaultPrimaryColor,this.secondaryColor=this.defaultSecondaryColor,this.tertiaryColor=this.defaultTertiaryColor,this.logoUploadId=null,this.faviconUploadId=null,this.errorMessage=null},preSave(t){Object.assign(t,{companyName:this.companyName,themeColors:{primaryColor:this.primaryColor,secondaryColor:this.secondaryColor,tertiaryColor:this.tertiaryColor},logo:{uploadId:this.logoUploadId},favicon:{uploadId:this.faviconUploadId}})}}},o,[],!1,null,null,null).exports;var l=function(){var t=this,e=t._self._c;return e("v-row",{staticClass:"ma-0"},[e("v-col",{staticClass:"pa-0",attrs:{cols:"12"}},[e("h4",{staticClass:"font-weight-bold mb-4 mt-8"},[t._v("\n      "+t._s(t.$t("generalSettings.loginCharacteristics"))+"\n    ")])]),t._v(" "),e("v-col",{staticClass:"pa-0",attrs:{cols:"12"}},[e("div",{staticClass:"d-flex flex-wrap-reverse"},[e("v-card",{staticClass:"position-relative mx-auto me-md-4 ms-md-0 mb-4",attrs:{color:"transparent","min-width":t.hasImage?"auto":t.width,width:t.hasImage?"auto":t.width,"min-height":t.height,height:t.height,flat:"",tile:""}},[t.hasImage&&t.loginBackgroundUploadId?e("v-btn",{staticClass:"position-absolute r-3 mt-2 z-index-two white",attrs:{title:t.$t("generalSettings.loginBackgroundCancelImageChoice"),loading:t.deleting,color:"primary",icon:"",border:"",outlined:""},on:{click:t.deleteBackground}},[e("v-icon",{attrs:{size:"18"}},[t._v("fas fa-undo")])],1):t.canDeleteDefaultBackground?e("v-btn",{staticClass:"position-absolute r-3 mt-2 z-index-two white",attrs:{title:t.$t("generalSettings.loginBackgroundRestoreDefaultBackground"),loading:t.deleting,color:"error",icon:"",border:"",outlined:""},on:{click:t.deleteDefaultBackground}},[e("v-icon",{attrs:{size:"22"}},[t._v("fas fa-trash")])],1):t._e(),t._v(" "),t.hasImage?e("img",{staticStyle:{height:"100%"},attrs:{src:t.loginBackgroundSrc,alt:"",lazy:""}}):t._e(),t._v(" "),e("v-card",{staticClass:"fill-height width-min-content flex-shrink-1 transparent",class:t.hasImage&&"position-absolute t-0",attrs:{"min-width":"100%",height:"100%",tile:"",flat:""}},[e("nav",{staticClass:"fill-height flex-grow-1"},[e("portal-login-introduction",{attrs:{color:t.hasImage?"transparent":"primary"},scopedSlots:t._u([{key:"title",fn:function(){return[e("span",{staticClass:"subtitle-3",style:t.hasImage&&`color: ${t.loginBackgroundTextColor};`},[t._v(t._s(t.$t(t.title)))])]},proxy:!0},{key:"subtitle",fn:function(){return[e("span",{staticClass:"subtitle-1",style:t.hasImage&&`color: ${t.loginBackgroundTextColor};`},[t._v(t._s(t.$t(t.subtitle)))])]},proxy:!0}])})],1)])],1),t._v(" "),e("v-card",{staticClass:"flex-grow-1 flex-shrink-0",attrs:{flat:""}},[e("h4",{staticClass:"my-0"},[t._v("\n          "+t._s(t.$t("generalSettings.loginTitle.title"))+"\n        ")]),t._v(" "),e("h6",{staticClass:"text-subtitle grey--text me-2"},[t._v("\n          "+t._s(t.$t("generalSettings.loginTitle.subtitle"))+"\n        ")]),t._v(" "),e("v-card",{attrs:{"max-width":"350px",flat:""}},[e("translation-text-field",{attrs:{id:"loginTitle",placeholder:t.$t("generalSettings.loginTitle.placeholder"),"default-language":t.defaultLanguage,"supported-languages":t.supportedLanguages,"drawer-title":"generalSettings.translateTitle"},model:{value:t.loginTitle,callback:function(e){t.loginTitle=e},expression:"loginTitle"}})],1),t._v(" "),e("h4",{staticClass:"mb-0 mt-4"},[t._v("\n          "+t._s(t.$t("generalSettings.loginSubtitle.title"))+"\n        ")]),t._v(" "),e("h6",{staticClass:"text-subtitle grey--text me-2"},[t._v("\n          "+t._s(t.$t("generalSettings.loginSubtitle.subtitle"))+"\n        ")]),t._v(" "),e("v-card",{attrs:{"max-width":"350px",flat:""}},[e("translation-text-field",{attrs:{id:"loginSubtitle",placeholder:t.$t("generalSettings.loginSubtitle.placeholder"),"default-language":t.defaultLanguage,"supported-languages":t.supportedLanguages,"drawer-title":"generalSettings.translateSubtitle"},model:{value:t.loginSubtitle,callback:function(e){t.loginSubtitle=e},expression:"loginSubtitle"}})],1),t._v(" "),e("h4",{staticClass:"mb-0 mt-4"},[t._v("\n          "+t._s(t.$t("generalSettings.loginBackground.title"))+"\n        ")]),t._v(" "),e("h6",{staticClass:"text-subtitle grey--text me-2"},[t._v("\n          "+t._s(t.$t("generalSettings.loginBackground.subtitle"))+"\n        ")]),t._v(" "),e("portal-general-settings-login-background-selector",{ref:"loginBackground",attrs:{"default-data":t.defaultLoginBackgroundSrc,"aspect-ratio":t.aspectRatio},on:{"data-updated":t.updateLoginBackgroundData,"text-color-updated":function(e){t.loginBackgroundTextColor=e}},model:{value:t.loginBackgroundUploadId,callback:function(e){t.loginBackgroundUploadId=e},expression:"loginBackgroundUploadId"}})],1)],1)])],1)};l._withStripped=!0;const s=i({props:{branding:{type:Object,default:null}},data:()=>({loginTitle:{},loginSubtitle:{},loginBackgroundUploadId:null,loginBackgroundData:null,loginBackgroundTextColor:null,errorMessage:null,aspectRatio:16/9/2.5,height:400,deleting:!1,refreshImageIndex:Date.now()}),computed:{isDefaultBackgroundDeleted(){return"0"===this.loginBackgroundUploadId},hasCustomBackground(){return this.loginBackgroundUploadId&&!this.isDefaultBackgroundDeleted},hasDefaultBackground(){return this.branding?.loginBackground?.size&&!this.isDefaultBackgroundDeleted},hasImage(){return this.hasCustomBackground||this.hasDefaultBackground},width(){return this.height*this.aspectRatio},defaultLanguage(){return this.branding?.defaultLanguage},supportedLanguages(){return this.branding?.supportedLanguages},defaultLoginTitle(){return this.branding?.loginTitle||{}},defaultLoginSubtitle(){return this.branding?.loginSubtitle||{}},defaultLoginBackgroundSrc(){return this.hasDefaultBackground&&`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/platform/branding/loginBackground?v=${this.refreshImageIndex}`||null},canDeleteDefaultBackground(){return this.branding?.loginBackground?.fileId&&!this.isDefaultBackgroundDeleted},loginBackgroundSrc(){return this.hasCustomBackground?this.$utils.convertImageDataAsSrc(this.loginBackgroundData):this.hasDefaultBackground?this.defaultLoginBackgroundSrc:null},title(){return this.loginTitle[this.defaultLanguage]},subtitle(){return this.loginSubtitle[this.defaultLanguage]},isValidForm(){return this.changed},changed(){if(!this.branding)return!1;if(this.loginBackgroundUploadId)return!0;if(this.loginBackgroundData&&this.loginBackgroundTextColor!==this.branding?.loginBackgroundTextColor)return!0;const t=JSON.parse(JSON.stringify(this.branding)),e=Object.assign(JSON.parse(JSON.stringify(this.branding)),{loginTitle:this.loginTitle,loginSubtitle:this.loginSubtitle});return JSON.stringify(t)!==JSON.stringify(e)}},watch:{isValidForm(){this.$emit("validity-check",this.isValidForm)},changed(){this.$emit("changed",this.changed)},errorMessage(){this.errorMessage?this.$root.$emit("alert-message",this.$t(this.errorMessage),"error"):this.$root.$emit("close-alert-message")}},methods:{init(){this.loginBackgroundUploadId=null,this.refreshImageIndex=Date.now(),this.loginTitle=this.defaultLoginTitle&&JSON.parse(JSON.stringify(this.defaultLoginTitle))||{},this.loginSubtitle=this.defaultLoginSubtitle&&JSON.parse(JSON.stringify(this.defaultLoginSubtitle))||{},this.loginBackgroundTextColor=this.branding?.loginBackgroundTextColor,this.loginBackgroundData=this.defaultLoginBackgroundSrc,this.$refs.loginBackground.init(this.loginBackgroundData,this.loginBackgroundTextColor)},preSave(t){this.$refs.loginBackground.preSave(t),t.loginTitle=this.loginTitle,t.loginSubtitle=this.loginSubtitle},deleteDefaultBackground(){this.deleting=!0,window.setTimeout((()=>{this.loginBackgroundData=null,this.loginBackgroundUploadId="0",this.loginBackgroundTextColor=null,this.$refs.loginBackground.init(this.loginBackgroundData,this.loginBackgroundTextColor,this.loginBackgroundUploadId),this.$nextTick((()=>this.deleting=!1))}),50)},deleteBackground(){this.deleting=!0,window.setTimeout((()=>{this.loginBackgroundData=this.defaultLoginBackgroundSrc,this.loginBackgroundUploadId=null,this.$refs.loginBackground.init(this.loginBackgroundData,this.loginBackgroundTextColor),this.$nextTick((()=>this.deleting=!1))}),50)},updateLoginBackgroundData(t){t?this.loginBackgroundData=t:"0"!==this.loginBackgroundUploadId&&(this.loginBackgroundData=this.defaultLoginBackgroundSrc)}}},l,[],!1,null,null,null).exports;var g=function(){var t=this,e=t._self._c;return e("v-dialog",{ref:"dialog",attrs:{color:"white",width:"290px"},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e("v-list-item",{staticClass:"px-0",attrs:{"two-line":"",dense:""}},[e("v-list-item-action",{staticClass:"me-2"},[e("v-card",t._g({attrs:{color:t.value,height:"50px",width:"50px"}},a))],1),t._v(" "),e("v-list-item-content",[e("v-list-item-title",[t._v("\n          "+t._s(t.label)+" "+t._s(t.$t("generalSettings.color.label"))+"\n        ")]),t._v(" "),e("v-spacer",{staticClass:"my-1"}),t._v(" "),e("v-list-item-subtitle",{staticClass:"grey--text"},[t._v("\n          "+t._s(t.value)+"\n        ")])],1)],1)]}}]),model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[t._v(" "),e("v-color-picker",{attrs:{swatches:t.swatches,mode:"hexa","show-swatches":""},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}}),t._v(" "),e("v-row",{staticClass:"mx-0 white"},[e("v-col",{staticClass:"center"},[e("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.cancel}},[t._v("\n        "+t._s(t.$t("generalSettings.cancel"))+"\n      ")])],1),t._v(" "),e("v-col",{staticClass:"center"},[e("v-btn",{attrs:{text:"",color:"primary"},on:{click:t.save}},[t._v("\n        "+t._s(t.$t("generalSettings.ok"))+"\n      ")])],1)],1)],1)};g._withStripped=!0;const c=i({props:{label:{type:String,default:null},value:{type:String,default:null}},data:()=>({modal:!1,color:null,originalValue:null,swatches:[["#FF0000","#319ab3","#f97575"],["#98cc81","#4273c8","#cea6ac"],["#bc99e7","#9ee4f5","#774ea9"],["#ffa500","#bed67e","#0E100F"],["#ffaacc","#0000AA","#000055"]]}),watch:{modal(){this.modal&&(this.originalValue=this.value)},value(){this.color=this.value}},created(){this.color=this.value},methods:{cancel(){this.$emit("input",this.originalValue),this.modal=!1},save(){this.$emit("input",this.color),this.modal=!1}}},g,[],!1,null,null,null).exports;var d=function(){var t=this,e=t._self._c;return e("v-hover",{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return e("v-img",{attrs:{src:t.logoPreviewSrc,role:"presentation",transition:"none",width:"150","min-height":"70","max-height":"70",contain:"",eager:""}},[e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:a,expression:"hover"}],staticClass:"justify-center light-grey-background absolute-full-size"},[a&&!t.isDefaultSrc?e("v-btn",{staticClass:"absolute-all-center z-index-two white error",attrs:{color:"error",icon:"",border:"",outlined:""},on:{click:t.resetLogo}},[e("v-icon",[t._v("fas fa-trash")])],1):t._e(),t._v(" "),t.resetInput?t._e():e("v-file-input",{directives:[{name:"show",rawName:"v-show",value:t.isDefaultSrc,expression:"isDefaultSrc"}],ref:"logoFileInput",staticClass:"file-selector",attrs:{id:"logoFileInput",loading:t.sendingImage,"prepend-icon":"fas fa-camera z-index-two rounded-circle primary-border-color primary--text white py-1 absolute-all-center",accept:"image/*",rounded:"",clearable:""},on:{change:t.uploadFile}})],1)])],1)}}])})};d._withStripped=!0;const u=i({props:{value:{type:String,default:()=>null},branding:{type:Object,default:null}},data:()=>({sendingImage:!1,logoSrc:null,uploadInProgress:!1,uploadProgress:0,maxFileSize:2097152,resetInput:!1}),computed:{isDefaultSrc(){return!this.logoSrc},logoPreviewSrc(){return this.logoSrc?this.$utils.convertImageDataAsSrc(this.logoSrc):`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/platform/branding/logo?v=${Math.random()}`}},watch:{sendingImage(){this.sendingImage?document.dispatchEvent(new CustomEvent("displayTopBarLoading")):document.dispatchEvent(new CustomEvent("hideTopBarLoading"))}},methods:{resetLogo(){this.logoSrc=null,this.$emit("input",null),this.sendingImage=!1,this.$refs.logoFileInput&&(this.resetInput=!0,this.$nextTick().then((()=>this.resetInput=!1)))},uploadFile(t){if(this.$root.$emit("close-alert-message"),t&&t.size){if(t.type&&0!==t.type.indexOf("image/"))return void this.$root.$emit("alert-message",this.$t("generalSettings.mustImage.label"),"error");if(t.size>this.maxFileSize)return void this.$root.$emit("alert-message",this.$t("generalSettings.logo.tooBigFile.label"),"error");this.sendingImage=!0;const e=this;return this.$uploadService.upload(t).then((a=>{if(a){const i=new FileReader;i.onload=t=>{e.logoSrc=t.target.result,e.$forceUpdate()},i.readAsDataURL(t),this.$emit("input",a)}else this.$root.$emit("alert-message",this.$t("generalSettings.uploadingError"),"error")})).catch((t=>this.$root.$emit("alert-message",this.$t(String(t)),"error"))).finally((()=>this.sendingImage=!1))}}}},d,[],!1,null,null,null).exports;var h=function(){var t=this,e=t._self._c;return e("v-hover",{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return e("v-img",{attrs:{src:t.faviconPreviewSrc,role:"presentation",transition:"none",width:"50","min-height":"50","max-height":"50",contain:"",eager:""}},[e("v-expand-transition",[e("div",{directives:[{name:"show",rawName:"v-show",value:a,expression:"hover"}],staticClass:"justify-center light-grey-background absolute-full-size"},[a&&!t.isDefaultSrc?e("v-btn",{staticClass:"absolute-all-center z-index-two white error",attrs:{color:"error",icon:"",border:"",outlined:""},on:{click:t.resetFavicon}},[e("v-icon",[t._v("fas fa-trash")])],1):t._e(),t._v(" "),t.resetInput?t._e():e("v-file-input",{directives:[{name:"show",rawName:"v-show",value:t.isDefaultSrc,expression:"isDefaultSrc"}],ref:"faviconFileInput",staticClass:"file-selector",attrs:{id:"faviconFileInput",loading:t.sendingImage,"prepend-icon":"fas fa-camera z-index-two rounded-circle primary-border-color primary--text white py-1 absolute-all-center",accept:"image/*",rounded:"",clearable:""},on:{change:t.uploadFile}})],1)])],1)}}])})};h._withStripped=!0;const p=i({props:{value:{type:String,default:()=>null},branding:{type:Object,default:null}},data:()=>({sendingImage:!1,faviconSrc:null,uploadInProgress:!1,uploadProgress:0,maxFileSize:10240,resetInput:!1}),computed:{isDefaultSrc(){return!this.faviconSrc},faviconPreviewSrc(){return this.faviconSrc?this.$utils.convertImageDataAsSrc(this.faviconSrc):`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/platform/branding/favicon?v=${Math.random()}`}},watch:{sendingImage(){this.sendingImage?document.dispatchEvent(new CustomEvent("displayTopBarLoading")):document.dispatchEvent(new CustomEvent("hideTopBarLoading"))}},methods:{resetFavicon(){this.faviconSrc=null,this.$emit("input",null),this.sendingImage=!1,this.$refs.faviconFileInput&&(this.resetInput=!0,this.$nextTick().then((()=>this.resetInput=!1)))},uploadFile(t){if(this.$root.$emit("close-alert-message"),t&&t.size){if(t.type&&0!==t.type.indexOf("image/"))return void this.$root.$emit("alert-message",this.$t("generalSettings.mustImage.label"),"error");if(t.size>this.maxFileSize)return void this.$root.$emit("alert-message",this.$t("generalSettings.favicon.tooBigFile.label"),"error");this.sendingImage=!0;const e=this;return this.$uploadService.upload(t).then((a=>{if(a){const i=new FileReader;i.onload=t=>{e.faviconSrc=t.target.result,e.$forceUpdate()},i.readAsDataURL(t),this.$emit("input",a)}else this.$root.$emit("alert-message",this.$t("generalSettings.uploadingError"),"error")})).catch((t=>this.$root.$emit("alert-message",this.$t(String(t)),"error"))).finally((()=>this.sendingImage=!1))}}}},h,[],!1,null,null,null).exports;var m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex"},[e("div",[e("v-btn",{staticClass:"btn btn-primary",attrs:{outlined:""},on:{click:function(e){return t.$refs.imageCropDrawer.open()}}},[t._v("\n      "+t._s(t.hasImage&&t.$t("generalSettings.changeLoginBackground.button")||t.$t("generalSettings.addLoginBackground.button"))+"\n    ")]),t._v(" "),t.hasImage?e("portal-general-settings-color-picker",{attrs:{label:t.$t("generalSettings.loginBackgroundFontColor")},model:{value:t.loginBackgroundTextColor,callback:function(e){t.loginBackgroundTextColor=e},expression:"loginBackgroundTextColor"}}):t._e()],1),t._v(" "),e("image-crop-drawer",{ref:"imageCropDrawer",attrs:{"crop-options":t.cropOptions,"max-file-size":t.maxFileSize,src:t.loginBackgroundPreviewSrc,"drawer-title":"generalSettings.changeLoginBackground.drawerTitle"},on:{data:function(e){t.loginBackgroundData=e}},model:{value:t.loginBackgroundUploadId,callback:function(e){t.loginBackgroundUploadId=e},expression:"loginBackgroundUploadId"}})],1)};m._withStripped=!0;const v={"portal-general-settings":n,"portal-general-settings-branding-site":r,"portal-general-settings-branding-login":s,"portal-general-settings-color-picker":c,"portal-general-settings-company-logo":u,"portal-general-settings-company-favicon":p,"portal-general-settings-login-background-selector":i({props:{value:{type:String,default:()=>null},aspectRatio:{type:Number,default:()=>16/9},defaultData:{type:String,default:null}},data:()=>({loginBackgroundData:null,loginBackgroundUploadId:null,loginBackgroundTextColor:"#FFFFFF",uploadInProgress:!1,uploadProgress:0,maxFileSize:2097152,resetInput:!1}),computed:{cropOptions(){return{aspectRatio:this.aspectRatio,cropBoxResizable:!1,minCropBoxHeight:200}},hasImage(){return this.loginBackgroundData},loginBackgroundPreviewSrc(){return this.loginBackgroundData?this.$utils.convertImageDataAsSrc(this.loginBackgroundData):this.defaultData}},watch:{loginBackgroundUploadId(){this.$emit("input",this.loginBackgroundUploadId||"")},loginBackgroundData(){this.$emit("data-updated",this.loginBackgroundData)},loginBackgroundTextColor(){this.$emit("text-color-updated",this.loginBackgroundTextColor)}},methods:{init(t,e,a){this.loginBackgroundUploadId=a||null,this.loginBackgroundData=t,this.loginBackgroundTextColor=e||"#FFFFFF",this.$refs.imageCropDrawer&&this.$refs.imageCropDrawer.init()},preSave(t){this.loginBackgroundUploadId&&Object.assign(t,{loginBackground:{uploadId:this.loginBackgroundUploadId}}),this.defaultData||this.loginBackgroundUploadId?Object.assign(t,{loginBackgroundTextColor:this.loginBackgroundTextColor}):Object.assign(t,{loginBackgroundTextColor:null})}}},m,[],!1,null,null,null).exports};for(const t in v)Vue.component(t,v[t]);const f=extensionRegistry.loadComponents("GeneralSettings");f&&f.length>0&&f.forEach((t=>{Vue.component(t.componentName,t.componentOptions)}));const b="generalSettings",S=window.eXo?.env?.portal?.language||"en",y=[`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.Login-${S}.json`,`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portal.login-${S}.json`,`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.Portlets-${S}.json`,`${eXo.env.portal.context}/${eXo.env.portal.rest}/i18n/bundle/locale.portlet.GeneralSettings-${S}.json`];function C(t){exoi18n.loadLanguageAsync(S,y).then((e=>Vue.createApp({data:{params:t},template:`<portal-general-settings id="${b}" :params="params" />`,vuetify:Vue.prototype.vuetifyOptions,i18n:e},`#${b}`,"General Settings")))}return e})()));