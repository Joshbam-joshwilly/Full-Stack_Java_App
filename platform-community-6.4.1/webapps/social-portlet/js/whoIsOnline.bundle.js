define((()=>(()=>{"use strict";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>c});var n=function(){var e=this,t=e._self._c;return t("v-app",{staticClass:"hiddenable-widget"},[e.display?t("div",{staticClass:"onlinePortlet"},[t("div",{staticClass:"white",attrs:{id:"onlineContent"}},[t("v-card-title",{staticClass:"title center"},[e._v("\n        "+e._s(e.$t("header.label"))+"\n      ")]),e._v(" "),t("div",{staticClass:"d-flex align-center justify-center flex-wrap py-3",attrs:{id:"onlineList"}},e._l(e.users,(function(e){return t("exo-user-avatar",{key:e.id,attrs:{identity:e,size:34,"popover-left-position":!0,popover:"",avatar:"","extra-class":"mx-1 mb-1"}})})),1)],1)]):e._e()])};n._withStripped=!0;var s=function(e,t,n,s,o,i,a,r){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=[],c._compiled=!0),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,l):[l]}return{exports:e,options:c}}({data:()=>({users:null,labels:null,delay:12e4,loaded:!1}),computed:{display(){return this.users&&this.users.length}},mounted(){this.$root.$applicationLoaded()},created(){document.onreadystatechange=()=>{"complete"!==document.readyState||this.loaded||(this.initOnlineUsers(this.$root.onlineUsers&&this.$root.onlineUsers.users||[]),setInterval(function(){this.retrieveOnlineUsers()}.bind(this),this.delay),this.loaded=!0)}},methods:{retrieveOnlineUsers(){return(e=eXo.env.portal.spaceId,e?fetch(`${Vue.prototype.$spacesConstants.SOCIAL_USER_API}?status=online&spaceId=${e}`,{credentials:"include"}).then((e=>e.json())):fetch(`${Vue.prototype.$spacesConstants.SOCIAL_USER_API}?status=online`,{credentials:"include"}).then((e=>e.json()))).then((e=>{this.initOnlineUsers(e&&e.users||[])}));var e},initOnlineUsers(e){if(e&&e.length){for(const t of e)t.href=`${this.$spacesConstants.PORTAL}/${this.$spacesConstants.PORTAL_NAME}/profile/${t.username}`;this.users=e}else this.users=[]}}},n);const o=s.exports;Vue.component("ExoWhoIsOnline",o);const i=`${Vue.prototype.$spacesConstants.LANG}`,a=`${Vue.prototype.$spacesConstants.PORTAL}/${Vue.prototype.$spacesConstants.PORTAL_REST}/i18n/bundle/locale.portlet.whoisonline.whoisonline-${i}.json`;if(extensionRegistry){const e=extensionRegistry.loadComponents("WhoIsOnLinePortlet");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}const r="OnlinePortlet",l="Who is Online";function c(){document.dispatchEvent(new CustomEvent("vue-app-loading-start",{detail:{appName:l,time:Date.now()}})),exoi18n.loadLanguageAsync(i,a).then((()=>{const e=JSON.parse(document.getElementById("whoIsOnlineDefaultValue").value);if(e&&e.length){const t=JSON.parse(document.getElementById("whoIsOnlineAvatarsDefaultValue").value);e.forEach((e=>{e.avatar=t[e.userId]}))}Vue.createApp({data:{onlineUsers:e},template:`<exo-who-is-online id="${r}"></exo-who-is-online>`,vuetify:Vue.prototype.vuetifyOptions,i18n:exoi18n.i18n},`#${r}`,l)}))}return t})()));