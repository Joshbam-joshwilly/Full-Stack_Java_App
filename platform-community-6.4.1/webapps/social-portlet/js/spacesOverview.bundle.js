define((()=>(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{init:()=>g});var s=function(){var e=this,t=e._self._c;return t("v-app",[t("v-card",{staticClass:"pa-4 text-center",attrs:{flat:""}},[t("v-card",{staticClass:"border-box-sizing d-flex flex-row justify-center ma-0",attrs:{flat:""}},[t("spaces-overview-card",{class:"-"===e.invitations&&"text-sub-title",attrs:{id:e.spacesInvitationOverview,title:e.$t("spacesOverview.label.invitations"),count:e.invitations},on:{click:function(t){e.$refs.spacesDrawer.open("invited",e.$t("spacesOverview.label.invitations"))}}}),e._v(" "),t("v-divider",{staticClass:"spacesOverviewVertivalSeparator ma-auto",attrs:{vertical:""}}),e._v(" "),t("spaces-overview-card",{class:"-"===e.sentRequests&&"text-sub-title",attrs:{id:e.spacesRequestsSentOverview,title:e.$t("spacesOverview.label.sentRequests"),count:e.sentRequests},on:{click:function(t){e.$refs.spacesDrawer.open("pending",e.$t("spacesOverview.label.sentPendingRequests"))}}})],1),e._v(" "),t("v-divider",{staticClass:"spacesOverviewHorizontalSeparator ma-auto"}),e._v(" "),t("v-card",{staticClass:"border-box-sizing d-flex flex-row justify-center ma-0",attrs:{flat:""}},[t("spaces-overview-card",{class:"-"===e.receivedRequests&&"text-sub-title",attrs:{id:e.spacesRequestsReceivedOverview,title:e.$t("spacesOverview.label.receivedRequests"),count:e.receivedRequests},on:{click:function(t){e.$refs.spacesDrawer.open("requests",e.$t("spacesOverview.label.receivedRequests"))}}}),e._v(" "),t("v-divider",{staticClass:"spacesOverviewVertivalSeparator ma-auto",attrs:{vertical:""}}),e._v(" "),t("spaces-overview-card",{class:"-"===e.managing&&"text-sub-title",attrs:{id:e.spacesManagingOverview,title:e.$t("spacesOverview.label.managing"),count:e.managing},on:{click:function(t){e.$refs.spacesDrawer.open("manager",e.$t("spacesOverview.label.managedSpaces"))}}})],1)],1),e._v(" "),t("spaces-overview-drawer",{ref:"spacesDrawer",on:{refresh:function(t){return e.refresh(t)}}})],1)};function i(e,t,s,i,a,n,r,c){var o,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=s,l._compiled=!0),i&&(l.functional=!0),n&&(l._scopeId="data-v-"+n),r?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},l._ssrRegister=o):a&&(o=c?function(){a.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:a),o)if(l.functional){l._injectStyles=o;var p=l.render;l.render=function(e,t){return o.call(t),p(e,t)}}else{var v=l.beforeCreate;l.beforeCreate=v?[].concat(v,o):[o]}return{exports:e,options:l}}s._withStripped=!0;const a=i({data:()=>({invitations:"-",sentRequests:"-",receivedRequests:"-",managing:"-",loading:0}),watch:{loading(e,t){t&&!e&&this.$root.$applicationLoaded()}},created(){this.refresh()},methods:{refresh(e){this.loading=0,e&&"invitations"!==e||(this.invitations="-",this.loading++,this.$spaceService.getSpaces(null,null,null,"invited").then((e=>{this.invitations=e&&e.size||0})).finally((()=>{this.loading--}))),e&&"sentRequests"!==e||(this.sentRequests="-",this.loading++,this.$spaceService.getSpaces(null,null,null,"pending").then((e=>{this.sentRequests=e&&e.size||0})).finally((()=>{this.loading--}))),e&&"receivedRequests"!==e||(this.receivedRequests="-",this.loading++,this.$spaceService.getSpaces(null,null,null,"requests").then((e=>{this.receivedRequests=e&&e.size||0})).finally((()=>{this.loading--}))),e&&"managing"!==e||(this.managing="-",this.loading++,this.$spaceService.getSpaces(null,null,null,"manager").then((e=>{this.managing=e&&e.size||0})).finally((()=>{this.loading--})))}}},s,[],!1,null,null,null).exports;var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"spacesOverviewCard d-flex flex-column",class:e.clickable,attrs:{id:e.id},on:{click:function(t){e.count&&e.$emit("click")}}},[t("v-flex",{staticClass:"ma-auto",attrs:{flat:""}},[t("div",{staticClass:"spacesOverviewCount text-center pb-1"},[e._v("\n      "+e._s(e.count)+"\n    ")]),e._v(" "),t("div",{staticClass:"spacesOverviewTitle text-center text-truncate pt-1"},[e._v("\n      "+e._s(e.title)+"\n    ")])])],1)};n._withStripped=!0;const r=i({props:{id:{type:String,default:()=>null},title:{type:String,default:()=>null},count:{type:Number,default:()=>0}},computed:{clickable(){return this.count&&"-"!==this.count&&"clickable"}}},n,[],!1,null,null,null).exports;var c=function(){var e=this,t=e._self._c;return t("exo-drawer",{ref:"overviewDrawer",attrs:{"body-classes":"hide-scroll decrease-z-index-more",right:""}},[t("template",{slot:"title"},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),t("template",{slot:"content"},[t("v-layout",{staticClass:"ma-3",attrs:{column:""}},[e.spaces&&e.spaces.length?t("spaces-overview-spaces-list",{staticClass:"ma-0 border-box-sizing",attrs:{spaces:e.spaces,filter:e.filter},on:{refresh:e.refresh,edit:e.editSpace}}):e.loadingSpaces?e._e():[t("span",{staticClass:"ma-auto"},[e._v(e._s(e.$t("spacesOverview.label.noResults")))])],e._v(" "),t("v-card-actions",{staticClass:"flex-grow-1 justify-center my-2"},[t("v-spacer"),e._v(" "),e.canShowMore?t("v-btn",{staticClass:"loadMoreButton ma-auto btn",attrs:{loading:e.loadingSpaces,disabled:e.loadingSpaces},on:{click:e.loadNextPage}},[e._v("\n          "+e._s(e.$t("spacesOverview.label.showMore"))+"\n        ")]):e._e(),e._v(" "),t("v-spacer")],1)],2)],1)],2)};c._withStripped=!0;const o=i({data:()=>({title:null,filter:null,loadingSpaces:!1,offset:0,pageSize:20,spaces:[]}),computed:{canShowMore(){return this.loadingSpaces||this.spaces.length>=this.limit}},methods:{refresh(e){this.$emit("refresh",e),this.searchSpaces()},searchSpaces(e){return this.spaces=[],this.loadingSpaces=!0,this.$spaceService.getSpaces(null,this.offset,this.limit,e||this.filter).then((t=>(this.spaces=t&&t.spaces||[],e&&(this.filter=e),this.$nextTick()))).finally((()=>this.loadingSpaces=!1))},loadNextPage(){this.limit+=this.pageSize,this.searchSpaces()},editSpace(e){document.dispatchEvent(new CustomEvent("meeds.social.editSpace",{detail:{data:e}})),this.$refs.overviewDrawer.close()},open(e,t){this.title=t,this.limit=this.pageSize,this.searchSpaces(e),this.$refs.overviewDrawer.open()}}},c,[],!1,null,null,null).exports;var l=function(){var e=this,t=e._self._c;return e.spaces&&e.spaces.length?t("v-list",{attrs:{"two-line":"",subheader:""}},e._l(e.spaces,(function(s){return t("spaces-overview-spaces-list-item",{key:s.id,attrs:{space:s,filter:e.filter},on:{refresh:function(t){return e.$emit("refresh")},edit:function(t){return e.$emit("edit",s)}}})})),1):e._e()};l._withStripped=!0;const p=i({props:{spaces:{type:Array,default:()=>null},filter:{type:String,default:()=>null}}},l,[],!1,null,null,null).exports;var v=function(){var e=this,t=e._self._c;return t("v-list-item",{staticClass:"pa-0 spaceItem"},[t("v-list-item-avatar",{staticClass:"my-0",class:e.spaceItemClass,attrs:{href:e.url,tile:""}},[t("v-avatar",{attrs:{size:e.avatarSize,tile:""}},[t("v-img",{staticClass:"mx-auto spaceAvatar",attrs:{src:e.avatarUrl,height:e.avatarSize,width:e.avatarSize,"max-height":e.avatarSize,"max-width":e.avatarSize,role:"presentation"}})],1)],1),e._v(" "),t("v-list-item-content",{staticClass:"pa-0",class:e.spaceItemClass,attrs:{href:e.url}},[t("v-list-item-title",[t("a",{staticClass:"text-color",attrs:{href:e.url}},[e._v("\n        "+e._s(e.space.displayName)+"\n      ")])]),e._v(" "),t("v-list-item-subtitle",["requests"===e.filter?[e._v("\n        "+e._s(e.$t("spacesOverview.requestToJoin.from",{0:e.space.pending[0].fullname}))+"\n      ")]:[e._v("\n        "+e._s(e.$t("spacesOverview.members",{0:e.space.membersCount}))+"\n      ")]],2)],1),e._v(" "),t("v-list-item-action",{staticClass:"ma-0 flex-row align-self-center"},["requests"===e.filter?[t("v-btn",{staticClass:"me-2 spacesOverviewCheck",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,fab:"",dark:"",depressed:""},on:{click:e.acceptUserRequest}},[t("v-icon",{attrs:{dark:""}},[e._v("\n          mdi-check\n        ")])],1),e._v(" "),t("v-btn",{staticClass:"spacesOverviewClose",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,fab:"",dark:"",depressed:""},on:{click:e.refuseUserRequest}},[t("v-icon",{attrs:{dark:""}},[e._v("\n          mdi-close\n        ")])],1)]:e._e(),e._v(" "),"invited"===e.filter?[t("v-btn",{staticClass:"me-2 spacesOverviewCheck",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,fab:"",dark:"",depressed:""},on:{click:e.acceptToJoin}},[t("v-icon",{attrs:{dark:""}},[e._v("\n          mdi-check\n        ")])],1),e._v(" "),t("v-btn",{staticClass:"spacesOverviewClose",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,fab:"",dark:"",depressed:""},on:{click:e.refuseToJoin}},[t("v-icon",{attrs:{dark:""}},[e._v("\n          mdi-close\n        ")])],1)]:e._e(),e._v(" "),"manager"===e.filter?[t("v-btn",{staticClass:"spacesOverviewCheck outlined",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,icon:"",fab:"",dark:"",depressed:""},on:{click:function(t){return e.$emit("edit")}}},[t("i",{staticClass:"uiIcon uiIconEdit"})])]:e._e(),e._v(" "),"pending"===e.filter?[t("v-btn",{staticClass:"spacesOverviewClose",attrs:{width:e.actionIconSize,height:e.actionIconSize,loading:e.sendingAction,disabled:e.sendingAction,fab:"",dark:"",depressed:""},on:{click:e.cancelRequest}},[t("v-icon",{attrs:{dark:""}},[e._v("\n          mdi-close\n        ")])],1)]:e._e()],2)],1)};v._withStripped=!0;const d={"spaces-overview":a,"spaces-overview-card":r,"spaces-overview-drawer":o,"spaces-overview-spaces-list":p,"spaces-overview-spaces-list-item":i({props:{space:{type:Object,default:()=>null},filter:{type:String,default:()=>null},avatarSize:{type:Number,default:()=>37}},data:()=>({actionIconSize:27,sendingAction:!1,spaceItemClass:`spaceList${parseInt(1e4*Math.random()).toString().toString()}`}),computed:{avatarUrl(){return this.space&&this.space.avatarUrl||`${eXo.env.portal.context}/${eXo.env.portal.rest}/v1/social/spaces/${this.space.prettyName}/avatar`},url(){if(!this.space||!this.space.groupId)return"#";const e=this.space.groupId.replace(/\//g,":");return`${eXo.env.portal.context}/g/${e}/`}},methods:{acceptUserRequest(){this.sendingAction=!0,this.$spaceService.acceptUserRequest(this.space.displayName,this.space.pending[0].username).then((()=>this.$emit("refresh","receivedRequests"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))},refuseUserRequest(){this.sendingAction=!0,this.$spaceService.refuseUserRequest(this.space.displayName,this.space.pending[0].username).then((()=>this.$emit("refresh","receivedRequests"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))},acceptToJoin(){this.sendingAction=!0,this.$spaceService.accept(this.space.id).then((()=>this.$emit("refresh","invitations"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))},refuseToJoin(){this.sendingAction=!0,this.$spaceService.deny(this.space.id).then((()=>this.$emit("refresh","invitations"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))},cancelRequest(){this.sendingAction=!0,this.$spaceService.cancel(this.space.id).then((()=>this.$emit("refresh","sentRequests"))).catch((e=>{console.error("Error processing action",e)})).finally((()=>{this.sendingAction=!1}))}}},v,[],!1,null,null,null).exports};for(const e in d)Vue.component(e,d[e]);if(extensionRegistry){const e=extensionRegistry.loadComponents("SpacesOverview");e&&e.length>0&&e.forEach((e=>{Vue.component(e.componentName,e.componentOptions)}))}const u=eXo&&eXo.env.portal.language||"en",h=`${Vue.prototype.$spacesConstants.PORTAL}/${Vue.prototype.$spacesConstants.PORTAL_REST}/i18n/bundle/locale.portlet.social.SpacesOverview-${u}.json`,f="SpacesOverview";function g(){exoi18n.loadLanguageAsync(u,h).then((e=>{Vue.createApp({template:`<spaces-overview id="${f}" />`,i18n:e,vuetify:Vue.prototype.vuetifyOptions},`#${f}`,"Spaces Overview")}))}return t})()));